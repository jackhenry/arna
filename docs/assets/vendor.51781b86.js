function ja(){}function qm(r,e){for(const n in e)r[n]=e[n];return r}function Yg(r){return r()}function tp(){return Object.create(null)}function jl(r){r.forEach(Yg)}function Xg(r){return typeof r=="function"}function Vm(r,e){return r!=r?e==e:r!==e||r&&typeof r=="object"||typeof r=="function"}function Zm(r){return Object.keys(r).length===0}function Qm(r,...e){if(r==null)return ja;const n=r.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function zF(r,e,n){r.$$.on_destroy.push(Qm(e,n))}function jF(r,e,n,a){if(r){const l=Kg(r,e,n,a);return r[0](l)}}function Kg(r,e,n,a){return r[1]&&a?qm(n.ctx.slice(),r[1](a(e))):n.ctx}function YF(r,e,n,a){if(r[2]&&a){const l=r[2](a(n));if(e.dirty===void 0)return l;if(typeof l=="object"){const f=[],h=Math.max(e.dirty.length,l.length);for(let v=0;v<h;v+=1)f[v]=e.dirty[v]|l[v];return f}return e.dirty|l}return e.dirty}function XF(r,e,n,a,l,f){if(l){const h=Kg(e,n,a,f);r.p(h,l)}}function KF(r){if(r.ctx.length>32){const e=[],n=r.ctx.length/32;for(let a=0;a<n;a++)e[a]=-1;return e}return-1}function qF(r){const e={};for(const n in r)n[0]!=="$"&&(e[n]=r[n]);return e}function VF(r,e,n){return r.set(n),e}function ZF(r){return r&&Xg(r.destroy)?r.destroy:ja}function QF(r,e){r.appendChild(e)}function JF(r,e,n){r.insertBefore(e,n||null)}function Jm(r){r.parentNode.removeChild(r)}function e$(r){return document.createElement(r)}function t$(r){return document.createElementNS("http://www.w3.org/2000/svg",r)}function qg(r){return document.createTextNode(r)}function r$(){return qg(" ")}function n$(){return qg("")}function i$(r,e,n,a){return r.addEventListener(e,n,a),()=>r.removeEventListener(e,n,a)}function a$(r,e,n){n==null?r.removeAttribute(e):r.getAttribute(e)!==n&&r.setAttribute(e,n)}function e_(r){return Array.from(r.childNodes)}function o$(r,e){e=""+e,r.wholeText!==e&&(r.data=e)}let Ul;function Ml(r){Ul=r}function qd(){if(!Ul)throw new Error("Function called outside component initialization");return Ul}function s$(r){qd().$$.on_mount.push(r)}function l$(r){qd().$$.after_update.push(r)}function u$(r){qd().$$.on_destroy.push(r)}const xl=[],rp=[],nh=[],wd=[],t_=Promise.resolve();let kd=!1;function r_(){kd||(kd=!0,t_.then(Vg))}function Od(r){nh.push(r)}function f$(r){wd.push(r)}const ld=new Set;let Wf=0;function Vg(){const r=Ul;do{for(;Wf<xl.length;){const e=xl[Wf];Wf++,Ml(e),n_(e.$$)}for(Ml(null),xl.length=0,Wf=0;rp.length;)rp.pop()();for(let e=0;e<nh.length;e+=1){const n=nh[e];ld.has(n)||(ld.add(n),n())}nh.length=0}while(xl.length);for(;wd.length;)wd.pop()();kd=!1,ld.clear(),Ml(r)}function n_(r){if(r.fragment!==null){r.update(),jl(r.before_update);const e=r.dirty;r.dirty=[-1],r.fragment&&r.fragment.p(r.ctx,e),r.after_update.forEach(Od)}}const ih=new Set;let za;function h$(){za={r:0,c:[],p:za}}function c$(){za.r||jl(za.c),za=za.p}function Zg(r,e){r&&r.i&&(ih.delete(r),r.i(e))}function i_(r,e,n,a){if(r&&r.o){if(ih.has(r))return;ih.add(r),za.c.push(()=>{ih.delete(r),a&&(n&&r.d(1),a())}),r.o(e)}}function d$(r,e){i_(r,1,1,()=>{e.delete(r.key)})}function v$(r,e,n,a,l,f,h,v,d,p,S,E){let A=r.length,O=f.length,k=A;const T={};for(;k--;)T[r[k].key]=k;const x=[],G=new Map,j=new Map;for(k=O;k--;){const P=E(l,f,k),I=n(P);let D=h.get(I);D?a&&D.p(P,e):(D=p(I,P),D.c()),G.set(I,x[k]=D),I in T&&j.set(I,Math.abs(k-T[I]))}const B=new Set,U=new Set;function J(P){Zg(P,1),P.m(v,S),h.set(P.key,P),S=P.first,O--}for(;A&&O;){const P=x[O-1],I=r[A-1],D=P.key,R=I.key;P===I?(S=P.first,A--,O--):G.has(R)?!h.has(D)||B.has(D)?J(P):U.has(R)?A--:j.get(D)>j.get(R)?(U.add(D),J(P)):(B.add(R),A--):(d(I,h),A--)}for(;A--;){const P=r[A];G.has(P.key)||d(P,h)}for(;O;)J(x[O-1]);return x}function p$(r,e,n){const a=r.$$.props[e];a!==void 0&&(r.$$.bound[a]=n,n(r.$$.ctx[a]))}function g$(r){r&&r.c()}function a_(r,e,n,a){const{fragment:l,on_mount:f,on_destroy:h,after_update:v}=r.$$;l&&l.m(e,n),a||Od(()=>{const d=f.map(Yg).filter(Xg);h?h.push(...d):jl(d),r.$$.on_mount=[]}),v.forEach(Od)}function o_(r,e){const n=r.$$;n.fragment!==null&&(jl(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function s_(r,e){r.$$.dirty[0]===-1&&(xl.push(r),r_(),r.$$.dirty.fill(0)),r.$$.dirty[e/31|0]|=1<<e%31}function y$(r,e,n,a,l,f,h,v=[-1]){const d=Ul;Ml(r);const p=r.$$={fragment:null,ctx:null,props:f,update:ja,not_equal:l,bound:tp(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(d?d.$$.context:[])),callbacks:tp(),dirty:v,skip_bound:!1,root:e.target||d.$$.root};h&&h(p.root);let S=!1;if(p.ctx=n?n(r,e.props||{},(E,A,...O)=>{const k=O.length?O[0]:A;return p.ctx&&l(p.ctx[E],p.ctx[E]=k)&&(!p.skip_bound&&p.bound[E]&&p.bound[E](k),S&&s_(r,E)),A}):[],p.update(),S=!0,jl(p.before_update),p.fragment=a?a(p.ctx):!1,e.target){if(e.hydrate){const E=e_(e.target);p.fragment&&p.fragment.l(E),E.forEach(Jm)}else p.fragment&&p.fragment.c();e.intro&&Zg(r.$$.fragment),a_(r,e.target,e.anchor,e.customElement),Vg()}Ml(d)}class m${$destroy(){o_(this,1),this.$destroy=ja}$on(e,n){const a=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return a.push(n),()=>{const l=a.indexOf(n);l!==-1&&a.splice(l,1)}}$set(e){this.$$set&&!Zm(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}var _e=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function _$(r){if(r.__esModule)return r;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(r).forEach(function(n){var a=Object.getOwnPropertyDescriptor(r,n);Object.defineProperty(e,n,a.get?a:{enumerable:!0,get:function(){return r[n]}})}),e}var Qg={exports:{}};(function(r,e){(function(n,a){r.exports=a()})(_e,function(){var n=navigator.userAgent,a=navigator.platform,l=/gecko\/\d/i.test(n),f=/MSIE \d/.test(n),h=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(n),v=/Edge\/(\d+)/.exec(n),d=f||h||v,p=d&&(f?document.documentMode||6:+(v||h)[1]),S=!v&&/WebKit\//.test(n),E=S&&/Qt\/\d+\.\d+/.test(n),A=!v&&/Chrome\//.test(n),O=/Opera\//.test(n),k=/Apple Computer/.test(navigator.vendor),T=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(n),x=/PhantomJS/.test(n),G=k&&(/Mobile\/\w+/.test(n)||navigator.maxTouchPoints>2),j=/Android/.test(n),B=G||j||/webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(n),U=G||/Mac/.test(a),J=/\bCrOS\b/.test(n),P=/win/i.test(a),I=O&&n.match(/Version\/(\d*\.\d*)/);I&&(I=Number(I[1])),I&&I>=15&&(O=!1,S=!0);var D=U&&(E||O&&(I==null||I<12.11)),R=l||d&&p>=9;function Y(t){return new RegExp("(^|\\s)"+t+"(?:$|\\s)\\s*")}var re=function(t,i){var s=t.className,o=Y(i).exec(s);if(o){var u=s.slice(o.index+o[0].length);t.className=s.slice(0,o.index)+(u?o[1]+u:"")}};function se(t){for(var i=t.childNodes.length;i>0;--i)t.removeChild(t.firstChild);return t}function Q(t,i){return se(t).appendChild(i)}function q(t,i,s,o){var u=document.createElement(t);if(s&&(u.className=s),o&&(u.style.cssText=o),typeof i=="string")u.appendChild(document.createTextNode(i));else if(i)for(var c=0;c<i.length;++c)u.appendChild(i[c]);return u}function Ce(t,i,s,o){var u=q(t,i,s,o);return u.setAttribute("role","presentation"),u}var K;document.createRange?K=function(t,i,s,o){var u=document.createRange();return u.setEnd(o||t,s),u.setStart(t,i),u}:K=function(t,i,s){var o=document.body.createTextRange();try{o.moveToElementText(t.parentNode)}catch{return o}return o.collapse(!0),o.moveEnd("character",s),o.moveStart("character",i),o};function ne(t,i){if(i.nodeType==3&&(i=i.parentNode),t.contains)return t.contains(i);do if(i.nodeType==11&&(i=i.host),i==t)return!0;while(i=i.parentNode)}function te(){var t;try{t=document.activeElement}catch{t=document.body||null}for(;t&&t.shadowRoot&&t.shadowRoot.activeElement;)t=t.shadowRoot.activeElement;return t}function pe(t,i){var s=t.className;Y(i).test(s)||(t.className+=(s?" ":"")+i)}function le(t,i){for(var s=t.split(" "),o=0;o<s.length;o++)s[o]&&!Y(s[o]).test(i)&&(i+=" "+s[o]);return i}var Ee=function(t){t.select()};G?Ee=function(t){t.selectionStart=0,t.selectionEnd=t.value.length}:d&&(Ee=function(t){try{t.select()}catch{}});function Be(t){var i=Array.prototype.slice.call(arguments,1);return function(){return t.apply(null,i)}}function Ke(t,i,s){i||(i={});for(var o in t)t.hasOwnProperty(o)&&(s!==!1||!i.hasOwnProperty(o))&&(i[o]=t[o]);return i}function Ne(t,i,s,o,u){i==null&&(i=t.search(/[^\s\u00a0]/),i==-1&&(i=t.length));for(var c=o||0,g=u||0;;){var m=t.indexOf("	",c);if(m<0||m>=i)return g+(i-c);g+=m-c,g+=s-g%s,c=m+1}}var Ye=function(){this.id=null,this.f=null,this.time=0,this.handler=Be(this.onTimeout,this)};Ye.prototype.onTimeout=function(t){t.id=0,t.time<=+new Date?t.f():setTimeout(t.handler,t.time-+new Date)},Ye.prototype.set=function(t,i){this.f=i;var s=+new Date+t;(!this.id||s<this.time)&&(clearTimeout(this.id),this.id=setTimeout(this.handler,t),this.time=s)};function Ue(t,i){for(var s=0;s<t.length;++s)if(t[s]==i)return s;return-1}var Xe=50,lt={toString:function(){return"CodeMirror.Pass"}},ht={scroll:!1},Tt={origin:"*mouse"},Ft={origin:"+move"};function mr(t,i,s){for(var o=0,u=0;;){var c=t.indexOf("	",o);c==-1&&(c=t.length);var g=c-o;if(c==t.length||u+g>=i)return o+Math.min(g,i-u);if(u+=c-o,u+=s-u%s,o=c+1,u>=i)return o}}var $t=[""];function Gt(t){for(;$t.length<=t;)$t.push(Ve($t)+" ");return $t[t]}function Ve(t){return t[t.length-1]}function Pr(t,i){for(var s=[],o=0;o<t.length;o++)s[o]=i(t[o],o);return s}function rn(t,i,s){for(var o=0,u=s(i);o<t.length&&s(t[o])<=u;)o++;t.splice(o,0,i)}function sr(){}function Tr(t,i){var s;return Object.create?s=Object.create(t):(sr.prototype=t,s=new sr),i&&Ke(i,s),s}var nn=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;function an(t){return/\w/.test(t)||t>"\x80"&&(t.toUpperCase()!=t.toLowerCase()||nn.test(t))}function Cr(t,i){return i?i.source.indexOf("\\w")>-1&&an(t)?!0:i.test(t):an(t)}function yn(t){for(var i in t)if(t.hasOwnProperty(i)&&t[i])return!1;return!0}var mn=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function qr(t){return t.charCodeAt(0)>=768&&mn.test(t)}function on(t,i,s){for(;(s<0?i>0:i<t.length)&&qr(t.charAt(i));)i+=s;return i}function Xt(t,i,s){for(var o=i>s?-1:1;;){if(i==s)return i;var u=(i+s)/2,c=o<0?Math.ceil(u):Math.floor(u);if(c==i)return t(c)?i:s;t(c)?s=c:i=c+o}}function ue(t,i,s,o){if(!t)return o(i,s,"ltr",0);for(var u=!1,c=0;c<t.length;++c){var g=t[c];(g.from<s&&g.to>i||i==s&&g.to==i)&&(o(Math.max(g.from,i),Math.min(g.to,s),g.level==1?"rtl":"ltr",c),u=!0)}u||o(i,s,"ltr")}var he=null;function ge(t,i,s){var o;he=null;for(var u=0;u<t.length;++u){var c=t[u];if(c.from<i&&c.to>i)return u;c.to==i&&(c.from!=c.to&&s=="before"?o=u:he=u),c.from==i&&(c.from!=c.to&&s!="before"?o=u:he=u)}return o!=null?o:he}var Se=function(){var t="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",i="nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111";function s(C){return C<=247?t.charAt(C):1424<=C&&C<=1524?"R":1536<=C&&C<=1785?i.charAt(C-1536):1774<=C&&C<=2220?"r":8192<=C&&C<=8203?"w":C==8204?"b":"L"}var o=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,u=/[stwN]/,c=/[LRr]/,g=/[Lb1n]/,m=/[1n]/;function _(C,L,M){this.level=C,this.from=L,this.to=M}return function(C,L){var M=L=="ltr"?"L":"R";if(C.length==0||L=="ltr"&&!o.test(C))return!1;for(var X=C.length,z=[],ie=0;ie<X;++ie)z.push(s(C.charCodeAt(ie)));for(var oe=0,ve=M;oe<X;++oe){var ke=z[oe];ke=="m"?z[oe]=ve:ve=ke}for(var xe=0,Oe=M;xe<X;++xe){var Pe=z[xe];Pe=="1"&&Oe=="r"?z[xe]="n":c.test(Pe)&&(Oe=Pe,Pe=="r"&&(z[xe]="R"))}for(var We=1,Ge=z[0];We<X-1;++We){var Je=z[We];Je=="+"&&Ge=="1"&&z[We+1]=="1"?z[We]="1":Je==","&&Ge==z[We+1]&&(Ge=="1"||Ge=="n")&&(z[We]=Ge),Ge=Je}for(var At=0;At<X;++At){var hr=z[At];if(hr==",")z[At]="N";else if(hr=="%"){var Mt=void 0;for(Mt=At+1;Mt<X&&z[Mt]=="%";++Mt);for(var Yr=At&&z[At-1]=="!"||Mt<X&&z[Mt]=="1"?"1":"N",Dr=At;Dr<Mt;++Dr)z[Dr]=Yr;At=Mt-1}}for(var er=0,Fr=M;er<X;++er){var gr=z[er];Fr=="L"&&gr=="1"?z[er]="L":c.test(gr)&&(Fr=gr)}for(var or=0;or<X;++or)if(u.test(z[or])){var tr=void 0;for(tr=or+1;tr<X&&u.test(z[tr]);++tr);for(var Ht=(or?z[or-1]:M)=="L",$r=(tr<X?z[tr]:M)=="L",zo=Ht==$r?Ht?"L":"R":M,sa=or;sa<tr;++sa)z[sa]=zo;or=tr-1}for(var Sr=[],Zn,cr=0;cr<X;)if(g.test(z[cr])){var od=cr;for(++cr;cr<X&&g.test(z[cr]);++cr);Sr.push(new _(0,od,cr))}else{var xi=cr,Wa=Sr.length,Ba=L=="rtl"?1:0;for(++cr;cr<X&&z[cr]!="L";++cr);for(var Or=xi;Or<cr;)if(m.test(z[Or])){xi<Or&&(Sr.splice(Wa,0,new _(1,xi,Or)),Wa+=Ba);var jo=Or;for(++Or;Or<cr&&m.test(z[Or]);++Or);Sr.splice(Wa,0,new _(2,jo,Or)),Wa+=Ba,xi=Or}else++Or;xi<cr&&Sr.splice(Wa,0,new _(1,xi,cr))}return L=="ltr"&&(Sr[0].level==1&&(Zn=C.match(/^\s+/))&&(Sr[0].from=Zn[0].length,Sr.unshift(new _(0,0,Zn[0].length))),Ve(Sr).level==1&&(Zn=C.match(/\s+$/))&&(Ve(Sr).to-=Zn[0].length,Sr.push(new _(0,X-Zn[0].length,X)))),L=="rtl"?Sr.reverse():Sr}}();function Te(t,i){var s=t.order;return s==null&&(s=t.order=Se(t.text,i)),s}var Fe=[],be=function(t,i,s){if(t.addEventListener)t.addEventListener(i,s,!1);else if(t.attachEvent)t.attachEvent("on"+i,s);else{var o=t._handlers||(t._handlers={});o[i]=(o[i]||Fe).concat(s)}};function ct(t,i){return t._handlers&&t._handlers[i]||Fe}function it(t,i,s){if(t.removeEventListener)t.removeEventListener(i,s,!1);else if(t.detachEvent)t.detachEvent("on"+i,s);else{var o=t._handlers,u=o&&o[i];if(u){var c=Ue(u,s);c>-1&&(o[i]=u.slice(0,c).concat(u.slice(c+1)))}}}function ot(t,i){var s=ct(t,i);if(!!s.length)for(var o=Array.prototype.slice.call(arguments,2),u=0;u<s.length;++u)s[u].apply(null,o)}function yt(t,i,s){return typeof i=="string"&&(i={type:i,preventDefault:function(){this.defaultPrevented=!0}}),ot(t,s||i.type,t,i),Nt(i)||i.codemirrorIgnore}function Br(t){var i=t._handlers&&t._handlers.cursorActivity;if(!!i)for(var s=t.curOp.cursorActivityHandlers||(t.curOp.cursorActivityHandlers=[]),o=0;o<i.length;++o)Ue(s,i[o])==-1&&s.push(i[o])}function ir(t,i){return ct(t,i).length>0}function Ur(t){t.prototype.on=function(i,s){be(this,i,s)},t.prototype.off=function(i,s){it(this,i,s)}}function xt(t){t.preventDefault?t.preventDefault():t.returnValue=!1}function Hr(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}function Nt(t){return t.defaultPrevented!=null?t.defaultPrevented:t.returnValue==!1}function Er(t){xt(t),Hr(t)}function at(t){return t.target||t.srcElement}function $e(t){var i=t.which;return i==null&&(t.button&1?i=1:t.button&2?i=3:t.button&4&&(i=2)),U&&t.ctrlKey&&i==1&&(i=3),i}var Wt=function(){if(d&&p<9)return!1;var t=q("div");return"draggable"in t||"dragDrop"in t}(),_n;function Wi(t){if(_n==null){var i=q("span","\u200B");Q(t,q("span",[i,document.createTextNode("x")])),t.firstChild.offsetHeight!=0&&(_n=i.offsetWidth<=1&&i.offsetHeight>2&&!(d&&p<8))}var s=_n?q("span","\u200B"):q("span","\xA0",null,"display: inline-block; width: 1px; margin-right: -1px");return s.setAttribute("cm-text",""),s}var Bi;function va(t){if(Bi!=null)return Bi;var i=Q(t,document.createTextNode("A\u062EA")),s=K(i,0,1).getBoundingClientRect(),o=K(i,1,2).getBoundingClientRect();return se(t),!s||s.left==s.right?!1:Bi=o.right-s.right<3}var sn=`

b`.split(/\n/).length!=3?function(t){for(var i=0,s=[],o=t.length;i<=o;){var u=t.indexOf(`
`,i);u==-1&&(u=t.length);var c=t.slice(i,t.charAt(u-1)=="\r"?u-1:u),g=c.indexOf("\r");g!=-1?(s.push(c.slice(0,g)),i+=g+1):(s.push(c),i=u+1)}return s}:function(t){return t.split(/\r\n?|\n/)},Cs=window.getSelection?function(t){try{return t.selectionStart!=t.selectionEnd}catch{return!1}}:function(t){var i;try{i=t.ownerDocument.selection.createRange()}catch{}return!i||i.parentElement()!=t?!1:i.compareEndPoints("StartToEnd",i)!=0},pa=function(){var t=q("div");return"oncopy"in t?!0:(t.setAttribute("oncopy","return;"),typeof t.oncopy=="function")}(),Es=null;function so(t){if(Es!=null)return Es;var i=Q(t,q("span","x")),s=i.getBoundingClientRect(),o=K(i,0,1).getBoundingClientRect();return Es=Math.abs(s.left-o.left)>1}var As={},pi={};function oc(t,i){arguments.length>2&&(i.dependencies=Array.prototype.slice.call(arguments,2)),As[t]=i}function sc(t,i){pi[t]=i}function lo(t){if(typeof t=="string"&&pi.hasOwnProperty(t))t=pi[t];else if(t&&typeof t.name=="string"&&pi.hasOwnProperty(t.name)){var i=pi[t.name];typeof i=="string"&&(i={name:i}),t=Tr(i,t),t.name=i.name}else{if(typeof t=="string"&&/^[\w\-]+\/[\w\-]+\+xml$/.test(t))return lo("application/xml");if(typeof t=="string"&&/^[\w\-]+\/[\w\-]+\+json$/.test(t))return lo("application/json")}return typeof t=="string"?{name:t}:t||{name:"null"}}function uo(t,i){i=lo(i);var s=As[i.name];if(!s)return uo(t,"text/plain");var o=s(t,i);if(Ui.hasOwnProperty(i.name)){var u=Ui[i.name];for(var c in u)!u.hasOwnProperty(c)||(o.hasOwnProperty(c)&&(o["_"+c]=o[c]),o[c]=u[c])}if(o.name=i.name,i.helperType&&(o.helperType=i.helperType),i.modeProps)for(var g in i.modeProps)o[g]=i.modeProps[g];return o}var Ui={};function du(t,i){var s=Ui.hasOwnProperty(t)?Ui[t]:Ui[t]={};Ke(i,s)}function gi(t,i){if(i===!0)return i;if(t.copyState)return t.copyState(i);var s={};for(var o in i){var u=i[o];u instanceof Array&&(u=u.concat([])),s[o]=u}return s}function fo(t,i){for(var s;t.innerMode&&(s=t.innerMode(i),!(!s||s.mode==t));)i=s.state,t=s.mode;return s||{mode:t,state:i}}function vu(t,i,s){return t.startState?t.startState(i,s):!0}var Bt=function(t,i,s){this.pos=this.start=0,this.string=t,this.tabSize=i||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0,this.lineOracle=s};Bt.prototype.eol=function(){return this.pos>=this.string.length},Bt.prototype.sol=function(){return this.pos==this.lineStart},Bt.prototype.peek=function(){return this.string.charAt(this.pos)||void 0},Bt.prototype.next=function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},Bt.prototype.eat=function(t){var i=this.string.charAt(this.pos),s;if(typeof t=="string"?s=i==t:s=i&&(t.test?t.test(i):t(i)),s)return++this.pos,i},Bt.prototype.eatWhile=function(t){for(var i=this.pos;this.eat(t););return this.pos>i},Bt.prototype.eatSpace=function(){for(var t=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>t},Bt.prototype.skipToEnd=function(){this.pos=this.string.length},Bt.prototype.skipTo=function(t){var i=this.string.indexOf(t,this.pos);if(i>-1)return this.pos=i,!0},Bt.prototype.backUp=function(t){this.pos-=t},Bt.prototype.column=function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=Ne(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?Ne(this.string,this.lineStart,this.tabSize):0)},Bt.prototype.indentation=function(){return Ne(this.string,null,this.tabSize)-(this.lineStart?Ne(this.string,this.lineStart,this.tabSize):0)},Bt.prototype.match=function(t,i,s){if(typeof t=="string"){var o=function(g){return s?g.toLowerCase():g},u=this.string.substr(this.pos,t.length);if(o(u)==o(t))return i!==!1&&(this.pos+=t.length),!0}else{var c=this.string.slice(this.pos).match(t);return c&&c.index>0?null:(c&&i!==!1&&(this.pos+=c[0].length),c)}},Bt.prototype.current=function(){return this.string.slice(this.start,this.pos)},Bt.prototype.hideFirstChars=function(t,i){this.lineStart+=t;try{return i()}finally{this.lineStart-=t}},Bt.prototype.lookAhead=function(t){var i=this.lineOracle;return i&&i.lookAhead(t)},Bt.prototype.baseToken=function(){var t=this.lineOracle;return t&&t.baseToken(this.pos)};function Me(t,i){if(i-=t.first,i<0||i>=t.size)throw new Error("There is no line "+(i+t.first)+" in the document.");for(var s=t;!s.lines;)for(var o=0;;++o){var u=s.children[o],c=u.chunkSize();if(i<c){s=u;break}i-=c}return s.lines[i]}function yi(t,i,s){var o=[],u=i.line;return t.iter(i.line,s.line+1,function(c){var g=c.text;u==s.line&&(g=g.slice(0,s.ch)),u==i.line&&(g=g.slice(i.ch)),o.push(g),++u}),o}function ws(t,i,s){var o=[];return t.iter(i,s,function(u){o.push(u.text)}),o}function ln(t,i){var s=i-t.height;if(s)for(var o=t;o;o=o.parent)o.height+=s}function pt(t){if(t.parent==null)return null;for(var i=t.parent,s=Ue(i.lines,t),o=i.parent;o;i=o,o=o.parent)for(var u=0;o.children[u]!=i;++u)s+=o.children[u].chunkSize();return s+i.first}function mi(t,i){var s=t.first;e:do{for(var o=0;o<t.children.length;++o){var u=t.children[o],c=u.height;if(i<c){t=u;continue e}i-=c,s+=u.chunkSize()}return s}while(!t.lines);for(var g=0;g<t.lines.length;++g){var m=t.lines[g],_=m.height;if(i<_)break;i-=_}return s+g}function ga(t,i){return i>=t.first&&i<t.first+t.size}function ya(t,i){return String(t.lineNumberFormatter(i+t.firstLineNumber))}function fe(t,i,s){if(s===void 0&&(s=null),!(this instanceof fe))return new fe(t,i,s);this.line=t,this.ch=i,this.sticky=s}function ze(t,i){return t.line-i.line||t.ch-i.ch}function Bn(t,i){return t.sticky==i.sticky&&ze(t,i)==0}function ks(t){return fe(t.line,t.ch)}function ho(t,i){return ze(t,i)<0?i:t}function co(t,i){return ze(t,i)<0?t:i}function pu(t,i){return Math.max(t.first,Math.min(i,t.first+t.size-1))}function je(t,i){if(i.line<t.first)return fe(t.first,0);var s=t.first+t.size-1;return i.line>s?fe(s,Me(t,s).text.length):gu(i,Me(t,i.line).text.length)}function gu(t,i){var s=t.ch;return s==null||s>i?fe(t.line,i):s<0?fe(t.line,0):t}function Os(t,i){for(var s=[],o=0;o<i.length;o++)s[o]=je(t,i[o]);return s}var vo=function(t,i){this.state=t,this.lookAhead=i},un=function(t,i,s,o){this.state=i,this.doc=t,this.line=s,this.maxLookAhead=o||0,this.baseTokens=null,this.baseTokenPos=1};un.prototype.lookAhead=function(t){var i=this.doc.getLine(this.line+t);return i!=null&&t>this.maxLookAhead&&(this.maxLookAhead=t),i},un.prototype.baseToken=function(t){if(!this.baseTokens)return null;for(;this.baseTokens[this.baseTokenPos]<=t;)this.baseTokenPos+=2;var i=this.baseTokens[this.baseTokenPos+1];return{type:i&&i.replace(/( |^)overlay .*/,""),size:this.baseTokens[this.baseTokenPos]-t}},un.prototype.nextLine=function(){this.line++,this.maxLookAhead>0&&this.maxLookAhead--},un.fromSaved=function(t,i,s){return i instanceof vo?new un(t,gi(t.mode,i.state),s,i.lookAhead):new un(t,gi(t.mode,i),s)},un.prototype.save=function(t){var i=t!==!1?gi(this.doc.mode,this.state):this.state;return this.maxLookAhead>0?new vo(i,this.maxLookAhead):i};function yu(t,i,s,o){var u=[t.state.modeGen],c={};Cu(t,i.text,t.doc.mode,s,function(C,L){return u.push(C,L)},c,o);for(var g=s.state,m=function(C){s.baseTokens=u;var L=t.state.overlays[C],M=1,X=0;s.state=!0,Cu(t,i.text,L.mode,s,function(z,ie){for(var oe=M;X<z;){var ve=u[M];ve>z&&u.splice(M,1,z,u[M+1],ve),M+=2,X=Math.min(z,ve)}if(!!ie)if(L.opaque)u.splice(oe,M-oe,z,"overlay "+ie),M=oe+2;else for(;oe<M;oe+=2){var ke=u[oe+1];u[oe+1]=(ke?ke+" ":"")+"overlay "+ie}},c),s.state=g,s.baseTokens=null,s.baseTokenPos=1},_=0;_<t.state.overlays.length;++_)m(_);return{styles:u,classes:c.bgClass||c.textClass?c:null}}function mu(t,i,s){if(!i.styles||i.styles[0]!=t.state.modeGen){var o=Hi(t,pt(i)),u=i.text.length>t.options.maxHighlightLength&&gi(t.doc.mode,o.state),c=yu(t,i,o);u&&(o.state=u),i.stateAfter=o.save(!u),i.styles=c.styles,c.classes?i.styleClasses=c.classes:i.styleClasses&&(i.styleClasses=null),s===t.doc.highlightFrontier&&(t.doc.modeFrontier=Math.max(t.doc.modeFrontier,++t.doc.highlightFrontier))}return i.styles}function Hi(t,i,s){var o=t.doc,u=t.display;if(!o.mode.startState)return new un(o,!0,i);var c=lc(t,i,s),g=c>o.first&&Me(o,c-1).stateAfter,m=g?un.fromSaved(o,g,c):new un(o,vu(o.mode),c);return o.iter(c,i,function(_){po(t,_.text,m);var C=m.line;_.stateAfter=C==i-1||C%5==0||C>=u.viewFrom&&C<u.viewTo?m.save():null,m.nextLine()}),s&&(o.modeFrontier=m.line),m}function po(t,i,s,o){var u=t.doc.mode,c=new Bt(i,t.options.tabSize,s);for(c.start=c.pos=o||0,i==""&&_u(u,s.state);!c.eol();)xs(u,c,s.state),c.start=c.pos}function _u(t,i){if(t.blankLine)return t.blankLine(i);if(!!t.innerMode){var s=fo(t,i);if(s.mode.blankLine)return s.mode.blankLine(s.state)}}function xs(t,i,s,o){for(var u=0;u<10;u++){o&&(o[0]=fo(t,s).mode);var c=t.token(i,s);if(i.pos>i.start)return c}throw new Error("Mode "+t.name+" failed to advance stream.")}var bu=function(t,i,s){this.start=t.start,this.end=t.pos,this.string=t.current(),this.type=i||null,this.state=s};function Su(t,i,s,o){var u=t.doc,c=u.mode,g;i=je(u,i);var m=Me(u,i.line),_=Hi(t,i.line,s),C=new Bt(m.text,t.options.tabSize,_),L;for(o&&(L=[]);(o||C.pos<i.ch)&&!C.eol();)C.start=C.pos,g=xs(c,C,_.state),o&&L.push(new bu(C,g,gi(u.mode,_.state)));return o?L:new bu(C,g,_.state)}function Tu(t,i){if(t)for(;;){var s=t.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!s)break;t=t.slice(0,s.index)+t.slice(s.index+s[0].length);var o=s[1]?"bgClass":"textClass";i[o]==null?i[o]=s[2]:new RegExp("(?:^|\\s)"+s[2]+"(?:$|\\s)").test(i[o])||(i[o]+=" "+s[2])}return t}function Cu(t,i,s,o,u,c,g){var m=s.flattenSpans;m==null&&(m=t.options.flattenSpans);var _=0,C=null,L=new Bt(i,t.options.tabSize,o),M,X=t.options.addModeClass&&[null];for(i==""&&Tu(_u(s,o.state),c);!L.eol();){if(L.pos>t.options.maxHighlightLength?(m=!1,g&&po(t,i,o,L.pos),L.pos=i.length,M=null):M=Tu(xs(s,L,o.state,X),c),X){var z=X[0].name;z&&(M="m-"+(M?z+" "+M:z))}if(!m||C!=M){for(;_<L.start;)_=Math.min(L.start,_+5e3),u(_,C);C=M}L.start=L.pos}for(;_<L.pos;){var ie=Math.min(L.pos,_+5e3);u(ie,C),_=ie}}function lc(t,i,s){for(var o,u,c=t.doc,g=s?-1:i-(t.doc.mode.innerMode?1e3:100),m=i;m>g;--m){if(m<=c.first)return c.first;var _=Me(c,m-1),C=_.stateAfter;if(C&&(!s||m+(C instanceof vo?C.lookAhead:0)<=c.modeFrontier))return m;var L=Ne(_.text,null,t.options.tabSize);(u==null||o>L)&&(u=m-1,o=L)}return u}function uc(t,i){if(t.modeFrontier=Math.min(t.modeFrontier,i),!(t.highlightFrontier<i-10)){for(var s=t.first,o=i-1;o>s;o--){var u=Me(t,o).stateAfter;if(u&&(!(u instanceof vo)||o+u.lookAhead<i)){s=o+1;break}}t.highlightFrontier=Math.min(t.highlightFrontier,s)}}var Eu=!1,bn=!1;function fc(){Eu=!0}function hc(){bn=!0}function go(t,i,s){this.marker=t,this.from=i,this.to=s}function zi(t,i){if(t)for(var s=0;s<t.length;++s){var o=t[s];if(o.marker==i)return o}}function Au(t,i){for(var s,o=0;o<t.length;++o)t[o]!=i&&(s||(s=[])).push(t[o]);return s}function cc(t,i,s){var o=s&&window.WeakSet&&(s.markedSpans||(s.markedSpans=new WeakSet));o&&o.has(t.markedSpans)?t.markedSpans.push(i):(t.markedSpans=t.markedSpans?t.markedSpans.concat([i]):[i],o&&o.add(t.markedSpans)),i.marker.attachLine(t)}function yo(t,i,s){var o;if(t)for(var u=0;u<t.length;++u){var c=t[u],g=c.marker,m=c.from==null||(g.inclusiveLeft?c.from<=i:c.from<i);if(m||c.from==i&&g.type=="bookmark"&&(!s||!c.marker.insertLeft)){var _=c.to==null||(g.inclusiveRight?c.to>=i:c.to>i);(o||(o=[])).push(new go(g,c.from,_?null:c.to))}}return o}function ji(t,i,s){var o;if(t)for(var u=0;u<t.length;++u){var c=t[u],g=c.marker,m=c.to==null||(g.inclusiveRight?c.to>=i:c.to>i);if(m||c.from==i&&g.type=="bookmark"&&(!s||c.marker.insertLeft)){var _=c.from==null||(g.inclusiveLeft?c.from<=i:c.from<i);(o||(o=[])).push(new go(g,_?null:c.from-i,c.to==null?null:c.to-i))}}return o}function Rs(t,i){if(i.full)return null;var s=ga(t,i.from.line)&&Me(t,i.from.line).markedSpans,o=ga(t,i.to.line)&&Me(t,i.to.line).markedSpans;if(!s&&!o)return null;var u=i.from.ch,c=i.to.ch,g=ze(i.from,i.to)==0,m=yo(s,u,g),_=ji(o,c,g),C=i.text.length==1,L=Ve(i.text).length+(C?u:0);if(m)for(var M=0;M<m.length;++M){var X=m[M];if(X.to==null){var z=zi(_,X.marker);z?C&&(X.to=z.to==null?null:z.to+L):X.to=u}}if(_)for(var ie=0;ie<_.length;++ie){var oe=_[ie];if(oe.to!=null&&(oe.to+=L),oe.from==null){var ve=zi(m,oe.marker);ve||(oe.from=L,C&&(m||(m=[])).push(oe))}else oe.from+=L,C&&(m||(m=[])).push(oe)}m&&(m=Ps(m)),_&&_!=m&&(_=Ps(_));var ke=[m];if(!C){var xe=i.text.length-2,Oe;if(xe>0&&m)for(var Pe=0;Pe<m.length;++Pe)m[Pe].to==null&&(Oe||(Oe=[])).push(new go(m[Pe].marker,null,null));for(var We=0;We<xe;++We)ke.push(Oe);ke.push(_)}return ke}function Ps(t){for(var i=0;i<t.length;++i){var s=t[i];s.from!=null&&s.from==s.to&&s.marker.clearWhenEmpty!==!1&&t.splice(i--,1)}return t.length?t:null}function dc(t,i,s){var o=null;if(t.iter(i.line,s.line+1,function(z){if(z.markedSpans)for(var ie=0;ie<z.markedSpans.length;++ie){var oe=z.markedSpans[ie].marker;oe.readOnly&&(!o||Ue(o,oe)==-1)&&(o||(o=[])).push(oe)}}),!o)return null;for(var u=[{from:i,to:s}],c=0;c<o.length;++c)for(var g=o[c],m=g.find(0),_=0;_<u.length;++_){var C=u[_];if(!(ze(C.to,m.from)<0||ze(C.from,m.to)>0)){var L=[_,1],M=ze(C.from,m.from),X=ze(C.to,m.to);(M<0||!g.inclusiveLeft&&!M)&&L.push({from:C.from,to:m.from}),(X>0||!g.inclusiveRight&&!X)&&L.push({from:m.to,to:C.to}),u.splice.apply(u,L),_+=L.length-3}}return u}function mo(t){var i=t.markedSpans;if(!!i){for(var s=0;s<i.length;++s)i[s].marker.detachLine(t);t.markedSpans=null}}function _o(t,i){if(!!i){for(var s=0;s<i.length;++s)i[s].marker.attachLine(t);t.markedSpans=i}}function bo(t){return t.inclusiveLeft?-1:0}function ma(t){return t.inclusiveRight?1:0}function Un(t,i){var s=t.lines.length-i.lines.length;if(s!=0)return s;var o=t.find(),u=i.find(),c=ze(o.from,u.from)||bo(t)-bo(i);if(c)return-c;var g=ze(o.to,u.to)||ma(t)-ma(i);return g||i.id-t.id}function wu(t,i){var s=bn&&t.markedSpans,o;if(s)for(var u=void 0,c=0;c<s.length;++c)u=s[c],u.marker.collapsed&&(i?u.from:u.to)==null&&(!o||Un(o,u.marker)<0)&&(o=u.marker);return o}function ku(t){return wu(t,!0)}function So(t){return wu(t,!1)}function Ls(t,i){var s=bn&&t.markedSpans,o;if(s)for(var u=0;u<s.length;++u){var c=s[u];c.marker.collapsed&&(c.from==null||c.from<i)&&(c.to==null||c.to>i)&&(!o||Un(o,c.marker)<0)&&(o=c.marker)}return o}function To(t,i,s,o,u){var c=Me(t,i),g=bn&&c.markedSpans;if(g)for(var m=0;m<g.length;++m){var _=g[m];if(!!_.marker.collapsed){var C=_.marker.find(0),L=ze(C.from,s)||bo(_.marker)-bo(u),M=ze(C.to,o)||ma(_.marker)-ma(u);if(!(L>=0&&M<=0||L<=0&&M>=0)&&(L<=0&&(_.marker.inclusiveRight&&u.inclusiveLeft?ze(C.to,s)>=0:ze(C.to,s)>0)||L>=0&&(_.marker.inclusiveRight&&u.inclusiveLeft?ze(C.from,o)<=0:ze(C.from,o)<0)))return!0}}}function zr(t){for(var i;i=ku(t);)t=i.find(-1,!0).line;return t}function vc(t){for(var i;i=So(t);)t=i.find(1,!0).line;return t}function pc(t){for(var i,s;i=So(t);)t=i.find(1,!0).line,(s||(s=[])).push(t);return s}function Is(t,i){var s=Me(t,i),o=zr(s);return s==o?i:pt(o)}function Ns(t,i){if(i>t.lastLine())return i;var s=Me(t,i),o;if(!Sn(t,s))return i;for(;o=So(s);)s=o.find(1,!0).line;return pt(s)+1}function Sn(t,i){var s=bn&&i.markedSpans;if(s){for(var o=void 0,u=0;u<s.length;++u)if(o=s[u],!!o.marker.collapsed){if(o.from==null)return!0;if(!o.marker.widgetNode&&o.from==0&&o.marker.inclusiveLeft&&Ms(t,i,o))return!0}}}function Ms(t,i,s){if(s.to==null){var o=s.marker.find(1,!0);return Ms(t,o.line,zi(o.line.markedSpans,s.marker))}if(s.marker.inclusiveRight&&s.to==i.text.length)return!0;for(var u=void 0,c=0;c<i.markedSpans.length;++c)if(u=i.markedSpans[c],u.marker.collapsed&&!u.marker.widgetNode&&u.from==s.to&&(u.to==null||u.to!=s.from)&&(u.marker.inclusiveLeft||s.marker.inclusiveRight)&&Ms(t,i,u))return!0}function Tn(t){t=zr(t);for(var i=0,s=t.parent,o=0;o<s.lines.length;++o){var u=s.lines[o];if(u==t)break;i+=u.height}for(var c=s.parent;c;s=c,c=s.parent)for(var g=0;g<c.children.length;++g){var m=c.children[g];if(m==s)break;i+=m.height}return i}function Co(t){if(t.height==0)return 0;for(var i=t.text.length,s,o=t;s=ku(o);){var u=s.find(0,!0);o=u.from.line,i+=u.from.ch-u.to.ch}for(o=t;s=So(o);){var c=s.find(0,!0);i-=o.text.length-c.from.ch,o=c.to.line,i+=o.text.length-c.to.ch}return i}function Ds(t){var i=t.display,s=t.doc;i.maxLine=Me(s,s.first),i.maxLineLength=Co(i.maxLine),i.maxLineChanged=!0,s.iter(function(o){var u=Co(o);u>i.maxLineLength&&(i.maxLineLength=u,i.maxLine=o)})}var Yi=function(t,i,s){this.text=t,_o(this,i),this.height=s?s(this):1};Yi.prototype.lineNo=function(){return pt(this)},Ur(Yi);function gc(t,i,s,o){t.text=i,t.stateAfter&&(t.stateAfter=null),t.styles&&(t.styles=null),t.order!=null&&(t.order=null),mo(t),_o(t,s);var u=o?o(t):1;u!=t.height&&ln(t,u)}function yc(t){t.parent=null,mo(t)}var Ou={},mc={};function xu(t,i){if(!t||/^\s*$/.test(t))return null;var s=i.addModeClass?mc:Ou;return s[t]||(s[t]=t.replace(/\S+/g,"cm-$&"))}function Ru(t,i){var s=Ce("span",null,null,S?"padding-right: .1px":null),o={pre:Ce("pre",[s],"CodeMirror-line"),content:s,col:0,pos:0,cm:t,trailingSpace:!1,splitSpaces:t.getOption("lineWrapping")};i.measure={};for(var u=0;u<=(i.rest?i.rest.length:0);u++){var c=u?i.rest[u-1]:i.line,g=void 0;o.pos=0,o.addToken=bc,va(t.display.measure)&&(g=Te(c,t.doc.direction))&&(o.addToken=Tc(o.addToken,g)),o.map=[];var m=i!=t.display.externalMeasured&&pt(c);Cc(c,o,mu(t,c,m)),c.styleClasses&&(c.styleClasses.bgClass&&(o.bgClass=le(c.styleClasses.bgClass,o.bgClass||"")),c.styleClasses.textClass&&(o.textClass=le(c.styleClasses.textClass,o.textClass||""))),o.map.length==0&&o.map.push(0,0,o.content.appendChild(Wi(t.display.measure))),u==0?(i.measure.map=o.map,i.measure.cache={}):((i.measure.maps||(i.measure.maps=[])).push(o.map),(i.measure.caches||(i.measure.caches=[])).push({}))}if(S){var _=o.content.lastChild;(/\bcm-tab\b/.test(_.className)||_.querySelector&&_.querySelector(".cm-tab"))&&(o.content.className="cm-tab-wrap-hack")}return ot(t,"renderLine",t,i.line,o.pre),o.pre.className&&(o.textClass=le(o.pre.className,o.textClass||"")),o}function _c(t){var i=q("span","\u2022","cm-invalidchar");return i.title="\\u"+t.charCodeAt(0).toString(16),i.setAttribute("aria-label",i.title),i}function bc(t,i,s,o,u,c,g){if(!!i){var m=t.splitSpaces?Sc(i,t.trailingSpace):i,_=t.cm.state.specialChars,C=!1,L;if(!_.test(i))t.col+=i.length,L=document.createTextNode(m),t.map.push(t.pos,t.pos+i.length,L),d&&p<9&&(C=!0),t.pos+=i.length;else{L=document.createDocumentFragment();for(var M=0;;){_.lastIndex=M;var X=_.exec(i),z=X?X.index-M:i.length-M;if(z){var ie=document.createTextNode(m.slice(M,M+z));d&&p<9?L.appendChild(q("span",[ie])):L.appendChild(ie),t.map.push(t.pos,t.pos+z,ie),t.col+=z,t.pos+=z}if(!X)break;M+=z+1;var oe=void 0;if(X[0]=="	"){var ve=t.cm.options.tabSize,ke=ve-t.col%ve;oe=L.appendChild(q("span",Gt(ke),"cm-tab")),oe.setAttribute("role","presentation"),oe.setAttribute("cm-text","	"),t.col+=ke}else X[0]=="\r"||X[0]==`
`?(oe=L.appendChild(q("span",X[0]=="\r"?"\u240D":"\u2424","cm-invalidchar")),oe.setAttribute("cm-text",X[0]),t.col+=1):(oe=t.cm.options.specialCharPlaceholder(X[0]),oe.setAttribute("cm-text",X[0]),d&&p<9?L.appendChild(q("span",[oe])):L.appendChild(oe),t.col+=1);t.map.push(t.pos,t.pos+1,oe),t.pos++}}if(t.trailingSpace=m.charCodeAt(i.length-1)==32,s||o||u||C||c||g){var xe=s||"";o&&(xe+=o),u&&(xe+=u);var Oe=q("span",[L],xe,c);if(g)for(var Pe in g)g.hasOwnProperty(Pe)&&Pe!="style"&&Pe!="class"&&Oe.setAttribute(Pe,g[Pe]);return t.content.appendChild(Oe)}t.content.appendChild(L)}}function Sc(t,i){if(t.length>1&&!/  /.test(t))return t;for(var s=i,o="",u=0;u<t.length;u++){var c=t.charAt(u);c==" "&&s&&(u==t.length-1||t.charCodeAt(u+1)==32)&&(c="\xA0"),o+=c,s=c==" "}return o}function Tc(t,i){return function(s,o,u,c,g,m,_){u=u?u+" cm-force-border":"cm-force-border";for(var C=s.pos,L=C+o.length;;){for(var M=void 0,X=0;X<i.length&&(M=i[X],!(M.to>C&&M.from<=C));X++);if(M.to>=L)return t(s,o,u,c,g,m,_);t(s,o.slice(0,M.to-C),u,c,null,m,_),c=null,o=o.slice(M.to-C),C=M.to}}}function Pu(t,i,s,o){var u=!o&&s.widgetNode;u&&t.map.push(t.pos,t.pos+i,u),!o&&t.cm.display.input.needsContentAttribute&&(u||(u=t.content.appendChild(document.createElement("span"))),u.setAttribute("cm-marker",s.id)),u&&(t.cm.display.input.setUneditable(u),t.content.appendChild(u)),t.pos+=i,t.trailingSpace=!1}function Cc(t,i,s){var o=t.markedSpans,u=t.text,c=0;if(!o){for(var g=1;g<s.length;g+=2)i.addToken(i,u.slice(c,c=s[g]),xu(s[g+1],i.cm.options));return}for(var m=u.length,_=0,C=1,L="",M,X,z=0,ie,oe,ve,ke,xe;;){if(z==_){ie=oe=ve=X="",xe=null,ke=null,z=1/0;for(var Oe=[],Pe=void 0,We=0;We<o.length;++We){var Ge=o[We],Je=Ge.marker;if(Je.type=="bookmark"&&Ge.from==_&&Je.widgetNode)Oe.push(Je);else if(Ge.from<=_&&(Ge.to==null||Ge.to>_||Je.collapsed&&Ge.to==_&&Ge.from==_)){if(Ge.to!=null&&Ge.to!=_&&z>Ge.to&&(z=Ge.to,oe=""),Je.className&&(ie+=" "+Je.className),Je.css&&(X=(X?X+";":"")+Je.css),Je.startStyle&&Ge.from==_&&(ve+=" "+Je.startStyle),Je.endStyle&&Ge.to==z&&(Pe||(Pe=[])).push(Je.endStyle,Ge.to),Je.title&&((xe||(xe={})).title=Je.title),Je.attributes)for(var At in Je.attributes)(xe||(xe={}))[At]=Je.attributes[At];Je.collapsed&&(!ke||Un(ke.marker,Je)<0)&&(ke=Ge)}else Ge.from>_&&z>Ge.from&&(z=Ge.from)}if(Pe)for(var hr=0;hr<Pe.length;hr+=2)Pe[hr+1]==z&&(oe+=" "+Pe[hr]);if(!ke||ke.from==_)for(var Mt=0;Mt<Oe.length;++Mt)Pu(i,0,Oe[Mt]);if(ke&&(ke.from||0)==_){if(Pu(i,(ke.to==null?m+1:ke.to)-_,ke.marker,ke.from==null),ke.to==null)return;ke.to==_&&(ke=!1)}}if(_>=m)break;for(var Yr=Math.min(m,z);;){if(L){var Dr=_+L.length;if(!ke){var er=Dr>Yr?L.slice(0,Yr-_):L;i.addToken(i,er,M?M+ie:ie,ve,_+er.length==z?oe:"",X,xe)}if(Dr>=Yr){L=L.slice(Yr-_),_=Yr;break}_=Dr,ve=""}L=u.slice(c,c=s[C++]),M=xu(s[C++],i.cm.options)}}}function Lu(t,i,s){this.line=i,this.rest=pc(i),this.size=this.rest?pt(Ve(this.rest))-s+1:1,this.node=this.text=null,this.hidden=Sn(t,i)}function _a(t,i,s){for(var o=[],u,c=i;c<s;c=u){var g=new Lu(t.doc,Me(t.doc,c),c);u=c+g.size,o.push(g)}return o}var Xi=null;function Ec(t){Xi?Xi.ops.push(t):t.ownsGroup=Xi={ops:[t],delayedCallbacks:[]}}function Ac(t){var i=t.delayedCallbacks,s=0;do{for(;s<i.length;s++)i[s].call(null);for(var o=0;o<t.ops.length;o++){var u=t.ops[o];if(u.cursorActivityHandlers)for(;u.cursorActivityCalled<u.cursorActivityHandlers.length;)u.cursorActivityHandlers[u.cursorActivityCalled++].call(null,u.cm)}}while(s<i.length)}function wc(t,i){var s=t.ownsGroup;if(!!s)try{Ac(s)}finally{Xi=null,i(s)}}var Ki=null;function Vt(t,i){var s=ct(t,i);if(!!s.length){var o=Array.prototype.slice.call(arguments,2),u;Xi?u=Xi.delayedCallbacks:Ki?u=Ki:(u=Ki=[],setTimeout(kc,0));for(var c=function(m){u.push(function(){return s[m].apply(null,o)})},g=0;g<s.length;++g)c(g)}}function kc(){var t=Ki;Ki=null;for(var i=0;i<t.length;++i)t[i]()}function Iu(t,i,s,o){for(var u=0;u<i.changes.length;u++){var c=i.changes[u];c=="text"?Mu(t,i):c=="gutter"?Eo(t,i,s,o):c=="class"?qi(t,i):c=="widget"&&Du(t,i,o)}i.changes=null}function ba(t){return t.node==t.text&&(t.node=q("div",null,null,"position: relative"),t.text.parentNode&&t.text.parentNode.replaceChild(t.node,t.text),t.node.appendChild(t.text),d&&p<8&&(t.node.style.zIndex=2)),t.node}function Oc(t,i){var s=i.bgClass?i.bgClass+" "+(i.line.bgClass||""):i.line.bgClass;if(s&&(s+=" CodeMirror-linebackground"),i.background)s?i.background.className=s:(i.background.parentNode.removeChild(i.background),i.background=null);else if(s){var o=ba(i);i.background=o.insertBefore(q("div",null,s),o.firstChild),t.display.input.setUneditable(i.background)}}function Nu(t,i){var s=t.display.externalMeasured;return s&&s.line==i.line?(t.display.externalMeasured=null,i.measure=s.measure,s.built):Ru(t,i)}function Mu(t,i){var s=i.text.className,o=Nu(t,i);i.text==i.node&&(i.node=o.pre),i.text.parentNode.replaceChild(o.pre,i.text),i.text=o.pre,o.bgClass!=i.bgClass||o.textClass!=i.textClass?(i.bgClass=o.bgClass,i.textClass=o.textClass,qi(t,i)):s&&(i.text.className=s)}function qi(t,i){Oc(t,i),i.line.wrapClass?ba(i).className=i.line.wrapClass:i.node!=i.text&&(i.node.className="");var s=i.textClass?i.textClass+" "+(i.line.textClass||""):i.line.textClass;i.text.className=s||""}function Eo(t,i,s,o){if(i.gutter&&(i.node.removeChild(i.gutter),i.gutter=null),i.gutterBackground&&(i.node.removeChild(i.gutterBackground),i.gutterBackground=null),i.line.gutterClass){var u=ba(i);i.gutterBackground=q("div",null,"CodeMirror-gutter-background "+i.line.gutterClass,"left: "+(t.options.fixedGutter?o.fixedPos:-o.gutterTotalWidth)+"px; width: "+o.gutterTotalWidth+"px"),t.display.input.setUneditable(i.gutterBackground),u.insertBefore(i.gutterBackground,i.text)}var c=i.line.gutterMarkers;if(t.options.lineNumbers||c){var g=ba(i),m=i.gutter=q("div",null,"CodeMirror-gutter-wrapper","left: "+(t.options.fixedGutter?o.fixedPos:-o.gutterTotalWidth)+"px");if(m.setAttribute("aria-hidden","true"),t.display.input.setUneditable(m),g.insertBefore(m,i.text),i.line.gutterClass&&(m.className+=" "+i.line.gutterClass),t.options.lineNumbers&&(!c||!c["CodeMirror-linenumbers"])&&(i.lineNumber=m.appendChild(q("div",ya(t.options,s),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+o.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+t.display.lineNumInnerWidth+"px"))),c)for(var _=0;_<t.display.gutterSpecs.length;++_){var C=t.display.gutterSpecs[_].className,L=c.hasOwnProperty(C)&&c[C];L&&m.appendChild(q("div",[L],"CodeMirror-gutter-elt","left: "+o.gutterLeft[C]+"px; width: "+o.gutterWidth[C]+"px"))}}}function Du(t,i,s){i.alignable&&(i.alignable=null);for(var o=Y("CodeMirror-linewidget"),u=i.node.firstChild,c=void 0;u;u=c)c=u.nextSibling,o.test(u.className)&&i.node.removeChild(u);Fs(t,i,s)}function xc(t,i,s,o){var u=Nu(t,i);return i.text=i.node=u.pre,u.bgClass&&(i.bgClass=u.bgClass),u.textClass&&(i.textClass=u.textClass),qi(t,i),Eo(t,i,s,o),Fs(t,i,o),i.node}function Fs(t,i,s){if(Fu(t,i.line,i,s,!0),i.rest)for(var o=0;o<i.rest.length;o++)Fu(t,i.rest[o],i,s,!1)}function Fu(t,i,s,o,u){if(!!i.widgets)for(var c=ba(s),g=0,m=i.widgets;g<m.length;++g){var _=m[g],C=q("div",[_.node],"CodeMirror-linewidget"+(_.className?" "+_.className:""));_.handleMouseEvents||C.setAttribute("cm-ignore-events","true"),$u(_,C,s,o),t.display.input.setUneditable(C),u&&_.above?c.insertBefore(C,s.gutter||s.text):c.appendChild(C),Vt(_,"redraw")}}function $u(t,i,s,o){if(t.noHScroll){(s.alignable||(s.alignable=[])).push(i);var u=o.wrapperWidth;i.style.left=o.fixedPos+"px",t.coverGutter||(u-=o.gutterTotalWidth,i.style.paddingLeft=o.gutterTotalWidth+"px"),i.style.width=u+"px"}t.coverGutter&&(i.style.zIndex=5,i.style.position="relative",t.noHScroll||(i.style.marginLeft=-o.gutterTotalWidth+"px"))}function Sa(t){if(t.height!=null)return t.height;var i=t.doc.cm;if(!i)return 0;if(!ne(document.body,t.node)){var s="position: relative;";t.coverGutter&&(s+="margin-left: -"+i.display.gutters.offsetWidth+"px;"),t.noHScroll&&(s+="width: "+i.display.wrapper.clientWidth+"px;"),Q(i.display.measure,q("div",[t.node],null,s))}return t.height=t.node.parentNode.offsetHeight}function Lr(t,i){for(var s=at(i);s!=t.wrapper;s=s.parentNode)if(!s||s.nodeType==1&&s.getAttribute("cm-ignore-events")=="true"||s.parentNode==t.sizer&&s!=t.mover)return!0}function Ao(t){return t.lineSpace.offsetTop}function $s(t){return t.mover.offsetHeight-t.lineSpace.offsetHeight}function Gu(t){if(t.cachedPaddingH)return t.cachedPaddingH;var i=Q(t.measure,q("pre","x","CodeMirror-line-like")),s=window.getComputedStyle?window.getComputedStyle(i):i.currentStyle,o={left:parseInt(s.paddingLeft),right:parseInt(s.paddingRight)};return!isNaN(o.left)&&!isNaN(o.right)&&(t.cachedPaddingH=o),o}function fn(t){return Xe-t.display.nativeBarWidth}function _i(t){return t.display.scroller.clientWidth-fn(t)-t.display.barWidth}function Gs(t){return t.display.scroller.clientHeight-fn(t)-t.display.barHeight}function Rc(t,i,s){var o=t.options.lineWrapping,u=o&&_i(t);if(!i.measure.heights||o&&i.measure.width!=u){var c=i.measure.heights=[];if(o){i.measure.width=u;for(var g=i.text.firstChild.getClientRects(),m=0;m<g.length-1;m++){var _=g[m],C=g[m+1];Math.abs(_.bottom-C.bottom)>2&&c.push((_.bottom+C.top)/2-s.top)}}c.push(s.bottom-s.top)}}function Wu(t,i,s){if(t.line==i)return{map:t.measure.map,cache:t.measure.cache};if(t.rest){for(var o=0;o<t.rest.length;o++)if(t.rest[o]==i)return{map:t.measure.maps[o],cache:t.measure.caches[o]};for(var u=0;u<t.rest.length;u++)if(pt(t.rest[u])>s)return{map:t.measure.maps[u],cache:t.measure.caches[u],before:!0}}}function Pc(t,i){i=zr(i);var s=pt(i),o=t.display.externalMeasured=new Lu(t.doc,i,s);o.lineN=s;var u=o.built=Ru(t,o);return o.text=u.pre,Q(t.display.lineMeasure,u.pre),o}function Ws(t,i,s,o){return hn(t,Vi(t,i),s,o)}function wo(t,i){if(i>=t.display.viewFrom&&i<t.display.viewTo)return t.display.view[Si(t,i)];var s=t.display.externalMeasured;if(s&&i>=s.lineN&&i<s.lineN+s.size)return s}function Vi(t,i){var s=pt(i),o=wo(t,s);o&&!o.text?o=null:o&&o.changes&&(Iu(t,o,s,Ys(t)),t.curOp.forceUpdate=!0),o||(o=Pc(t,i));var u=Wu(o,i,s);return{line:i,view:o,rect:null,map:u.map,cache:u.cache,before:u.before,hasHeights:!1}}function hn(t,i,s,o,u){i.before&&(s=-1);var c=s+(o||""),g;return i.cache.hasOwnProperty(c)?g=i.cache[c]:(i.rect||(i.rect=i.view.text.getBoundingClientRect()),i.hasHeights||(Rc(t,i.view,i.rect),i.hasHeights=!0),g=Hu(t,i,s,o),g.bogus||(i.cache[c]=g)),{left:g.left,right:g.right,top:u?g.rtop:g.top,bottom:u?g.rbottom:g.bottom}}var Bu={left:0,right:0,top:0,bottom:0};function ko(t,i,s){for(var o,u,c,g,m,_,C=0;C<t.length;C+=3)if(m=t[C],_=t[C+1],i<m?(u=0,c=1,g="left"):i<_?(u=i-m,c=u+1):(C==t.length-3||i==_&&t[C+3]>i)&&(c=_-m,u=c-1,i>=_&&(g="right")),u!=null){if(o=t[C+2],m==_&&s==(o.insertLeft?"left":"right")&&(g=s),s=="left"&&u==0)for(;C&&t[C-2]==t[C-3]&&t[C-1].insertLeft;)o=t[(C-=3)+2],g="left";if(s=="right"&&u==_-m)for(;C<t.length-3&&t[C+3]==t[C+4]&&!t[C+5].insertLeft;)o=t[(C+=3)+2],g="right";break}return{node:o,start:u,end:c,collapse:g,coverStart:m,coverEnd:_}}function Uu(t,i){var s=Bu;if(i=="left")for(var o=0;o<t.length&&(s=t[o]).left==s.right;o++);else for(var u=t.length-1;u>=0&&(s=t[u]).left==s.right;u--);return s}function Hu(t,i,s,o){var u=ko(i.map,s,o),c=u.node,g=u.start,m=u.end,_=u.collapse,C;if(c.nodeType==3){for(var L=0;L<4;L++){for(;g&&qr(i.line.text.charAt(u.coverStart+g));)--g;for(;u.coverStart+m<u.coverEnd&&qr(i.line.text.charAt(u.coverStart+m));)++m;if(d&&p<9&&g==0&&m==u.coverEnd-u.coverStart?C=c.parentNode.getBoundingClientRect():C=Uu(K(c,g,m).getClientRects(),o),C.left||C.right||g==0)break;m=g,g=g-1,_="right"}d&&p<11&&(C=zu(t.display.measure,C))}else{g>0&&(_=o="right");var M;t.options.lineWrapping&&(M=c.getClientRects()).length>1?C=M[o=="right"?M.length-1:0]:C=c.getBoundingClientRect()}if(d&&p<9&&!g&&(!C||!C.left&&!C.right)){var X=c.parentNode.getClientRects()[0];X?C={left:X.left,right:X.left+En(t.display),top:X.top,bottom:X.bottom}:C=Bu}for(var z=C.top-i.rect.top,ie=C.bottom-i.rect.top,oe=(z+ie)/2,ve=i.view.measure.heights,ke=0;ke<ve.length-1&&!(oe<ve[ke]);ke++);var xe=ke?ve[ke-1]:0,Oe=ve[ke],Pe={left:(_=="right"?C.right:C.left)-i.rect.left,right:(_=="left"?C.left:C.right)-i.rect.left,top:xe,bottom:Oe};return!C.left&&!C.right&&(Pe.bogus=!0),t.options.singleCursorHeightPerLine||(Pe.rtop=z,Pe.rbottom=ie),Pe}function zu(t,i){if(!window.screen||screen.logicalXDPI==null||screen.logicalXDPI==screen.deviceXDPI||!so(t))return i;var s=screen.logicalXDPI/screen.deviceXDPI,o=screen.logicalYDPI/screen.deviceYDPI;return{left:i.left*s,right:i.right*s,top:i.top*o,bottom:i.bottom*o}}function Bs(t){if(t.measure&&(t.measure.cache={},t.measure.heights=null,t.rest))for(var i=0;i<t.rest.length;i++)t.measure.caches[i]={}}function Ta(t){t.display.externalMeasure=null,se(t.display.lineMeasure);for(var i=0;i<t.display.view.length;i++)Bs(t.display.view[i])}function Ca(t){Ta(t),t.display.cachedCharWidth=t.display.cachedTextHeight=t.display.cachedPaddingH=null,t.options.lineWrapping||(t.display.maxLineChanged=!0),t.display.lineNumChars=null}function Us(){return A&&j?-(document.body.getBoundingClientRect().left-parseInt(getComputedStyle(document.body).marginLeft)):window.pageXOffset||(document.documentElement||document.body).scrollLeft}function ju(){return A&&j?-(document.body.getBoundingClientRect().top-parseInt(getComputedStyle(document.body).marginTop)):window.pageYOffset||(document.documentElement||document.body).scrollTop}function Hs(t){var i=zr(t),s=i.widgets,o=0;if(s)for(var u=0;u<s.length;++u)s[u].above&&(o+=Sa(s[u]));return o}function Oo(t,i,s,o,u){if(!u){var c=Hs(i);s.top+=c,s.bottom+=c}if(o=="line")return s;o||(o="local");var g=Tn(i);if(o=="local"?g+=Ao(t.display):g-=t.display.viewOffset,o=="page"||o=="window"){var m=t.display.lineSpace.getBoundingClientRect();g+=m.top+(o=="window"?0:ju());var _=m.left+(o=="window"?0:Us());s.left+=_,s.right+=_}return s.top+=g,s.bottom+=g,s}function Yu(t,i,s){if(s=="div")return i;var o=i.left,u=i.top;if(s=="page")o-=Us(),u-=ju();else if(s=="local"||!s){var c=t.display.sizer.getBoundingClientRect();o+=c.left,u+=c.top}var g=t.display.lineSpace.getBoundingClientRect();return{left:o-g.left,top:u-g.top}}function xo(t,i,s,o,u){return o||(o=Me(t.doc,i.line)),Oo(t,o,Ws(t,o,i.ch,u),s)}function Ir(t,i,s,o,u,c){o=o||Me(t.doc,i.line),u||(u=Vi(t,o));function g(ie,oe){var ve=hn(t,u,ie,oe?"right":"left",c);return oe?ve.left=ve.right:ve.right=ve.left,Oo(t,o,ve,s)}var m=Te(o,t.doc.direction),_=i.ch,C=i.sticky;if(_>=o.text.length?(_=o.text.length,C="before"):_<=0&&(_=0,C="after"),!m)return g(C=="before"?_-1:_,C=="before");function L(ie,oe,ve){var ke=m[oe],xe=ke.level==1;return g(ve?ie-1:ie,xe!=ve)}var M=ge(m,_,C),X=he,z=L(_,M,C=="before");return X!=null&&(z.other=L(_,X,C!="before")),z}function Ea(t,i){var s=0;i=je(t.doc,i),t.options.lineWrapping||(s=En(t.display)*i.ch);var o=Me(t.doc,i.line),u=Tn(o)+Ao(t.display);return{left:s,right:s,top:u,bottom:u+o.height}}function Aa(t,i,s,o,u){var c=fe(t,i,s);return c.xRel=u,o&&(c.outside=o),c}function zs(t,i,s){var o=t.doc;if(s+=t.display.viewOffset,s<0)return Aa(o.first,0,null,-1,-1);var u=mi(o,s),c=o.first+o.size-1;if(u>c)return Aa(o.first+o.size-1,Me(o,c).text.length,null,1,1);i<0&&(i=0);for(var g=Me(o,u);;){var m=Lc(t,g,u,i,s),_=Ls(g,m.ch+(m.xRel>0||m.outside>0?1:0));if(!_)return m;var C=_.find(1);if(C.line==u)return C;g=Me(o,u=C.line)}}function Xu(t,i,s,o){o-=Hs(i);var u=i.text.length,c=Xt(function(g){return hn(t,s,g-1).bottom<=o},u,0);return u=Xt(function(g){return hn(t,s,g).top>o},c,u),{begin:c,end:u}}function Ro(t,i,s,o){s||(s=Vi(t,i));var u=Oo(t,i,hn(t,s,o),"line").top;return Xu(t,i,s,u)}function js(t,i,s,o){return t.bottom<=s?!1:t.top>s?!0:(o?t.left:t.right)>i}function Lc(t,i,s,o,u){u-=Tn(i);var c=Vi(t,i),g=Hs(i),m=0,_=i.text.length,C=!0,L=Te(i,t.doc.direction);if(L){var M=(t.options.lineWrapping?Ku:Ic)(t,i,s,c,L,o,u);C=M.level!=1,m=C?M.from:M.to-1,_=C?M.to:M.from-1}var X=null,z=null,ie=Xt(function(We){var Ge=hn(t,c,We);return Ge.top+=g,Ge.bottom+=g,js(Ge,o,u,!1)?(Ge.top<=u&&Ge.left<=o&&(X=We,z=Ge),!0):!1},m,_),oe,ve,ke=!1;if(z){var xe=o-z.left<z.right-o,Oe=xe==C;ie=X+(Oe?0:1),ve=Oe?"after":"before",oe=xe?z.left:z.right}else{!C&&(ie==_||ie==m)&&ie++,ve=ie==0?"after":ie==i.text.length?"before":hn(t,c,ie-(C?1:0)).bottom+g<=u==C?"after":"before";var Pe=Ir(t,fe(s,ie,ve),"line",i,c);oe=Pe.left,ke=u<Pe.top?-1:u>=Pe.bottom?1:0}return ie=on(i.text,ie,1),Aa(s,ie,ve,ke,o-oe)}function Ic(t,i,s,o,u,c,g){var m=Xt(function(M){var X=u[M],z=X.level!=1;return js(Ir(t,fe(s,z?X.to:X.from,z?"before":"after"),"line",i,o),c,g,!0)},0,u.length-1),_=u[m];if(m>0){var C=_.level!=1,L=Ir(t,fe(s,C?_.from:_.to,C?"after":"before"),"line",i,o);js(L,c,g,!0)&&L.top>g&&(_=u[m-1])}return _}function Ku(t,i,s,o,u,c,g){var m=Xu(t,i,o,g),_=m.begin,C=m.end;/\s/.test(i.text.charAt(C-1))&&C--;for(var L=null,M=null,X=0;X<u.length;X++){var z=u[X];if(!(z.from>=C||z.to<=_)){var ie=z.level!=1,oe=hn(t,o,ie?Math.min(C,z.to)-1:Math.max(_,z.from)).right,ve=oe<c?c-oe+1e9:oe-c;(!L||M>ve)&&(L=z,M=ve)}}return L||(L=u[u.length-1]),L.from<_&&(L={from:_,to:L.to,level:L.level}),L.to>C&&(L={from:L.from,to:C,level:L.level}),L}var Cn;function Zi(t){if(t.cachedTextHeight!=null)return t.cachedTextHeight;if(Cn==null){Cn=q("pre",null,"CodeMirror-line-like");for(var i=0;i<49;++i)Cn.appendChild(document.createTextNode("x")),Cn.appendChild(q("br"));Cn.appendChild(document.createTextNode("x"))}Q(t.measure,Cn);var s=Cn.offsetHeight/50;return s>3&&(t.cachedTextHeight=s),se(t.measure),s||1}function En(t){if(t.cachedCharWidth!=null)return t.cachedCharWidth;var i=q("span","xxxxxxxxxx"),s=q("pre",[i],"CodeMirror-line-like");Q(t.measure,s);var o=i.getBoundingClientRect(),u=(o.right-o.left)/10;return u>2&&(t.cachedCharWidth=u),u||10}function Ys(t){for(var i=t.display,s={},o={},u=i.gutters.clientLeft,c=i.gutters.firstChild,g=0;c;c=c.nextSibling,++g){var m=t.display.gutterSpecs[g].className;s[m]=c.offsetLeft+c.clientLeft+u,o[m]=c.clientWidth}return{fixedPos:Xs(i),gutterTotalWidth:i.gutters.offsetWidth,gutterLeft:s,gutterWidth:o,wrapperWidth:i.wrapper.clientWidth}}function Xs(t){return t.scroller.getBoundingClientRect().left-t.sizer.getBoundingClientRect().left}function Ks(t){var i=Zi(t.display),s=t.options.lineWrapping,o=s&&Math.max(5,t.display.scroller.clientWidth/En(t.display)-3);return function(u){if(Sn(t.doc,u))return 0;var c=0;if(u.widgets)for(var g=0;g<u.widgets.length;g++)u.widgets[g].height&&(c+=u.widgets[g].height);return s?c+(Math.ceil(u.text.length/o)||1)*i:c+i}}function wa(t){var i=t.doc,s=Ks(t);i.iter(function(o){var u=s(o);u!=o.height&&ln(o,u)})}function bi(t,i,s,o){var u=t.display;if(!s&&at(i).getAttribute("cm-not-content")=="true")return null;var c,g,m=u.lineSpace.getBoundingClientRect();try{c=i.clientX-m.left,g=i.clientY-m.top}catch{return null}var _=zs(t,c,g),C;if(o&&_.xRel>0&&(C=Me(t.doc,_.line).text).length==_.ch){var L=Ne(C,C.length,t.options.tabSize)-C.length;_=fe(_.line,Math.max(0,Math.round((c-Gu(t.display).left)/En(t.display))-L))}return _}function Si(t,i){if(i>=t.display.viewTo||(i-=t.display.viewFrom,i<0))return null;for(var s=t.display.view,o=0;o<s.length;o++)if(i-=s[o].size,i<0)return o}function _r(t,i,s,o){i==null&&(i=t.doc.first),s==null&&(s=t.doc.first+t.doc.size),o||(o=0);var u=t.display;if(o&&s<u.viewTo&&(u.updateLineNumbers==null||u.updateLineNumbers>i)&&(u.updateLineNumbers=i),t.curOp.viewChanged=!0,i>=u.viewTo)bn&&Is(t.doc,i)<u.viewTo&&wn(t);else if(s<=u.viewFrom)bn&&Ns(t.doc,s+o)>u.viewFrom?wn(t):(u.viewFrom+=o,u.viewTo+=o);else if(i<=u.viewFrom&&s>=u.viewTo)wn(t);else if(i<=u.viewFrom){var c=Po(t,s,s+o,1);c?(u.view=u.view.slice(c.index),u.viewFrom=c.lineN,u.viewTo+=o):wn(t)}else if(s>=u.viewTo){var g=Po(t,i,i,-1);g?(u.view=u.view.slice(0,g.index),u.viewTo=g.lineN):wn(t)}else{var m=Po(t,i,i,-1),_=Po(t,s,s+o,1);m&&_?(u.view=u.view.slice(0,m.index).concat(_a(t,m.lineN,_.lineN)).concat(u.view.slice(_.index)),u.viewTo+=o):wn(t)}var C=u.externalMeasured;C&&(s<C.lineN?C.lineN+=o:i<C.lineN+C.size&&(u.externalMeasured=null))}function An(t,i,s){t.curOp.viewChanged=!0;var o=t.display,u=t.display.externalMeasured;if(u&&i>=u.lineN&&i<u.lineN+u.size&&(o.externalMeasured=null),!(i<o.viewFrom||i>=o.viewTo)){var c=o.view[Si(t,i)];if(c.node!=null){var g=c.changes||(c.changes=[]);Ue(g,s)==-1&&g.push(s)}}}function wn(t){t.display.viewFrom=t.display.viewTo=t.doc.first,t.display.view=[],t.display.viewOffset=0}function Po(t,i,s,o){var u=Si(t,i),c,g=t.display.view;if(!bn||s==t.doc.first+t.doc.size)return{index:u,lineN:s};for(var m=t.display.viewFrom,_=0;_<u;_++)m+=g[_].size;if(m!=i){if(o>0){if(u==g.length-1)return null;c=m+g[u].size-i,u++}else c=m-i;i+=c,s+=c}for(;Is(t.doc,s)!=s;){if(u==(o<0?0:g.length-1))return null;s+=o*g[u-(o<0?1:0)].size,u+=o}return{index:u,lineN:s}}function Nc(t,i,s){var o=t.display,u=o.view;u.length==0||i>=o.viewTo||s<=o.viewFrom?(o.view=_a(t,i,s),o.viewFrom=i):(o.viewFrom>i?o.view=_a(t,i,o.viewFrom).concat(o.view):o.viewFrom<i&&(o.view=o.view.slice(Si(t,i))),o.viewFrom=i,o.viewTo<s?o.view=o.view.concat(_a(t,o.viewTo,s)):o.viewTo>s&&(o.view=o.view.slice(0,Si(t,s)))),o.viewTo=s}function qu(t){for(var i=t.display.view,s=0,o=0;o<i.length;o++){var u=i[o];!u.hidden&&(!u.node||u.changes)&&++s}return s}function ka(t){t.display.input.showSelection(t.display.input.prepareSelection())}function Vu(t,i){i===void 0&&(i=!0);var s=t.doc,o={},u=o.cursors=document.createDocumentFragment(),c=o.selection=document.createDocumentFragment(),g=t.options.$customCursor;g&&(i=!0);for(var m=0;m<s.sel.ranges.length;m++)if(!(!i&&m==s.sel.primIndex)){var _=s.sel.ranges[m];if(!(_.from().line>=t.display.viewTo||_.to().line<t.display.viewFrom)){var C=_.empty();if(g){var L=g(t,_);L&&qs(t,L,u)}else(C||t.options.showCursorWhenSelecting)&&qs(t,_.head,u);C||Mc(t,_,c)}}return o}function qs(t,i,s){var o=Ir(t,i,"div",null,null,!t.options.singleCursorHeightPerLine),u=s.appendChild(q("div","\xA0","CodeMirror-cursor"));if(u.style.left=o.left+"px",u.style.top=o.top+"px",u.style.height=Math.max(0,o.bottom-o.top)*t.options.cursorHeight+"px",/\bcm-fat-cursor\b/.test(t.getWrapperElement().className)){var c=xo(t,i,"div",null,null),g=c.right-c.left;u.style.width=(g>0?g:t.defaultCharWidth())+"px"}if(o.other){var m=s.appendChild(q("div","\xA0","CodeMirror-cursor CodeMirror-secondarycursor"));m.style.display="",m.style.left=o.other.left+"px",m.style.top=o.other.top+"px",m.style.height=(o.other.bottom-o.other.top)*.85+"px"}}function Lo(t,i){return t.top-i.top||t.left-i.left}function Mc(t,i,s){var o=t.display,u=t.doc,c=document.createDocumentFragment(),g=Gu(t.display),m=g.left,_=Math.max(o.sizerWidth,_i(t)-o.sizer.offsetLeft)-g.right,C=u.direction=="ltr";function L(Oe,Pe,We,Ge){Pe<0&&(Pe=0),Pe=Math.round(Pe),Ge=Math.round(Ge),c.appendChild(q("div",null,"CodeMirror-selected","position: absolute; left: "+Oe+`px;
                             top: `+Pe+"px; width: "+(We==null?_-Oe:We)+`px;
                             height: `+(Ge-Pe)+"px"))}function M(Oe,Pe,We){var Ge=Me(u,Oe),Je=Ge.text.length,At,hr;function Mt(er,Fr){return xo(t,fe(Oe,er),"div",Ge,Fr)}function Yr(er,Fr,gr){var or=Ro(t,Ge,null,er),tr=Fr=="ltr"==(gr=="after")?"left":"right",Ht=gr=="after"?or.begin:or.end-(/\s/.test(Ge.text.charAt(or.end-1))?2:1);return Mt(Ht,tr)[tr]}var Dr=Te(Ge,u.direction);return ue(Dr,Pe||0,We==null?Je:We,function(er,Fr,gr,or){var tr=gr=="ltr",Ht=Mt(er,tr?"left":"right"),$r=Mt(Fr-1,tr?"right":"left"),zo=Pe==null&&er==0,sa=We==null&&Fr==Je,Sr=or==0,Zn=!Dr||or==Dr.length-1;if($r.top-Ht.top<=3){var cr=(C?zo:sa)&&Sr,od=(C?sa:zo)&&Zn,xi=cr?m:(tr?Ht:$r).left,Wa=od?_:(tr?$r:Ht).right;L(xi,Ht.top,Wa-xi,Ht.bottom)}else{var Ba,Or,jo,sd;tr?(Ba=C&&zo&&Sr?m:Ht.left,Or=C?_:Yr(er,gr,"before"),jo=C?m:Yr(Fr,gr,"after"),sd=C&&sa&&Zn?_:$r.right):(Ba=C?Yr(er,gr,"before"):m,Or=!C&&zo&&Sr?_:Ht.right,jo=!C&&sa&&Zn?m:$r.left,sd=C?Yr(Fr,gr,"after"):_),L(Ba,Ht.top,Or-Ba,Ht.bottom),Ht.bottom<$r.top&&L(m,Ht.bottom,null,$r.top),L(jo,$r.top,sd-jo,$r.bottom)}(!At||Lo(Ht,At)<0)&&(At=Ht),Lo($r,At)<0&&(At=$r),(!hr||Lo(Ht,hr)<0)&&(hr=Ht),Lo($r,hr)<0&&(hr=$r)}),{start:At,end:hr}}var X=i.from(),z=i.to();if(X.line==z.line)M(X.line,X.ch,z.ch);else{var ie=Me(u,X.line),oe=Me(u,z.line),ve=zr(ie)==zr(oe),ke=M(X.line,X.ch,ve?ie.text.length+1:null).end,xe=M(z.line,ve?0:null,z.ch).start;ve&&(ke.top<xe.top-2?(L(ke.right,ke.top,null,ke.bottom),L(m,xe.top,xe.left,xe.bottom)):L(ke.right,ke.top,xe.left-ke.right,ke.bottom)),ke.bottom<xe.top&&L(m,ke.bottom,null,xe.top)}s.appendChild(c)}function Vs(t){if(!!t.state.focused){var i=t.display;clearInterval(i.blinker);var s=!0;i.cursorDiv.style.visibility="",t.options.cursorBlinkRate>0?i.blinker=setInterval(function(){t.hasFocus()||Qi(t),i.cursorDiv.style.visibility=(s=!s)?"":"hidden"},t.options.cursorBlinkRate):t.options.cursorBlinkRate<0&&(i.cursorDiv.style.visibility="hidden")}}function Zu(t){t.hasFocus()||(t.display.input.focus(),t.state.focused||Qs(t))}function Zs(t){t.state.delayingBlurEvent=!0,setTimeout(function(){t.state.delayingBlurEvent&&(t.state.delayingBlurEvent=!1,t.state.focused&&Qi(t))},100)}function Qs(t,i){t.state.delayingBlurEvent&&!t.state.draggingText&&(t.state.delayingBlurEvent=!1),t.options.readOnly!="nocursor"&&(t.state.focused||(ot(t,"focus",t,i),t.state.focused=!0,pe(t.display.wrapper,"CodeMirror-focused"),!t.curOp&&t.display.selForContextMenu!=t.doc.sel&&(t.display.input.reset(),S&&setTimeout(function(){return t.display.input.reset(!0)},20)),t.display.input.receivedFocus()),Vs(t))}function Qi(t,i){t.state.delayingBlurEvent||(t.state.focused&&(ot(t,"blur",t,i),t.state.focused=!1,re(t.display.wrapper,"CodeMirror-focused")),clearInterval(t.display.blinker),setTimeout(function(){t.state.focused||(t.display.shift=!1)},150))}function Io(t){for(var i=t.display,s=i.lineDiv.offsetTop,o=Math.max(0,i.scroller.getBoundingClientRect().top),u=i.lineDiv.getBoundingClientRect().top,c=0,g=0;g<i.view.length;g++){var m=i.view[g],_=t.options.lineWrapping,C=void 0,L=0;if(!m.hidden){if(u+=m.line.height,d&&p<8){var M=m.node.offsetTop+m.node.offsetHeight;C=M-s,s=M}else{var X=m.node.getBoundingClientRect();C=X.bottom-X.top,!_&&m.text.firstChild&&(L=m.text.firstChild.getBoundingClientRect().right-X.left-1)}var z=m.line.height-C;if((z>.005||z<-.005)&&(u<o&&(c-=z),ln(m.line,C),Js(m.line),m.rest))for(var ie=0;ie<m.rest.length;ie++)Js(m.rest[ie]);if(L>t.display.sizerWidth){var oe=Math.ceil(L/En(t.display));oe>t.display.maxLineLength&&(t.display.maxLineLength=oe,t.display.maxLine=m.line,t.display.maxLineChanged=!0)}}}Math.abs(c)>2&&(i.scroller.scrollTop+=c)}function Js(t){if(t.widgets)for(var i=0;i<t.widgets.length;++i){var s=t.widgets[i],o=s.node.parentNode;o&&(s.height=o.offsetHeight)}}function Oa(t,i,s){var o=s&&s.top!=null?Math.max(0,s.top):t.scroller.scrollTop;o=Math.floor(o-Ao(t));var u=s&&s.bottom!=null?s.bottom:o+t.wrapper.clientHeight,c=mi(i,o),g=mi(i,u);if(s&&s.ensure){var m=s.ensure.from.line,_=s.ensure.to.line;m<c?(c=m,g=mi(i,Tn(Me(i,m))+t.wrapper.clientHeight)):Math.min(_,i.lastLine())>=g&&(c=mi(i,Tn(Me(i,_))-t.wrapper.clientHeight),g=_)}return{from:c,to:Math.max(g,c+1)}}function Dc(t,i){if(!yt(t,"scrollCursorIntoView")){var s=t.display,o=s.sizer.getBoundingClientRect(),u=null;if(i.top+o.top<0?u=!0:i.bottom+o.top>(window.innerHeight||document.documentElement.clientHeight)&&(u=!1),u!=null&&!x){var c=q("div","\u200B",null,`position: absolute;
                         top: `+(i.top-s.viewOffset-Ao(t.display))+`px;
                         height: `+(i.bottom-i.top+fn(t)+s.barHeight)+`px;
                         left: `+i.left+"px; width: "+Math.max(2,i.right-i.left)+"px;");t.display.lineSpace.appendChild(c),c.scrollIntoView(u),t.display.lineSpace.removeChild(c)}}}function Qu(t,i,s,o){o==null&&(o=0);var u;!t.options.lineWrapping&&i==s&&(s=i.sticky=="before"?fe(i.line,i.ch+1,"before"):i,i=i.ch?fe(i.line,i.sticky=="before"?i.ch-1:i.ch,"after"):i);for(var c=0;c<5;c++){var g=!1,m=Ir(t,i),_=!s||s==i?m:Ir(t,s);u={left:Math.min(m.left,_.left),top:Math.min(m.top,_.top)-o,right:Math.max(m.left,_.left),bottom:Math.max(m.bottom,_.bottom)+o};var C=el(t,u),L=t.doc.scrollTop,M=t.doc.scrollLeft;if(C.scrollTop!=null&&(Ra(t,C.scrollTop),Math.abs(t.doc.scrollTop-L)>1&&(g=!0)),C.scrollLeft!=null&&(Ti(t,C.scrollLeft),Math.abs(t.doc.scrollLeft-M)>1&&(g=!0)),!g)break}return u}function Fc(t,i){var s=el(t,i);s.scrollTop!=null&&Ra(t,s.scrollTop),s.scrollLeft!=null&&Ti(t,s.scrollLeft)}function el(t,i){var s=t.display,o=Zi(t.display);i.top<0&&(i.top=0);var u=t.curOp&&t.curOp.scrollTop!=null?t.curOp.scrollTop:s.scroller.scrollTop,c=Gs(t),g={};i.bottom-i.top>c&&(i.bottom=i.top+c);var m=t.doc.height+$s(s),_=i.top<o,C=i.bottom>m-o;if(i.top<u)g.scrollTop=_?0:i.top;else if(i.bottom>u+c){var L=Math.min(i.top,(C?m:i.bottom)-c);L!=u&&(g.scrollTop=L)}var M=t.options.fixedGutter?0:s.gutters.offsetWidth,X=t.curOp&&t.curOp.scrollLeft!=null?t.curOp.scrollLeft:s.scroller.scrollLeft-M,z=_i(t)-s.gutters.offsetWidth,ie=i.right-i.left>z;return ie&&(i.right=i.left+z),i.left<10?g.scrollLeft=0:i.left<X?g.scrollLeft=Math.max(0,i.left+M-(ie?0:10)):i.right>z+X-3&&(g.scrollLeft=i.right+(ie?0:10)-z),g}function kn(t,i){i!=null&&(No(t),t.curOp.scrollTop=(t.curOp.scrollTop==null?t.doc.scrollTop:t.curOp.scrollTop)+i)}function Ji(t){No(t);var i=t.getCursor();t.curOp.scrollToPos={from:i,to:i,margin:t.options.cursorScrollMargin}}function xa(t,i,s){(i!=null||s!=null)&&No(t),i!=null&&(t.curOp.scrollLeft=i),s!=null&&(t.curOp.scrollTop=s)}function ea(t,i){No(t),t.curOp.scrollToPos=i}function No(t){var i=t.curOp.scrollToPos;if(i){t.curOp.scrollToPos=null;var s=Ea(t,i.from),o=Ea(t,i.to);Ju(t,s,o,i.margin)}}function Ju(t,i,s,o){var u=el(t,{left:Math.min(i.left,s.left),top:Math.min(i.top,s.top)-o,right:Math.max(i.right,s.right),bottom:Math.max(i.bottom,s.bottom)+o});xa(t,u.scrollLeft,u.scrollTop)}function Ra(t,i){Math.abs(t.doc.scrollTop-i)<2||(l||il(t,{top:i}),ef(t,i,!0),l&&il(t),La(t,100))}function ef(t,i,s){i=Math.max(0,Math.min(t.display.scroller.scrollHeight-t.display.scroller.clientHeight,i)),!(t.display.scroller.scrollTop==i&&!s)&&(t.doc.scrollTop=i,t.display.scrollbars.setScrollTop(i),t.display.scroller.scrollTop!=i&&(t.display.scroller.scrollTop=i))}function Ti(t,i,s,o){i=Math.max(0,Math.min(i,t.display.scroller.scrollWidth-t.display.scroller.clientWidth)),!((s?i==t.doc.scrollLeft:Math.abs(t.doc.scrollLeft-i)<2)&&!o)&&(t.doc.scrollLeft=i,sf(t),t.display.scroller.scrollLeft!=i&&(t.display.scroller.scrollLeft=i),t.display.scrollbars.setScrollLeft(i))}function Ci(t){var i=t.display,s=i.gutters.offsetWidth,o=Math.round(t.doc.height+$s(t.display));return{clientHeight:i.scroller.clientHeight,viewHeight:i.wrapper.clientHeight,scrollWidth:i.scroller.scrollWidth,clientWidth:i.scroller.clientWidth,viewWidth:i.wrapper.clientWidth,barLeft:t.options.fixedGutter?s:0,docHeight:o,scrollHeight:o+fn(t)+i.barHeight,nativeBarWidth:i.nativeBarWidth,gutterWidth:s}}var Zt=function(t,i,s){this.cm=s;var o=this.vert=q("div",[q("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),u=this.horiz=q("div",[q("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");o.tabIndex=u.tabIndex=-1,t(o),t(u),be(o,"scroll",function(){o.clientHeight&&i(o.scrollTop,"vertical")}),be(u,"scroll",function(){u.clientWidth&&i(u.scrollLeft,"horizontal")}),this.checkedZeroWidth=!1,d&&p<8&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")};Zt.prototype.update=function(t){var i=t.scrollWidth>t.clientWidth+1,s=t.scrollHeight>t.clientHeight+1,o=t.nativeBarWidth;if(s){this.vert.style.display="block",this.vert.style.bottom=i?o+"px":"0";var u=t.viewHeight-(i?o:0);this.vert.firstChild.style.height=Math.max(0,t.scrollHeight-t.clientHeight+u)+"px"}else this.vert.scrollTop=0,this.vert.style.display="",this.vert.firstChild.style.height="0";if(i){this.horiz.style.display="block",this.horiz.style.right=s?o+"px":"0",this.horiz.style.left=t.barLeft+"px";var c=t.viewWidth-t.barLeft-(s?o:0);this.horiz.firstChild.style.width=Math.max(0,t.scrollWidth-t.clientWidth+c)+"px"}else this.horiz.style.display="",this.horiz.firstChild.style.width="0";return!this.checkedZeroWidth&&t.clientHeight>0&&(o==0&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:s?o:0,bottom:i?o:0}},Zt.prototype.setScrollLeft=function(t){this.horiz.scrollLeft!=t&&(this.horiz.scrollLeft=t),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz,"horiz")},Zt.prototype.setScrollTop=function(t){this.vert.scrollTop!=t&&(this.vert.scrollTop=t),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert,"vert")},Zt.prototype.zeroWidthHack=function(){var t=U&&!T?"12px":"18px";this.horiz.style.height=this.vert.style.width=t,this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none",this.disableHoriz=new Ye,this.disableVert=new Ye},Zt.prototype.enableZeroWidthBar=function(t,i,s){t.style.pointerEvents="auto";function o(){var u=t.getBoundingClientRect(),c=s=="vert"?document.elementFromPoint(u.right-1,(u.top+u.bottom)/2):document.elementFromPoint((u.right+u.left)/2,u.bottom-1);c!=t?t.style.pointerEvents="none":i.set(1e3,o)}i.set(1e3,o)},Zt.prototype.clear=function(){var t=this.horiz.parentNode;t.removeChild(this.horiz),t.removeChild(this.vert)};var ta=function(){};ta.prototype.update=function(){return{bottom:0,right:0}},ta.prototype.setScrollLeft=function(){},ta.prototype.setScrollTop=function(){},ta.prototype.clear=function(){};function Ei(t,i){i||(i=Ci(t));var s=t.display.barWidth,o=t.display.barHeight;Pa(t,i);for(var u=0;u<4&&s!=t.display.barWidth||o!=t.display.barHeight;u++)s!=t.display.barWidth&&t.options.lineWrapping&&Io(t),Pa(t,Ci(t)),s=t.display.barWidth,o=t.display.barHeight}function Pa(t,i){var s=t.display,o=s.scrollbars.update(i);s.sizer.style.paddingRight=(s.barWidth=o.right)+"px",s.sizer.style.paddingBottom=(s.barHeight=o.bottom)+"px",s.heightForcer.style.borderBottom=o.bottom+"px solid transparent",o.right&&o.bottom?(s.scrollbarFiller.style.display="block",s.scrollbarFiller.style.height=o.bottom+"px",s.scrollbarFiller.style.width=o.right+"px"):s.scrollbarFiller.style.display="",o.bottom&&t.options.coverGutterNextToScrollbar&&t.options.fixedGutter?(s.gutterFiller.style.display="block",s.gutterFiller.style.height=o.bottom+"px",s.gutterFiller.style.width=i.gutterWidth+"px"):s.gutterFiller.style.display=""}var tl={native:Zt,null:ta};function rl(t){t.display.scrollbars&&(t.display.scrollbars.clear(),t.display.scrollbars.addClass&&re(t.display.wrapper,t.display.scrollbars.addClass)),t.display.scrollbars=new tl[t.options.scrollbarStyle](function(i){t.display.wrapper.insertBefore(i,t.display.scrollbarFiller),be(i,"mousedown",function(){t.state.focused&&setTimeout(function(){return t.display.input.focus()},0)}),i.setAttribute("cm-not-content","true")},function(i,s){s=="horizontal"?Ti(t,i):Ra(t,i)},t),t.display.scrollbars.addClass&&pe(t.display.wrapper,t.display.scrollbars.addClass)}var $c=0;function Hn(t){t.curOp={cm:t,viewChanged:!1,startHeight:t.doc.height,forceUpdate:!1,updateInput:0,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++$c,markArrays:null},Ec(t.curOp)}function On(t){var i=t.curOp;i&&wc(i,function(s){for(var o=0;o<s.ops.length;o++)s.ops[o].cm.curOp=null;Gc(s)})}function Gc(t){for(var i=t.ops,s=0;s<i.length;s++)tf(i[s]);for(var o=0;o<i.length;o++)rf(i[o]);for(var u=0;u<i.length;u++)Wc(i[u]);for(var c=0;c<i.length;c++)Bc(i[c]);for(var g=0;g<i.length;g++)Uc(i[g])}function tf(t){var i=t.cm,s=i.display;Hc(i),t.updateMaxLine&&Ds(i),t.mustUpdate=t.viewChanged||t.forceUpdate||t.scrollTop!=null||t.scrollToPos&&(t.scrollToPos.from.line<s.viewFrom||t.scrollToPos.to.line>=s.viewTo)||s.maxLineChanged&&i.options.lineWrapping,t.update=t.mustUpdate&&new xn(i,t.mustUpdate&&{top:t.scrollTop,ensure:t.scrollToPos},t.forceUpdate)}function rf(t){t.updatedDisplay=t.mustUpdate&&nl(t.cm,t.update)}function Wc(t){var i=t.cm,s=i.display;t.updatedDisplay&&Io(i),t.barMeasure=Ci(i),s.maxLineChanged&&!i.options.lineWrapping&&(t.adjustWidthTo=Ws(i,s.maxLine,s.maxLine.text.length).left+3,i.display.sizerWidth=t.adjustWidthTo,t.barMeasure.scrollWidth=Math.max(s.scroller.clientWidth,s.sizer.offsetLeft+t.adjustWidthTo+fn(i)+i.display.barWidth),t.maxScrollLeft=Math.max(0,s.sizer.offsetLeft+t.adjustWidthTo-_i(i))),(t.updatedDisplay||t.selectionChanged)&&(t.preparedSelection=s.input.prepareSelection())}function Bc(t){var i=t.cm;t.adjustWidthTo!=null&&(i.display.sizer.style.minWidth=t.adjustWidthTo+"px",t.maxScrollLeft<i.doc.scrollLeft&&Ti(i,Math.min(i.display.scroller.scrollLeft,t.maxScrollLeft),!0),i.display.maxLineChanged=!1);var s=t.focus&&t.focus==te();t.preparedSelection&&i.display.input.showSelection(t.preparedSelection,s),(t.updatedDisplay||t.startHeight!=i.doc.height)&&Ei(i,t.barMeasure),t.updatedDisplay&&ol(i,t.barMeasure),t.selectionChanged&&Vs(i),i.state.focused&&t.updateInput&&i.display.input.reset(t.typing),s&&Zu(t.cm)}function Uc(t){var i=t.cm,s=i.display,o=i.doc;if(t.updatedDisplay&&of(i,t.update),s.wheelStartX!=null&&(t.scrollTop!=null||t.scrollLeft!=null||t.scrollToPos)&&(s.wheelStartX=s.wheelStartY=null),t.scrollTop!=null&&ef(i,t.scrollTop,t.forceScroll),t.scrollLeft!=null&&Ti(i,t.scrollLeft,!0,!0),t.scrollToPos){var u=Qu(i,je(o,t.scrollToPos.from),je(o,t.scrollToPos.to),t.scrollToPos.margin);Dc(i,u)}var c=t.maybeHiddenMarkers,g=t.maybeUnhiddenMarkers;if(c)for(var m=0;m<c.length;++m)c[m].lines.length||ot(c[m],"hide");if(g)for(var _=0;_<g.length;++_)g[_].lines.length&&ot(g[_],"unhide");s.wrapper.offsetHeight&&(o.scrollTop=i.display.scroller.scrollTop),t.changeObjs&&ot(i,"changes",i,t.changeObjs),t.update&&t.update.finish()}function vr(t,i){if(t.curOp)return i();Hn(t);try{return i()}finally{On(t)}}function Rt(t,i){return function(){if(t.curOp)return i.apply(t,arguments);Hn(t);try{return i.apply(t,arguments)}finally{On(t)}}}function pr(t){return function(){if(this.curOp)return t.apply(this,arguments);Hn(this);try{return t.apply(this,arguments)}finally{On(this)}}}function Qt(t){return function(){var i=this.cm;if(!i||i.curOp)return t.apply(this,arguments);Hn(i);try{return t.apply(this,arguments)}finally{On(i)}}}function La(t,i){t.doc.highlightFrontier<t.display.viewTo&&t.state.highlight.set(i,Be(nf,t))}function nf(t){var i=t.doc;if(!(i.highlightFrontier>=t.display.viewTo)){var s=+new Date+t.options.workTime,o=Hi(t,i.highlightFrontier),u=[];i.iter(o.line,Math.min(i.first+i.size,t.display.viewTo+500),function(c){if(o.line>=t.display.viewFrom){var g=c.styles,m=c.text.length>t.options.maxHighlightLength?gi(i.mode,o.state):null,_=yu(t,c,o,!0);m&&(o.state=m),c.styles=_.styles;var C=c.styleClasses,L=_.classes;L?c.styleClasses=L:C&&(c.styleClasses=null);for(var M=!g||g.length!=c.styles.length||C!=L&&(!C||!L||C.bgClass!=L.bgClass||C.textClass!=L.textClass),X=0;!M&&X<g.length;++X)M=g[X]!=c.styles[X];M&&u.push(o.line),c.stateAfter=o.save(),o.nextLine()}else c.text.length<=t.options.maxHighlightLength&&po(t,c.text,o),c.stateAfter=o.line%5==0?o.save():null,o.nextLine();if(+new Date>s)return La(t,t.options.workDelay),!0}),i.highlightFrontier=o.line,i.modeFrontier=Math.max(i.modeFrontier,o.line),u.length&&vr(t,function(){for(var c=0;c<u.length;c++)An(t,u[c],"text")})}}var xn=function(t,i,s){var o=t.display;this.viewport=i,this.visible=Oa(o,t.doc,i),this.editorIsHidden=!o.wrapper.offsetWidth,this.wrapperHeight=o.wrapper.clientHeight,this.wrapperWidth=o.wrapper.clientWidth,this.oldDisplayWidth=_i(t),this.force=s,this.dims=Ys(t),this.events=[]};xn.prototype.signal=function(t,i){ir(t,i)&&this.events.push(arguments)},xn.prototype.finish=function(){for(var t=0;t<this.events.length;t++)ot.apply(null,this.events[t])};function Hc(t){var i=t.display;!i.scrollbarsClipped&&i.scroller.offsetWidth&&(i.nativeBarWidth=i.scroller.offsetWidth-i.scroller.clientWidth,i.heightForcer.style.height=fn(t)+"px",i.sizer.style.marginBottom=-i.nativeBarWidth+"px",i.sizer.style.borderRightWidth=fn(t)+"px",i.scrollbarsClipped=!0)}function af(t){if(t.hasFocus())return null;var i=te();if(!i||!ne(t.display.lineDiv,i))return null;var s={activeElt:i};if(window.getSelection){var o=window.getSelection();o.anchorNode&&o.extend&&ne(t.display.lineDiv,o.anchorNode)&&(s.anchorNode=o.anchorNode,s.anchorOffset=o.anchorOffset,s.focusNode=o.focusNode,s.focusOffset=o.focusOffset)}return s}function zc(t){if(!(!t||!t.activeElt||t.activeElt==te())&&(t.activeElt.focus(),!/^(INPUT|TEXTAREA)$/.test(t.activeElt.nodeName)&&t.anchorNode&&ne(document.body,t.anchorNode)&&ne(document.body,t.focusNode))){var i=window.getSelection(),s=document.createRange();s.setEnd(t.anchorNode,t.anchorOffset),s.collapse(!1),i.removeAllRanges(),i.addRange(s),i.extend(t.focusNode,t.focusOffset)}}function nl(t,i){var s=t.display,o=t.doc;if(i.editorIsHidden)return wn(t),!1;if(!i.force&&i.visible.from>=s.viewFrom&&i.visible.to<=s.viewTo&&(s.updateLineNumbers==null||s.updateLineNumbers>=s.viewTo)&&s.renderedView==s.view&&qu(t)==0)return!1;lf(t)&&(wn(t),i.dims=Ys(t));var u=o.first+o.size,c=Math.max(i.visible.from-t.options.viewportMargin,o.first),g=Math.min(u,i.visible.to+t.options.viewportMargin);s.viewFrom<c&&c-s.viewFrom<20&&(c=Math.max(o.first,s.viewFrom)),s.viewTo>g&&s.viewTo-g<20&&(g=Math.min(u,s.viewTo)),bn&&(c=Is(t.doc,c),g=Ns(t.doc,g));var m=c!=s.viewFrom||g!=s.viewTo||s.lastWrapHeight!=i.wrapperHeight||s.lastWrapWidth!=i.wrapperWidth;Nc(t,c,g),s.viewOffset=Tn(Me(t.doc,s.viewFrom)),t.display.mover.style.top=s.viewOffset+"px";var _=qu(t);if(!m&&_==0&&!i.force&&s.renderedView==s.view&&(s.updateLineNumbers==null||s.updateLineNumbers>=s.viewTo))return!1;var C=af(t);return _>4&&(s.lineDiv.style.display="none"),jc(t,s.updateLineNumbers,i.dims),_>4&&(s.lineDiv.style.display=""),s.renderedView=s.view,zc(C),se(s.cursorDiv),se(s.selectionDiv),s.gutters.style.height=s.sizer.style.minHeight=0,m&&(s.lastWrapHeight=i.wrapperHeight,s.lastWrapWidth=i.wrapperWidth,La(t,400)),s.updateLineNumbers=null,!0}function of(t,i){for(var s=i.viewport,o=!0;;o=!1){if(!o||!t.options.lineWrapping||i.oldDisplayWidth==_i(t)){if(s&&s.top!=null&&(s={top:Math.min(t.doc.height+$s(t.display)-Gs(t),s.top)}),i.visible=Oa(t.display,t.doc,s),i.visible.from>=t.display.viewFrom&&i.visible.to<=t.display.viewTo)break}else o&&(i.visible=Oa(t.display,t.doc,s));if(!nl(t,i))break;Io(t);var u=Ci(t);ka(t),Ei(t,u),ol(t,u),i.force=!1}i.signal(t,"update",t),(t.display.viewFrom!=t.display.reportedViewFrom||t.display.viewTo!=t.display.reportedViewTo)&&(i.signal(t,"viewportChange",t,t.display.viewFrom,t.display.viewTo),t.display.reportedViewFrom=t.display.viewFrom,t.display.reportedViewTo=t.display.viewTo)}function il(t,i){var s=new xn(t,i);if(nl(t,s)){Io(t),of(t,s);var o=Ci(t);ka(t),Ei(t,o),ol(t,o),s.finish()}}function jc(t,i,s){var o=t.display,u=t.options.lineNumbers,c=o.lineDiv,g=c.firstChild;function m(ie){var oe=ie.nextSibling;return S&&U&&t.display.currentWheelTarget==ie?ie.style.display="none":ie.parentNode.removeChild(ie),oe}for(var _=o.view,C=o.viewFrom,L=0;L<_.length;L++){var M=_[L];if(!M.hidden)if(!M.node||M.node.parentNode!=c){var X=xc(t,M,C,s);c.insertBefore(X,g)}else{for(;g!=M.node;)g=m(g);var z=u&&i!=null&&i<=C&&M.lineNumber;M.changes&&(Ue(M.changes,"gutter")>-1&&(z=!1),Iu(t,M,C,s)),z&&(se(M.lineNumber),M.lineNumber.appendChild(document.createTextNode(ya(t.options,C)))),g=M.node.nextSibling}C+=M.size}for(;g;)g=m(g)}function al(t){var i=t.gutters.offsetWidth;t.sizer.style.marginLeft=i+"px",Vt(t,"gutterChanged",t)}function ol(t,i){t.display.sizer.style.minHeight=i.docHeight+"px",t.display.heightForcer.style.top=i.docHeight+"px",t.display.gutters.style.height=i.docHeight+t.display.barHeight+fn(t)+"px"}function sf(t){var i=t.display,s=i.view;if(!(!i.alignWidgets&&(!i.gutters.firstChild||!t.options.fixedGutter))){for(var o=Xs(i)-i.scroller.scrollLeft+t.doc.scrollLeft,u=i.gutters.offsetWidth,c=o+"px",g=0;g<s.length;g++)if(!s[g].hidden){t.options.fixedGutter&&(s[g].gutter&&(s[g].gutter.style.left=c),s[g].gutterBackground&&(s[g].gutterBackground.style.left=c));var m=s[g].alignable;if(m)for(var _=0;_<m.length;_++)m[_].style.left=c}t.options.fixedGutter&&(i.gutters.style.left=o+u+"px")}}function lf(t){if(!t.options.lineNumbers)return!1;var i=t.doc,s=ya(t.options,i.first+i.size-1),o=t.display;if(s.length!=o.lineNumChars){var u=o.measure.appendChild(q("div",[q("div",s)],"CodeMirror-linenumber CodeMirror-gutter-elt")),c=u.firstChild.offsetWidth,g=u.offsetWidth-c;return o.lineGutter.style.width="",o.lineNumInnerWidth=Math.max(c,o.lineGutter.offsetWidth-g)+1,o.lineNumWidth=o.lineNumInnerWidth+g,o.lineNumChars=o.lineNumInnerWidth?s.length:-1,o.lineGutter.style.width=o.lineNumWidth+"px",al(t.display),!0}return!1}function sl(t,i){for(var s=[],o=!1,u=0;u<t.length;u++){var c=t[u],g=null;if(typeof c!="string"&&(g=c.style,c=c.className),c=="CodeMirror-linenumbers")if(i)o=!0;else continue;s.push({className:c,style:g})}return i&&!o&&s.push({className:"CodeMirror-linenumbers",style:null}),s}function uf(t){var i=t.gutters,s=t.gutterSpecs;se(i),t.lineGutter=null;for(var o=0;o<s.length;++o){var u=s[o],c=u.className,g=u.style,m=i.appendChild(q("div",null,"CodeMirror-gutter "+c));g&&(m.style.cssText=g),c=="CodeMirror-linenumbers"&&(t.lineGutter=m,m.style.width=(t.lineNumWidth||1)+"px")}i.style.display=s.length?"":"none",al(t)}function Ia(t){uf(t.display),_r(t),sf(t)}function Yc(t,i,s,o){var u=this;this.input=s,u.scrollbarFiller=q("div",null,"CodeMirror-scrollbar-filler"),u.scrollbarFiller.setAttribute("cm-not-content","true"),u.gutterFiller=q("div",null,"CodeMirror-gutter-filler"),u.gutterFiller.setAttribute("cm-not-content","true"),u.lineDiv=Ce("div",null,"CodeMirror-code"),u.selectionDiv=q("div",null,null,"position: relative; z-index: 1"),u.cursorDiv=q("div",null,"CodeMirror-cursors"),u.measure=q("div",null,"CodeMirror-measure"),u.lineMeasure=q("div",null,"CodeMirror-measure"),u.lineSpace=Ce("div",[u.measure,u.lineMeasure,u.selectionDiv,u.cursorDiv,u.lineDiv],null,"position: relative; outline: none");var c=Ce("div",[u.lineSpace],"CodeMirror-lines");u.mover=q("div",[c],null,"position: relative"),u.sizer=q("div",[u.mover],"CodeMirror-sizer"),u.sizerWidth=null,u.heightForcer=q("div",null,null,"position: absolute; height: "+Xe+"px; width: 1px;"),u.gutters=q("div",null,"CodeMirror-gutters"),u.lineGutter=null,u.scroller=q("div",[u.sizer,u.heightForcer,u.gutters],"CodeMirror-scroll"),u.scroller.setAttribute("tabIndex","-1"),u.wrapper=q("div",[u.scrollbarFiller,u.gutterFiller,u.scroller],"CodeMirror"),u.wrapper.setAttribute("translate","no"),d&&p<8&&(u.gutters.style.zIndex=-1,u.scroller.style.paddingRight=0),!S&&!(l&&B)&&(u.scroller.draggable=!0),t&&(t.appendChild?t.appendChild(u.wrapper):t(u.wrapper)),u.viewFrom=u.viewTo=i.first,u.reportedViewFrom=u.reportedViewTo=i.first,u.view=[],u.renderedView=null,u.externalMeasured=null,u.viewOffset=0,u.lastWrapHeight=u.lastWrapWidth=0,u.updateLineNumbers=null,u.nativeBarWidth=u.barHeight=u.barWidth=0,u.scrollbarsClipped=!1,u.lineNumWidth=u.lineNumInnerWidth=u.lineNumChars=null,u.alignWidgets=!1,u.cachedCharWidth=u.cachedTextHeight=u.cachedPaddingH=null,u.maxLine=null,u.maxLineLength=0,u.maxLineChanged=!1,u.wheelDX=u.wheelDY=u.wheelStartX=u.wheelStartY=null,u.shift=!1,u.selForContextMenu=null,u.activeTouch=null,u.gutterSpecs=sl(o.gutters,o.lineNumbers),uf(u),s.init(u)}var Mo=0,Vr=null;d?Vr=-.53:l?Vr=15:A?Vr=-.7:k&&(Vr=-1/3);function ff(t){var i=t.wheelDeltaX,s=t.wheelDeltaY;return i==null&&t.detail&&t.axis==t.HORIZONTAL_AXIS&&(i=t.detail),s==null&&t.detail&&t.axis==t.VERTICAL_AXIS?s=t.detail:s==null&&(s=t.wheelDelta),{x:i,y:s}}function ll(t){var i=ff(t);return i.x*=Vr,i.y*=Vr,i}function Do(t,i){var s=ff(i),o=s.x,u=s.y,c=Vr;i.deltaMode===0&&(o=i.deltaX,u=i.deltaY,c=1);var g=t.display,m=g.scroller,_=m.scrollWidth>m.clientWidth,C=m.scrollHeight>m.clientHeight;if(!!(o&&_||u&&C)){if(u&&U&&S){e:for(var L=i.target,M=g.view;L!=m;L=L.parentNode)for(var X=0;X<M.length;X++)if(M[X].node==L){t.display.currentWheelTarget=L;break e}}if(o&&!l&&!O&&c!=null){u&&C&&Ra(t,Math.max(0,m.scrollTop+u*c)),Ti(t,Math.max(0,m.scrollLeft+o*c)),(!u||u&&C)&&xt(i),g.wheelStartX=null;return}if(u&&c!=null){var z=u*c,ie=t.doc.scrollTop,oe=ie+g.wrapper.clientHeight;z<0?ie=Math.max(0,ie+z-50):oe=Math.min(t.doc.height,oe+z+50),il(t,{top:ie,bottom:oe})}Mo<20&&i.deltaMode!==0&&(g.wheelStartX==null?(g.wheelStartX=m.scrollLeft,g.wheelStartY=m.scrollTop,g.wheelDX=o,g.wheelDY=u,setTimeout(function(){if(g.wheelStartX!=null){var ve=m.scrollLeft-g.wheelStartX,ke=m.scrollTop-g.wheelStartY,xe=ke&&g.wheelDY&&ke/g.wheelDY||ve&&g.wheelDX&&ve/g.wheelDX;g.wheelStartX=g.wheelStartY=null,xe&&(Vr=(Vr*Mo+xe)/(Mo+1),++Mo)}},200)):(g.wheelDX+=o,g.wheelDY+=u))}}var br=function(t,i){this.ranges=t,this.primIndex=i};br.prototype.primary=function(){return this.ranges[this.primIndex]},br.prototype.equals=function(t){if(t==this)return!0;if(t.primIndex!=this.primIndex||t.ranges.length!=this.ranges.length)return!1;for(var i=0;i<this.ranges.length;i++){var s=this.ranges[i],o=t.ranges[i];if(!Bn(s.anchor,o.anchor)||!Bn(s.head,o.head))return!1}return!0},br.prototype.deepCopy=function(){for(var t=[],i=0;i<this.ranges.length;i++)t[i]=new ut(ks(this.ranges[i].anchor),ks(this.ranges[i].head));return new br(t,this.primIndex)},br.prototype.somethingSelected=function(){for(var t=0;t<this.ranges.length;t++)if(!this.ranges[t].empty())return!0;return!1},br.prototype.contains=function(t,i){i||(i=t);for(var s=0;s<this.ranges.length;s++){var o=this.ranges[s];if(ze(i,o.from())>=0&&ze(t,o.to())<=0)return s}return-1};var ut=function(t,i){this.anchor=t,this.head=i};ut.prototype.from=function(){return co(this.anchor,this.head)},ut.prototype.to=function(){return ho(this.anchor,this.head)},ut.prototype.empty=function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch};function jr(t,i,s){var o=t&&t.options.selectionsMayTouch,u=i[s];i.sort(function(X,z){return ze(X.from(),z.from())}),s=Ue(i,u);for(var c=1;c<i.length;c++){var g=i[c],m=i[c-1],_=ze(m.to(),g.from());if(o&&!g.empty()?_>0:_>=0){var C=co(m.from(),g.from()),L=ho(m.to(),g.to()),M=m.empty()?g.from()==g.head:m.from()==m.head;c<=s&&--s,i.splice(--c,2,new ut(M?L:C,M?C:L))}}return new br(i,s)}function zn(t,i){return new br([new ut(t,i||t)],0)}function jn(t){return t.text?fe(t.from.line+t.text.length-1,Ve(t.text).length+(t.text.length==1?t.from.ch:0)):t.to}function hf(t,i){if(ze(t,i.from)<0)return t;if(ze(t,i.to)<=0)return jn(i);var s=t.line+i.text.length-(i.to.line-i.from.line)-1,o=t.ch;return t.line==i.to.line&&(o+=jn(i).ch-i.to.ch),fe(s,o)}function Nr(t,i){for(var s=[],o=0;o<t.sel.ranges.length;o++){var u=t.sel.ranges[o];s.push(new ut(hf(u.anchor,i),hf(u.head,i)))}return jr(t.cm,s,t.sel.primIndex)}function Ai(t,i,s){return t.line==i.line?fe(s.line,t.ch-i.ch+s.ch):fe(s.line+(t.line-i.line),t.ch)}function Xc(t,i,s){for(var o=[],u=fe(t.first,0),c=u,g=0;g<i.length;g++){var m=i[g],_=Ai(m.from,u,c),C=Ai(jn(m),u,c);if(u=m.to,c=C,s=="around"){var L=t.sel.ranges[g],M=ze(L.head,L.anchor)<0;o[g]=new ut(M?C:_,M?_:C)}else o[g]=new ut(_,_)}return new br(o,t.sel.primIndex)}function Na(t){t.doc.mode=uo(t.options,t.doc.modeOption),Ma(t)}function Ma(t){t.doc.iter(function(i){i.stateAfter&&(i.stateAfter=null),i.styles&&(i.styles=null)}),t.doc.modeFrontier=t.doc.highlightFrontier=t.doc.first,La(t,100),t.state.modeGen++,t.curOp&&_r(t)}function ra(t,i){return i.from.ch==0&&i.to.ch==0&&Ve(i.text)==""&&(!t.cm||t.cm.options.wholeLineUpdateBefore)}function ul(t,i,s,o){function u(xe){return s?s[xe]:null}function c(xe,Oe,Pe){gc(xe,Oe,Pe,o),Vt(xe,"change",xe,i)}function g(xe,Oe){for(var Pe=[],We=xe;We<Oe;++We)Pe.push(new Yi(C[We],u(We),o));return Pe}var m=i.from,_=i.to,C=i.text,L=Me(t,m.line),M=Me(t,_.line),X=Ve(C),z=u(C.length-1),ie=_.line-m.line;if(i.full)t.insert(0,g(0,C.length)),t.remove(C.length,t.size-C.length);else if(ra(t,i)){var oe=g(0,C.length-1);c(M,M.text,z),ie&&t.remove(m.line,ie),oe.length&&t.insert(m.line,oe)}else if(L==M)if(C.length==1)c(L,L.text.slice(0,m.ch)+X+L.text.slice(_.ch),z);else{var ve=g(1,C.length-1);ve.push(new Yi(X+L.text.slice(_.ch),z,o)),c(L,L.text.slice(0,m.ch)+C[0],u(0)),t.insert(m.line+1,ve)}else if(C.length==1)c(L,L.text.slice(0,m.ch)+C[0]+M.text.slice(_.ch),u(0)),t.remove(m.line+1,ie);else{c(L,L.text.slice(0,m.ch)+C[0],u(0)),c(M,X+M.text.slice(_.ch),z);var ke=g(1,C.length-1);ie>1&&t.remove(m.line+1,ie-1),t.insert(m.line+1,ke)}Vt(t,"change",t,i)}function Yn(t,i,s){function o(u,c,g){if(u.linked)for(var m=0;m<u.linked.length;++m){var _=u.linked[m];if(_.doc!=c){var C=g&&_.sharedHist;s&&!C||(i(_.doc,C),o(_.doc,u,C))}}}o(t,null,!0)}function cf(t,i){if(i.cm)throw new Error("This document is already in use.");t.doc=i,i.cm=t,wa(t),Na(t),df(t),t.options.direction=i.direction,t.options.lineWrapping||Ds(t),t.options.mode=i.modeOption,_r(t)}function df(t){(t.doc.direction=="rtl"?pe:re)(t.display.lineDiv,"CodeMirror-rtl")}function fl(t){vr(t,function(){df(t),_r(t)})}function Ar(t){this.done=[],this.undone=[],this.undoDepth=t?t.undoDepth:1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=t?t.maxGeneration:1}function cn(t,i){var s={from:ks(i.from),to:jn(i),text:yi(t,i.from,i.to)};return pf(t,s,i.from.line,i.to.line+1),Yn(t,function(o){return pf(o,s,i.from.line,i.to.line+1)},!0),s}function Rn(t){for(;t.length;){var i=Ve(t);if(i.ranges)t.pop();else break}}function Kc(t,i){if(i)return Rn(t.done),Ve(t.done);if(t.done.length&&!Ve(t.done).ranges)return Ve(t.done);if(t.done.length>1&&!t.done[t.done.length-2].ranges)return t.done.pop(),Ve(t.done)}function vf(t,i,s,o){var u=t.history;u.undone.length=0;var c=+new Date,g,m;if((u.lastOp==o||u.lastOrigin==i.origin&&i.origin&&(i.origin.charAt(0)=="+"&&u.lastModTime>c-(t.cm?t.cm.options.historyEventDelay:500)||i.origin.charAt(0)=="*"))&&(g=Kc(u,u.lastOp==o)))m=Ve(g.changes),ze(i.from,i.to)==0&&ze(i.from,m.to)==0?m.to=jn(i):g.changes.push(cn(t,i));else{var _=Ve(u.done);for((!_||!_.ranges)&&Fo(t.sel,u.done),g={changes:[cn(t,i)],generation:u.generation},u.done.push(g);u.done.length>u.undoDepth;)u.done.shift(),u.done[0].ranges||u.done.shift()}u.done.push(s),u.generation=++u.maxGeneration,u.lastModTime=u.lastSelTime=c,u.lastOp=u.lastSelOp=o,u.lastOrigin=u.lastSelOrigin=i.origin,m||ot(t,"historyAdded")}function qc(t,i,s,o){var u=i.charAt(0);return u=="*"||u=="+"&&s.ranges.length==o.ranges.length&&s.somethingSelected()==o.somethingSelected()&&new Date-t.history.lastSelTime<=(t.cm?t.cm.options.historyEventDelay:500)}function Vc(t,i,s,o){var u=t.history,c=o&&o.origin;s==u.lastSelOp||c&&u.lastSelOrigin==c&&(u.lastModTime==u.lastSelTime&&u.lastOrigin==c||qc(t,c,Ve(u.done),i))?u.done[u.done.length-1]=i:Fo(i,u.done),u.lastSelTime=+new Date,u.lastSelOrigin=c,u.lastSelOp=s,o&&o.clearRedo!==!1&&Rn(u.undone)}function Fo(t,i){var s=Ve(i);s&&s.ranges&&s.equals(t)||i.push(t)}function pf(t,i,s,o){var u=i["spans_"+t.id],c=0;t.iter(Math.max(t.first,s),Math.min(t.first+t.size,o),function(g){g.markedSpans&&((u||(u=i["spans_"+t.id]={}))[c]=g.markedSpans),++c})}function Zc(t){if(!t)return null;for(var i,s=0;s<t.length;++s)t[s].marker.explicitlyCleared?i||(i=t.slice(0,s)):i&&i.push(t[s]);return i?i.length?i:null:t}function Qc(t,i){var s=i["spans_"+t.id];if(!s)return null;for(var o=[],u=0;u<i.text.length;++u)o.push(Zc(s[u]));return o}function gf(t,i){var s=Qc(t,i),o=Rs(t,i);if(!s)return o;if(!o)return s;for(var u=0;u<s.length;++u){var c=s[u],g=o[u];if(c&&g){e:for(var m=0;m<g.length;++m){for(var _=g[m],C=0;C<c.length;++C)if(c[C].marker==_.marker)continue e;c.push(_)}}else g&&(s[u]=g)}return s}function Xn(t,i,s){for(var o=[],u=0;u<t.length;++u){var c=t[u];if(c.ranges){o.push(s?br.prototype.deepCopy.call(c):c);continue}var g=c.changes,m=[];o.push({changes:m});for(var _=0;_<g.length;++_){var C=g[_],L=void 0;if(m.push({from:C.from,to:C.to,text:C.text}),i)for(var M in C)(L=M.match(/^spans_(\d+)$/))&&Ue(i,Number(L[1]))>-1&&(Ve(m)[M]=C[M],delete C[M])}}return o}function hl(t,i,s,o){if(o){var u=t.anchor;if(s){var c=ze(i,u)<0;c!=ze(s,u)<0?(u=i,i=s):c!=ze(i,s)<0&&(i=s)}return new ut(u,i)}else return new ut(s||i,i)}function $o(t,i,s,o,u){u==null&&(u=t.cm&&(t.cm.display.shift||t.extend)),lr(t,new br([hl(t.sel.primary(),i,s,u)],0),o)}function yf(t,i,s){for(var o=[],u=t.cm&&(t.cm.display.shift||t.extend),c=0;c<t.sel.ranges.length;c++)o[c]=hl(t.sel.ranges[c],i[c],null,u);var g=jr(t.cm,o,t.sel.primIndex);lr(t,g,s)}function cl(t,i,s,o){var u=t.sel.ranges.slice(0);u[i]=s,lr(t,jr(t.cm,u,t.sel.primIndex),o)}function mf(t,i,s,o){lr(t,zn(i,s),o)}function _f(t,i,s){var o={ranges:i.ranges,update:function(u){this.ranges=[];for(var c=0;c<u.length;c++)this.ranges[c]=new ut(je(t,u[c].anchor),je(t,u[c].head))},origin:s&&s.origin};return ot(t,"beforeSelectionChange",t,o),t.cm&&ot(t.cm,"beforeSelectionChange",t.cm,o),o.ranges!=i.ranges?jr(t.cm,o.ranges,o.ranges.length-1):i}function bf(t,i,s){var o=t.history.done,u=Ve(o);u&&u.ranges?(o[o.length-1]=i,Go(t,i,s)):lr(t,i,s)}function lr(t,i,s){Go(t,i,s),Vc(t,t.sel,t.cm?t.cm.curOp.id:NaN,s)}function Go(t,i,s){(ir(t,"beforeSelectionChange")||t.cm&&ir(t.cm,"beforeSelectionChange"))&&(i=_f(t,i,s));var o=s&&s.bias||(ze(i.primary().head,t.sel.primary().head)<0?-1:1);Sf(t,Cf(t,i,o,!0)),!(s&&s.scroll===!1)&&t.cm&&t.cm.getOption("readOnly")!="nocursor"&&Ji(t.cm)}function Sf(t,i){i.equals(t.sel)||(t.sel=i,t.cm&&(t.cm.curOp.updateInput=1,t.cm.curOp.selectionChanged=!0,Br(t.cm)),Vt(t,"cursorActivity",t))}function Tf(t){Sf(t,Cf(t,t.sel,null,!1))}function Cf(t,i,s,o){for(var u,c=0;c<i.ranges.length;c++){var g=i.ranges[c],m=i.ranges.length==t.sel.ranges.length&&t.sel.ranges[c],_=Da(t,g.anchor,m&&m.anchor,s,o),C=Da(t,g.head,m&&m.head,s,o);(u||_!=g.anchor||C!=g.head)&&(u||(u=i.ranges.slice(0,c)),u[c]=new ut(_,C))}return u?jr(t.cm,u,i.primIndex):i}function Kn(t,i,s,o,u){var c=Me(t,i.line);if(c.markedSpans)for(var g=0;g<c.markedSpans.length;++g){var m=c.markedSpans[g],_=m.marker,C="selectLeft"in _?!_.selectLeft:_.inclusiveLeft,L="selectRight"in _?!_.selectRight:_.inclusiveRight;if((m.from==null||(C?m.from<=i.ch:m.from<i.ch))&&(m.to==null||(L?m.to>=i.ch:m.to>i.ch))){if(u&&(ot(_,"beforeCursorEnter"),_.explicitlyCleared))if(c.markedSpans){--g;continue}else break;if(!_.atomic)continue;if(s){var M=_.find(o<0?1:-1),X=void 0;if((o<0?L:C)&&(M=Ef(t,M,-o,M&&M.line==i.line?c:null)),M&&M.line==i.line&&(X=ze(M,s))&&(o<0?X<0:X>0))return Kn(t,M,i,o,u)}var z=_.find(o<0?-1:1);return(o<0?C:L)&&(z=Ef(t,z,o,z.line==i.line?c:null)),z?Kn(t,z,i,o,u):null}}return i}function Da(t,i,s,o,u){var c=o||1,g=Kn(t,i,s,c,u)||!u&&Kn(t,i,s,c,!0)||Kn(t,i,s,-c,u)||!u&&Kn(t,i,s,-c,!0);return g||(t.cantEdit=!0,fe(t.first,0))}function Ef(t,i,s,o){return s<0&&i.ch==0?i.line>t.first?je(t,fe(i.line-1)):null:s>0&&i.ch==(o||Me(t,i.line)).text.length?i.line<t.first+t.size-1?fe(i.line+1,0):null:new fe(i.line,i.ch+s)}function Af(t){t.setSelection(fe(t.firstLine(),0),fe(t.lastLine()),ht)}function wf(t,i,s){var o={canceled:!1,from:i.from,to:i.to,text:i.text,origin:i.origin,cancel:function(){return o.canceled=!0}};return s&&(o.update=function(u,c,g,m){u&&(o.from=je(t,u)),c&&(o.to=je(t,c)),g&&(o.text=g),m!==void 0&&(o.origin=m)}),ot(t,"beforeChange",t,o),t.cm&&ot(t.cm,"beforeChange",t.cm,o),o.canceled?(t.cm&&(t.cm.curOp.updateInput=2),null):{from:o.from,to:o.to,text:o.text,origin:o.origin}}function wi(t,i,s){if(t.cm){if(!t.cm.curOp)return Rt(t.cm,wi)(t,i,s);if(t.cm.state.suppressEdits)return}if(!((ir(t,"beforeChange")||t.cm&&ir(t.cm,"beforeChange"))&&(i=wf(t,i,!0),!i))){var o=Eu&&!s&&dc(t,i.from,i.to);if(o)for(var u=o.length-1;u>=0;--u)dl(t,{from:o[u].from,to:o[u].to,text:u?[""]:i.text,origin:i.origin});else dl(t,i)}}function dl(t,i){if(!(i.text.length==1&&i.text[0]==""&&ze(i.from,i.to)==0)){var s=Nr(t,i);vf(t,i,s,t.cm?t.cm.curOp.id:NaN),$a(t,i,s,Rs(t,i));var o=[];Yn(t,function(u,c){!c&&Ue(o,u.history)==-1&&(xf(u.history,i),o.push(u.history)),$a(u,i,null,Rs(u,i))})}}function Fa(t,i,s){var o=t.cm&&t.cm.state.suppressEdits;if(!(o&&!s)){for(var u=t.history,c,g=t.sel,m=i=="undo"?u.done:u.undone,_=i=="undo"?u.undone:u.done,C=0;C<m.length&&(c=m[C],!(s?c.ranges&&!c.equals(t.sel):!c.ranges));C++);if(C!=m.length){for(u.lastOrigin=u.lastSelOrigin=null;;)if(c=m.pop(),c.ranges){if(Fo(c,_),s&&!c.equals(t.sel)){lr(t,c,{clearRedo:!1});return}g=c}else if(o){m.push(c);return}else break;var L=[];Fo(g,_),_.push({changes:L,generation:u.generation}),u.generation=c.generation||++u.maxGeneration;for(var M=ir(t,"beforeChange")||t.cm&&ir(t.cm,"beforeChange"),X=function(oe){var ve=c.changes[oe];if(ve.origin=i,M&&!wf(t,ve,!1))return m.length=0,{};L.push(cn(t,ve));var ke=oe?Nr(t,ve):Ve(m);$a(t,ve,ke,gf(t,ve)),!oe&&t.cm&&t.cm.scrollIntoView({from:ve.from,to:jn(ve)});var xe=[];Yn(t,function(Oe,Pe){!Pe&&Ue(xe,Oe.history)==-1&&(xf(Oe.history,ve),xe.push(Oe.history)),$a(Oe,ve,null,gf(Oe,ve))})},z=c.changes.length-1;z>=0;--z){var ie=X(z);if(ie)return ie.v}}}}function vl(t,i){if(i!=0&&(t.first+=i,t.sel=new br(Pr(t.sel.ranges,function(u){return new ut(fe(u.anchor.line+i,u.anchor.ch),fe(u.head.line+i,u.head.ch))}),t.sel.primIndex),t.cm)){_r(t.cm,t.first,t.first-i,i);for(var s=t.cm.display,o=s.viewFrom;o<s.viewTo;o++)An(t.cm,o,"gutter")}}function $a(t,i,s,o){if(t.cm&&!t.cm.curOp)return Rt(t.cm,$a)(t,i,s,o);if(i.to.line<t.first){vl(t,i.text.length-1-(i.to.line-i.from.line));return}if(!(i.from.line>t.lastLine())){if(i.from.line<t.first){var u=i.text.length-1-(t.first-i.from.line);vl(t,u),i={from:fe(t.first,0),to:fe(i.to.line+u,i.to.ch),text:[Ve(i.text)],origin:i.origin}}var c=t.lastLine();i.to.line>c&&(i={from:i.from,to:fe(c,Me(t,c).text.length),text:[i.text[0]],origin:i.origin}),i.removed=yi(t,i.from,i.to),s||(s=Nr(t,i)),t.cm?kf(t.cm,i,o):ul(t,i,o),Go(t,s,ht),t.cantEdit&&Da(t,fe(t.firstLine(),0))&&(t.cantEdit=!1)}}function kf(t,i,s){var o=t.doc,u=t.display,c=i.from,g=i.to,m=!1,_=c.line;t.options.lineWrapping||(_=pt(zr(Me(o,c.line))),o.iter(_,g.line+1,function(z){if(z==u.maxLine)return m=!0,!0})),o.sel.contains(i.from,i.to)>-1&&Br(t),ul(o,i,s,Ks(t)),t.options.lineWrapping||(o.iter(_,c.line+i.text.length,function(z){var ie=Co(z);ie>u.maxLineLength&&(u.maxLine=z,u.maxLineLength=ie,u.maxLineChanged=!0,m=!1)}),m&&(t.curOp.updateMaxLine=!0)),uc(o,c.line),La(t,400);var C=i.text.length-(g.line-c.line)-1;i.full?_r(t):c.line==g.line&&i.text.length==1&&!ra(t.doc,i)?An(t,c.line,"text"):_r(t,c.line,g.line+1,C);var L=ir(t,"changes"),M=ir(t,"change");if(M||L){var X={from:c,to:g,text:i.text,removed:i.removed,origin:i.origin};M&&Vt(t,"change",t,X),L&&(t.curOp.changeObjs||(t.curOp.changeObjs=[])).push(X)}t.display.selForContextMenu=null}function wr(t,i,s,o,u){var c;o||(o=s),ze(o,s)<0&&(c=[o,s],s=c[0],o=c[1]),typeof i=="string"&&(i=t.splitLines(i)),wi(t,{from:s,to:o,text:i,origin:u})}function Ut(t,i,s,o){s<t.line?t.line+=o:i<t.line&&(t.line=i,t.ch=0)}function Of(t,i,s,o){for(var u=0;u<t.length;++u){var c=t[u],g=!0;if(c.ranges){c.copied||(c=t[u]=c.deepCopy(),c.copied=!0);for(var m=0;m<c.ranges.length;m++)Ut(c.ranges[m].anchor,i,s,o),Ut(c.ranges[m].head,i,s,o);continue}for(var _=0;_<c.changes.length;++_){var C=c.changes[_];if(s<C.from.line)C.from=fe(C.from.line+o,C.from.ch),C.to=fe(C.to.line+o,C.to.ch);else if(i<=C.to.line){g=!1;break}}g||(t.splice(0,u+1),u=0)}}function xf(t,i){var s=i.from.line,o=i.to.line,u=i.text.length-(o-s)-1;Of(t.done,s,o,u),Of(t.undone,s,o,u)}function na(t,i,s,o){var u=i,c=i;return typeof i=="number"?c=Me(t,pu(t,i)):u=pt(i),u==null?null:(o(c,u)&&t.cm&&An(t.cm,u,s),c)}function ia(t){this.lines=t,this.parent=null;for(var i=0,s=0;s<t.length;++s)t[s].parent=this,i+=t[s].height;this.height=i}ia.prototype={chunkSize:function(){return this.lines.length},removeInner:function(t,i){for(var s=t,o=t+i;s<o;++s){var u=this.lines[s];this.height-=u.height,yc(u),Vt(u,"delete")}this.lines.splice(t,i)},collapse:function(t){t.push.apply(t,this.lines)},insertInner:function(t,i,s){this.height+=s,this.lines=this.lines.slice(0,t).concat(i).concat(this.lines.slice(t));for(var o=0;o<i.length;++o)i[o].parent=this},iterN:function(t,i,s){for(var o=t+i;t<o;++t)if(s(this.lines[t]))return!0}};function qn(t){this.children=t;for(var i=0,s=0,o=0;o<t.length;++o){var u=t[o];i+=u.chunkSize(),s+=u.height,u.parent=this}this.size=i,this.height=s,this.parent=null}qn.prototype={chunkSize:function(){return this.size},removeInner:function(t,i){this.size-=i;for(var s=0;s<this.children.length;++s){var o=this.children[s],u=o.chunkSize();if(t<u){var c=Math.min(i,u-t),g=o.height;if(o.removeInner(t,c),this.height-=g-o.height,u==c&&(this.children.splice(s--,1),o.parent=null),(i-=c)==0)break;t=0}else t-=u}if(this.size-i<25&&(this.children.length>1||!(this.children[0]instanceof ia))){var m=[];this.collapse(m),this.children=[new ia(m)],this.children[0].parent=this}},collapse:function(t){for(var i=0;i<this.children.length;++i)this.children[i].collapse(t)},insertInner:function(t,i,s){this.size+=i.length,this.height+=s;for(var o=0;o<this.children.length;++o){var u=this.children[o],c=u.chunkSize();if(t<=c){if(u.insertInner(t,i,s),u.lines&&u.lines.length>50){for(var g=u.lines.length%25+25,m=g;m<u.lines.length;){var _=new ia(u.lines.slice(m,m+=25));u.height-=_.height,this.children.splice(++o,0,_),_.parent=this}u.lines=u.lines.slice(0,g),this.maybeSpill()}break}t-=c}},maybeSpill:function(){if(!(this.children.length<=10)){var t=this;do{var i=t.children.splice(t.children.length-5,5),s=new qn(i);if(t.parent){t.size-=s.size,t.height-=s.height;var u=Ue(t.parent.children,t);t.parent.children.splice(u+1,0,s)}else{var o=new qn(t.children);o.parent=t,t.children=[o,s],t=o}s.parent=t.parent}while(t.children.length>10);t.parent.maybeSpill()}},iterN:function(t,i,s){for(var o=0;o<this.children.length;++o){var u=this.children[o],c=u.chunkSize();if(t<c){var g=Math.min(i,c-t);if(u.iterN(t,g,s))return!0;if((i-=g)==0)break;t=0}else t-=c}}};var aa=function(t,i,s){if(s)for(var o in s)s.hasOwnProperty(o)&&(this[o]=s[o]);this.doc=t,this.node=i};aa.prototype.clear=function(){var t=this.doc.cm,i=this.line.widgets,s=this.line,o=pt(s);if(!(o==null||!i)){for(var u=0;u<i.length;++u)i[u]==this&&i.splice(u--,1);i.length||(s.widgets=null);var c=Sa(this);ln(s,Math.max(0,s.height-c)),t&&(vr(t,function(){Rf(t,s,-c),An(t,o,"widget")}),Vt(t,"lineWidgetCleared",t,this,o))}},aa.prototype.changed=function(){var t=this,i=this.height,s=this.doc.cm,o=this.line;this.height=null;var u=Sa(this)-i;!u||(Sn(this.doc,o)||ln(o,o.height+u),s&&vr(s,function(){s.curOp.forceUpdate=!0,Rf(s,o,u),Vt(s,"lineWidgetChanged",s,t,pt(o))}))},Ur(aa);function Rf(t,i,s){Tn(i)<(t.curOp&&t.curOp.scrollTop||t.doc.scrollTop)&&kn(t,s)}function Pf(t,i,s,o){var u=new aa(t,s,o),c=t.cm;return c&&u.noHScroll&&(c.display.alignWidgets=!0),na(t,i,"widget",function(g){var m=g.widgets||(g.widgets=[]);if(u.insertAt==null?m.push(u):m.splice(Math.min(m.length,Math.max(0,u.insertAt)),0,u),u.line=g,c&&!Sn(t,g)){var _=Tn(g)<t.scrollTop;ln(g,g.height+Sa(u)),_&&kn(c,u.height),c.curOp.forceUpdate=!0}return!0}),c&&Vt(c,"lineWidgetAdded",c,u,typeof i=="number"?i:pt(i)),u}var Lf=0,Pn=function(t,i){this.lines=[],this.type=i,this.doc=t,this.id=++Lf};Pn.prototype.clear=function(){if(!this.explicitlyCleared){var t=this.doc.cm,i=t&&!t.curOp;if(i&&Hn(t),ir(this,"clear")){var s=this.find();s&&Vt(this,"clear",s.from,s.to)}for(var o=null,u=null,c=0;c<this.lines.length;++c){var g=this.lines[c],m=zi(g.markedSpans,this);t&&!this.collapsed?An(t,pt(g),"text"):t&&(m.to!=null&&(u=pt(g)),m.from!=null&&(o=pt(g))),g.markedSpans=Au(g.markedSpans,m),m.from==null&&this.collapsed&&!Sn(this.doc,g)&&t&&ln(g,Zi(t.display))}if(t&&this.collapsed&&!t.options.lineWrapping)for(var _=0;_<this.lines.length;++_){var C=zr(this.lines[_]),L=Co(C);L>t.display.maxLineLength&&(t.display.maxLine=C,t.display.maxLineLength=L,t.display.maxLineChanged=!0)}o!=null&&t&&this.collapsed&&_r(t,o,u+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,t&&Tf(t.doc)),t&&Vt(t,"markerCleared",t,this,o,u),i&&On(t),this.parent&&this.parent.clear()}},Pn.prototype.find=function(t,i){t==null&&this.type=="bookmark"&&(t=1);for(var s,o,u=0;u<this.lines.length;++u){var c=this.lines[u],g=zi(c.markedSpans,this);if(g.from!=null&&(s=fe(i?c:pt(c),g.from),t==-1))return s;if(g.to!=null&&(o=fe(i?c:pt(c),g.to),t==1))return o}return s&&{from:s,to:o}},Pn.prototype.changed=function(){var t=this,i=this.find(-1,!0),s=this,o=this.doc.cm;!i||!o||vr(o,function(){var u=i.line,c=pt(i.line),g=wo(o,c);if(g&&(Bs(g),o.curOp.selectionChanged=o.curOp.forceUpdate=!0),o.curOp.updateMaxLine=!0,!Sn(s.doc,u)&&s.height!=null){var m=s.height;s.height=null;var _=Sa(s)-m;_&&ln(u,u.height+_)}Vt(o,"markerChanged",o,t)})},Pn.prototype.attachLine=function(t){if(!this.lines.length&&this.doc.cm){var i=this.doc.cm.curOp;(!i.maybeHiddenMarkers||Ue(i.maybeHiddenMarkers,this)==-1)&&(i.maybeUnhiddenMarkers||(i.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(t)},Pn.prototype.detachLine=function(t){if(this.lines.splice(Ue(this.lines,t),1),!this.lines.length&&this.doc.cm){var i=this.doc.cm.curOp;(i.maybeHiddenMarkers||(i.maybeHiddenMarkers=[])).push(this)}},Ur(Pn);function oa(t,i,s,o,u){if(o&&o.shared)return Jc(t,i,s,o,u);if(t.cm&&!t.cm.curOp)return Rt(t.cm,oa)(t,i,s,o,u);var c=new Pn(t,u),g=ze(i,s);if(o&&Ke(o,c,!1),g>0||g==0&&c.clearWhenEmpty!==!1)return c;if(c.replacedWith&&(c.collapsed=!0,c.widgetNode=Ce("span",[c.replacedWith],"CodeMirror-widget"),o.handleMouseEvents||c.widgetNode.setAttribute("cm-ignore-events","true"),o.insertLeft&&(c.widgetNode.insertLeft=!0)),c.collapsed){if(To(t,i.line,i,s,c)||i.line!=s.line&&To(t,s.line,i,s,c))throw new Error("Inserting collapsed marker partially overlapping an existing one");hc()}c.addToHistory&&vf(t,{from:i,to:s,origin:"markText"},t.sel,NaN);var m=i.line,_=t.cm,C;if(t.iter(m,s.line+1,function(M){_&&c.collapsed&&!_.options.lineWrapping&&zr(M)==_.display.maxLine&&(C=!0),c.collapsed&&m!=i.line&&ln(M,0),cc(M,new go(c,m==i.line?i.ch:null,m==s.line?s.ch:null),t.cm&&t.cm.curOp),++m}),c.collapsed&&t.iter(i.line,s.line+1,function(M){Sn(t,M)&&ln(M,0)}),c.clearOnEnter&&be(c,"beforeCursorEnter",function(){return c.clear()}),c.readOnly&&(fc(),(t.history.done.length||t.history.undone.length)&&t.clearHistory()),c.collapsed&&(c.id=++Lf,c.atomic=!0),_){if(C&&(_.curOp.updateMaxLine=!0),c.collapsed)_r(_,i.line,s.line+1);else if(c.className||c.startStyle||c.endStyle||c.css||c.attributes||c.title)for(var L=i.line;L<=s.line;L++)An(_,L,"text");c.atomic&&Tf(_.doc),Vt(_,"markerAdded",_,c)}return c}var Ga=function(t,i){this.markers=t,this.primary=i;for(var s=0;s<t.length;++s)t[s].parent=this};Ga.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var t=0;t<this.markers.length;++t)this.markers[t].clear();Vt(this,"clear")}},Ga.prototype.find=function(t,i){return this.primary.find(t,i)},Ur(Ga);function Jc(t,i,s,o,u){o=Ke(o),o.shared=!1;var c=[oa(t,i,s,o,u)],g=c[0],m=o.widgetNode;return Yn(t,function(_){m&&(o.widgetNode=m.cloneNode(!0)),c.push(oa(_,je(_,i),je(_,s),o,u));for(var C=0;C<_.linked.length;++C)if(_.linked[C].isParent)return;g=Ve(c)}),new Ga(c,g)}function pl(t){return t.findMarks(fe(t.first,0),t.clipPos(fe(t.lastLine())),function(i){return i.parent})}function If(t,i){for(var s=0;s<i.length;s++){var o=i[s],u=o.find(),c=t.clipPos(u.from),g=t.clipPos(u.to);if(ze(c,g)){var m=oa(t,c,g,o.primary,o.primary.type);o.markers.push(m),m.parent=o}}}function ed(t){for(var i=function(o){var u=t[o],c=[u.primary.doc];Yn(u.primary.doc,function(_){return c.push(_)});for(var g=0;g<u.markers.length;g++){var m=u.markers[g];Ue(c,m.doc)==-1&&(m.parent=null,u.markers.splice(g--,1))}},s=0;s<t.length;s++)i(s)}var Wo=0,ur=function(t,i,s,o,u){if(!(this instanceof ur))return new ur(t,i,s,o,u);s==null&&(s=0),qn.call(this,[new ia([new Yi("",null)])]),this.first=s,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.modeFrontier=this.highlightFrontier=s;var c=fe(s,0);this.sel=zn(c),this.history=new Ar(null),this.id=++Wo,this.modeOption=i,this.lineSep=o,this.direction=u=="rtl"?"rtl":"ltr",this.extend=!1,typeof t=="string"&&(t=this.splitLines(t)),ul(this,{from:c,to:c,text:t}),lr(this,zn(c),ht)};ur.prototype=Tr(qn.prototype,{constructor:ur,iter:function(t,i,s){s?this.iterN(t-this.first,i-t,s):this.iterN(this.first,this.first+this.size,t)},insert:function(t,i){for(var s=0,o=0;o<i.length;++o)s+=i[o].height;this.insertInner(t-this.first,i,s)},remove:function(t,i){this.removeInner(t-this.first,i)},getValue:function(t){var i=ws(this,this.first,this.first+this.size);return t===!1?i:i.join(t||this.lineSeparator())},setValue:Qt(function(t){var i=fe(this.first,0),s=this.first+this.size-1;wi(this,{from:i,to:fe(s,Me(this,s).text.length),text:this.splitLines(t),origin:"setValue",full:!0},!0),this.cm&&xa(this.cm,0,0),lr(this,zn(i),ht)}),replaceRange:function(t,i,s,o){i=je(this,i),s=s?je(this,s):i,wr(this,t,i,s,o)},getRange:function(t,i,s){var o=yi(this,je(this,t),je(this,i));return s===!1?o:s===""?o.join(""):o.join(s||this.lineSeparator())},getLine:function(t){var i=this.getLineHandle(t);return i&&i.text},getLineHandle:function(t){if(ga(this,t))return Me(this,t)},getLineNumber:function(t){return pt(t)},getLineHandleVisualStart:function(t){return typeof t=="number"&&(t=Me(this,t)),zr(t)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(t){return je(this,t)},getCursor:function(t){var i=this.sel.primary(),s;return t==null||t=="head"?s=i.head:t=="anchor"?s=i.anchor:t=="end"||t=="to"||t===!1?s=i.to():s=i.from(),s},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:Qt(function(t,i,s){mf(this,je(this,typeof t=="number"?fe(t,i||0):t),null,s)}),setSelection:Qt(function(t,i,s){mf(this,je(this,t),je(this,i||t),s)}),extendSelection:Qt(function(t,i,s){$o(this,je(this,t),i&&je(this,i),s)}),extendSelections:Qt(function(t,i){yf(this,Os(this,t),i)}),extendSelectionsBy:Qt(function(t,i){var s=Pr(this.sel.ranges,t);yf(this,Os(this,s),i)}),setSelections:Qt(function(t,i,s){if(!!t.length){for(var o=[],u=0;u<t.length;u++)o[u]=new ut(je(this,t[u].anchor),je(this,t[u].head||t[u].anchor));i==null&&(i=Math.min(t.length-1,this.sel.primIndex)),lr(this,jr(this.cm,o,i),s)}}),addSelection:Qt(function(t,i,s){var o=this.sel.ranges.slice(0);o.push(new ut(je(this,t),je(this,i||t))),lr(this,jr(this.cm,o,o.length-1),s)}),getSelection:function(t){for(var i=this.sel.ranges,s,o=0;o<i.length;o++){var u=yi(this,i[o].from(),i[o].to());s=s?s.concat(u):u}return t===!1?s:s.join(t||this.lineSeparator())},getSelections:function(t){for(var i=[],s=this.sel.ranges,o=0;o<s.length;o++){var u=yi(this,s[o].from(),s[o].to());t!==!1&&(u=u.join(t||this.lineSeparator())),i[o]=u}return i},replaceSelection:function(t,i,s){for(var o=[],u=0;u<this.sel.ranges.length;u++)o[u]=t;this.replaceSelections(o,i,s||"+input")},replaceSelections:Qt(function(t,i,s){for(var o=[],u=this.sel,c=0;c<u.ranges.length;c++){var g=u.ranges[c];o[c]={from:g.from(),to:g.to(),text:this.splitLines(t[c]),origin:s}}for(var m=i&&i!="end"&&Xc(this,o,i),_=o.length-1;_>=0;_--)wi(this,o[_]);m?bf(this,m):this.cm&&Ji(this.cm)}),undo:Qt(function(){Fa(this,"undo")}),redo:Qt(function(){Fa(this,"redo")}),undoSelection:Qt(function(){Fa(this,"undo",!0)}),redoSelection:Qt(function(){Fa(this,"redo",!0)}),setExtending:function(t){this.extend=t},getExtending:function(){return this.extend},historySize:function(){for(var t=this.history,i=0,s=0,o=0;o<t.done.length;o++)t.done[o].ranges||++i;for(var u=0;u<t.undone.length;u++)t.undone[u].ranges||++s;return{undo:i,redo:s}},clearHistory:function(){var t=this;this.history=new Ar(this.history),Yn(this,function(i){return i.history=t.history},!0)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(t){return t&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(t){return this.history.generation==(t||this.cleanGeneration)},getHistory:function(){return{done:Xn(this.history.done),undone:Xn(this.history.undone)}},setHistory:function(t){var i=this.history=new Ar(this.history);i.done=Xn(t.done.slice(0),null,!0),i.undone=Xn(t.undone.slice(0),null,!0)},setGutterMarker:Qt(function(t,i,s){return na(this,t,"gutter",function(o){var u=o.gutterMarkers||(o.gutterMarkers={});return u[i]=s,!s&&yn(u)&&(o.gutterMarkers=null),!0})}),clearGutter:Qt(function(t){var i=this;this.iter(function(s){s.gutterMarkers&&s.gutterMarkers[t]&&na(i,s,"gutter",function(){return s.gutterMarkers[t]=null,yn(s.gutterMarkers)&&(s.gutterMarkers=null),!0})})}),lineInfo:function(t){var i;if(typeof t=="number"){if(!ga(this,t)||(i=t,t=Me(this,t),!t))return null}else if(i=pt(t),i==null)return null;return{line:i,handle:t,text:t.text,gutterMarkers:t.gutterMarkers,textClass:t.textClass,bgClass:t.bgClass,wrapClass:t.wrapClass,widgets:t.widgets}},addLineClass:Qt(function(t,i,s){return na(this,t,i=="gutter"?"gutter":"class",function(o){var u=i=="text"?"textClass":i=="background"?"bgClass":i=="gutter"?"gutterClass":"wrapClass";if(!o[u])o[u]=s;else{if(Y(s).test(o[u]))return!1;o[u]+=" "+s}return!0})}),removeLineClass:Qt(function(t,i,s){return na(this,t,i=="gutter"?"gutter":"class",function(o){var u=i=="text"?"textClass":i=="background"?"bgClass":i=="gutter"?"gutterClass":"wrapClass",c=o[u];if(c)if(s==null)o[u]=null;else{var g=c.match(Y(s));if(!g)return!1;var m=g.index+g[0].length;o[u]=c.slice(0,g.index)+(!g.index||m==c.length?"":" ")+c.slice(m)||null}else return!1;return!0})}),addLineWidget:Qt(function(t,i,s){return Pf(this,t,i,s)}),removeLineWidget:function(t){t.clear()},markText:function(t,i,s){return oa(this,je(this,t),je(this,i),s,s&&s.type||"range")},setBookmark:function(t,i){var s={replacedWith:i&&(i.nodeType==null?i.widget:i),insertLeft:i&&i.insertLeft,clearWhenEmpty:!1,shared:i&&i.shared,handleMouseEvents:i&&i.handleMouseEvents};return t=je(this,t),oa(this,t,t,s,"bookmark")},findMarksAt:function(t){t=je(this,t);var i=[],s=Me(this,t.line).markedSpans;if(s)for(var o=0;o<s.length;++o){var u=s[o];(u.from==null||u.from<=t.ch)&&(u.to==null||u.to>=t.ch)&&i.push(u.marker.parent||u.marker)}return i},findMarks:function(t,i,s){t=je(this,t),i=je(this,i);var o=[],u=t.line;return this.iter(t.line,i.line+1,function(c){var g=c.markedSpans;if(g)for(var m=0;m<g.length;m++){var _=g[m];!(_.to!=null&&u==t.line&&t.ch>=_.to||_.from==null&&u!=t.line||_.from!=null&&u==i.line&&_.from>=i.ch)&&(!s||s(_.marker))&&o.push(_.marker.parent||_.marker)}++u}),o},getAllMarks:function(){var t=[];return this.iter(function(i){var s=i.markedSpans;if(s)for(var o=0;o<s.length;++o)s[o].from!=null&&t.push(s[o].marker)}),t},posFromIndex:function(t){var i,s=this.first,o=this.lineSeparator().length;return this.iter(function(u){var c=u.text.length+o;if(c>t)return i=t,!0;t-=c,++s}),je(this,fe(s,i))},indexFromPos:function(t){t=je(this,t);var i=t.ch;if(t.line<this.first||t.ch<0)return 0;var s=this.lineSeparator().length;return this.iter(this.first,t.line,function(o){i+=o.text.length+s}),i},copy:function(t){var i=new ur(ws(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep,this.direction);return i.scrollTop=this.scrollTop,i.scrollLeft=this.scrollLeft,i.sel=this.sel,i.extend=!1,t&&(i.history.undoDepth=this.history.undoDepth,i.setHistory(this.getHistory())),i},linkedDoc:function(t){t||(t={});var i=this.first,s=this.first+this.size;t.from!=null&&t.from>i&&(i=t.from),t.to!=null&&t.to<s&&(s=t.to);var o=new ur(ws(this,i,s),t.mode||this.modeOption,i,this.lineSep,this.direction);return t.sharedHist&&(o.history=this.history),(this.linked||(this.linked=[])).push({doc:o,sharedHist:t.sharedHist}),o.linked=[{doc:this,isParent:!0,sharedHist:t.sharedHist}],If(o,pl(this)),o},unlinkDoc:function(t){if(t instanceof Lt&&(t=t.doc),this.linked)for(var i=0;i<this.linked.length;++i){var s=this.linked[i];if(s.doc==t){this.linked.splice(i,1),t.unlinkDoc(this),ed(pl(this));break}}if(t.history==this.history){var o=[t.id];Yn(t,function(u){return o.push(u.id)},!0),t.history=new Ar(null),t.history.done=Xn(this.history.done,o),t.history.undone=Xn(this.history.undone,o)}},iterLinkedDocs:function(t){Yn(this,t)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(t){return this.lineSep?t.split(this.lineSep):sn(t)},lineSeparator:function(){return this.lineSep||`
`},setDirection:Qt(function(t){t!="rtl"&&(t="ltr"),t!=this.direction&&(this.direction=t,this.iter(function(i){return i.order=null}),this.cm&&fl(this.cm))})}),ur.prototype.eachLine=ur.prototype.iter;var gl=0;function Nf(t){var i=this;if(Mf(i),!(yt(i,t)||Lr(i.display,t))){xt(t),d&&(gl=+new Date);var s=bi(i,t,!0),o=t.dataTransfer.files;if(!(!s||i.isReadOnly()))if(o&&o.length&&window.FileReader&&window.File)for(var u=o.length,c=Array(u),g=0,m=function(){++g==u&&Rt(i,function(){s=je(i.doc,s);var z={from:s,to:s,text:i.doc.splitLines(c.filter(function(ie){return ie!=null}).join(i.doc.lineSeparator())),origin:"paste"};wi(i.doc,z),bf(i.doc,zn(je(i.doc,s),je(i.doc,jn(z))))})()},_=function(z,ie){if(i.options.allowDropFileTypes&&Ue(i.options.allowDropFileTypes,z.type)==-1){m();return}var oe=new FileReader;oe.onerror=function(){return m()},oe.onload=function(){var ve=oe.result;if(/[\x00-\x08\x0e-\x1f]{2}/.test(ve)){m();return}c[ie]=ve,m()},oe.readAsText(z)},C=0;C<o.length;C++)_(o[C],C);else{if(i.state.draggingText&&i.doc.sel.contains(s)>-1){i.state.draggingText(t),setTimeout(function(){return i.display.input.focus()},20);return}try{var L=t.dataTransfer.getData("Text");if(L){var M;if(i.state.draggingText&&!i.state.draggingText.copy&&(M=i.listSelections()),Go(i.doc,zn(s,s)),M)for(var X=0;X<M.length;++X)wr(i.doc,"",M[X].anchor,M[X].head,"drag");i.replaceSelection(L,"around","paste"),i.display.input.focus()}}catch{}}}}function td(t,i){if(d&&(!t.state.draggingText||+new Date-gl<100)){Er(i);return}if(!(yt(t,i)||Lr(t.display,i))&&(i.dataTransfer.setData("Text",t.getSelection()),i.dataTransfer.effectAllowed="copyMove",i.dataTransfer.setDragImage&&!k)){var s=q("img",null,null,"position: fixed; left: 0; top: 0;");s.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",O&&(s.width=s.height=1,t.display.wrapper.appendChild(s),s._top=s.offsetTop),i.dataTransfer.setDragImage(s,0,0),O&&s.parentNode.removeChild(s)}}function ar(t,i){var s=bi(t,i);if(!!s){var o=document.createDocumentFragment();qs(t,s,o),t.display.dragCursor||(t.display.dragCursor=q("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),t.display.lineSpace.insertBefore(t.display.dragCursor,t.display.cursorDiv)),Q(t.display.dragCursor,o)}}function Mf(t){t.display.dragCursor&&(t.display.lineSpace.removeChild(t.display.dragCursor),t.display.dragCursor=null)}function y(t){if(!!document.getElementsByClassName){for(var i=document.getElementsByClassName("CodeMirror"),s=[],o=0;o<i.length;o++){var u=i[o].CodeMirror;u&&s.push(u)}s.length&&s[0].operation(function(){for(var c=0;c<s.length;c++)t(s[c])})}}var b=!1;function w(){b||(N(),b=!0)}function N(){var t;be(window,"resize",function(){t==null&&(t=setTimeout(function(){t=null,y(W)},100))}),be(window,"blur",function(){return y(Qi)})}function W(t){var i=t.display;i.cachedCharWidth=i.cachedTextHeight=i.cachedPaddingH=null,i.scrollbarsClipped=!1,t.setSize()}for(var H={3:"Pause",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",145:"ScrollLock",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",224:"Mod",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"},$=0;$<10;$++)H[$+48]=H[$+96]=String($);for(var V=65;V<=90;V++)H[V]=String.fromCharCode(V);for(var Z=1;Z<=12;Z++)H[Z+111]=H[Z+63235]="F"+Z;var ae={};ae.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},ae.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},ae.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"},ae.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},ae.default=U?ae.macDefault:ae.pcDefault;function ce(t){var i=t.split(/-(?!$)/);t=i[i.length-1];for(var s,o,u,c,g=0;g<i.length-1;g++){var m=i[g];if(/^(cmd|meta|m)$/i.test(m))c=!0;else if(/^a(lt)?$/i.test(m))s=!0;else if(/^(c|ctrl|control)$/i.test(m))o=!0;else if(/^s(hift)?$/i.test(m))u=!0;else throw new Error("Unrecognized modifier name: "+m)}return s&&(t="Alt-"+t),o&&(t="Ctrl-"+t),c&&(t="Cmd-"+t),u&&(t="Shift-"+t),t}function Re(t){var i={};for(var s in t)if(t.hasOwnProperty(s)){var o=t[s];if(/^(name|fallthrough|(de|at)tach)$/.test(s))continue;if(o=="..."){delete t[s];continue}for(var u=Pr(s.split(" "),ce),c=0;c<u.length;c++){var g=void 0,m=void 0;c==u.length-1?(m=u.join(" "),g=o):(m=u.slice(0,c+1).join(" "),g="...");var _=i[m];if(!_)i[m]=g;else if(_!=g)throw new Error("Inconsistent bindings for "+m)}delete t[s]}for(var C in i)t[C]=i[C];return t}function de(t,i,s,o){i=Qe(i);var u=i.call?i.call(t,o):i[t];if(u===!1)return"nothing";if(u==="...")return"multi";if(u!=null&&s(u))return"handled";if(i.fallthrough){if(Object.prototype.toString.call(i.fallthrough)!="[object Array]")return de(t,i.fallthrough,s,o);for(var c=0;c<i.fallthrough.length;c++){var g=de(t,i.fallthrough[c],s,o);if(g)return g}}}function Ie(t){var i=typeof t=="string"?t:H[t.keyCode];return i=="Ctrl"||i=="Alt"||i=="Shift"||i=="Mod"}function Le(t,i,s){var o=t;return i.altKey&&o!="Alt"&&(t="Alt-"+t),(D?i.metaKey:i.ctrlKey)&&o!="Ctrl"&&(t="Ctrl-"+t),(D?i.ctrlKey:i.metaKey)&&o!="Mod"&&(t="Cmd-"+t),!s&&i.shiftKey&&o!="Shift"&&(t="Shift-"+t),t}function Ze(t,i){if(O&&t.keyCode==34&&t.char)return!1;var s=H[t.keyCode];return s==null||t.altGraphKey?!1:(t.keyCode==3&&t.code&&(s=t.code),Le(s,t,i))}function Qe(t){return typeof t=="string"?ae[t]:t}function et(t,i){for(var s=t.doc.sel.ranges,o=[],u=0;u<s.length;u++){for(var c=i(s[u]);o.length&&ze(c.from,Ve(o).to)<=0;){var g=o.pop();if(ze(g.from,c.from)<0){c.from=g.from;break}}o.push(c)}vr(t,function(){for(var m=o.length-1;m>=0;m--)wr(t.doc,"",o[m].from,o[m].to,"+delete");Ji(t)})}function ft(t,i,s){var o=on(t.text,i+s,s);return o<0||o>t.text.length?null:o}function Jt(t,i,s){var o=ft(t,i.ch,s);return o==null?null:new fe(i.line,o,s<0?"after":"before")}function Kt(t,i,s,o,u){if(t){i.doc.direction=="rtl"&&(u=-u);var c=Te(s,i.doc.direction);if(c){var g=u<0?Ve(c):c[0],m=u<0==(g.level==1),_=m?"after":"before",C;if(g.level>0||i.doc.direction=="rtl"){var L=Vi(i,s);C=u<0?s.text.length-1:0;var M=hn(i,L,C).top;C=Xt(function(X){return hn(i,L,X).top==M},u<0==(g.level==1)?g.from:g.to-1,C),_=="before"&&(C=ft(s,C,1))}else C=u<0?g.to:g.from;return new fe(o,C,_)}}return new fe(o,u<0?s.text.length:0,u<0?"before":"after")}function kr(t,i,s,o){var u=Te(i,t.doc.direction);if(!u)return Jt(i,s,o);s.ch>=i.text.length?(s.ch=i.text.length,s.sticky="before"):s.ch<=0&&(s.ch=0,s.sticky="after");var c=ge(u,s.ch,s.sticky),g=u[c];if(t.doc.direction=="ltr"&&g.level%2==0&&(o>0?g.to>s.ch:g.from<s.ch))return Jt(i,s,o);var m=function(ke,xe){return ft(i,ke instanceof fe?ke.ch:ke,xe)},_,C=function(ke){return t.options.lineWrapping?(_=_||Vi(t,i),Ro(t,i,_,ke)):{begin:0,end:i.text.length}},L=C(s.sticky=="before"?m(s,-1):s.ch);if(t.doc.direction=="rtl"||g.level==1){var M=g.level==1==o<0,X=m(s,M?1:-1);if(X!=null&&(M?X<=g.to&&X<=L.end:X>=g.from&&X>=L.begin)){var z=M?"before":"after";return new fe(s.line,X,z)}}var ie=function(ke,xe,Oe){for(var Pe=function(At,hr){return hr?new fe(s.line,m(At,1),"before"):new fe(s.line,At,"after")};ke>=0&&ke<u.length;ke+=xe){var We=u[ke],Ge=xe>0==(We.level!=1),Je=Ge?Oe.begin:m(Oe.end,-1);if(We.from<=Je&&Je<We.to||(Je=Ge?We.from:m(We.to,-1),Oe.begin<=Je&&Je<Oe.end))return Pe(Je,Ge)}},oe=ie(c+o,o,L);if(oe)return oe;var ve=o>0?L.end:m(L.begin,-1);return ve!=null&&!(o>0&&ve==i.text.length)&&(oe=ie(o>0?0:u.length-1,o,C(ve)),oe)?oe:null}var tt={selectAll:Af,singleSelection:function(t){return t.setSelection(t.getCursor("anchor"),t.getCursor("head"),ht)},killLine:function(t){return et(t,function(i){if(i.empty()){var s=Me(t.doc,i.head.line).text.length;return i.head.ch==s&&i.head.line<t.lastLine()?{from:i.head,to:fe(i.head.line+1,0)}:{from:i.head,to:fe(i.head.line,s)}}else return{from:i.from(),to:i.to()}})},deleteLine:function(t){return et(t,function(i){return{from:fe(i.from().line,0),to:je(t.doc,fe(i.to().line+1,0))}})},delLineLeft:function(t){return et(t,function(i){return{from:fe(i.from().line,0),to:i.from()}})},delWrappedLineLeft:function(t){return et(t,function(i){var s=t.charCoords(i.head,"div").top+5,o=t.coordsChar({left:0,top:s},"div");return{from:o,to:i.from()}})},delWrappedLineRight:function(t){return et(t,function(i){var s=t.charCoords(i.head,"div").top+5,o=t.coordsChar({left:t.display.lineDiv.offsetWidth+100,top:s},"div");return{from:i.from(),to:o}})},undo:function(t){return t.undo()},redo:function(t){return t.redo()},undoSelection:function(t){return t.undoSelection()},redoSelection:function(t){return t.redoSelection()},goDocStart:function(t){return t.extendSelection(fe(t.firstLine(),0))},goDocEnd:function(t){return t.extendSelection(fe(t.lastLine()))},goLineStart:function(t){return t.extendSelectionsBy(function(i){return ye(t,i.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(t){return t.extendSelectionsBy(function(i){return rt(t,i.head)},{origin:"+move",bias:1})},goLineEnd:function(t){return t.extendSelectionsBy(function(i){return He(t,i.head.line)},{origin:"+move",bias:-1})},goLineRight:function(t){return t.extendSelectionsBy(function(i){var s=t.cursorCoords(i.head,"div").top+5;return t.coordsChar({left:t.display.lineDiv.offsetWidth+100,top:s},"div")},Ft)},goLineLeft:function(t){return t.extendSelectionsBy(function(i){var s=t.cursorCoords(i.head,"div").top+5;return t.coordsChar({left:0,top:s},"div")},Ft)},goLineLeftSmart:function(t){return t.extendSelectionsBy(function(i){var s=t.cursorCoords(i.head,"div").top+5,o=t.coordsChar({left:0,top:s},"div");return o.ch<t.getLine(o.line).search(/\S/)?rt(t,i.head):o},Ft)},goLineUp:function(t){return t.moveV(-1,"line")},goLineDown:function(t){return t.moveV(1,"line")},goPageUp:function(t){return t.moveV(-1,"page")},goPageDown:function(t){return t.moveV(1,"page")},goCharLeft:function(t){return t.moveH(-1,"char")},goCharRight:function(t){return t.moveH(1,"char")},goColumnLeft:function(t){return t.moveH(-1,"column")},goColumnRight:function(t){return t.moveH(1,"column")},goWordLeft:function(t){return t.moveH(-1,"word")},goGroupRight:function(t){return t.moveH(1,"group")},goGroupLeft:function(t){return t.moveH(-1,"group")},goWordRight:function(t){return t.moveH(1,"word")},delCharBefore:function(t){return t.deleteH(-1,"codepoint")},delCharAfter:function(t){return t.deleteH(1,"char")},delWordBefore:function(t){return t.deleteH(-1,"word")},delWordAfter:function(t){return t.deleteH(1,"word")},delGroupBefore:function(t){return t.deleteH(-1,"group")},delGroupAfter:function(t){return t.deleteH(1,"group")},indentAuto:function(t){return t.indentSelection("smart")},indentMore:function(t){return t.indentSelection("add")},indentLess:function(t){return t.indentSelection("subtract")},insertTab:function(t){return t.replaceSelection("	")},insertSoftTab:function(t){for(var i=[],s=t.listSelections(),o=t.options.tabSize,u=0;u<s.length;u++){var c=s[u].from(),g=Ne(t.getLine(c.line),c.ch,o);i.push(Gt(o-g%o))}t.replaceSelections(i)},defaultTab:function(t){t.somethingSelected()?t.indentSelection("add"):t.execCommand("insertTab")},transposeChars:function(t){return vr(t,function(){for(var i=t.listSelections(),s=[],o=0;o<i.length;o++)if(!!i[o].empty()){var u=i[o].head,c=Me(t.doc,u.line).text;if(c){if(u.ch==c.length&&(u=new fe(u.line,u.ch-1)),u.ch>0)u=new fe(u.line,u.ch+1),t.replaceRange(c.charAt(u.ch-1)+c.charAt(u.ch-2),fe(u.line,u.ch-2),u,"+transpose");else if(u.line>t.doc.first){var g=Me(t.doc,u.line-1).text;g&&(u=new fe(u.line,1),t.replaceRange(c.charAt(0)+t.doc.lineSeparator()+g.charAt(g.length-1),fe(u.line-1,g.length-1),u,"+transpose"))}}s.push(new ut(u,u))}t.setSelections(s)})},newlineAndIndent:function(t){return vr(t,function(){for(var i=t.listSelections(),s=i.length-1;s>=0;s--)t.replaceRange(t.doc.lineSeparator(),i[s].anchor,i[s].head,"+input");i=t.listSelections();for(var o=0;o<i.length;o++)t.indentLine(i[o].from().line,null,!0);Ji(t)})},openLine:function(t){return t.replaceSelection(`
`,"start")},toggleOverwrite:function(t){return t.toggleOverwrite()}};function ye(t,i){var s=Me(t.doc,i),o=zr(s);return o!=s&&(i=pt(o)),Kt(!0,t,o,i,1)}function He(t,i){var s=Me(t.doc,i),o=vc(s);return o!=s&&(i=pt(o)),Kt(!0,t,s,i,-1)}function rt(t,i){var s=ye(t,i.line),o=Me(t.doc,s.line),u=Te(o,t.doc.direction);if(!u||u[0].level==0){var c=Math.max(s.ch,o.text.search(/\S/)),g=i.line==s.line&&i.ch<=c&&i.ch;return fe(s.line,g?0:c,s.sticky)}return s}function qe(t,i,s){if(typeof i=="string"&&(i=tt[i],!i))return!1;t.display.input.ensurePolled();var o=t.display.shift,u=!1;try{t.isReadOnly()&&(t.state.suppressEdits=!0),s&&(t.display.shift=!1),u=i(t)!=lt}finally{t.display.shift=o,t.state.suppressEdits=!1}return u}function fr(t,i,s){for(var o=0;o<t.state.keyMaps.length;o++){var u=de(i,t.state.keyMaps[o],s,t);if(u)return u}return t.options.extraKeys&&de(i,t.options.extraKeys,s,t)||de(i,t.options.keyMap,s,t)}var Et=new Ye;function nt(t,i,s,o){var u=t.state.keySeq;if(u){if(Ie(i))return"handled";if(/\'$/.test(i)?t.state.keySeq=null:Et.set(50,function(){t.state.keySeq==u&&(t.state.keySeq=null,t.display.input.reset())}),dt(t,u+" "+i,s,o))return!0}return dt(t,i,s,o)}function dt(t,i,s,o){var u=fr(t,i,o);return u=="multi"&&(t.state.keySeq=i),u=="handled"&&Vt(t,"keyHandled",t,i,s),(u=="handled"||u=="multi")&&(xt(s),Vs(t)),!!u}function vt(t,i){var s=Ze(i,!0);return s?i.shiftKey&&!t.state.keySeq?nt(t,"Shift-"+s,i,function(o){return qe(t,o,!0)})||nt(t,s,i,function(o){if(typeof o=="string"?/^go[A-Z]/.test(o):o.motion)return qe(t,o)}):nt(t,s,i,function(o){return qe(t,o)}):!1}function mt(t,i,s){return nt(t,"'"+s+"'",i,function(o){return qe(t,o,!0)})}var Mr=null;function Ln(t){var i=this;if(!(t.target&&t.target!=i.display.input.getField())&&(i.curOp.focus=te(),!yt(i,t))){d&&p<11&&t.keyCode==27&&(t.returnValue=!1);var s=t.keyCode;i.display.shift=s==16||t.shiftKey;var o=vt(i,t);O&&(Mr=o?s:null,!o&&s==88&&!pa&&(U?t.metaKey:t.ctrlKey)&&i.replaceSelection("",null,"cut")),l&&!U&&!o&&s==46&&t.shiftKey&&!t.ctrlKey&&document.execCommand&&document.execCommand("cut"),s==18&&!/\bCodeMirror-crosshair\b/.test(i.display.lineDiv.className)&&Vn(i)}}function Vn(t){var i=t.display.lineDiv;pe(i,"CodeMirror-crosshair");function s(o){(o.keyCode==18||!o.altKey)&&(re(i,"CodeMirror-crosshair"),it(document,"keyup",s),it(document,"mouseover",s))}be(document,"keyup",s),be(document,"mouseover",s)}function ki(t){t.keyCode==16&&(this.doc.sel.shift=!1),yt(this,t)}function Oi(t){var i=this;if(!(t.target&&t.target!=i.display.input.getField())&&!(Lr(i.display,t)||yt(i,t)||t.ctrlKey&&!t.altKey||U&&t.metaKey)){var s=t.keyCode,o=t.charCode;if(O&&s==Mr){Mr=null,xt(t);return}if(!(O&&(!t.which||t.which<10)&&vt(i,t))){var u=String.fromCharCode(o==null?s:o);u!="\b"&&(mt(i,t,u)||i.display.input.onKeyPress(t))}}}var In=400,Nn=function(t,i,s){this.time=t,this.pos=i,this.button=s};Nn.prototype.compare=function(t,i,s){return this.time+In>t&&ze(i,this.pos)==0&&s==this.button};var Mn,Zr;function yl(t,i){var s=+new Date;return Zr&&Zr.compare(s,t,i)?(Mn=Zr=null,"triple"):Mn&&Mn.compare(s,t,i)?(Zr=new Nn(s,t,i),Mn=null,"double"):(Mn=new Nn(s,t,i),Zr=null,"single")}function Bo(t){var i=this,s=i.display;if(!(yt(i,t)||s.activeTouch&&s.input.supportsTouch())){if(s.input.ensurePolled(),s.shift=t.shiftKey,Lr(s,t)){S||(s.scroller.draggable=!1,setTimeout(function(){return s.scroller.draggable=!0},100));return}if(!rd(i,t)){var o=bi(i,t),u=$e(t),c=o?yl(o,u):"single";window.focus(),u==1&&i.state.selectingText&&i.state.selectingText(t),!(o&&Pm(i,u,o,c,t))&&(u==1?o?Im(i,o,c,t):at(t)==s.scroller&&xt(t):u==2?(o&&$o(i.doc,o),setTimeout(function(){return s.input.focus()},20)):u==3&&(R?i.display.input.onContextMenu(t):Zs(i)))}}}function Pm(t,i,s,o,u){var c="Click";return o=="double"?c="Double"+c:o=="triple"&&(c="Triple"+c),c=(i==1?"Left":i==2?"Middle":"Right")+c,nt(t,Le(c,u),u,function(g){if(typeof g=="string"&&(g=tt[g]),!g)return!1;var m=!1;try{t.isReadOnly()&&(t.state.suppressEdits=!0),m=g(t,s)!=lt}finally{t.state.suppressEdits=!1}return m})}function Lm(t,i,s){var o=t.getOption("configureMouse"),u=o?o(t,i,s):{};if(u.unit==null){var c=J?s.shiftKey&&s.metaKey:s.altKey;u.unit=c?"rectangle":i=="single"?"char":i=="double"?"word":"line"}return(u.extend==null||t.doc.extend)&&(u.extend=t.doc.extend||s.shiftKey),u.addNew==null&&(u.addNew=U?s.metaKey:s.ctrlKey),u.moveOnDrag==null&&(u.moveOnDrag=!(U?s.altKey:s.ctrlKey)),u}function Im(t,i,s,o){d?setTimeout(Be(Zu,t),0):t.curOp.focus=te();var u=Lm(t,s,o),c=t.doc.sel,g;t.options.dragDrop&&Wt&&!t.isReadOnly()&&s=="single"&&(g=c.contains(i))>-1&&(ze((g=c.ranges[g]).from(),i)<0||i.xRel>0)&&(ze(g.to(),i)>0||i.xRel<0)?Nm(t,o,i,u):Mm(t,o,i,u)}function Nm(t,i,s,o){var u=t.display,c=!1,g=Rt(t,function(C){S&&(u.scroller.draggable=!1),t.state.draggingText=!1,t.state.delayingBlurEvent&&(t.hasFocus()?t.state.delayingBlurEvent=!1:Zs(t)),it(u.wrapper.ownerDocument,"mouseup",g),it(u.wrapper.ownerDocument,"mousemove",m),it(u.scroller,"dragstart",_),it(u.scroller,"drop",g),c||(xt(C),o.addNew||$o(t.doc,s,null,null,o.extend),S&&!k||d&&p==9?setTimeout(function(){u.wrapper.ownerDocument.body.focus({preventScroll:!0}),u.input.focus()},20):u.input.focus())}),m=function(C){c=c||Math.abs(i.clientX-C.clientX)+Math.abs(i.clientY-C.clientY)>=10},_=function(){return c=!0};S&&(u.scroller.draggable=!0),t.state.draggingText=g,g.copy=!o.moveOnDrag,be(u.wrapper.ownerDocument,"mouseup",g),be(u.wrapper.ownerDocument,"mousemove",m),be(u.scroller,"dragstart",_),be(u.scroller,"drop",g),t.state.delayingBlurEvent=!0,setTimeout(function(){return u.input.focus()},20),u.scroller.dragDrop&&u.scroller.dragDrop()}function Hv(t,i,s){if(s=="char")return new ut(i,i);if(s=="word")return t.findWordAt(i);if(s=="line")return new ut(fe(i.line,0),je(t.doc,fe(i.line+1,0)));var o=s(t,i);return new ut(o.from,o.to)}function Mm(t,i,s,o){d&&Zs(t);var u=t.display,c=t.doc;xt(i);var g,m,_=c.sel,C=_.ranges;if(o.addNew&&!o.extend?(m=c.sel.contains(s),m>-1?g=C[m]:g=new ut(s,s)):(g=c.sel.primary(),m=c.sel.primIndex),o.unit=="rectangle")o.addNew||(g=new ut(s,s)),s=bi(t,i,!0,!0),m=-1;else{var L=Hv(t,s,o.unit);o.extend?g=hl(g,L.anchor,L.head,o.extend):g=L}o.addNew?m==-1?(m=C.length,lr(c,jr(t,C.concat([g]),m),{scroll:!1,origin:"*mouse"})):C.length>1&&C[m].empty()&&o.unit=="char"&&!o.extend?(lr(c,jr(t,C.slice(0,m).concat(C.slice(m+1)),0),{scroll:!1,origin:"*mouse"}),_=c.sel):cl(c,m,g,Tt):(m=0,lr(c,new br([g],0),Tt),_=c.sel);var M=s;function X(Oe){if(ze(M,Oe)!=0)if(M=Oe,o.unit=="rectangle"){for(var Pe=[],We=t.options.tabSize,Ge=Ne(Me(c,s.line).text,s.ch,We),Je=Ne(Me(c,Oe.line).text,Oe.ch,We),At=Math.min(Ge,Je),hr=Math.max(Ge,Je),Mt=Math.min(s.line,Oe.line),Yr=Math.min(t.lastLine(),Math.max(s.line,Oe.line));Mt<=Yr;Mt++){var Dr=Me(c,Mt).text,er=mr(Dr,At,We);At==hr?Pe.push(new ut(fe(Mt,er),fe(Mt,er))):Dr.length>er&&Pe.push(new ut(fe(Mt,er),fe(Mt,mr(Dr,hr,We))))}Pe.length||Pe.push(new ut(s,s)),lr(c,jr(t,_.ranges.slice(0,m).concat(Pe),m),{origin:"*mouse",scroll:!1}),t.scrollIntoView(Oe)}else{var Fr=g,gr=Hv(t,Oe,o.unit),or=Fr.anchor,tr;ze(gr.anchor,or)>0?(tr=gr.head,or=co(Fr.from(),gr.anchor)):(tr=gr.anchor,or=ho(Fr.to(),gr.head));var Ht=_.ranges.slice(0);Ht[m]=Dm(t,new ut(je(c,or),tr)),lr(c,jr(t,Ht,m),Tt)}}var z=u.wrapper.getBoundingClientRect(),ie=0;function oe(Oe){var Pe=++ie,We=bi(t,Oe,!0,o.unit=="rectangle");if(!!We)if(ze(We,M)!=0){t.curOp.focus=te(),X(We);var Ge=Oa(u,c);(We.line>=Ge.to||We.line<Ge.from)&&setTimeout(Rt(t,function(){ie==Pe&&oe(Oe)}),150)}else{var Je=Oe.clientY<z.top?-20:Oe.clientY>z.bottom?20:0;Je&&setTimeout(Rt(t,function(){ie==Pe&&(u.scroller.scrollTop+=Je,oe(Oe))}),50)}}function ve(Oe){t.state.selectingText=!1,ie=1/0,Oe&&(xt(Oe),u.input.focus()),it(u.wrapper.ownerDocument,"mousemove",ke),it(u.wrapper.ownerDocument,"mouseup",xe),c.history.lastSelOrigin=null}var ke=Rt(t,function(Oe){Oe.buttons===0||!$e(Oe)?ve(Oe):oe(Oe)}),xe=Rt(t,ve);t.state.selectingText=xe,be(u.wrapper.ownerDocument,"mousemove",ke),be(u.wrapper.ownerDocument,"mouseup",xe)}function Dm(t,i){var s=i.anchor,o=i.head,u=Me(t.doc,s.line);if(ze(s,o)==0&&s.sticky==o.sticky)return i;var c=Te(u);if(!c)return i;var g=ge(c,s.ch,s.sticky),m=c[g];if(m.from!=s.ch&&m.to!=s.ch)return i;var _=g+(m.from==s.ch==(m.level!=1)?0:1);if(_==0||_==c.length)return i;var C;if(o.line!=s.line)C=(o.line-s.line)*(t.doc.direction=="ltr"?1:-1)>0;else{var L=ge(c,o.ch,o.sticky),M=L-g||(o.ch-s.ch)*(m.level==1?-1:1);L==_-1||L==_?C=M<0:C=M>0}var X=c[_+(C?-1:0)],z=C==(X.level==1),ie=z?X.from:X.to,oe=z?"after":"before";return s.ch==ie&&s.sticky==oe?i:new ut(new fe(s.line,ie,oe),o)}function zv(t,i,s,o){var u,c;if(i.touches)u=i.touches[0].clientX,c=i.touches[0].clientY;else try{u=i.clientX,c=i.clientY}catch{return!1}if(u>=Math.floor(t.display.gutters.getBoundingClientRect().right))return!1;o&&xt(i);var g=t.display,m=g.lineDiv.getBoundingClientRect();if(c>m.bottom||!ir(t,s))return Nt(i);c-=m.top-g.viewOffset;for(var _=0;_<t.display.gutterSpecs.length;++_){var C=g.gutters.childNodes[_];if(C&&C.getBoundingClientRect().right>=u){var L=mi(t.doc,c),M=t.display.gutterSpecs[_];return ot(t,s,t,L,M.className,i),Nt(i)}}}function rd(t,i){return zv(t,i,"gutterClick",!0)}function jv(t,i){Lr(t.display,i)||Fm(t,i)||yt(t,i,"contextmenu")||R||t.display.input.onContextMenu(i)}function Fm(t,i){return ir(t,"gutterContextMenu")?zv(t,i,"gutterContextMenu",!1):!1}function Yv(t){t.display.wrapper.className=t.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+t.options.theme.replace(/(^|\s)\s*/g," cm-s-"),Ca(t)}var Uo={toString:function(){return"CodeMirror.Init"}},Xv={},Df={};function $m(t){var i=t.optionHandlers;function s(o,u,c,g){t.defaults[o]=u,c&&(i[o]=g?function(m,_,C){C!=Uo&&c(m,_,C)}:c)}t.defineOption=s,t.Init=Uo,s("value","",function(o,u){return o.setValue(u)},!0),s("mode",null,function(o,u){o.doc.modeOption=u,Na(o)},!0),s("indentUnit",2,Na,!0),s("indentWithTabs",!1),s("smartIndent",!0),s("tabSize",4,function(o){Ma(o),Ca(o),_r(o)},!0),s("lineSeparator",null,function(o,u){if(o.doc.lineSep=u,!!u){var c=[],g=o.doc.first;o.doc.iter(function(_){for(var C=0;;){var L=_.text.indexOf(u,C);if(L==-1)break;C=L+u.length,c.push(fe(g,L))}g++});for(var m=c.length-1;m>=0;m--)wr(o.doc,u,c[m],fe(c[m].line,c[m].ch+u.length))}}),s("specialChars",/[\u0000-\u001f\u007f-\u009f\u00ad\u061c\u200b\u200e\u200f\u2028\u2029\ufeff\ufff9-\ufffc]/g,function(o,u,c){o.state.specialChars=new RegExp(u.source+(u.test("	")?"":"|	"),"g"),c!=Uo&&o.refresh()}),s("specialCharPlaceholder",_c,function(o){return o.refresh()},!0),s("electricChars",!0),s("inputStyle",B?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},!0),s("spellcheck",!1,function(o,u){return o.getInputField().spellcheck=u},!0),s("autocorrect",!1,function(o,u){return o.getInputField().autocorrect=u},!0),s("autocapitalize",!1,function(o,u){return o.getInputField().autocapitalize=u},!0),s("rtlMoveVisually",!P),s("wholeLineUpdateBefore",!0),s("theme","default",function(o){Yv(o),Ia(o)},!0),s("keyMap","default",function(o,u,c){var g=Qe(u),m=c!=Uo&&Qe(c);m&&m.detach&&m.detach(o,g),g.attach&&g.attach(o,m||null)}),s("extraKeys",null),s("configureMouse",null),s("lineWrapping",!1,Wm,!0),s("gutters",[],function(o,u){o.display.gutterSpecs=sl(u,o.options.lineNumbers),Ia(o)},!0),s("fixedGutter",!0,function(o,u){o.display.gutters.style.left=u?Xs(o.display)+"px":"0",o.refresh()},!0),s("coverGutterNextToScrollbar",!1,function(o){return Ei(o)},!0),s("scrollbarStyle","native",function(o){rl(o),Ei(o),o.display.scrollbars.setScrollTop(o.doc.scrollTop),o.display.scrollbars.setScrollLeft(o.doc.scrollLeft)},!0),s("lineNumbers",!1,function(o,u){o.display.gutterSpecs=sl(o.options.gutters,u),Ia(o)},!0),s("firstLineNumber",1,Ia,!0),s("lineNumberFormatter",function(o){return o},Ia,!0),s("showCursorWhenSelecting",!1,ka,!0),s("resetSelectionOnContextMenu",!0),s("lineWiseCopyCut",!0),s("pasteLinesPerSelection",!0),s("selectionsMayTouch",!1),s("readOnly",!1,function(o,u){u=="nocursor"&&(Qi(o),o.display.input.blur()),o.display.input.readOnlyChanged(u)}),s("screenReaderLabel",null,function(o,u){u=u===""?null:u,o.display.input.screenReaderLabelChanged(u)}),s("disableInput",!1,function(o,u){u||o.display.input.reset()},!0),s("dragDrop",!0,Gm),s("allowDropFileTypes",null),s("cursorBlinkRate",530),s("cursorScrollMargin",0),s("cursorHeight",1,ka,!0),s("singleCursorHeightPerLine",!0,ka,!0),s("workTime",100),s("workDelay",100),s("flattenSpans",!0,Ma,!0),s("addModeClass",!1,Ma,!0),s("pollInterval",100),s("undoDepth",200,function(o,u){return o.doc.history.undoDepth=u}),s("historyEventDelay",1250),s("viewportMargin",10,function(o){return o.refresh()},!0),s("maxHighlightLength",1e4,Ma,!0),s("moveInputWithCursor",!0,function(o,u){u||o.display.input.resetPosition()}),s("tabindex",null,function(o,u){return o.display.input.getField().tabIndex=u||""}),s("autofocus",null),s("direction","ltr",function(o,u){return o.doc.setDirection(u)},!0),s("phrases",null)}function Gm(t,i,s){var o=s&&s!=Uo;if(!i!=!o){var u=t.display.dragFunctions,c=i?be:it;c(t.display.scroller,"dragstart",u.start),c(t.display.scroller,"dragenter",u.enter),c(t.display.scroller,"dragover",u.over),c(t.display.scroller,"dragleave",u.leave),c(t.display.scroller,"drop",u.drop)}}function Wm(t){t.options.lineWrapping?(pe(t.display.wrapper,"CodeMirror-wrap"),t.display.sizer.style.minWidth="",t.display.sizerWidth=null):(re(t.display.wrapper,"CodeMirror-wrap"),Ds(t)),wa(t),_r(t),Ca(t),setTimeout(function(){return Ei(t)},100)}function Lt(t,i){var s=this;if(!(this instanceof Lt))return new Lt(t,i);this.options=i=i?Ke(i):{},Ke(Xv,i,!1);var o=i.value;typeof o=="string"?o=new ur(o,i.mode,null,i.lineSeparator,i.direction):i.mode&&(o.modeOption=i.mode),this.doc=o;var u=new Lt.inputStyles[i.inputStyle](this),c=this.display=new Yc(t,o,u,i);c.wrapper.CodeMirror=this,Yv(this),i.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),rl(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:-1,cutIncoming:-1,selectingText:!1,draggingText:!1,highlight:new Ye,keySeq:null,specialChars:null},i.autofocus&&!B&&c.input.focus(),d&&p<11&&setTimeout(function(){return s.display.input.reset(!0)},20),Bm(this),w(),Hn(this),this.curOp.forceUpdate=!0,cf(this,o),i.autofocus&&!B||this.hasFocus()?setTimeout(function(){s.hasFocus()&&!s.state.focused&&Qs(s)},20):Qi(this);for(var g in Df)Df.hasOwnProperty(g)&&Df[g](this,i[g],Uo);lf(this),i.finishInit&&i.finishInit(this);for(var m=0;m<nd.length;++m)nd[m](this);On(this),S&&i.lineWrapping&&getComputedStyle(c.lineDiv).textRendering=="optimizelegibility"&&(c.lineDiv.style.textRendering="auto")}Lt.defaults=Xv,Lt.optionHandlers=Df;function Bm(t){var i=t.display;be(i.scroller,"mousedown",Rt(t,Bo)),d&&p<11?be(i.scroller,"dblclick",Rt(t,function(_){if(!yt(t,_)){var C=bi(t,_);if(!(!C||rd(t,_)||Lr(t.display,_))){xt(_);var L=t.findWordAt(C);$o(t.doc,L.anchor,L.head)}}})):be(i.scroller,"dblclick",function(_){return yt(t,_)||xt(_)}),be(i.scroller,"contextmenu",function(_){return jv(t,_)}),be(i.input.getField(),"contextmenu",function(_){i.scroller.contains(_.target)||jv(t,_)});var s,o={end:0};function u(){i.activeTouch&&(s=setTimeout(function(){return i.activeTouch=null},1e3),o=i.activeTouch,o.end=+new Date)}function c(_){if(_.touches.length!=1)return!1;var C=_.touches[0];return C.radiusX<=1&&C.radiusY<=1}function g(_,C){if(C.left==null)return!0;var L=C.left-_.left,M=C.top-_.top;return L*L+M*M>20*20}be(i.scroller,"touchstart",function(_){if(!yt(t,_)&&!c(_)&&!rd(t,_)){i.input.ensurePolled(),clearTimeout(s);var C=+new Date;i.activeTouch={start:C,moved:!1,prev:C-o.end<=300?o:null},_.touches.length==1&&(i.activeTouch.left=_.touches[0].pageX,i.activeTouch.top=_.touches[0].pageY)}}),be(i.scroller,"touchmove",function(){i.activeTouch&&(i.activeTouch.moved=!0)}),be(i.scroller,"touchend",function(_){var C=i.activeTouch;if(C&&!Lr(i,_)&&C.left!=null&&!C.moved&&new Date-C.start<300){var L=t.coordsChar(i.activeTouch,"page"),M;!C.prev||g(C,C.prev)?M=new ut(L,L):!C.prev.prev||g(C,C.prev.prev)?M=t.findWordAt(L):M=new ut(fe(L.line,0),je(t.doc,fe(L.line+1,0))),t.setSelection(M.anchor,M.head),t.focus(),xt(_)}u()}),be(i.scroller,"touchcancel",u),be(i.scroller,"scroll",function(){i.scroller.clientHeight&&(Ra(t,i.scroller.scrollTop),Ti(t,i.scroller.scrollLeft,!0),ot(t,"scroll",t))}),be(i.scroller,"mousewheel",function(_){return Do(t,_)}),be(i.scroller,"DOMMouseScroll",function(_){return Do(t,_)}),be(i.wrapper,"scroll",function(){return i.wrapper.scrollTop=i.wrapper.scrollLeft=0}),i.dragFunctions={enter:function(_){yt(t,_)||Er(_)},over:function(_){yt(t,_)||(ar(t,_),Er(_))},start:function(_){return td(t,_)},drop:Rt(t,Nf),leave:function(_){yt(t,_)||Mf(t)}};var m=i.input.getField();be(m,"keyup",function(_){return ki.call(t,_)}),be(m,"keydown",Rt(t,Ln)),be(m,"keypress",Rt(t,Oi)),be(m,"focus",function(_){return Qs(t,_)}),be(m,"blur",function(_){return Qi(t,_)})}var nd=[];Lt.defineInitHook=function(t){return nd.push(t)};function ml(t,i,s,o){var u=t.doc,c;s==null&&(s="add"),s=="smart"&&(u.mode.indent?c=Hi(t,i).state:s="prev");var g=t.options.tabSize,m=Me(u,i),_=Ne(m.text,null,g);m.stateAfter&&(m.stateAfter=null);var C=m.text.match(/^\s*/)[0],L;if(!o&&!/\S/.test(m.text))L=0,s="not";else if(s=="smart"&&(L=u.mode.indent(c,m.text.slice(C.length),m.text),L==lt||L>150)){if(!o)return;s="prev"}s=="prev"?i>u.first?L=Ne(Me(u,i-1).text,null,g):L=0:s=="add"?L=_+t.options.indentUnit:s=="subtract"?L=_-t.options.indentUnit:typeof s=="number"&&(L=_+s),L=Math.max(0,L);var M="",X=0;if(t.options.indentWithTabs)for(var z=Math.floor(L/g);z;--z)X+=g,M+="	";if(X<L&&(M+=Gt(L-X)),M!=C)return wr(u,M,fe(i,0),fe(i,C.length),"+input"),m.stateAfter=null,!0;for(var ie=0;ie<u.sel.ranges.length;ie++){var oe=u.sel.ranges[ie];if(oe.head.line==i&&oe.head.ch<C.length){var ve=fe(i,C.length);cl(u,ie,new ut(ve,ve));break}}}var Dn=null;function Ff(t){Dn=t}function id(t,i,s,o,u){var c=t.doc;t.display.shift=!1,o||(o=c.sel);var g=+new Date-200,m=u=="paste"||t.state.pasteIncoming>g,_=sn(i),C=null;if(m&&o.ranges.length>1)if(Dn&&Dn.text.join(`
`)==i){if(o.ranges.length%Dn.text.length==0){C=[];for(var L=0;L<Dn.text.length;L++)C.push(c.splitLines(Dn.text[L]))}}else _.length==o.ranges.length&&t.options.pasteLinesPerSelection&&(C=Pr(_,function(ke){return[ke]}));for(var M=t.curOp.updateInput,X=o.ranges.length-1;X>=0;X--){var z=o.ranges[X],ie=z.from(),oe=z.to();z.empty()&&(s&&s>0?ie=fe(ie.line,ie.ch-s):t.state.overwrite&&!m?oe=fe(oe.line,Math.min(Me(c,oe.line).text.length,oe.ch+Ve(_).length)):m&&Dn&&Dn.lineWise&&Dn.text.join(`
`)==_.join(`
`)&&(ie=oe=fe(ie.line,0)));var ve={from:ie,to:oe,text:C?C[X%C.length]:_,origin:u||(m?"paste":t.state.cutIncoming>g?"cut":"+input")};wi(t.doc,ve),Vt(t,"inputRead",t,ve)}i&&!m&&qv(t,i),Ji(t),t.curOp.updateInput<2&&(t.curOp.updateInput=M),t.curOp.typing=!0,t.state.pasteIncoming=t.state.cutIncoming=-1}function Kv(t,i){var s=t.clipboardData&&t.clipboardData.getData("Text");if(s)return t.preventDefault(),!i.isReadOnly()&&!i.options.disableInput&&vr(i,function(){return id(i,s,0,null,"paste")}),!0}function qv(t,i){if(!(!t.options.electricChars||!t.options.smartIndent))for(var s=t.doc.sel,o=s.ranges.length-1;o>=0;o--){var u=s.ranges[o];if(!(u.head.ch>100||o&&s.ranges[o-1].head.line==u.head.line)){var c=t.getModeAt(u.head),g=!1;if(c.electricChars){for(var m=0;m<c.electricChars.length;m++)if(i.indexOf(c.electricChars.charAt(m))>-1){g=ml(t,u.head.line,"smart");break}}else c.electricInput&&c.electricInput.test(Me(t.doc,u.head.line).text.slice(0,u.head.ch))&&(g=ml(t,u.head.line,"smart"));g&&Vt(t,"electricInput",t,u.head.line)}}}function Vv(t){for(var i=[],s=[],o=0;o<t.doc.sel.ranges.length;o++){var u=t.doc.sel.ranges[o].head.line,c={anchor:fe(u,0),head:fe(u+1,0)};s.push(c),i.push(t.getRange(c.anchor,c.head))}return{text:i,ranges:s}}function Zv(t,i,s,o){t.setAttribute("autocorrect",s?"":"off"),t.setAttribute("autocapitalize",o?"":"off"),t.setAttribute("spellcheck",!!i)}function Qv(){var t=q("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; min-height: 1em; outline: none"),i=q("div",[t],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return S?t.style.width="1000px":t.setAttribute("wrap","off"),G&&(t.style.border="1px solid black"),Zv(t),i}function Um(t){var i=t.optionHandlers,s=t.helpers={};t.prototype={constructor:t,focus:function(){window.focus(),this.display.input.focus()},setOption:function(o,u){var c=this.options,g=c[o];c[o]==u&&o!="mode"||(c[o]=u,i.hasOwnProperty(o)&&Rt(this,i[o])(this,u,g),ot(this,"optionChange",this,o))},getOption:function(o){return this.options[o]},getDoc:function(){return this.doc},addKeyMap:function(o,u){this.state.keyMaps[u?"push":"unshift"](Qe(o))},removeKeyMap:function(o){for(var u=this.state.keyMaps,c=0;c<u.length;++c)if(u[c]==o||u[c].name==o)return u.splice(c,1),!0},addOverlay:pr(function(o,u){var c=o.token?o:t.getMode(this.options,o);if(c.startState)throw new Error("Overlays may not be stateful.");rn(this.state.overlays,{mode:c,modeSpec:o,opaque:u&&u.opaque,priority:u&&u.priority||0},function(g){return g.priority}),this.state.modeGen++,_r(this)}),removeOverlay:pr(function(o){for(var u=this.state.overlays,c=0;c<u.length;++c){var g=u[c].modeSpec;if(g==o||typeof o=="string"&&g.name==o){u.splice(c,1),this.state.modeGen++,_r(this);return}}}),indentLine:pr(function(o,u,c){typeof u!="string"&&typeof u!="number"&&(u==null?u=this.options.smartIndent?"smart":"prev":u=u?"add":"subtract"),ga(this.doc,o)&&ml(this,o,u,c)}),indentSelection:pr(function(o){for(var u=this.doc.sel.ranges,c=-1,g=0;g<u.length;g++){var m=u[g];if(m.empty())m.head.line>c&&(ml(this,m.head.line,o,!0),c=m.head.line,g==this.doc.sel.primIndex&&Ji(this));else{var _=m.from(),C=m.to(),L=Math.max(c,_.line);c=Math.min(this.lastLine(),C.line-(C.ch?0:1))+1;for(var M=L;M<c;++M)ml(this,M,o);var X=this.doc.sel.ranges;_.ch==0&&u.length==X.length&&X[g].from().ch>0&&cl(this.doc,g,new ut(_,X[g].to()),ht)}}}),getTokenAt:function(o,u){return Su(this,o,u)},getLineTokens:function(o,u){return Su(this,fe(o),u,!0)},getTokenTypeAt:function(o){o=je(this.doc,o);var u=mu(this,Me(this.doc,o.line)),c=0,g=(u.length-1)/2,m=o.ch,_;if(m==0)_=u[2];else for(;;){var C=c+g>>1;if((C?u[C*2-1]:0)>=m)g=C;else if(u[C*2+1]<m)c=C+1;else{_=u[C*2+2];break}}var L=_?_.indexOf("overlay "):-1;return L<0?_:L==0?null:_.slice(0,L-1)},getModeAt:function(o){var u=this.doc.mode;return u.innerMode?t.innerMode(u,this.getTokenAt(o).state).mode:u},getHelper:function(o,u){return this.getHelpers(o,u)[0]},getHelpers:function(o,u){var c=[];if(!s.hasOwnProperty(u))return c;var g=s[u],m=this.getModeAt(o);if(typeof m[u]=="string")g[m[u]]&&c.push(g[m[u]]);else if(m[u])for(var _=0;_<m[u].length;_++){var C=g[m[u][_]];C&&c.push(C)}else m.helperType&&g[m.helperType]?c.push(g[m.helperType]):g[m.name]&&c.push(g[m.name]);for(var L=0;L<g._global.length;L++){var M=g._global[L];M.pred(m,this)&&Ue(c,M.val)==-1&&c.push(M.val)}return c},getStateAfter:function(o,u){var c=this.doc;return o=pu(c,o==null?c.first+c.size-1:o),Hi(this,o+1,u).state},cursorCoords:function(o,u){var c,g=this.doc.sel.primary();return o==null?c=g.head:typeof o=="object"?c=je(this.doc,o):c=o?g.from():g.to(),Ir(this,c,u||"page")},charCoords:function(o,u){return xo(this,je(this.doc,o),u||"page")},coordsChar:function(o,u){return o=Yu(this,o,u||"page"),zs(this,o.left,o.top)},lineAtHeight:function(o,u){return o=Yu(this,{top:o,left:0},u||"page").top,mi(this.doc,o+this.display.viewOffset)},heightAtLine:function(o,u,c){var g=!1,m;if(typeof o=="number"){var _=this.doc.first+this.doc.size-1;o<this.doc.first?o=this.doc.first:o>_&&(o=_,g=!0),m=Me(this.doc,o)}else m=o;return Oo(this,m,{top:0,left:0},u||"page",c||g).top+(g?this.doc.height-Tn(m):0)},defaultTextHeight:function(){return Zi(this.display)},defaultCharWidth:function(){return En(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(o,u,c,g,m){var _=this.display;o=Ir(this,je(this.doc,o));var C=o.bottom,L=o.left;if(u.style.position="absolute",u.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(u),_.sizer.appendChild(u),g=="over")C=o.top;else if(g=="above"||g=="near"){var M=Math.max(_.wrapper.clientHeight,this.doc.height),X=Math.max(_.sizer.clientWidth,_.lineSpace.clientWidth);(g=="above"||o.bottom+u.offsetHeight>M)&&o.top>u.offsetHeight?C=o.top-u.offsetHeight:o.bottom+u.offsetHeight<=M&&(C=o.bottom),L+u.offsetWidth>X&&(L=X-u.offsetWidth)}u.style.top=C+"px",u.style.left=u.style.right="",m=="right"?(L=_.sizer.clientWidth-u.offsetWidth,u.style.right="0px"):(m=="left"?L=0:m=="middle"&&(L=(_.sizer.clientWidth-u.offsetWidth)/2),u.style.left=L+"px"),c&&Fc(this,{left:L,top:C,right:L+u.offsetWidth,bottom:C+u.offsetHeight})},triggerOnKeyDown:pr(Ln),triggerOnKeyPress:pr(Oi),triggerOnKeyUp:ki,triggerOnMouseDown:pr(Bo),execCommand:function(o){if(tt.hasOwnProperty(o))return tt[o].call(null,this)},triggerElectric:pr(function(o){qv(this,o)}),findPosH:function(o,u,c,g){var m=1;u<0&&(m=-1,u=-u);for(var _=je(this.doc,o),C=0;C<u&&(_=ad(this.doc,_,m,c,g),!_.hitSide);++C);return _},moveH:pr(function(o,u){var c=this;this.extendSelectionsBy(function(g){return c.display.shift||c.doc.extend||g.empty()?ad(c.doc,g.head,o,u,c.options.rtlMoveVisually):o<0?g.from():g.to()},Ft)}),deleteH:pr(function(o,u){var c=this.doc.sel,g=this.doc;c.somethingSelected()?g.replaceSelection("",null,"+delete"):et(this,function(m){var _=ad(g,m.head,o,u,!1);return o<0?{from:_,to:m.head}:{from:m.head,to:_}})}),findPosV:function(o,u,c,g){var m=1,_=g;u<0&&(m=-1,u=-u);for(var C=je(this.doc,o),L=0;L<u;++L){var M=Ir(this,C,"div");if(_==null?_=M.left:M.left=_,C=Jv(this,M,m,c),C.hitSide)break}return C},moveV:pr(function(o,u){var c=this,g=this.doc,m=[],_=!this.display.shift&&!g.extend&&g.sel.somethingSelected();if(g.extendSelectionsBy(function(L){if(_)return o<0?L.from():L.to();var M=Ir(c,L.head,"div");L.goalColumn!=null&&(M.left=L.goalColumn),m.push(M.left);var X=Jv(c,M,o,u);return u=="page"&&L==g.sel.primary()&&kn(c,xo(c,X,"div").top-M.top),X},Ft),m.length)for(var C=0;C<g.sel.ranges.length;C++)g.sel.ranges[C].goalColumn=m[C]}),findWordAt:function(o){var u=this.doc,c=Me(u,o.line).text,g=o.ch,m=o.ch;if(c){var _=this.getHelper(o,"wordChars");(o.sticky=="before"||m==c.length)&&g?--g:++m;for(var C=c.charAt(g),L=Cr(C,_)?function(M){return Cr(M,_)}:/\s/.test(C)?function(M){return/\s/.test(M)}:function(M){return!/\s/.test(M)&&!Cr(M)};g>0&&L(c.charAt(g-1));)--g;for(;m<c.length&&L(c.charAt(m));)++m}return new ut(fe(o.line,g),fe(o.line,m))},toggleOverwrite:function(o){o!=null&&o==this.state.overwrite||((this.state.overwrite=!this.state.overwrite)?pe(this.display.cursorDiv,"CodeMirror-overwrite"):re(this.display.cursorDiv,"CodeMirror-overwrite"),ot(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==te()},isReadOnly:function(){return!!(this.options.readOnly||this.doc.cantEdit)},scrollTo:pr(function(o,u){xa(this,o,u)}),getScrollInfo:function(){var o=this.display.scroller;return{left:o.scrollLeft,top:o.scrollTop,height:o.scrollHeight-fn(this)-this.display.barHeight,width:o.scrollWidth-fn(this)-this.display.barWidth,clientHeight:Gs(this),clientWidth:_i(this)}},scrollIntoView:pr(function(o,u){o==null?(o={from:this.doc.sel.primary().head,to:null},u==null&&(u=this.options.cursorScrollMargin)):typeof o=="number"?o={from:fe(o,0),to:null}:o.from==null&&(o={from:o,to:null}),o.to||(o.to=o.from),o.margin=u||0,o.from.line!=null?ea(this,o):Ju(this,o.from,o.to,o.margin)}),setSize:pr(function(o,u){var c=this,g=function(_){return typeof _=="number"||/^\d+$/.test(String(_))?_+"px":_};o!=null&&(this.display.wrapper.style.width=g(o)),u!=null&&(this.display.wrapper.style.height=g(u)),this.options.lineWrapping&&Ta(this);var m=this.display.viewFrom;this.doc.iter(m,this.display.viewTo,function(_){if(_.widgets){for(var C=0;C<_.widgets.length;C++)if(_.widgets[C].noHScroll){An(c,m,"widget");break}}++m}),this.curOp.forceUpdate=!0,ot(this,"refresh",this)}),operation:function(o){return vr(this,o)},startOperation:function(){return Hn(this)},endOperation:function(){return On(this)},refresh:pr(function(){var o=this.display.cachedTextHeight;_r(this),this.curOp.forceUpdate=!0,Ca(this),xa(this,this.doc.scrollLeft,this.doc.scrollTop),al(this.display),(o==null||Math.abs(o-Zi(this.display))>.5||this.options.lineWrapping)&&wa(this),ot(this,"refresh",this)}),swapDoc:pr(function(o){var u=this.doc;return u.cm=null,this.state.selectingText&&this.state.selectingText(),cf(this,o),Ca(this),this.display.input.reset(),xa(this,o.scrollLeft,o.scrollTop),this.curOp.forceScroll=!0,Vt(this,"swapDoc",this,u),u}),phrase:function(o){var u=this.options.phrases;return u&&Object.prototype.hasOwnProperty.call(u,o)?u[o]:o},getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},Ur(t),t.registerHelper=function(o,u,c){s.hasOwnProperty(o)||(s[o]=t[o]={_global:[]}),s[o][u]=c},t.registerGlobalHelper=function(o,u,c,g){t.registerHelper(o,u,g),s[o]._global.push({pred:c,val:g})}}function ad(t,i,s,o,u){var c=i,g=s,m=Me(t,i.line),_=u&&t.direction=="rtl"?-s:s;function C(){var xe=i.line+_;return xe<t.first||xe>=t.first+t.size?!1:(i=new fe(xe,i.ch,i.sticky),m=Me(t,xe))}function L(xe){var Oe;if(o=="codepoint"){var Pe=m.text.charCodeAt(i.ch+(s>0?0:-1));if(isNaN(Pe))Oe=null;else{var We=s>0?Pe>=55296&&Pe<56320:Pe>=56320&&Pe<57343;Oe=new fe(i.line,Math.max(0,Math.min(m.text.length,i.ch+s*(We?2:1))),-s)}}else u?Oe=kr(t.cm,m,i,s):Oe=Jt(m,i,s);if(Oe==null)if(!xe&&C())i=Kt(u,t.cm,m,i.line,_);else return!1;else i=Oe;return!0}if(o=="char"||o=="codepoint")L();else if(o=="column")L(!0);else if(o=="word"||o=="group")for(var M=null,X=o=="group",z=t.cm&&t.cm.getHelper(i,"wordChars"),ie=!0;!(s<0&&!L(!ie));ie=!1){var oe=m.text.charAt(i.ch)||`
`,ve=Cr(oe,z)?"w":X&&oe==`
`?"n":!X||/\s/.test(oe)?null:"p";if(X&&!ie&&!ve&&(ve="s"),M&&M!=ve){s<0&&(s=1,L(),i.sticky="after");break}if(ve&&(M=ve),s>0&&!L(!ie))break}var ke=Da(t,i,c,g,!0);return Bn(c,ke)&&(ke.hitSide=!0),ke}function Jv(t,i,s,o){var u=t.doc,c=i.left,g;if(o=="page"){var m=Math.min(t.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight),_=Math.max(m-.5*Zi(t.display),3);g=(s>0?i.bottom:i.top)+s*_}else o=="line"&&(g=s>0?i.bottom+3:i.top-3);for(var C;C=zs(t,c,g),!!C.outside;){if(s<0?g<=0:g>=u.height){C.hitSide=!0;break}g+=s*5}return C}var _t=function(t){this.cm=t,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new Ye,this.composing=null,this.gracePeriod=!1,this.readDOMTimeout=null};_t.prototype.init=function(t){var i=this,s=this,o=s.cm,u=s.div=t.lineDiv;u.contentEditable=!0,Zv(u,o.options.spellcheck,o.options.autocorrect,o.options.autocapitalize);function c(m){for(var _=m.target;_;_=_.parentNode){if(_==u)return!0;if(/\bCodeMirror-(?:line)?widget\b/.test(_.className))break}return!1}be(u,"paste",function(m){!c(m)||yt(o,m)||Kv(m,o)||p<=11&&setTimeout(Rt(o,function(){return i.updateFromDOM()}),20)}),be(u,"compositionstart",function(m){i.composing={data:m.data,done:!1}}),be(u,"compositionupdate",function(m){i.composing||(i.composing={data:m.data,done:!1})}),be(u,"compositionend",function(m){i.composing&&(m.data!=i.composing.data&&i.readFromDOMSoon(),i.composing.done=!0)}),be(u,"touchstart",function(){return s.forceCompositionEnd()}),be(u,"input",function(){i.composing||i.readFromDOMSoon()});function g(m){if(!(!c(m)||yt(o,m))){if(o.somethingSelected())Ff({lineWise:!1,text:o.getSelections()}),m.type=="cut"&&o.replaceSelection("",null,"cut");else if(o.options.lineWiseCopyCut){var _=Vv(o);Ff({lineWise:!0,text:_.text}),m.type=="cut"&&o.operation(function(){o.setSelections(_.ranges,0,ht),o.replaceSelection("",null,"cut")})}else return;if(m.clipboardData){m.clipboardData.clearData();var C=Dn.text.join(`
`);if(m.clipboardData.setData("Text",C),m.clipboardData.getData("Text")==C){m.preventDefault();return}}var L=Qv(),M=L.firstChild;o.display.lineSpace.insertBefore(L,o.display.lineSpace.firstChild),M.value=Dn.text.join(`
`);var X=te();Ee(M),setTimeout(function(){o.display.lineSpace.removeChild(L),X.focus(),X==u&&s.showPrimarySelection()},50)}}be(u,"copy",g),be(u,"cut",g)},_t.prototype.screenReaderLabelChanged=function(t){t?this.div.setAttribute("aria-label",t):this.div.removeAttribute("aria-label")},_t.prototype.prepareSelection=function(){var t=Vu(this.cm,!1);return t.focus=te()==this.div,t},_t.prototype.showSelection=function(t,i){!t||!this.cm.display.view.length||((t.focus||i)&&this.showPrimarySelection(),this.showMultipleSelections(t))},_t.prototype.getSelection=function(){return this.cm.display.wrapper.ownerDocument.getSelection()},_t.prototype.showPrimarySelection=function(){var t=this.getSelection(),i=this.cm,s=i.doc.sel.primary(),o=s.from(),u=s.to();if(i.display.viewTo==i.display.viewFrom||o.line>=i.display.viewTo||u.line<i.display.viewFrom){t.removeAllRanges();return}var c=$f(i,t.anchorNode,t.anchorOffset),g=$f(i,t.focusNode,t.focusOffset);if(!(c&&!c.bad&&g&&!g.bad&&ze(co(c,g),o)==0&&ze(ho(c,g),u)==0)){var m=i.display.view,_=o.line>=i.display.viewFrom&&ep(i,o)||{node:m[0].measure.map[2],offset:0},C=u.line<i.display.viewTo&&ep(i,u);if(!C){var L=m[m.length-1].measure,M=L.maps?L.maps[L.maps.length-1]:L.map;C={node:M[M.length-1],offset:M[M.length-2]-M[M.length-3]}}if(!_||!C){t.removeAllRanges();return}var X=t.rangeCount&&t.getRangeAt(0),z;try{z=K(_.node,_.offset,C.offset,C.node)}catch{}z&&(!l&&i.state.focused?(t.collapse(_.node,_.offset),z.collapsed||(t.removeAllRanges(),t.addRange(z))):(t.removeAllRanges(),t.addRange(z)),X&&t.anchorNode==null?t.addRange(X):l&&this.startGracePeriod()),this.rememberSelection()}},_t.prototype.startGracePeriod=function(){var t=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout(function(){t.gracePeriod=!1,t.selectionChanged()&&t.cm.operation(function(){return t.cm.curOp.selectionChanged=!0})},20)},_t.prototype.showMultipleSelections=function(t){Q(this.cm.display.cursorDiv,t.cursors),Q(this.cm.display.selectionDiv,t.selection)},_t.prototype.rememberSelection=function(){var t=this.getSelection();this.lastAnchorNode=t.anchorNode,this.lastAnchorOffset=t.anchorOffset,this.lastFocusNode=t.focusNode,this.lastFocusOffset=t.focusOffset},_t.prototype.selectionInEditor=function(){var t=this.getSelection();if(!t.rangeCount)return!1;var i=t.getRangeAt(0).commonAncestorContainer;return ne(this.div,i)},_t.prototype.focus=function(){this.cm.options.readOnly!="nocursor"&&((!this.selectionInEditor()||te()!=this.div)&&this.showSelection(this.prepareSelection(),!0),this.div.focus())},_t.prototype.blur=function(){this.div.blur()},_t.prototype.getField=function(){return this.div},_t.prototype.supportsTouch=function(){return!0},_t.prototype.receivedFocus=function(){var t=this,i=this;this.selectionInEditor()?setTimeout(function(){return t.pollSelection()},20):vr(this.cm,function(){return i.cm.curOp.selectionChanged=!0});function s(){i.cm.state.focused&&(i.pollSelection(),i.polling.set(i.cm.options.pollInterval,s))}this.polling.set(this.cm.options.pollInterval,s)},_t.prototype.selectionChanged=function(){var t=this.getSelection();return t.anchorNode!=this.lastAnchorNode||t.anchorOffset!=this.lastAnchorOffset||t.focusNode!=this.lastFocusNode||t.focusOffset!=this.lastFocusOffset},_t.prototype.pollSelection=function(){if(!(this.readDOMTimeout!=null||this.gracePeriod||!this.selectionChanged())){var t=this.getSelection(),i=this.cm;if(j&&A&&this.cm.display.gutterSpecs.length&&Hm(t.anchorNode)){this.cm.triggerOnKeyDown({type:"keydown",keyCode:8,preventDefault:Math.abs}),this.blur(),this.focus();return}if(!this.composing){this.rememberSelection();var s=$f(i,t.anchorNode,t.anchorOffset),o=$f(i,t.focusNode,t.focusOffset);s&&o&&vr(i,function(){lr(i.doc,zn(s,o),ht),(s.bad||o.bad)&&(i.curOp.selectionChanged=!0)})}}},_t.prototype.pollContent=function(){this.readDOMTimeout!=null&&(clearTimeout(this.readDOMTimeout),this.readDOMTimeout=null);var t=this.cm,i=t.display,s=t.doc.sel.primary(),o=s.from(),u=s.to();if(o.ch==0&&o.line>t.firstLine()&&(o=fe(o.line-1,Me(t.doc,o.line-1).length)),u.ch==Me(t.doc,u.line).text.length&&u.line<t.lastLine()&&(u=fe(u.line+1,0)),o.line<i.viewFrom||u.line>i.viewTo-1)return!1;var c,g,m;o.line==i.viewFrom||(c=Si(t,o.line))==0?(g=pt(i.view[0].line),m=i.view[0].node):(g=pt(i.view[c].line),m=i.view[c-1].node.nextSibling);var _=Si(t,u.line),C,L;if(_==i.view.length-1?(C=i.viewTo-1,L=i.lineDiv.lastChild):(C=pt(i.view[_+1].line)-1,L=i.view[_+1].node.previousSibling),!m)return!1;for(var M=t.doc.splitLines(zm(t,m,L,g,C)),X=yi(t.doc,fe(g,0),fe(C,Me(t.doc,C).text.length));M.length>1&&X.length>1;)if(Ve(M)==Ve(X))M.pop(),X.pop(),C--;else if(M[0]==X[0])M.shift(),X.shift(),g++;else break;for(var z=0,ie=0,oe=M[0],ve=X[0],ke=Math.min(oe.length,ve.length);z<ke&&oe.charCodeAt(z)==ve.charCodeAt(z);)++z;for(var xe=Ve(M),Oe=Ve(X),Pe=Math.min(xe.length-(M.length==1?z:0),Oe.length-(X.length==1?z:0));ie<Pe&&xe.charCodeAt(xe.length-ie-1)==Oe.charCodeAt(Oe.length-ie-1);)++ie;if(M.length==1&&X.length==1&&g==o.line)for(;z&&z>o.ch&&xe.charCodeAt(xe.length-ie-1)==Oe.charCodeAt(Oe.length-ie-1);)z--,ie++;M[M.length-1]=xe.slice(0,xe.length-ie).replace(/^\u200b+/,""),M[0]=M[0].slice(z).replace(/\u200b+$/,"");var We=fe(g,z),Ge=fe(C,X.length?Ve(X).length-ie:0);if(M.length>1||M[0]||ze(We,Ge))return wr(t.doc,M,We,Ge,"+input"),!0},_t.prototype.ensurePolled=function(){this.forceCompositionEnd()},_t.prototype.reset=function(){this.forceCompositionEnd()},_t.prototype.forceCompositionEnd=function(){!this.composing||(clearTimeout(this.readDOMTimeout),this.composing=null,this.updateFromDOM(),this.div.blur(),this.div.focus())},_t.prototype.readFromDOMSoon=function(){var t=this;this.readDOMTimeout==null&&(this.readDOMTimeout=setTimeout(function(){if(t.readDOMTimeout=null,t.composing)if(t.composing.done)t.composing=null;else return;t.updateFromDOM()},80))},_t.prototype.updateFromDOM=function(){var t=this;(this.cm.isReadOnly()||!this.pollContent())&&vr(this.cm,function(){return _r(t.cm)})},_t.prototype.setUneditable=function(t){t.contentEditable="false"},_t.prototype.onKeyPress=function(t){t.charCode==0||this.composing||(t.preventDefault(),this.cm.isReadOnly()||Rt(this.cm,id)(this.cm,String.fromCharCode(t.charCode==null?t.keyCode:t.charCode),0))},_t.prototype.readOnlyChanged=function(t){this.div.contentEditable=String(t!="nocursor")},_t.prototype.onContextMenu=function(){},_t.prototype.resetPosition=function(){},_t.prototype.needsContentAttribute=!0;function ep(t,i){var s=wo(t,i.line);if(!s||s.hidden)return null;var o=Me(t.doc,i.line),u=Wu(s,o,i.line),c=Te(o,t.doc.direction),g="left";if(c){var m=ge(c,i.ch);g=m%2?"right":"left"}var _=ko(u.map,i.ch,g);return _.offset=_.collapse=="right"?_.end:_.start,_}function Hm(t){for(var i=t;i;i=i.parentNode)if(/CodeMirror-gutter-wrapper/.test(i.className))return!0;return!1}function Ho(t,i){return i&&(t.bad=!0),t}function zm(t,i,s,o,u){var c="",g=!1,m=t.doc.lineSeparator(),_=!1;function C(z){return function(ie){return ie.id==z}}function L(){g&&(c+=m,_&&(c+=m),g=_=!1)}function M(z){z&&(L(),c+=z)}function X(z){if(z.nodeType==1){var ie=z.getAttribute("cm-text");if(ie){M(ie);return}var oe=z.getAttribute("cm-marker"),ve;if(oe){var ke=t.findMarks(fe(o,0),fe(u+1,0),C(+oe));ke.length&&(ve=ke[0].find(0))&&M(yi(t.doc,ve.from,ve.to).join(m));return}if(z.getAttribute("contenteditable")=="false")return;var xe=/^(pre|div|p|li|table|br)$/i.test(z.nodeName);if(!/^br$/i.test(z.nodeName)&&z.textContent.length==0)return;xe&&L();for(var Oe=0;Oe<z.childNodes.length;Oe++)X(z.childNodes[Oe]);/^(pre|p)$/i.test(z.nodeName)&&(_=!0),xe&&(g=!0)}else z.nodeType==3&&M(z.nodeValue.replace(/\u200b/g,"").replace(/\u00a0/g," "))}for(;X(i),i!=s;)i=i.nextSibling,_=!1;return c}function $f(t,i,s){var o;if(i==t.display.lineDiv){if(o=t.display.lineDiv.childNodes[s],!o)return Ho(t.clipPos(fe(t.display.viewTo-1)),!0);i=null,s=0}else for(o=i;;o=o.parentNode){if(!o||o==t.display.lineDiv)return null;if(o.parentNode&&o.parentNode==t.display.lineDiv)break}for(var u=0;u<t.display.view.length;u++){var c=t.display.view[u];if(c.node==o)return jm(c,i,s)}}function jm(t,i,s){var o=t.text.firstChild,u=!1;if(!i||!ne(o,i))return Ho(fe(pt(t.line),0),!0);if(i==o&&(u=!0,i=o.childNodes[s],s=0,!i)){var c=t.rest?Ve(t.rest):t.line;return Ho(fe(pt(c),c.text.length),u)}var g=i.nodeType==3?i:null,m=i;for(!g&&i.childNodes.length==1&&i.firstChild.nodeType==3&&(g=i.firstChild,s&&(s=g.nodeValue.length));m.parentNode!=o;)m=m.parentNode;var _=t.measure,C=_.maps;function L(ve,ke,xe){for(var Oe=-1;Oe<(C?C.length:0);Oe++)for(var Pe=Oe<0?_.map:C[Oe],We=0;We<Pe.length;We+=3){var Ge=Pe[We+2];if(Ge==ve||Ge==ke){var Je=pt(Oe<0?t.line:t.rest[Oe]),At=Pe[We]+xe;return(xe<0||Ge!=ve)&&(At=Pe[We+(xe?1:0)]),fe(Je,At)}}}var M=L(g,m,s);if(M)return Ho(M,u);for(var X=m.nextSibling,z=g?g.nodeValue.length-s:0;X;X=X.nextSibling){if(M=L(X,X.firstChild,0),M)return Ho(fe(M.line,M.ch-z),u);z+=X.textContent.length}for(var ie=m.previousSibling,oe=s;ie;ie=ie.previousSibling){if(M=L(ie,ie.firstChild,-1),M)return Ho(fe(M.line,M.ch+oe),u);oe+=ie.textContent.length}}var qt=function(t){this.cm=t,this.prevInput="",this.pollingFast=!1,this.polling=new Ye,this.hasSelection=!1,this.composing=null};qt.prototype.init=function(t){var i=this,s=this,o=this.cm;this.createField(t);var u=this.textarea;t.wrapper.insertBefore(this.wrapper,t.wrapper.firstChild),G&&(u.style.width="0px"),be(u,"input",function(){d&&p>=9&&i.hasSelection&&(i.hasSelection=null),s.poll()}),be(u,"paste",function(g){yt(o,g)||Kv(g,o)||(o.state.pasteIncoming=+new Date,s.fastPoll())});function c(g){if(!yt(o,g)){if(o.somethingSelected())Ff({lineWise:!1,text:o.getSelections()});else if(o.options.lineWiseCopyCut){var m=Vv(o);Ff({lineWise:!0,text:m.text}),g.type=="cut"?o.setSelections(m.ranges,null,ht):(s.prevInput="",u.value=m.text.join(`
`),Ee(u))}else return;g.type=="cut"&&(o.state.cutIncoming=+new Date)}}be(u,"cut",c),be(u,"copy",c),be(t.scroller,"paste",function(g){if(!(Lr(t,g)||yt(o,g))){if(!u.dispatchEvent){o.state.pasteIncoming=+new Date,s.focus();return}var m=new Event("paste");m.clipboardData=g.clipboardData,u.dispatchEvent(m)}}),be(t.lineSpace,"selectstart",function(g){Lr(t,g)||xt(g)}),be(u,"compositionstart",function(){var g=o.getCursor("from");s.composing&&s.composing.range.clear(),s.composing={start:g,range:o.markText(g,o.getCursor("to"),{className:"CodeMirror-composing"})}}),be(u,"compositionend",function(){s.composing&&(s.poll(),s.composing.range.clear(),s.composing=null)})},qt.prototype.createField=function(t){this.wrapper=Qv(),this.textarea=this.wrapper.firstChild},qt.prototype.screenReaderLabelChanged=function(t){t?this.textarea.setAttribute("aria-label",t):this.textarea.removeAttribute("aria-label")},qt.prototype.prepareSelection=function(){var t=this.cm,i=t.display,s=t.doc,o=Vu(t);if(t.options.moveInputWithCursor){var u=Ir(t,s.sel.primary().head,"div"),c=i.wrapper.getBoundingClientRect(),g=i.lineDiv.getBoundingClientRect();o.teTop=Math.max(0,Math.min(i.wrapper.clientHeight-10,u.top+g.top-c.top)),o.teLeft=Math.max(0,Math.min(i.wrapper.clientWidth-10,u.left+g.left-c.left))}return o},qt.prototype.showSelection=function(t){var i=this.cm,s=i.display;Q(s.cursorDiv,t.cursors),Q(s.selectionDiv,t.selection),t.teTop!=null&&(this.wrapper.style.top=t.teTop+"px",this.wrapper.style.left=t.teLeft+"px")},qt.prototype.reset=function(t){if(!(this.contextMenuPending||this.composing)){var i=this.cm;if(i.somethingSelected()){this.prevInput="";var s=i.getSelection();this.textarea.value=s,i.state.focused&&Ee(this.textarea),d&&p>=9&&(this.hasSelection=s)}else t||(this.prevInput=this.textarea.value="",d&&p>=9&&(this.hasSelection=null))}},qt.prototype.getField=function(){return this.textarea},qt.prototype.supportsTouch=function(){return!1},qt.prototype.focus=function(){if(this.cm.options.readOnly!="nocursor"&&(!B||te()!=this.textarea))try{this.textarea.focus()}catch{}},qt.prototype.blur=function(){this.textarea.blur()},qt.prototype.resetPosition=function(){this.wrapper.style.top=this.wrapper.style.left=0},qt.prototype.receivedFocus=function(){this.slowPoll()},qt.prototype.slowPoll=function(){var t=this;this.pollingFast||this.polling.set(this.cm.options.pollInterval,function(){t.poll(),t.cm.state.focused&&t.slowPoll()})},qt.prototype.fastPoll=function(){var t=!1,i=this;i.pollingFast=!0;function s(){var o=i.poll();!o&&!t?(t=!0,i.polling.set(60,s)):(i.pollingFast=!1,i.slowPoll())}i.polling.set(20,s)},qt.prototype.poll=function(){var t=this,i=this.cm,s=this.textarea,o=this.prevInput;if(this.contextMenuPending||!i.state.focused||Cs(s)&&!o&&!this.composing||i.isReadOnly()||i.options.disableInput||i.state.keySeq)return!1;var u=s.value;if(u==o&&!i.somethingSelected())return!1;if(d&&p>=9&&this.hasSelection===u||U&&/[\uf700-\uf7ff]/.test(u))return i.display.input.reset(),!1;if(i.doc.sel==i.display.selForContextMenu){var c=u.charCodeAt(0);if(c==8203&&!o&&(o="\u200B"),c==8666)return this.reset(),this.cm.execCommand("undo")}for(var g=0,m=Math.min(o.length,u.length);g<m&&o.charCodeAt(g)==u.charCodeAt(g);)++g;return vr(i,function(){id(i,u.slice(g),o.length-g,null,t.composing?"*compose":null),u.length>1e3||u.indexOf(`
`)>-1?s.value=t.prevInput="":t.prevInput=u,t.composing&&(t.composing.range.clear(),t.composing.range=i.markText(t.composing.start,i.getCursor("to"),{className:"CodeMirror-composing"}))}),!0},qt.prototype.ensurePolled=function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},qt.prototype.onKeyPress=function(){d&&p>=9&&(this.hasSelection=null),this.fastPoll()},qt.prototype.onContextMenu=function(t){var i=this,s=i.cm,o=s.display,u=i.textarea;i.contextMenuPending&&i.contextMenuPending();var c=bi(s,t),g=o.scroller.scrollTop;if(!c||O)return;var m=s.options.resetSelectionOnContextMenu;m&&s.doc.sel.contains(c)==-1&&Rt(s,lr)(s.doc,zn(c),ht);var _=u.style.cssText,C=i.wrapper.style.cssText,L=i.wrapper.offsetParent.getBoundingClientRect();i.wrapper.style.cssText="position: static",u.style.cssText=`position: absolute; width: 30px; height: 30px;
      top: `+(t.clientY-L.top-5)+"px; left: "+(t.clientX-L.left-5)+`px;
      z-index: 1000; background: `+(d?"rgba(255, 255, 255, .05)":"transparent")+`;
      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);`;var M;S&&(M=window.scrollY),o.input.focus(),S&&window.scrollTo(null,M),o.input.reset(),s.somethingSelected()||(u.value=i.prevInput=" "),i.contextMenuPending=z,o.selForContextMenu=s.doc.sel,clearTimeout(o.detectingSelectAll);function X(){if(u.selectionStart!=null){var oe=s.somethingSelected(),ve="\u200B"+(oe?u.value:"");u.value="\u21DA",u.value=ve,i.prevInput=oe?"":"\u200B",u.selectionStart=1,u.selectionEnd=ve.length,o.selForContextMenu=s.doc.sel}}function z(){if(i.contextMenuPending==z&&(i.contextMenuPending=!1,i.wrapper.style.cssText=C,u.style.cssText=_,d&&p<9&&o.scrollbars.setScrollTop(o.scroller.scrollTop=g),u.selectionStart!=null)){(!d||d&&p<9)&&X();var oe=0,ve=function(){o.selForContextMenu==s.doc.sel&&u.selectionStart==0&&u.selectionEnd>0&&i.prevInput=="\u200B"?Rt(s,Af)(s):oe++<10?o.detectingSelectAll=setTimeout(ve,500):(o.selForContextMenu=null,o.input.reset())};o.detectingSelectAll=setTimeout(ve,200)}}if(d&&p>=9&&X(),R){Er(t);var ie=function(){it(window,"mouseup",ie),setTimeout(z,20)};be(window,"mouseup",ie)}else setTimeout(z,50)},qt.prototype.readOnlyChanged=function(t){t||this.reset(),this.textarea.disabled=t=="nocursor",this.textarea.readOnly=!!t},qt.prototype.setUneditable=function(){},qt.prototype.needsContentAttribute=!1;function Ym(t,i){if(i=i?Ke(i):{},i.value=t.value,!i.tabindex&&t.tabIndex&&(i.tabindex=t.tabIndex),!i.placeholder&&t.placeholder&&(i.placeholder=t.placeholder),i.autofocus==null){var s=te();i.autofocus=s==t||t.getAttribute("autofocus")!=null&&s==document.body}function o(){t.value=m.getValue()}var u;if(t.form&&(be(t.form,"submit",o),!i.leaveSubmitMethodAlone)){var c=t.form;u=c.submit;try{var g=c.submit=function(){o(),c.submit=u,c.submit(),c.submit=g}}catch{}}i.finishInit=function(_){_.save=o,_.getTextArea=function(){return t},_.toTextArea=function(){_.toTextArea=isNaN,o(),t.parentNode.removeChild(_.getWrapperElement()),t.style.display="",t.form&&(it(t.form,"submit",o),!i.leaveSubmitMethodAlone&&typeof t.form.submit=="function"&&(t.form.submit=u))}},t.style.display="none";var m=Lt(function(_){return t.parentNode.insertBefore(_,t.nextSibling)},i);return m}function Xm(t){t.off=it,t.on=be,t.wheelEventPixels=ll,t.Doc=ur,t.splitLines=sn,t.countColumn=Ne,t.findColumn=mr,t.isWordChar=an,t.Pass=lt,t.signal=ot,t.Line=Yi,t.changeEnd=jn,t.scrollbarModel=tl,t.Pos=fe,t.cmpPos=ze,t.modes=As,t.mimeModes=pi,t.resolveMode=lo,t.getMode=uo,t.modeExtensions=Ui,t.extendMode=du,t.copyState=gi,t.startState=vu,t.innerMode=fo,t.commands=tt,t.keyMap=ae,t.keyName=Ze,t.isModifierKey=Ie,t.lookupKey=de,t.normalizeKeyMap=Re,t.StringStream=Bt,t.SharedTextMarker=Ga,t.TextMarker=Pn,t.LineWidget=aa,t.e_preventDefault=xt,t.e_stopPropagation=Hr,t.e_stop=Er,t.addClass=pe,t.contains=ne,t.rmClass=re,t.keyNames=H}$m(Lt),Um(Lt);var Km="iter insert remove copy getEditor constructor".split(" ");for(var Gf in ur.prototype)ur.prototype.hasOwnProperty(Gf)&&Ue(Km,Gf)<0&&(Lt.prototype[Gf]=function(t){return function(){return t.apply(this.doc,arguments)}}(ur.prototype[Gf]));return Ur(ur),Lt.inputStyles={textarea:qt,contenteditable:_t},Lt.defineMode=function(t){!Lt.defaults.mode&&t!="null"&&(Lt.defaults.mode=t),oc.apply(this,arguments)},Lt.defineMIME=sc,Lt.defineMode("null",function(){return{token:function(t){return t.skipToEnd()}}}),Lt.defineMIME("text/plain","null"),Lt.defineExtension=function(t,i){Lt.prototype[t]=i},Lt.defineDocExtension=function(t,i){ur.prototype[t]=i},Lt.fromTextArea=Ym,Xm(Lt),Lt.version="5.65.2",Lt})})(Qg);var b$=Qg.exports,Jg={exports:{}};/**
 * chroma.js - JavaScript library for color conversions
 *
 * Copyright (c) 2011-2019, Gregor Aisch
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 * 1. Redistributions of source code must retain the above copyright notice, this
 * list of conditions and the following disclaimer.
 *
 * 2. Redistributions in binary form must reproduce the above copyright notice,
 * this list of conditions and the following disclaimer in the documentation
 * and/or other materials provided with the distribution.
 *
 * 3. The name Gregor Aisch may not be used to endorse or promote products
 * derived from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL GREGOR AISCH OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 * -------------------------------------------------------
 *
 * chroma.js includes colors from colorbrewer2.org, which are released under
 * the following license:
 *
 * Copyright (c) 2002 Cynthia Brewer, Mark Harrower,
 * and The Pennsylvania State University.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,
 * either express or implied. See the License for the specific
 * language governing permissions and limitations under the License.
 *
 * ------------------------------------------------------
 *
 * Named colors are taken from X11 Color Names.
 * http://www.w3.org/TR/css3-color/#svg-color
 *
 * @preserve
 */(function(r,e){(function(n,a){r.exports=a()})(_e,function(){for(var n=function(y,b,w){return b===void 0&&(b=0),w===void 0&&(w=1),y<b?b:y>w?w:y},a=n,l=function(y){y._clipped=!1,y._unclipped=y.slice(0);for(var b=0;b<=3;b++)b<3?((y[b]<0||y[b]>255)&&(y._clipped=!0),y[b]=a(y[b],0,255)):b===3&&(y[b]=a(y[b],0,1));return y},f={},h=0,v=["Boolean","Number","String","Function","Array","Date","RegExp","Undefined","Null"];h<v.length;h+=1){var d=v[h];f["[object "+d+"]"]=d.toLowerCase()}var p=function(y){return f[Object.prototype.toString.call(y)]||"object"},S=p,E=function(y,b){return b===void 0&&(b=null),y.length>=3?Array.prototype.slice.call(y):S(y[0])=="object"&&b?b.split("").filter(function(w){return y[0][w]!==void 0}).map(function(w){return y[0][w]}):y[0]},A=p,O=function(y){if(y.length<2)return null;var b=y.length-1;return A(y[b])=="string"?y[b].toLowerCase():null},k=Math.PI,T={clip_rgb:l,limit:n,type:p,unpack:E,last:O,PI:k,TWOPI:k*2,PITHIRD:k/3,DEG2RAD:k/180,RAD2DEG:180/k},x={format:{},autodetect:[]},G=T.last,j=T.clip_rgb,B=T.type,U=x,J=function(){for(var b=[],w=arguments.length;w--;)b[w]=arguments[w];var N=this;if(B(b[0])==="object"&&b[0].constructor&&b[0].constructor===this.constructor)return b[0];var W=G(b),H=!1;if(!W){H=!0,U.sorted||(U.autodetect=U.autodetect.sort(function(ce,Re){return Re.p-ce.p}),U.sorted=!0);for(var $=0,V=U.autodetect;$<V.length;$+=1){var Z=V[$];if(W=Z.test.apply(Z,b),W)break}}if(U.format[W]){var ae=U.format[W].apply(null,H?b:b.slice(0,-1));N._rgb=j(ae)}else throw new Error("unknown format: "+b);N._rgb.length===3&&N._rgb.push(1)};J.prototype.toString=function(){return B(this.hex)=="function"?this.hex():"["+this._rgb.join(",")+"]"};var P=J,I=function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];return new(Function.prototype.bind.apply(I.Color,[null].concat(y)))};I.Color=P,I.version="2.4.2";var D=I,R=T.unpack,Y=Math.max,re=function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];var w=R(y,"rgb"),N=w[0],W=w[1],H=w[2];N=N/255,W=W/255,H=H/255;var $=1-Y(N,Y(W,H)),V=$<1?1/(1-$):0,Z=(1-N-$)*V,ae=(1-W-$)*V,ce=(1-H-$)*V;return[Z,ae,ce,$]},se=re,Q=T.unpack,q=function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];y=Q(y,"cmyk");var w=y[0],N=y[1],W=y[2],H=y[3],$=y.length>4?y[4]:1;return H===1?[0,0,0,$]:[w>=1?0:255*(1-w)*(1-H),N>=1?0:255*(1-N)*(1-H),W>=1?0:255*(1-W)*(1-H),$]},Ce=q,K=D,ne=P,te=x,pe=T.unpack,le=T.type,Ee=se;ne.prototype.cmyk=function(){return Ee(this._rgb)},K.cmyk=function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];return new(Function.prototype.bind.apply(ne,[null].concat(y,["cmyk"])))},te.format.cmyk=Ce,te.autodetect.push({p:2,test:function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];if(y=pe(y,"cmyk"),le(y)==="array"&&y.length===4)return"cmyk"}});var Be=T.unpack,Ke=T.last,Ne=function(y){return Math.round(y*100)/100},Ye=function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];var w=Be(y,"hsla"),N=Ke(y)||"lsa";return w[0]=Ne(w[0]||0),w[1]=Ne(w[1]*100)+"%",w[2]=Ne(w[2]*100)+"%",N==="hsla"||w.length>3&&w[3]<1?(w[3]=w.length>3?w[3]:1,N="hsla"):w.length=3,N+"("+w.join(",")+")"},Ue=Ye,Xe=T.unpack,lt=function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];y=Xe(y,"rgba");var w=y[0],N=y[1],W=y[2];w/=255,N/=255,W/=255;var H=Math.min(w,N,W),$=Math.max(w,N,W),V=($+H)/2,Z,ae;return $===H?(Z=0,ae=Number.NaN):Z=V<.5?($-H)/($+H):($-H)/(2-$-H),w==$?ae=(N-W)/($-H):N==$?ae=2+(W-w)/($-H):W==$&&(ae=4+(w-N)/($-H)),ae*=60,ae<0&&(ae+=360),y.length>3&&y[3]!==void 0?[ae,Z,V,y[3]]:[ae,Z,V]},ht=lt,Tt=T.unpack,Ft=T.last,mr=Ue,$t=ht,Gt=Math.round,Ve=function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];var w=Tt(y,"rgba"),N=Ft(y)||"rgb";return N.substr(0,3)=="hsl"?mr($t(w),N):(w[0]=Gt(w[0]),w[1]=Gt(w[1]),w[2]=Gt(w[2]),(N==="rgba"||w.length>3&&w[3]<1)&&(w[3]=w.length>3?w[3]:1,N="rgba"),N+"("+w.slice(0,N==="rgb"?3:4).join(",")+")")},Pr=Ve,rn=T.unpack,sr=Math.round,Tr=function(){for(var y,b=[],w=arguments.length;w--;)b[w]=arguments[w];b=rn(b,"hsl");var N=b[0],W=b[1],H=b[2],$,V,Z;if(W===0)$=V=Z=H*255;else{var ae=[0,0,0],ce=[0,0,0],Re=H<.5?H*(1+W):H+W-H*W,de=2*H-Re,Ie=N/360;ae[0]=Ie+1/3,ae[1]=Ie,ae[2]=Ie-1/3;for(var Le=0;Le<3;Le++)ae[Le]<0&&(ae[Le]+=1),ae[Le]>1&&(ae[Le]-=1),6*ae[Le]<1?ce[Le]=de+(Re-de)*6*ae[Le]:2*ae[Le]<1?ce[Le]=Re:3*ae[Le]<2?ce[Le]=de+(Re-de)*(2/3-ae[Le])*6:ce[Le]=de;y=[sr(ce[0]*255),sr(ce[1]*255),sr(ce[2]*255)],$=y[0],V=y[1],Z=y[2]}return b.length>3?[$,V,Z,b[3]]:[$,V,Z,1]},nn=Tr,an=nn,Cr=x,yn=/^rgb\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*\)$/,mn=/^rgba\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*,\s*([01]|[01]?\.\d+)\)$/,qr=/^rgb\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,on=/^rgba\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,Xt=/^hsl\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,ue=/^hsla\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,he=Math.round,ge=function(y){y=y.toLowerCase().trim();var b;if(Cr.format.named)try{return Cr.format.named(y)}catch{}if(b=y.match(yn)){for(var w=b.slice(1,4),N=0;N<3;N++)w[N]=+w[N];return w[3]=1,w}if(b=y.match(mn)){for(var W=b.slice(1,5),H=0;H<4;H++)W[H]=+W[H];return W}if(b=y.match(qr)){for(var $=b.slice(1,4),V=0;V<3;V++)$[V]=he($[V]*2.55);return $[3]=1,$}if(b=y.match(on)){for(var Z=b.slice(1,5),ae=0;ae<3;ae++)Z[ae]=he(Z[ae]*2.55);return Z[3]=+Z[3],Z}if(b=y.match(Xt)){var ce=b.slice(1,4);ce[1]*=.01,ce[2]*=.01;var Re=an(ce);return Re[3]=1,Re}if(b=y.match(ue)){var de=b.slice(1,4);de[1]*=.01,de[2]*=.01;var Ie=an(de);return Ie[3]=+b[4],Ie}};ge.test=function(y){return yn.test(y)||mn.test(y)||qr.test(y)||on.test(y)||Xt.test(y)||ue.test(y)};var Se=ge,Te=D,Fe=P,be=x,ct=T.type,it=Pr,ot=Se;Fe.prototype.css=function(y){return it(this._rgb,y)},Te.css=function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];return new(Function.prototype.bind.apply(Fe,[null].concat(y,["css"])))},be.format.css=ot,be.autodetect.push({p:5,test:function(y){for(var b=[],w=arguments.length-1;w-- >0;)b[w]=arguments[w+1];if(!b.length&&ct(y)==="string"&&ot.test(y))return"css"}});var yt=P,Br=D,ir=x,Ur=T.unpack;ir.format.gl=function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];var w=Ur(y,"rgba");return w[0]*=255,w[1]*=255,w[2]*=255,w},Br.gl=function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];return new(Function.prototype.bind.apply(yt,[null].concat(y,["gl"])))},yt.prototype.gl=function(){var y=this._rgb;return[y[0]/255,y[1]/255,y[2]/255,y[3]]};var xt=T.unpack,Hr=function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];var w=xt(y,"rgb"),N=w[0],W=w[1],H=w[2],$=Math.min(N,W,H),V=Math.max(N,W,H),Z=V-$,ae=Z*100/255,ce=$/(255-Z)*100,Re;return Z===0?Re=Number.NaN:(N===V&&(Re=(W-H)/Z),W===V&&(Re=2+(H-N)/Z),H===V&&(Re=4+(N-W)/Z),Re*=60,Re<0&&(Re+=360)),[Re,ae,ce]},Nt=Hr,Er=T.unpack,at=Math.floor,$e=function(){for(var y,b,w,N,W,H,$=[],V=arguments.length;V--;)$[V]=arguments[V];$=Er($,"hcg");var Z=$[0],ae=$[1],ce=$[2],Re,de,Ie;ce=ce*255;var Le=ae*255;if(ae===0)Re=de=Ie=ce;else{Z===360&&(Z=0),Z>360&&(Z-=360),Z<0&&(Z+=360),Z/=60;var Ze=at(Z),Qe=Z-Ze,et=ce*(1-ae),ft=et+Le*(1-Qe),Jt=et+Le*Qe,Kt=et+Le;switch(Ze){case 0:y=[Kt,Jt,et],Re=y[0],de=y[1],Ie=y[2];break;case 1:b=[ft,Kt,et],Re=b[0],de=b[1],Ie=b[2];break;case 2:w=[et,Kt,Jt],Re=w[0],de=w[1],Ie=w[2];break;case 3:N=[et,ft,Kt],Re=N[0],de=N[1],Ie=N[2];break;case 4:W=[Jt,et,Kt],Re=W[0],de=W[1],Ie=W[2];break;case 5:H=[Kt,et,ft],Re=H[0],de=H[1],Ie=H[2];break}}return[Re,de,Ie,$.length>3?$[3]:1]},Wt=$e,_n=T.unpack,Wi=T.type,Bi=D,va=P,sn=x,Cs=Nt;va.prototype.hcg=function(){return Cs(this._rgb)},Bi.hcg=function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];return new(Function.prototype.bind.apply(va,[null].concat(y,["hcg"])))},sn.format.hcg=Wt,sn.autodetect.push({p:1,test:function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];if(y=_n(y,"hcg"),Wi(y)==="array"&&y.length===3)return"hcg"}});var pa=T.unpack,Es=T.last,so=Math.round,As=function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];var w=pa(y,"rgba"),N=w[0],W=w[1],H=w[2],$=w[3],V=Es(y)||"auto";$===void 0&&($=1),V==="auto"&&(V=$<1?"rgba":"rgb"),N=so(N),W=so(W),H=so(H);var Z=N<<16|W<<8|H,ae="000000"+Z.toString(16);ae=ae.substr(ae.length-6);var ce="0"+so($*255).toString(16);switch(ce=ce.substr(ce.length-2),V.toLowerCase()){case"rgba":return"#"+ae+ce;case"argb":return"#"+ce+ae;default:return"#"+ae}},pi=As,oc=/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,sc=/^#?([A-Fa-f0-9]{8}|[A-Fa-f0-9]{4})$/,lo=function(y){if(y.match(oc)){(y.length===4||y.length===7)&&(y=y.substr(1)),y.length===3&&(y=y.split(""),y=y[0]+y[0]+y[1]+y[1]+y[2]+y[2]);var b=parseInt(y,16),w=b>>16,N=b>>8&255,W=b&255;return[w,N,W,1]}if(y.match(sc)){(y.length===5||y.length===9)&&(y=y.substr(1)),y.length===4&&(y=y.split(""),y=y[0]+y[0]+y[1]+y[1]+y[2]+y[2]+y[3]+y[3]);var H=parseInt(y,16),$=H>>24&255,V=H>>16&255,Z=H>>8&255,ae=Math.round((H&255)/255*100)/100;return[$,V,Z,ae]}throw new Error("unknown hex color: "+y)},uo=lo,Ui=D,du=P,gi=T.type,fo=x,vu=pi;du.prototype.hex=function(y){return vu(this._rgb,y)},Ui.hex=function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];return new(Function.prototype.bind.apply(du,[null].concat(y,["hex"])))},fo.format.hex=uo,fo.autodetect.push({p:4,test:function(y){for(var b=[],w=arguments.length-1;w-- >0;)b[w]=arguments[w+1];if(!b.length&&gi(y)==="string"&&[3,4,5,6,7,8,9].indexOf(y.length)>=0)return"hex"}});var Bt=T.unpack,Me=T.TWOPI,yi=Math.min,ws=Math.sqrt,ln=Math.acos,pt=function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];var w=Bt(y,"rgb"),N=w[0],W=w[1],H=w[2];N/=255,W/=255,H/=255;var $,V=yi(N,W,H),Z=(N+W+H)/3,ae=Z>0?1-V/Z:0;return ae===0?$=NaN:($=(N-W+(N-H))/2,$/=ws((N-W)*(N-W)+(N-H)*(W-H)),$=ln($),H>W&&($=Me-$),$/=Me),[$*360,ae,Z]},mi=pt,ga=T.unpack,ya=T.limit,fe=T.TWOPI,ze=T.PITHIRD,Bn=Math.cos,ks=function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];y=ga(y,"hsi");var w=y[0],N=y[1],W=y[2],H,$,V;return isNaN(w)&&(w=0),isNaN(N)&&(N=0),w>360&&(w-=360),w<0&&(w+=360),w/=360,w<1/3?(V=(1-N)/3,H=(1+N*Bn(fe*w)/Bn(ze-fe*w))/3,$=1-(V+H)):w<2/3?(w-=1/3,H=(1-N)/3,$=(1+N*Bn(fe*w)/Bn(ze-fe*w))/3,V=1-(H+$)):(w-=2/3,$=(1-N)/3,V=(1+N*Bn(fe*w)/Bn(ze-fe*w))/3,H=1-($+V)),H=ya(W*H*3),$=ya(W*$*3),V=ya(W*V*3),[H*255,$*255,V*255,y.length>3?y[3]:1]},ho=ks,co=T.unpack,pu=T.type,je=D,gu=P,Os=x,vo=mi;gu.prototype.hsi=function(){return vo(this._rgb)},je.hsi=function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];return new(Function.prototype.bind.apply(gu,[null].concat(y,["hsi"])))},Os.format.hsi=ho,Os.autodetect.push({p:2,test:function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];if(y=co(y,"hsi"),pu(y)==="array"&&y.length===3)return"hsi"}});var un=T.unpack,yu=T.type,mu=D,Hi=P,po=x,_u=ht;Hi.prototype.hsl=function(){return _u(this._rgb)},mu.hsl=function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];return new(Function.prototype.bind.apply(Hi,[null].concat(y,["hsl"])))},po.format.hsl=nn,po.autodetect.push({p:2,test:function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];if(y=un(y,"hsl"),yu(y)==="array"&&y.length===3)return"hsl"}});var xs=T.unpack,bu=Math.min,Su=Math.max,Tu=function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];y=xs(y,"rgb");var w=y[0],N=y[1],W=y[2],H=bu(w,N,W),$=Su(w,N,W),V=$-H,Z,ae,ce;return ce=$/255,$===0?(Z=Number.NaN,ae=0):(ae=V/$,w===$&&(Z=(N-W)/V),N===$&&(Z=2+(W-w)/V),W===$&&(Z=4+(w-N)/V),Z*=60,Z<0&&(Z+=360)),[Z,ae,ce]},Cu=Tu,lc=T.unpack,uc=Math.floor,Eu=function(){for(var y,b,w,N,W,H,$=[],V=arguments.length;V--;)$[V]=arguments[V];$=lc($,"hsv");var Z=$[0],ae=$[1],ce=$[2],Re,de,Ie;if(ce*=255,ae===0)Re=de=Ie=ce;else{Z===360&&(Z=0),Z>360&&(Z-=360),Z<0&&(Z+=360),Z/=60;var Le=uc(Z),Ze=Z-Le,Qe=ce*(1-ae),et=ce*(1-ae*Ze),ft=ce*(1-ae*(1-Ze));switch(Le){case 0:y=[ce,ft,Qe],Re=y[0],de=y[1],Ie=y[2];break;case 1:b=[et,ce,Qe],Re=b[0],de=b[1],Ie=b[2];break;case 2:w=[Qe,ce,ft],Re=w[0],de=w[1],Ie=w[2];break;case 3:N=[Qe,et,ce],Re=N[0],de=N[1],Ie=N[2];break;case 4:W=[ft,Qe,ce],Re=W[0],de=W[1],Ie=W[2];break;case 5:H=[ce,Qe,et],Re=H[0],de=H[1],Ie=H[2];break}}return[Re,de,Ie,$.length>3?$[3]:1]},bn=Eu,fc=T.unpack,hc=T.type,go=D,zi=P,Au=x,cc=Cu;zi.prototype.hsv=function(){return cc(this._rgb)},go.hsv=function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];return new(Function.prototype.bind.apply(zi,[null].concat(y,["hsv"])))},Au.format.hsv=bn,Au.autodetect.push({p:2,test:function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];if(y=fc(y,"hsv"),hc(y)==="array"&&y.length===3)return"hsv"}});var yo={Kn:18,Xn:.95047,Yn:1,Zn:1.08883,t0:.137931034,t1:.206896552,t2:.12841855,t3:.008856452},ji=yo,Rs=T.unpack,Ps=Math.pow,dc=function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];var w=Rs(y,"rgb"),N=w[0],W=w[1],H=w[2],$=bo(N,W,H),V=$[0],Z=$[1],ae=$[2],ce=116*Z-16;return[ce<0?0:ce,500*(V-Z),200*(Z-ae)]},mo=function(y){return(y/=255)<=.04045?y/12.92:Ps((y+.055)/1.055,2.4)},_o=function(y){return y>ji.t3?Ps(y,1/3):y/ji.t2+ji.t0},bo=function(y,b,w){y=mo(y),b=mo(b),w=mo(w);var N=_o((.4124564*y+.3575761*b+.1804375*w)/ji.Xn),W=_o((.2126729*y+.7151522*b+.072175*w)/ji.Yn),H=_o((.0193339*y+.119192*b+.9503041*w)/ji.Zn);return[N,W,H]},ma=dc,Un=yo,wu=T.unpack,ku=Math.pow,So=function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];y=wu(y,"lab");var w=y[0],N=y[1],W=y[2],H,$,V,Z,ae,ce;return $=(w+16)/116,H=isNaN(N)?$:$+N/500,V=isNaN(W)?$:$-W/200,$=Un.Yn*To($),H=Un.Xn*To(H),V=Un.Zn*To(V),Z=Ls(3.2404542*H-1.5371385*$-.4985314*V),ae=Ls(-.969266*H+1.8760108*$+.041556*V),ce=Ls(.0556434*H-.2040259*$+1.0572252*V),[Z,ae,ce,y.length>3?y[3]:1]},Ls=function(y){return 255*(y<=.00304?12.92*y:1.055*ku(y,1/2.4)-.055)},To=function(y){return y>Un.t1?y*y*y:Un.t2*(y-Un.t0)},zr=So,vc=T.unpack,pc=T.type,Is=D,Ns=P,Sn=x,Ms=ma;Ns.prototype.lab=function(){return Ms(this._rgb)},Is.lab=function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];return new(Function.prototype.bind.apply(Ns,[null].concat(y,["lab"])))},Sn.format.lab=zr,Sn.autodetect.push({p:2,test:function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];if(y=vc(y,"lab"),pc(y)==="array"&&y.length===3)return"lab"}});var Tn=T.unpack,Co=T.RAD2DEG,Ds=Math.sqrt,Yi=Math.atan2,gc=Math.round,yc=function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];var w=Tn(y,"lab"),N=w[0],W=w[1],H=w[2],$=Ds(W*W+H*H),V=(Yi(H,W)*Co+360)%360;return gc($*1e4)===0&&(V=Number.NaN),[N,$,V]},Ou=yc,mc=T.unpack,xu=ma,Ru=Ou,_c=function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];var w=mc(y,"rgb"),N=w[0],W=w[1],H=w[2],$=xu(N,W,H),V=$[0],Z=$[1],ae=$[2];return Ru(V,Z,ae)},bc=_c,Sc=T.unpack,Tc=T.DEG2RAD,Pu=Math.sin,Cc=Math.cos,Lu=function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];var w=Sc(y,"lch"),N=w[0],W=w[1],H=w[2];return isNaN(H)&&(H=0),H=H*Tc,[N,Cc(H)*W,Pu(H)*W]},_a=Lu,Xi=T.unpack,Ec=_a,Ac=zr,wc=function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];y=Xi(y,"lch");var w=y[0],N=y[1],W=y[2],H=Ec(w,N,W),$=H[0],V=H[1],Z=H[2],ae=Ac($,V,Z),ce=ae[0],Re=ae[1],de=ae[2];return[ce,Re,de,y.length>3?y[3]:1]},Ki=wc,Vt=T.unpack,kc=Ki,Iu=function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];var w=Vt(y,"hcl").reverse();return kc.apply(void 0,w)},ba=Iu,Oc=T.unpack,Nu=T.type,Mu=D,qi=P,Eo=x,Du=bc;qi.prototype.lch=function(){return Du(this._rgb)},qi.prototype.hcl=function(){return Du(this._rgb).reverse()},Mu.lch=function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];return new(Function.prototype.bind.apply(qi,[null].concat(y,["lch"])))},Mu.hcl=function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];return new(Function.prototype.bind.apply(qi,[null].concat(y,["hcl"])))},Eo.format.lch=Ki,Eo.format.hcl=ba,["lch","hcl"].forEach(function(y){return Eo.autodetect.push({p:2,test:function(){for(var b=[],w=arguments.length;w--;)b[w]=arguments[w];if(b=Oc(b,y),Nu(b)==="array"&&b.length===3)return y}})});var xc={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflower:"#6495ed",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",laserlemon:"#ffff54",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrod:"#fafad2",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",maroon2:"#7f0000",maroon3:"#b03060",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",purple2:"#7f007f",purple3:"#a020f0",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},Fs=xc,Fu=P,$u=x,Sa=T.type,Lr=Fs,Ao=uo,$s=pi;Fu.prototype.name=function(){for(var y=$s(this._rgb,"rgb"),b=0,w=Object.keys(Lr);b<w.length;b+=1){var N=w[b];if(Lr[N]===y)return N.toLowerCase()}return y},$u.format.named=function(y){if(y=y.toLowerCase(),Lr[y])return Ao(Lr[y]);throw new Error("unknown color name: "+y)},$u.autodetect.push({p:5,test:function(y){for(var b=[],w=arguments.length-1;w-- >0;)b[w]=arguments[w+1];if(!b.length&&Sa(y)==="string"&&Lr[y.toLowerCase()])return"named"}});var Gu=T.unpack,fn=function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];var w=Gu(y,"rgb"),N=w[0],W=w[1],H=w[2];return(N<<16)+(W<<8)+H},_i=fn,Gs=T.type,Rc=function(y){if(Gs(y)=="number"&&y>=0&&y<=16777215){var b=y>>16,w=y>>8&255,N=y&255;return[b,w,N,1]}throw new Error("unknown num color: "+y)},Wu=Rc,Pc=D,Ws=P,wo=x,Vi=T.type,hn=_i;Ws.prototype.num=function(){return hn(this._rgb)},Pc.num=function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];return new(Function.prototype.bind.apply(Ws,[null].concat(y,["num"])))},wo.format.num=Wu,wo.autodetect.push({p:5,test:function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];if(y.length===1&&Vi(y[0])==="number"&&y[0]>=0&&y[0]<=16777215)return"num"}});var Bu=D,ko=P,Uu=x,Hu=T.unpack,zu=T.type,Bs=Math.round;ko.prototype.rgb=function(y){return y===void 0&&(y=!0),y===!1?this._rgb.slice(0,3):this._rgb.slice(0,3).map(Bs)},ko.prototype.rgba=function(y){return y===void 0&&(y=!0),this._rgb.slice(0,4).map(function(b,w){return w<3?y===!1?b:Bs(b):b})},Bu.rgb=function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];return new(Function.prototype.bind.apply(ko,[null].concat(y,["rgb"])))},Uu.format.rgb=function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];var w=Hu(y,"rgba");return w[3]===void 0&&(w[3]=1),w},Uu.autodetect.push({p:3,test:function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];if(y=Hu(y,"rgba"),zu(y)==="array"&&(y.length===3||y.length===4&&zu(y[3])=="number"&&y[3]>=0&&y[3]<=1))return"rgb"}});var Ta=Math.log,Ca=function(y){var b=y/100,w,N,W;return b<66?(w=255,N=b<6?0:-155.25485562709179-.44596950469579133*(N=b-2)+104.49216199393888*Ta(N),W=b<20?0:-254.76935184120902+.8274096064007395*(W=b-10)+115.67994401066147*Ta(W)):(w=351.97690566805693+.114206453784165*(w=b-55)-40.25366309332127*Ta(w),N=325.4494125711974+.07943456536662342*(N=b-50)-28.0852963507957*Ta(N),W=255),[w,N,W,1]},Us=Ca,ju=Us,Hs=T.unpack,Oo=Math.round,Yu=function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];for(var w=Hs(y,"rgb"),N=w[0],W=w[2],H=1e3,$=4e4,V=.4,Z;$-H>V;){Z=($+H)*.5;var ae=ju(Z);ae[2]/ae[0]>=W/N?$=Z:H=Z}return Oo(Z)},xo=Yu,Ir=D,Ea=P,Aa=x,zs=xo;Ea.prototype.temp=Ea.prototype.kelvin=Ea.prototype.temperature=function(){return zs(this._rgb)},Ir.temp=Ir.kelvin=Ir.temperature=function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];return new(Function.prototype.bind.apply(Ea,[null].concat(y,["temp"])))},Aa.format.temp=Aa.format.kelvin=Aa.format.temperature=Us;var Xu=T.unpack,Ro=Math.cbrt,js=Math.pow,Lc=Math.sign,Ic=function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];var w=Xu(y,"rgb"),N=w[0],W=w[1],H=w[2],$=[Cn(N/255),Cn(W/255),Cn(H/255)],V=$[0],Z=$[1],ae=$[2],ce=Ro(.4122214708*V+.5363325363*Z+.0514459929*ae),Re=Ro(.2119034982*V+.6806995451*Z+.1073969566*ae),de=Ro(.0883024619*V+.2817188376*Z+.6299787005*ae);return[.2104542553*ce+.793617785*Re-.0040720468*de,1.9779984951*ce-2.428592205*Re+.4505937099*de,.0259040371*ce+.7827717662*Re-.808675766*de]},Ku=Ic;function Cn(y){var b=Math.abs(y);return b<.04045?y/12.92:(Lc(y)||1)*js((b+.055)/1.055,2.4)}var Zi=T.unpack,En=Math.pow,Ys=Math.sign,Xs=function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];y=Zi(y,"lab");var w=y[0],N=y[1],W=y[2],H=En(w+.3963377774*N+.2158037573*W,3),$=En(w-.1055613458*N-.0638541728*W,3),V=En(w-.0894841775*N-1.291485548*W,3);return[255*wa(4.0767416621*H-3.3077115913*$+.2309699292*V),255*wa(-1.2684380046*H+2.6097574011*$-.3413193965*V),255*wa(-.0041960863*H-.7034186147*$+1.707614701*V),y.length>3?y[3]:1]},Ks=Xs;function wa(y){var b=Math.abs(y);return b>.0031308?(Ys(y)||1)*(1.055*En(b,1/2.4)-.055):y*12.92}var bi=T.unpack,Si=T.type,_r=D,An=P,wn=x,Po=Ku;An.prototype.oklab=function(){return Po(this._rgb)},_r.oklab=function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];return new(Function.prototype.bind.apply(An,[null].concat(y,["oklab"])))},wn.format.oklab=Ks,wn.autodetect.push({p:3,test:function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];if(y=bi(y,"oklab"),Si(y)==="array"&&y.length===3)return"oklab"}});var Nc=T.unpack,qu=Ku,ka=Ou,Vu=function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];var w=Nc(y,"rgb"),N=w[0],W=w[1],H=w[2],$=qu(N,W,H),V=$[0],Z=$[1],ae=$[2];return ka(V,Z,ae)},qs=Vu,Lo=T.unpack,Mc=_a,Vs=Ks,Zu=function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];y=Lo(y,"lch");var w=y[0],N=y[1],W=y[2],H=Mc(w,N,W),$=H[0],V=H[1],Z=H[2],ae=Vs($,V,Z),ce=ae[0],Re=ae[1],de=ae[2];return[ce,Re,de,y.length>3?y[3]:1]},Zs=Zu,Qs=T.unpack,Qi=T.type,Io=D,Js=P,Oa=x,Dc=qs;Js.prototype.oklch=function(){return Dc(this._rgb)},Io.oklch=function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];return new(Function.prototype.bind.apply(Js,[null].concat(y,["oklch"])))},Oa.format.oklch=Zs,Oa.autodetect.push({p:3,test:function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];if(y=Qs(y,"oklch"),Qi(y)==="array"&&y.length===3)return"oklch"}});var Qu=P,Fc=T.type;Qu.prototype.alpha=function(y,b){return b===void 0&&(b=!1),y!==void 0&&Fc(y)==="number"?b?(this._rgb[3]=y,this):new Qu([this._rgb[0],this._rgb[1],this._rgb[2],y],"rgb"):this._rgb[3]};var el=P;el.prototype.clipped=function(){return this._rgb._clipped||!1};var kn=P,Ji=yo;kn.prototype.darken=function(y){y===void 0&&(y=1);var b=this,w=b.lab();return w[0]-=Ji.Kn*y,new kn(w,"lab").alpha(b.alpha(),!0)},kn.prototype.brighten=function(y){return y===void 0&&(y=1),this.darken(-y)},kn.prototype.darker=kn.prototype.darken,kn.prototype.brighter=kn.prototype.brighten;var xa=P;xa.prototype.get=function(y){var b=y.split("."),w=b[0],N=b[1],W=this[w]();if(N){var H=w.indexOf(N)-(w.substr(0,2)==="ok"?2:0);if(H>-1)return W[H];throw new Error("unknown channel "+N+" in mode "+w)}else return W};var ea=P,No=T.type,Ju=Math.pow,Ra=1e-7,ef=20;ea.prototype.luminance=function(y){if(y!==void 0&&No(y)==="number"){if(y===0)return new ea([0,0,0,this._rgb[3]],"rgb");if(y===1)return new ea([255,255,255,this._rgb[3]],"rgb");var b=this.luminance(),w="rgb",N=ef,W=function($,V){var Z=$.interpolate(V,.5,w),ae=Z.luminance();return Math.abs(y-ae)<Ra||!N--?Z:ae>y?W($,Z):W(Z,V)},H=(b>y?W(new ea([0,0,0]),this):W(this,new ea([255,255,255]))).rgb();return new ea(H.concat([this._rgb[3]]))}return Ti.apply(void 0,this._rgb.slice(0,3))};var Ti=function(y,b,w){return y=Ci(y),b=Ci(b),w=Ci(w),.2126*y+.7152*b+.0722*w},Ci=function(y){return y/=255,y<=.03928?y/12.92:Ju((y+.055)/1.055,2.4)},Zt={},ta=P,Ei=T.type,Pa=Zt,tl=function(y,b,w){w===void 0&&(w=.5);for(var N=[],W=arguments.length-3;W-- >0;)N[W]=arguments[W+3];var H=N[0]||"lrgb";if(!Pa[H]&&!N.length&&(H=Object.keys(Pa)[0]),!Pa[H])throw new Error("interpolation mode "+H+" is not defined");return Ei(y)!=="object"&&(y=new ta(y)),Ei(b)!=="object"&&(b=new ta(b)),Pa[H](y,b,w).alpha(y.alpha()+w*(b.alpha()-y.alpha()))},rl=P,$c=tl;rl.prototype.mix=rl.prototype.interpolate=function(y,b){b===void 0&&(b=.5);for(var w=[],N=arguments.length-2;N-- >0;)w[N]=arguments[N+2];return $c.apply(void 0,[this,y,b].concat(w))};var Hn=P;Hn.prototype.premultiply=function(y){y===void 0&&(y=!1);var b=this._rgb,w=b[3];return y?(this._rgb=[b[0]*w,b[1]*w,b[2]*w,w],this):new Hn([b[0]*w,b[1]*w,b[2]*w,w],"rgb")};var On=P,Gc=yo;On.prototype.saturate=function(y){y===void 0&&(y=1);var b=this,w=b.lch();return w[1]+=Gc.Kn*y,w[1]<0&&(w[1]=0),new On(w,"lch").alpha(b.alpha(),!0)},On.prototype.desaturate=function(y){return y===void 0&&(y=1),this.saturate(-y)};var tf=P,rf=T.type;tf.prototype.set=function(y,b,w){w===void 0&&(w=!1);var N=y.split("."),W=N[0],H=N[1],$=this[W]();if(H){var V=W.indexOf(H)-(W.substr(0,2)==="ok"?2:0);if(V>-1){if(rf(b)=="string")switch(b.charAt(0)){case"+":$[V]+=+b;break;case"-":$[V]+=+b;break;case"*":$[V]*=+b.substr(1);break;case"/":$[V]/=+b.substr(1);break;default:$[V]=+b}else if(rf(b)==="number")$[V]=b;else throw new Error("unsupported value for Color.set");var Z=new tf($,W);return w?(this._rgb=Z._rgb,this):Z}throw new Error("unknown channel "+H+" in mode "+W)}else return $};var Wc=P,Bc=function(y,b,w){var N=y._rgb,W=b._rgb;return new Wc(N[0]+w*(W[0]-N[0]),N[1]+w*(W[1]-N[1]),N[2]+w*(W[2]-N[2]),"rgb")};Zt.rgb=Bc;var Uc=P,vr=Math.sqrt,Rt=Math.pow,pr=function(y,b,w){var N=y._rgb,W=N[0],H=N[1],$=N[2],V=b._rgb,Z=V[0],ae=V[1],ce=V[2];return new Uc(vr(Rt(W,2)*(1-w)+Rt(Z,2)*w),vr(Rt(H,2)*(1-w)+Rt(ae,2)*w),vr(Rt($,2)*(1-w)+Rt(ce,2)*w),"rgb")};Zt.lrgb=pr;var Qt=P,La=function(y,b,w){var N=y.lab(),W=b.lab();return new Qt(N[0]+w*(W[0]-N[0]),N[1]+w*(W[1]-N[1]),N[2]+w*(W[2]-N[2]),"lab")};Zt.lab=La;var nf=P,xn=function(y,b,w,N){var W,H,$,V;N==="hsl"?($=y.hsl(),V=b.hsl()):N==="hsv"?($=y.hsv(),V=b.hsv()):N==="hcg"?($=y.hcg(),V=b.hcg()):N==="hsi"?($=y.hsi(),V=b.hsi()):N==="lch"||N==="hcl"?(N="hcl",$=y.hcl(),V=b.hcl()):N==="oklch"&&($=y.oklch().reverse(),V=b.oklch().reverse());var Z,ae,ce,Re,de,Ie;(N.substr(0,1)==="h"||N==="oklch")&&(W=$,Z=W[0],ce=W[1],de=W[2],H=V,ae=H[0],Re=H[1],Ie=H[2]);var Le,Ze,Qe,et;return!isNaN(Z)&&!isNaN(ae)?(ae>Z&&ae-Z>180?et=ae-(Z+360):ae<Z&&Z-ae>180?et=ae+360-Z:et=ae-Z,Ze=Z+w*et):isNaN(Z)?isNaN(ae)?Ze=Number.NaN:(Ze=ae,(de==1||de==0)&&N!="hsv"&&(Le=Re)):(Ze=Z,(Ie==1||Ie==0)&&N!="hsv"&&(Le=ce)),Le===void 0&&(Le=ce+w*(Re-ce)),Qe=de+w*(Ie-de),N==="oklch"?new nf([Qe,Le,Ze],N):new nf([Ze,Le,Qe],N)},Hc=xn,af=function(y,b,w){return Hc(y,b,w,"lch")};Zt.lch=af,Zt.hcl=af;var zc=P,nl=function(y,b,w){var N=y.num(),W=b.num();return new zc(N+w*(W-N),"num")};Zt.num=nl;var of=xn,il=function(y,b,w){return of(y,b,w,"hcg")};Zt.hcg=il;var jc=xn,al=function(y,b,w){return jc(y,b,w,"hsi")};Zt.hsi=al;var ol=xn,sf=function(y,b,w){return ol(y,b,w,"hsl")};Zt.hsl=sf;var lf=xn,sl=function(y,b,w){return lf(y,b,w,"hsv")};Zt.hsv=sl;var uf=P,Ia=function(y,b,w){var N=y.oklab(),W=b.oklab();return new uf(N[0]+w*(W[0]-N[0]),N[1]+w*(W[1]-N[1]),N[2]+w*(W[2]-N[2]),"oklab")};Zt.oklab=Ia;var Yc=xn,Mo=function(y,b,w){return Yc(y,b,w,"oklch")};Zt.oklch=Mo;var Vr=P,ff=T.clip_rgb,ll=Math.pow,Do=Math.sqrt,br=Math.PI,ut=Math.cos,jr=Math.sin,zn=Math.atan2,jn=function(y,b,w){b===void 0&&(b="lrgb"),w===void 0&&(w=null);var N=y.length;w||(w=Array.from(new Array(N)).map(function(){return 1}));var W=N/w.reduce(function(Ze,Qe){return Ze+Qe});if(w.forEach(function(Ze,Qe){w[Qe]*=W}),y=y.map(function(Ze){return new Vr(Ze)}),b==="lrgb")return hf(y,w);for(var H=y.shift(),$=H.get(b),V=[],Z=0,ae=0,ce=0;ce<$.length;ce++)if($[ce]=($[ce]||0)*w[0],V.push(isNaN($[ce])?0:w[0]),b.charAt(ce)==="h"&&!isNaN($[ce])){var Re=$[ce]/180*br;Z+=ut(Re)*w[0],ae+=jr(Re)*w[0]}var de=H.alpha()*w[0];y.forEach(function(Ze,Qe){var et=Ze.get(b);de+=Ze.alpha()*w[Qe+1];for(var ft=0;ft<$.length;ft++)if(!isNaN(et[ft]))if(V[ft]+=w[Qe+1],b.charAt(ft)==="h"){var Jt=et[ft]/180*br;Z+=ut(Jt)*w[Qe+1],ae+=jr(Jt)*w[Qe+1]}else $[ft]+=et[ft]*w[Qe+1]});for(var Ie=0;Ie<$.length;Ie++)if(b.charAt(Ie)==="h"){for(var Le=zn(ae/V[Ie],Z/V[Ie])/br*180;Le<0;)Le+=360;for(;Le>=360;)Le-=360;$[Ie]=Le}else $[Ie]=$[Ie]/V[Ie];return de/=N,new Vr($,b).alpha(de>.99999?1:de,!0)},hf=function(y,b){for(var w=y.length,N=[0,0,0,0],W=0;W<y.length;W++){var H=y[W],$=b[W]/w,V=H._rgb;N[0]+=ll(V[0],2)*$,N[1]+=ll(V[1],2)*$,N[2]+=ll(V[2],2)*$,N[3]+=V[3]*$}return N[0]=Do(N[0]),N[1]=Do(N[1]),N[2]=Do(N[2]),N[3]>.9999999&&(N[3]=1),new Vr(ff(N))},Nr=D,Ai=T.type,Xc=Math.pow,Na=function(y){var b="rgb",w=Nr("#ccc"),N=0,W=[0,1],H=[],$=[0,0],V=!1,Z=[],ae=!1,ce=0,Re=1,de=!1,Ie={},Le=!0,Ze=1,Qe=function(ye){if(ye=ye||["#fff","#000"],ye&&Ai(ye)==="string"&&Nr.brewer&&Nr.brewer[ye.toLowerCase()]&&(ye=Nr.brewer[ye.toLowerCase()]),Ai(ye)==="array"){ye.length===1&&(ye=[ye[0],ye[0]]),ye=ye.slice(0);for(var He=0;He<ye.length;He++)ye[He]=Nr(ye[He]);H.length=0;for(var rt=0;rt<ye.length;rt++)H.push(rt/(ye.length-1))}return kr(),Z=ye},et=function(ye){if(V!=null){for(var He=V.length-1,rt=0;rt<He&&ye>=V[rt];)rt++;return rt-1}return 0},ft=function(ye){return ye},Jt=function(ye){return ye},Kt=function(ye,He){var rt,qe;if(He==null&&(He=!1),isNaN(ye)||ye===null)return w;if(He)qe=ye;else if(V&&V.length>2){var fr=et(ye);qe=fr/(V.length-2)}else Re!==ce?qe=(ye-ce)/(Re-ce):qe=1;qe=Jt(qe),He||(qe=ft(qe)),Ze!==1&&(qe=Xc(qe,Ze)),qe=$[0]+qe*(1-$[0]-$[1]),qe=Math.min(1,Math.max(0,qe));var Et=Math.floor(qe*1e4);if(Le&&Ie[Et])rt=Ie[Et];else{if(Ai(Z)==="array")for(var nt=0;nt<H.length;nt++){var dt=H[nt];if(qe<=dt){rt=Z[nt];break}if(qe>=dt&&nt===H.length-1){rt=Z[nt];break}if(qe>dt&&qe<H[nt+1]){qe=(qe-dt)/(H[nt+1]-dt),rt=Nr.interpolate(Z[nt],Z[nt+1],qe,b);break}}else Ai(Z)==="function"&&(rt=Z(qe));Le&&(Ie[Et]=rt)}return rt},kr=function(){return Ie={}};Qe(y);var tt=function(ye){var He=Nr(Kt(ye));return ae&&He[ae]?He[ae]():He};return tt.classes=function(ye){if(ye!=null){if(Ai(ye)==="array")V=ye,W=[ye[0],ye[ye.length-1]];else{var He=Nr.analyze(W);ye===0?V=[He.min,He.max]:V=Nr.limits(He,"e",ye)}return tt}return V},tt.domain=function(ye){if(!arguments.length)return W;ce=ye[0],Re=ye[ye.length-1],H=[];var He=Z.length;if(ye.length===He&&ce!==Re)for(var rt=0,qe=Array.from(ye);rt<qe.length;rt+=1){var fr=qe[rt];H.push((fr-ce)/(Re-ce))}else{for(var Et=0;Et<He;Et++)H.push(Et/(He-1));if(ye.length>2){var nt=ye.map(function(vt,mt){return mt/(ye.length-1)}),dt=ye.map(function(vt){return(vt-ce)/(Re-ce)});dt.every(function(vt,mt){return nt[mt]===vt})||(Jt=function(vt){if(vt<=0||vt>=1)return vt;for(var mt=0;vt>=dt[mt+1];)mt++;var Mr=(vt-dt[mt])/(dt[mt+1]-dt[mt]),Ln=nt[mt]+Mr*(nt[mt+1]-nt[mt]);return Ln})}}return W=[ce,Re],tt},tt.mode=function(ye){return arguments.length?(b=ye,kr(),tt):b},tt.range=function(ye,He){return Qe(ye),tt},tt.out=function(ye){return ae=ye,tt},tt.spread=function(ye){return arguments.length?(N=ye,tt):N},tt.correctLightness=function(ye){return ye==null&&(ye=!0),de=ye,kr(),de?ft=function(He){for(var rt=Kt(0,!0).lab()[0],qe=Kt(1,!0).lab()[0],fr=rt>qe,Et=Kt(He,!0).lab()[0],nt=rt+(qe-rt)*He,dt=Et-nt,vt=0,mt=1,Mr=20;Math.abs(dt)>.01&&Mr-- >0;)(function(){return fr&&(dt*=-1),dt<0?(vt=He,He+=(mt-He)*.5):(mt=He,He+=(vt-He)*.5),Et=Kt(He,!0).lab()[0],dt=Et-nt})();return He}:ft=function(He){return He},tt},tt.padding=function(ye){return ye!=null?(Ai(ye)==="number"&&(ye=[ye,ye]),$=ye,tt):$},tt.colors=function(ye,He){arguments.length<2&&(He="hex");var rt=[];if(arguments.length===0)rt=Z.slice(0);else if(ye===1)rt=[tt(.5)];else if(ye>1){var qe=W[0],fr=W[1]-qe;rt=Ma(0,ye,!1).map(function(mt){return tt(qe+mt/(ye-1)*fr)})}else{y=[];var Et=[];if(V&&V.length>2)for(var nt=1,dt=V.length,vt=1<=dt;vt?nt<dt:nt>dt;vt?nt++:nt--)Et.push((V[nt-1]+V[nt])*.5);else Et=W;rt=Et.map(function(mt){return tt(mt)})}return Nr[He]&&(rt=rt.map(function(mt){return mt[He]()})),rt},tt.cache=function(ye){return ye!=null?(Le=ye,tt):Le},tt.gamma=function(ye){return ye!=null?(Ze=ye,tt):Ze},tt.nodata=function(ye){return ye!=null?(w=Nr(ye),tt):w},tt};function Ma(y,b,w){for(var N=[],W=y<b,H=w?W?b+1:b-1:b,$=y;W?$<H:$>H;W?$++:$--)N.push($);return N}var ra=P,ul=Na,Yn=function(y){for(var b=[1,1],w=1;w<y;w++){for(var N=[1],W=1;W<=b.length;W++)N[W]=(b[W]||0)+b[W-1];b=N}return b},cf=function(y){var b,w,N,W,H,$,V;if(y=y.map(function(de){return new ra(de)}),y.length===2)b=y.map(function(de){return de.lab()}),H=b[0],$=b[1],W=function(de){var Ie=[0,1,2].map(function(Le){return H[Le]+de*($[Le]-H[Le])});return new ra(Ie,"lab")};else if(y.length===3)w=y.map(function(de){return de.lab()}),H=w[0],$=w[1],V=w[2],W=function(de){var Ie=[0,1,2].map(function(Le){return(1-de)*(1-de)*H[Le]+2*(1-de)*de*$[Le]+de*de*V[Le]});return new ra(Ie,"lab")};else if(y.length===4){var Z;N=y.map(function(de){return de.lab()}),H=N[0],$=N[1],V=N[2],Z=N[3],W=function(de){var Ie=[0,1,2].map(function(Le){return(1-de)*(1-de)*(1-de)*H[Le]+3*(1-de)*(1-de)*de*$[Le]+3*(1-de)*de*de*V[Le]+de*de*de*Z[Le]});return new ra(Ie,"lab")}}else if(y.length>=5){var ae,ce,Re;ae=y.map(function(de){return de.lab()}),Re=y.length-1,ce=Yn(Re),W=function(de){var Ie=1-de,Le=[0,1,2].map(function(Ze){return ae.reduce(function(Qe,et,ft){return Qe+ce[ft]*Math.pow(Ie,Re-ft)*Math.pow(de,ft)*et[Ze]},0)});return new ra(Le,"lab")}}else throw new RangeError("No point in running bezier with only one color.");return W},df=function(y){var b=cf(y);return b.scale=function(){return ul(b)},b},fl=D,Ar=function(y,b,w){if(!Ar[w])throw new Error("unknown blend mode "+w);return Ar[w](y,b)},cn=function(y){return function(b,w){var N=fl(w).rgb(),W=fl(b).rgb();return fl.rgb(y(N,W))}},Rn=function(y){return function(b,w){var N=[];return N[0]=y(b[0],w[0]),N[1]=y(b[1],w[1]),N[2]=y(b[2],w[2]),N}},Kc=function(y){return y},vf=function(y,b){return y*b/255},qc=function(y,b){return y>b?b:y},Vc=function(y,b){return y>b?y:b},Fo=function(y,b){return 255*(1-(1-y/255)*(1-b/255))},pf=function(y,b){return b<128?2*y*b/255:255*(1-2*(1-y/255)*(1-b/255))},Zc=function(y,b){return 255*(1-(1-b/255)/(y/255))},Qc=function(y,b){return y===255?255:(y=255*(b/255)/(1-y/255),y>255?255:y)};Ar.normal=cn(Rn(Kc)),Ar.multiply=cn(Rn(vf)),Ar.screen=cn(Rn(Fo)),Ar.overlay=cn(Rn(pf)),Ar.darken=cn(Rn(qc)),Ar.lighten=cn(Rn(Vc)),Ar.dodge=cn(Rn(Qc)),Ar.burn=cn(Rn(Zc));for(var gf=Ar,Xn=T.type,hl=T.clip_rgb,$o=T.TWOPI,yf=Math.pow,cl=Math.sin,mf=Math.cos,_f=D,bf=function(y,b,w,N,W){y===void 0&&(y=300),b===void 0&&(b=-1.5),w===void 0&&(w=1),N===void 0&&(N=1),W===void 0&&(W=[0,1]);var H=0,$;Xn(W)==="array"?$=W[1]-W[0]:($=0,W=[W,W]);var V=function(Z){var ae=$o*((y+120)/360+b*Z),ce=yf(W[0]+$*Z,N),Re=H!==0?w[0]+Z*H:w,de=Re*ce*(1-ce)/2,Ie=mf(ae),Le=cl(ae),Ze=ce+de*(-.14861*Ie+1.78277*Le),Qe=ce+de*(-.29227*Ie-.90649*Le),et=ce+de*(1.97294*Ie);return _f(hl([Ze*255,Qe*255,et*255,1]))};return V.start=function(Z){return Z==null?y:(y=Z,V)},V.rotations=function(Z){return Z==null?b:(b=Z,V)},V.gamma=function(Z){return Z==null?N:(N=Z,V)},V.hue=function(Z){return Z==null?w:(w=Z,Xn(w)==="array"?(H=w[1]-w[0],H===0&&(w=w[1])):H=0,V)},V.lightness=function(Z){return Z==null?W:(Xn(Z)==="array"?(W=Z,$=Z[1]-Z[0]):(W=[Z,Z],$=0),V)},V.scale=function(){return _f.scale(V)},V.hue(w),V},lr=P,Go="0123456789abcdef",Sf=Math.floor,Tf=Math.random,Cf=function(){for(var y="#",b=0;b<6;b++)y+=Go.charAt(Sf(Tf()*16));return new lr(y,"hex")},Kn=p,Da=Math.log,Ef=Math.pow,Af=Math.floor,wf=Math.abs,wi=function(y,b){b===void 0&&(b=null);var w={min:Number.MAX_VALUE,max:Number.MAX_VALUE*-1,sum:0,values:[],count:0};return Kn(y)==="object"&&(y=Object.values(y)),y.forEach(function(N){b&&Kn(N)==="object"&&(N=N[b]),N!=null&&!isNaN(N)&&(w.values.push(N),w.sum+=N,N<w.min&&(w.min=N),N>w.max&&(w.max=N),w.count+=1)}),w.domain=[w.min,w.max],w.limits=function(N,W){return dl(w,N,W)},w},dl=function(y,b,w){b===void 0&&(b="equal"),w===void 0&&(w=7),Kn(y)=="array"&&(y=wi(y));var N=y.min,W=y.max,H=y.values.sort(function(yl,Bo){return yl-Bo});if(w===1)return[N,W];var $=[];if(b.substr(0,1)==="c"&&($.push(N),$.push(W)),b.substr(0,1)==="e"){$.push(N);for(var V=1;V<w;V++)$.push(N+V/w*(W-N));$.push(W)}else if(b.substr(0,1)==="l"){if(N<=0)throw new Error("Logarithmic scales are only possible for values > 0");var Z=Math.LOG10E*Da(N),ae=Math.LOG10E*Da(W);$.push(N);for(var ce=1;ce<w;ce++)$.push(Ef(10,Z+ce/w*(ae-Z)));$.push(W)}else if(b.substr(0,1)==="q"){$.push(N);for(var Re=1;Re<w;Re++){var de=(H.length-1)*Re/w,Ie=Af(de);if(Ie===de)$.push(H[Ie]);else{var Le=de-Ie;$.push(H[Ie]*(1-Le)+H[Ie+1]*Le)}}$.push(W)}else if(b.substr(0,1)==="k"){var Ze,Qe=H.length,et=new Array(Qe),ft=new Array(w),Jt=!0,Kt=0,kr=null;kr=[],kr.push(N);for(var tt=1;tt<w;tt++)kr.push(N+tt/w*(W-N));for(kr.push(W);Jt;){for(var ye=0;ye<w;ye++)ft[ye]=0;for(var He=0;He<Qe;He++)for(var rt=H[He],qe=Number.MAX_VALUE,fr=void 0,Et=0;Et<w;Et++){var nt=wf(kr[Et]-rt);nt<qe&&(qe=nt,fr=Et),ft[fr]++,et[He]=fr}for(var dt=new Array(w),vt=0;vt<w;vt++)dt[vt]=null;for(var mt=0;mt<Qe;mt++)Ze=et[mt],dt[Ze]===null?dt[Ze]=H[mt]:dt[Ze]+=H[mt];for(var Mr=0;Mr<w;Mr++)dt[Mr]*=1/ft[Mr];Jt=!1;for(var Ln=0;Ln<w;Ln++)if(dt[Ln]!==kr[Ln]){Jt=!0;break}kr=dt,Kt++,Kt>200&&(Jt=!1)}for(var Vn={},ki=0;ki<w;ki++)Vn[ki]=[];for(var Oi=0;Oi<Qe;Oi++)Ze=et[Oi],Vn[Ze].push(H[Oi]);for(var In=[],Nn=0;Nn<w;Nn++)In.push(Vn[Nn][0]),In.push(Vn[Nn][Vn[Nn].length-1]);In=In.sort(function(yl,Bo){return yl-Bo}),$.push(In[0]);for(var Mn=1;Mn<In.length;Mn+=2){var Zr=In[Mn];!isNaN(Zr)&&$.indexOf(Zr)===-1&&$.push(Zr)}}return $},Fa={analyze:wi,limits:dl},vl=P,$a=function(y,b){y=new vl(y),b=new vl(b);var w=y.luminance(),N=b.luminance();return w>N?(w+.05)/(N+.05):(N+.05)/(w+.05)},kf=P,wr=Math.sqrt,Ut=Math.pow,Of=Math.min,xf=Math.max,na=Math.atan2,ia=Math.abs,qn=Math.cos,aa=Math.sin,Rf=Math.exp,Pf=Math.PI,Lf=function(y,b,w,N,W){w===void 0&&(w=1),N===void 0&&(N=1),W===void 0&&(W=1);var H=function(Zr){return 360*Zr/(2*Pf)},$=function(Zr){return 2*Pf*Zr/360};y=new kf(y),b=new kf(b);var V=Array.from(y.lab()),Z=V[0],ae=V[1],ce=V[2],Re=Array.from(b.lab()),de=Re[0],Ie=Re[1],Le=Re[2],Ze=(Z+de)/2,Qe=wr(Ut(ae,2)+Ut(ce,2)),et=wr(Ut(Ie,2)+Ut(Le,2)),ft=(Qe+et)/2,Jt=.5*(1-wr(Ut(ft,7)/(Ut(ft,7)+Ut(25,7)))),Kt=ae*(1+Jt),kr=Ie*(1+Jt),tt=wr(Ut(Kt,2)+Ut(ce,2)),ye=wr(Ut(kr,2)+Ut(Le,2)),He=(tt+ye)/2,rt=H(na(ce,Kt)),qe=H(na(Le,kr)),fr=rt>=0?rt:rt+360,Et=qe>=0?qe:qe+360,nt=ia(fr-Et)>180?(fr+Et+360)/2:(fr+Et)/2,dt=1-.17*qn($(nt-30))+.24*qn($(2*nt))+.32*qn($(3*nt+6))-.2*qn($(4*nt-63)),vt=Et-fr;vt=ia(vt)<=180?vt:Et<=fr?vt+360:vt-360,vt=2*wr(tt*ye)*aa($(vt)/2);var mt=de-Z,Mr=ye-tt,Ln=1+.015*Ut(Ze-50,2)/wr(20+Ut(Ze-50,2)),Vn=1+.045*He,ki=1+.015*He*dt,Oi=30*Rf(-Ut((nt-275)/25,2)),In=2*wr(Ut(He,7)/(Ut(He,7)+Ut(25,7))),Nn=-In*aa(2*$(Oi)),Mn=wr(Ut(mt/(w*Ln),2)+Ut(Mr/(N*Vn),2)+Ut(vt/(W*ki),2)+Nn*(Mr/(N*Vn))*(vt/(W*ki)));return xf(0,Of(100,Mn))},Pn=P,oa=function(y,b,w){w===void 0&&(w="lab"),y=new Pn(y),b=new Pn(b);var N=y.get(w),W=b.get(w),H=0;for(var $ in N){var V=(N[$]||0)-(W[$]||0);H+=V*V}return Math.sqrt(H)},Ga=P,Jc=function(){for(var y=[],b=arguments.length;b--;)y[b]=arguments[b];try{return new(Function.prototype.bind.apply(Ga,[null].concat(y))),!0}catch{return!1}},pl=D,If=Na,ed={cool:function(){return If([pl.hsl(180,1,.9),pl.hsl(250,.7,.4)])},hot:function(){return If(["#000","#f00","#ff0","#fff"]).mode("rgb")}},Wo={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Viridis:["#440154","#482777","#3f4a8a","#31678e","#26838f","#1f9d8a","#6cce5a","#b6de2b","#fee825"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},ur=0,gl=Object.keys(Wo);ur<gl.length;ur+=1){var Nf=gl[ur];Wo[Nf.toLowerCase()]=Wo[Nf]}var td=Wo,ar=D;ar.average=jn,ar.bezier=df,ar.blend=gf,ar.cubehelix=bf,ar.mix=ar.interpolate=tl,ar.random=Cf,ar.scale=Na,ar.analyze=Fa.analyze,ar.contrast=$a,ar.deltaE=Lf,ar.distance=oa,ar.limits=Fa.limits,ar.valid=Jc,ar.scales=ed,ar.colors=Fs,ar.brewer=td;var Mf=ar;return Mf})})(Jg);var S$=Jg.exports;const Yo=[];function T$(r,e=ja){let n;const a=new Set;function l(v){if(Vm(r,v)&&(r=v,n)){const d=!Yo.length;for(const p of a)p[1](),Yo.push(p,r);if(d){for(let p=0;p<Yo.length;p+=2)Yo[p][0](Yo[p+1]);Yo.length=0}}}function f(v){l(v(r))}function h(v,d=ja){const p=[v,d];return a.add(p),a.size===1&&(n=e(l)||ja),v(r),()=>{a.delete(p),a.size===0&&(n(),n=null)}}return{set:l,update:f,subscribe:h}}var l_={},Yl={};Object.defineProperty(Yl,"__esModule",{value:!0});Yl.VERSION=void 0;Yl.VERSION="10.1.2";var tn={},u_=Object.prototype;function f_(r){var e=r&&r.constructor,n=typeof e=="function"&&e.prototype||u_;return r===n}var Xl=f_;function h_(r,e){return function(n){return r(e(n))}}var e0=h_,c_=e0,d_=c_(Object.keys,Object),v_=d_,p_=Xl,g_=v_,y_=Object.prototype,m_=y_.hasOwnProperty;function __(r){if(!p_(r))return g_(r);var e=[];for(var n in Object(r))m_.call(r,n)&&n!="constructor"&&e.push(n);return e}var t0=__,b_=typeof _e=="object"&&_e&&_e.Object===Object&&_e,r0=b_,S_=r0,T_=typeof self=="object"&&self&&self.Object===Object&&self,C_=S_||T_||Function("return this")(),ni=C_,E_=ni,A_=E_.Symbol,ls=A_,np=ls,n0=Object.prototype,w_=n0.hasOwnProperty,k_=n0.toString,_l=np?np.toStringTag:void 0;function O_(r){var e=w_.call(r,_l),n=r[_l];try{r[_l]=void 0;var a=!0}catch{}var l=k_.call(r);return a&&(e?r[_l]=n:delete r[_l]),l}var x_=O_,R_=Object.prototype,P_=R_.toString;function L_(r){return P_.call(r)}var I_=L_,ip=ls,N_=x_,M_=I_,D_="[object Null]",F_="[object Undefined]",ap=ip?ip.toStringTag:void 0;function $_(r){return r==null?r===void 0?F_:D_:ap&&ap in Object(r)?N_(r):M_(r)}var Ka=$_;function G_(r){var e=typeof r;return r!=null&&(e=="object"||e=="function")}var ii=G_,W_=Ka,B_=ii,U_="[object AsyncFunction]",H_="[object Function]",z_="[object GeneratorFunction]",j_="[object Proxy]";function Y_(r){if(!B_(r))return!1;var e=W_(r);return e==H_||e==z_||e==U_||e==j_}var Kl=Y_,X_=ni,K_=X_["__core-js_shared__"],q_=K_,ud=q_,op=function(){var r=/[^.]+$/.exec(ud&&ud.keys&&ud.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}();function V_(r){return!!op&&op in r}var Z_=V_,Q_=Function.prototype,J_=Q_.toString;function e1(r){if(r!=null){try{return J_.call(r)}catch{}try{return r+""}catch{}}return""}var i0=e1,t1=Kl,r1=Z_,n1=ii,i1=i0,a1=/[\\^$.*+?()[\]{}|]/g,o1=/^\[object .+?Constructor\]$/,s1=Function.prototype,l1=Object.prototype,u1=s1.toString,f1=l1.hasOwnProperty,h1=RegExp("^"+u1.call(f1).replace(a1,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function c1(r){if(!n1(r)||r1(r))return!1;var e=t1(r)?h1:o1;return e.test(i1(r))}var d1=c1;function v1(r,e){return r==null?void 0:r[e]}var p1=v1,g1=d1,y1=p1;function m1(r,e){var n=y1(r,e);return g1(n)?n:void 0}var qa=m1,_1=qa,b1=ni,S1=_1(b1,"DataView"),T1=S1,C1=qa,E1=ni,A1=C1(E1,"Map"),Vd=A1,w1=qa,k1=ni,O1=w1(k1,"Promise"),x1=O1,R1=qa,P1=ni,L1=R1(P1,"Set"),a0=L1,I1=qa,N1=ni,M1=I1(N1,"WeakMap"),D1=M1,xd=T1,Rd=Vd,Pd=x1,Ld=a0,Id=D1,o0=Ka,us=i0,sp="[object Map]",F1="[object Object]",lp="[object Promise]",up="[object Set]",fp="[object WeakMap]",hp="[object DataView]",$1=us(xd),G1=us(Rd),W1=us(Pd),B1=us(Ld),U1=us(Id),Ha=o0;(xd&&Ha(new xd(new ArrayBuffer(1)))!=hp||Rd&&Ha(new Rd)!=sp||Pd&&Ha(Pd.resolve())!=lp||Ld&&Ha(new Ld)!=up||Id&&Ha(new Id)!=fp)&&(Ha=function(r){var e=o0(r),n=e==F1?r.constructor:void 0,a=n?us(n):"";if(a)switch(a){case $1:return hp;case G1:return sp;case W1:return lp;case B1:return up;case U1:return fp}return e});var ql=Ha;function H1(r){return r!=null&&typeof r=="object"}var ai=H1,z1=Ka,j1=ai,Y1="[object Arguments]";function X1(r){return j1(r)&&z1(r)==Y1}var K1=X1,cp=K1,q1=ai,s0=Object.prototype,V1=s0.hasOwnProperty,Z1=s0.propertyIsEnumerable,Q1=cp(function(){return arguments}())?cp:function(r){return q1(r)&&V1.call(r,"callee")&&!Z1.call(r,"callee")},yh=Q1,J1=Array.isArray,kt=J1,eb=9007199254740991;function tb(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=eb}var Zd=tb,rb=Kl,nb=Zd;function ib(r){return r!=null&&nb(r.length)&&!rb(r)}var oi=ib,es={exports:{}};function ab(){return!1}var ob=ab;(function(r,e){var n=ni,a=ob,l=e&&!e.nodeType&&e,f=l&&!0&&r&&!r.nodeType&&r,h=f&&f.exports===l,v=h?n.Buffer:void 0,d=v?v.isBuffer:void 0,p=d||a;r.exports=p})(es,es.exports);var sb=Ka,lb=Zd,ub=ai,fb="[object Arguments]",hb="[object Array]",cb="[object Boolean]",db="[object Date]",vb="[object Error]",pb="[object Function]",gb="[object Map]",yb="[object Number]",mb="[object Object]",_b="[object RegExp]",bb="[object Set]",Sb="[object String]",Tb="[object WeakMap]",Cb="[object ArrayBuffer]",Eb="[object DataView]",Ab="[object Float32Array]",wb="[object Float64Array]",kb="[object Int8Array]",Ob="[object Int16Array]",xb="[object Int32Array]",Rb="[object Uint8Array]",Pb="[object Uint8ClampedArray]",Lb="[object Uint16Array]",Ib="[object Uint32Array]",It={};It[Ab]=It[wb]=It[kb]=It[Ob]=It[xb]=It[Rb]=It[Pb]=It[Lb]=It[Ib]=!0;It[fb]=It[hb]=It[Cb]=It[cb]=It[Eb]=It[db]=It[vb]=It[pb]=It[gb]=It[yb]=It[mb]=It[_b]=It[bb]=It[Sb]=It[Tb]=!1;function Nb(r){return ub(r)&&lb(r.length)&&!!It[sb(r)]}var Mb=Nb;function Db(r){return function(e){return r(e)}}var Vl=Db,ts={exports:{}};(function(r,e){var n=r0,a=e&&!e.nodeType&&e,l=a&&!0&&r&&!r.nodeType&&r,f=l&&l.exports===a,h=f&&n.process,v=function(){try{var d=l&&l.import&&l.import("util").types;return d||h&&h.binding&&h.binding("util")}catch{}}();r.exports=v})(ts,ts.exports);var Fb=Mb,$b=Vl,dp=ts.exports,vp=dp&&dp.isTypedArray,Gb=vp?$b(vp):Fb,Qd=Gb,Wb=t0,Bb=ql,Ub=yh,Hb=kt,zb=oi,jb=es.exports,Yb=Xl,Xb=Qd,Kb="[object Map]",qb="[object Set]",Vb=Object.prototype,Zb=Vb.hasOwnProperty;function Qb(r){if(r==null)return!0;if(zb(r)&&(Hb(r)||typeof r=="string"||typeof r.splice=="function"||jb(r)||Xb(r)||Ub(r)))return!r.length;var e=Bb(r);if(e==Kb||e==qb)return!r.size;if(Yb(r))return!Wb(r).length;for(var n in r)if(Zb.call(r,n))return!1;return!0}var si=Qb;function Jb(r,e){for(var n=-1,a=r==null?0:r.length,l=Array(a);++n<a;)l[n]=e(r[n],n,r);return l}var Zl=Jb;function eS(){this.__data__=[],this.size=0}var tS=eS;function rS(r,e){return r===e||r!==r&&e!==e}var Ql=rS,nS=Ql;function iS(r,e){for(var n=r.length;n--;)if(nS(r[n][0],e))return n;return-1}var mh=iS,aS=mh,oS=Array.prototype,sS=oS.splice;function lS(r){var e=this.__data__,n=aS(e,r);if(n<0)return!1;var a=e.length-1;return n==a?e.pop():sS.call(e,n,1),--this.size,!0}var uS=lS,fS=mh;function hS(r){var e=this.__data__,n=fS(e,r);return n<0?void 0:e[n][1]}var cS=hS,dS=mh;function vS(r){return dS(this.__data__,r)>-1}var pS=vS,gS=mh;function yS(r,e){var n=this.__data__,a=gS(n,r);return a<0?(++this.size,n.push([r,e])):n[a][1]=e,this}var mS=yS,_S=tS,bS=uS,SS=cS,TS=pS,CS=mS;function fs(r){var e=-1,n=r==null?0:r.length;for(this.clear();++e<n;){var a=r[e];this.set(a[0],a[1])}}fs.prototype.clear=_S;fs.prototype.delete=bS;fs.prototype.get=SS;fs.prototype.has=TS;fs.prototype.set=CS;var _h=fs,ES=_h;function AS(){this.__data__=new ES,this.size=0}var wS=AS;function kS(r){var e=this.__data__,n=e.delete(r);return this.size=e.size,n}var OS=kS;function xS(r){return this.__data__.get(r)}var RS=xS;function PS(r){return this.__data__.has(r)}var LS=PS,IS=qa,NS=IS(Object,"create"),bh=NS,pp=bh;function MS(){this.__data__=pp?pp(null):{},this.size=0}var DS=MS;function FS(r){var e=this.has(r)&&delete this.__data__[r];return this.size-=e?1:0,e}var $S=FS,GS=bh,WS="__lodash_hash_undefined__",BS=Object.prototype,US=BS.hasOwnProperty;function HS(r){var e=this.__data__;if(GS){var n=e[r];return n===WS?void 0:n}return US.call(e,r)?e[r]:void 0}var zS=HS,jS=bh,YS=Object.prototype,XS=YS.hasOwnProperty;function KS(r){var e=this.__data__;return jS?e[r]!==void 0:XS.call(e,r)}var qS=KS,VS=bh,ZS="__lodash_hash_undefined__";function QS(r,e){var n=this.__data__;return this.size+=this.has(r)?0:1,n[r]=VS&&e===void 0?ZS:e,this}var JS=QS,eT=DS,tT=$S,rT=zS,nT=qS,iT=JS;function hs(r){var e=-1,n=r==null?0:r.length;for(this.clear();++e<n;){var a=r[e];this.set(a[0],a[1])}}hs.prototype.clear=eT;hs.prototype.delete=tT;hs.prototype.get=rT;hs.prototype.has=nT;hs.prototype.set=iT;var aT=hs,gp=aT,oT=_h,sT=Vd;function lT(){this.size=0,this.__data__={hash:new gp,map:new(sT||oT),string:new gp}}var uT=lT;function fT(r){var e=typeof r;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?r!=="__proto__":r===null}var hT=fT,cT=hT;function dT(r,e){var n=r.__data__;return cT(e)?n[typeof e=="string"?"string":"hash"]:n.map}var Sh=dT,vT=Sh;function pT(r){var e=vT(this,r).delete(r);return this.size-=e?1:0,e}var gT=pT,yT=Sh;function mT(r){return yT(this,r).get(r)}var _T=mT,bT=Sh;function ST(r){return bT(this,r).has(r)}var TT=ST,CT=Sh;function ET(r,e){var n=CT(this,r),a=n.size;return n.set(r,e),this.size+=n.size==a?0:1,this}var AT=ET,wT=uT,kT=gT,OT=_T,xT=TT,RT=AT;function cs(r){var e=-1,n=r==null?0:r.length;for(this.clear();++e<n;){var a=r[e];this.set(a[0],a[1])}}cs.prototype.clear=wT;cs.prototype.delete=kT;cs.prototype.get=OT;cs.prototype.has=xT;cs.prototype.set=RT;var Jd=cs,PT=_h,LT=Vd,IT=Jd,NT=200;function MT(r,e){var n=this.__data__;if(n instanceof PT){var a=n.__data__;if(!LT||a.length<NT-1)return a.push([r,e]),this.size=++n.size,this;n=this.__data__=new IT(a)}return n.set(r,e),this.size=n.size,this}var DT=MT,FT=_h,$T=wS,GT=OS,WT=RS,BT=LS,UT=DT;function ds(r){var e=this.__data__=new FT(r);this.size=e.size}ds.prototype.clear=$T;ds.prototype.delete=GT;ds.prototype.get=WT;ds.prototype.has=BT;ds.prototype.set=UT;var ev=ds,HT="__lodash_hash_undefined__";function zT(r){return this.__data__.set(r,HT),this}var jT=zT;function YT(r){return this.__data__.has(r)}var XT=YT,KT=Jd,qT=jT,VT=XT;function hh(r){var e=-1,n=r==null?0:r.length;for(this.__data__=new KT;++e<n;)this.add(r[e])}hh.prototype.add=hh.prototype.push=qT;hh.prototype.has=VT;var tv=hh;function ZT(r,e){for(var n=-1,a=r==null?0:r.length;++n<a;)if(e(r[n],n,r))return!0;return!1}var l0=ZT;function QT(r,e){return r.has(e)}var rv=QT,JT=tv,eC=l0,tC=rv,rC=1,nC=2;function iC(r,e,n,a,l,f){var h=n&rC,v=r.length,d=e.length;if(v!=d&&!(h&&d>v))return!1;var p=f.get(r),S=f.get(e);if(p&&S)return p==e&&S==r;var E=-1,A=!0,O=n&nC?new JT:void 0;for(f.set(r,e),f.set(e,r);++E<v;){var k=r[E],T=e[E];if(a)var x=h?a(T,k,E,e,r,f):a(k,T,E,r,e,f);if(x!==void 0){if(x)continue;A=!1;break}if(O){if(!eC(e,function(G,j){if(!tC(O,j)&&(k===G||l(k,G,n,a,f)))return O.push(j)})){A=!1;break}}else if(!(k===T||l(k,T,n,a,f))){A=!1;break}}return f.delete(r),f.delete(e),A}var u0=iC,aC=ni,oC=aC.Uint8Array,f0=oC;function sC(r){var e=-1,n=Array(r.size);return r.forEach(function(a,l){n[++e]=[l,a]}),n}var lC=sC;function uC(r){var e=-1,n=Array(r.size);return r.forEach(function(a){n[++e]=a}),n}var nv=uC,yp=ls,mp=f0,fC=Ql,hC=u0,cC=lC,dC=nv,vC=1,pC=2,gC="[object Boolean]",yC="[object Date]",mC="[object Error]",_C="[object Map]",bC="[object Number]",SC="[object RegExp]",TC="[object Set]",CC="[object String]",EC="[object Symbol]",AC="[object ArrayBuffer]",wC="[object DataView]",_p=yp?yp.prototype:void 0,fd=_p?_p.valueOf:void 0;function kC(r,e,n,a,l,f,h){switch(n){case wC:if(r.byteLength!=e.byteLength||r.byteOffset!=e.byteOffset)return!1;r=r.buffer,e=e.buffer;case AC:return!(r.byteLength!=e.byteLength||!f(new mp(r),new mp(e)));case gC:case yC:case bC:return fC(+r,+e);case mC:return r.name==e.name&&r.message==e.message;case SC:case CC:return r==e+"";case _C:var v=cC;case TC:var d=a&vC;if(v||(v=dC),r.size!=e.size&&!d)return!1;var p=h.get(r);if(p)return p==e;a|=pC,h.set(r,e);var S=hC(v(r),v(e),a,l,f,h);return h.delete(r),S;case EC:if(fd)return fd.call(r)==fd.call(e)}return!1}var OC=kC;function xC(r,e){for(var n=-1,a=e.length,l=r.length;++n<a;)r[l+n]=e[n];return r}var iv=xC,RC=iv,PC=kt;function LC(r,e,n){var a=e(r);return PC(r)?a:RC(a,n(r))}var h0=LC;function IC(r,e){for(var n=-1,a=r==null?0:r.length,l=0,f=[];++n<a;){var h=r[n];e(h,n,r)&&(f[l++]=h)}return f}var av=IC;function NC(){return[]}var c0=NC,MC=av,DC=c0,FC=Object.prototype,$C=FC.propertyIsEnumerable,bp=Object.getOwnPropertySymbols,GC=bp?function(r){return r==null?[]:(r=Object(r),MC(bp(r),function(e){return $C.call(r,e)}))}:DC,ov=GC;function WC(r,e){for(var n=-1,a=Array(r);++n<r;)a[n]=e(n);return a}var BC=WC,UC=9007199254740991,HC=/^(?:0|[1-9]\d*)$/;function zC(r,e){var n=typeof r;return e=e==null?UC:e,!!e&&(n=="number"||n!="symbol"&&HC.test(r))&&r>-1&&r%1==0&&r<e}var Th=zC,jC=BC,YC=yh,XC=kt,KC=es.exports,qC=Th,VC=Qd,ZC=Object.prototype,QC=ZC.hasOwnProperty;function JC(r,e){var n=XC(r),a=!n&&YC(r),l=!n&&!a&&KC(r),f=!n&&!a&&!l&&VC(r),h=n||a||l||f,v=h?jC(r.length,String):[],d=v.length;for(var p in r)(e||QC.call(r,p))&&!(h&&(p=="length"||l&&(p=="offset"||p=="parent")||f&&(p=="buffer"||p=="byteLength"||p=="byteOffset")||qC(p,d)))&&v.push(p);return v}var d0=JC,e2=d0,t2=t0,r2=oi;function n2(r){return r2(r)?e2(r):t2(r)}var pn=n2,i2=h0,a2=ov,o2=pn;function s2(r){return i2(r,o2,a2)}var v0=s2,Sp=v0,l2=1,u2=Object.prototype,f2=u2.hasOwnProperty;function h2(r,e,n,a,l,f){var h=n&l2,v=Sp(r),d=v.length,p=Sp(e),S=p.length;if(d!=S&&!h)return!1;for(var E=d;E--;){var A=v[E];if(!(h?A in e:f2.call(e,A)))return!1}var O=f.get(r),k=f.get(e);if(O&&k)return O==e&&k==r;var T=!0;f.set(r,e),f.set(e,r);for(var x=h;++E<d;){A=v[E];var G=r[A],j=e[A];if(a)var B=h?a(j,G,A,e,r,f):a(G,j,A,r,e,f);if(!(B===void 0?G===j||l(G,j,n,a,f):B)){T=!1;break}x||(x=A=="constructor")}if(T&&!x){var U=r.constructor,J=e.constructor;U!=J&&"constructor"in r&&"constructor"in e&&!(typeof U=="function"&&U instanceof U&&typeof J=="function"&&J instanceof J)&&(T=!1)}return f.delete(r),f.delete(e),T}var c2=h2,hd=ev,d2=u0,v2=OC,p2=c2,Tp=ql,Cp=kt,Ep=es.exports,g2=Qd,y2=1,Ap="[object Arguments]",wp="[object Array]",Bf="[object Object]",m2=Object.prototype,kp=m2.hasOwnProperty;function _2(r,e,n,a,l,f){var h=Cp(r),v=Cp(e),d=h?wp:Tp(r),p=v?wp:Tp(e);d=d==Ap?Bf:d,p=p==Ap?Bf:p;var S=d==Bf,E=p==Bf,A=d==p;if(A&&Ep(r)){if(!Ep(e))return!1;h=!0,S=!1}if(A&&!S)return f||(f=new hd),h||g2(r)?d2(r,e,n,a,l,f):v2(r,e,d,n,a,l,f);if(!(n&y2)){var O=S&&kp.call(r,"__wrapped__"),k=E&&kp.call(e,"__wrapped__");if(O||k){var T=O?r.value():r,x=k?e.value():e;return f||(f=new hd),l(T,x,n,a,f)}}return A?(f||(f=new hd),p2(r,e,n,a,l,f)):!1}var b2=_2,S2=b2,Op=ai;function p0(r,e,n,a,l){return r===e?!0:r==null||e==null||!Op(r)&&!Op(e)?r!==r&&e!==e:S2(r,e,n,a,p0,l)}var g0=p0,T2=ev,C2=g0,E2=1,A2=2;function w2(r,e,n,a){var l=n.length,f=l,h=!a;if(r==null)return!f;for(r=Object(r);l--;){var v=n[l];if(h&&v[2]?v[1]!==r[v[0]]:!(v[0]in r))return!1}for(;++l<f;){v=n[l];var d=v[0],p=r[d],S=v[1];if(h&&v[2]){if(p===void 0&&!(d in r))return!1}else{var E=new T2;if(a)var A=a(p,S,d,r,e,E);if(!(A===void 0?C2(S,p,E2|A2,a,E):A))return!1}}return!0}var k2=w2,O2=ii;function x2(r){return r===r&&!O2(r)}var y0=x2,R2=y0,P2=pn;function L2(r){for(var e=P2(r),n=e.length;n--;){var a=e[n],l=r[a];e[n]=[a,l,R2(l)]}return e}var I2=L2;function N2(r,e){return function(n){return n==null?!1:n[r]===e&&(e!==void 0||r in Object(n))}}var m0=N2,M2=k2,D2=I2,F2=m0;function $2(r){var e=D2(r);return e.length==1&&e[0][2]?F2(e[0][0],e[0][1]):function(n){return n===r||M2(n,r,e)}}var G2=$2,W2=Ka,B2=ai,U2="[object Symbol]";function H2(r){return typeof r=="symbol"||B2(r)&&W2(r)==U2}var Ch=H2,z2=kt,j2=Ch,Y2=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,X2=/^\w*$/;function K2(r,e){if(z2(r))return!1;var n=typeof r;return n=="number"||n=="symbol"||n=="boolean"||r==null||j2(r)?!0:X2.test(r)||!Y2.test(r)||e!=null&&r in Object(e)}var sv=K2,_0=Jd,q2="Expected a function";function lv(r,e){if(typeof r!="function"||e!=null&&typeof e!="function")throw new TypeError(q2);var n=function(){var a=arguments,l=e?e.apply(this,a):a[0],f=n.cache;if(f.has(l))return f.get(l);var h=r.apply(this,a);return n.cache=f.set(l,h)||f,h};return n.cache=new(lv.Cache||_0),n}lv.Cache=_0;var V2=lv,Z2=V2,Q2=500;function J2(r){var e=Z2(r,function(a){return n.size===Q2&&n.clear(),a}),n=e.cache;return e}var eE=J2,tE=eE,rE=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,nE=/\\(\\)?/g,iE=tE(function(r){var e=[];return r.charCodeAt(0)===46&&e.push(""),r.replace(rE,function(n,a,l,f){e.push(l?f.replace(nE,"$1"):a||n)}),e}),aE=iE,xp=ls,oE=Zl,sE=kt,lE=Ch,uE=1/0,Rp=xp?xp.prototype:void 0,Pp=Rp?Rp.toString:void 0;function b0(r){if(typeof r=="string")return r;if(sE(r))return oE(r,b0)+"";if(lE(r))return Pp?Pp.call(r):"";var e=r+"";return e=="0"&&1/r==-uE?"-0":e}var fE=b0,hE=fE;function cE(r){return r==null?"":hE(r)}var S0=cE,dE=kt,vE=sv,pE=aE,gE=S0;function yE(r,e){return dE(r)?r:vE(r,e)?[r]:pE(gE(r))}var Eh=yE,mE=Ch,_E=1/0;function bE(r){if(typeof r=="string"||mE(r))return r;var e=r+"";return e=="0"&&1/r==-_E?"-0":e}var Jl=bE,SE=Eh,TE=Jl;function CE(r,e){e=SE(e,r);for(var n=0,a=e.length;r!=null&&n<a;)r=r[TE(e[n++])];return n&&n==a?r:void 0}var uv=CE,EE=uv;function AE(r,e,n){var a=r==null?void 0:EE(r,e);return a===void 0?n:a}var wE=AE;function kE(r,e){return r!=null&&e in Object(r)}var OE=kE,xE=Eh,RE=yh,PE=kt,LE=Th,IE=Zd,NE=Jl;function ME(r,e,n){e=xE(e,r);for(var a=-1,l=e.length,f=!1;++a<l;){var h=NE(e[a]);if(!(f=r!=null&&n(r,h)))break;r=r[h]}return f||++a!=l?f:(l=r==null?0:r.length,!!l&&IE(l)&&LE(h,l)&&(PE(r)||RE(r)))}var T0=ME,DE=OE,FE=T0;function $E(r,e){return r!=null&&FE(r,e,DE)}var GE=$E,WE=g0,BE=wE,UE=GE,HE=sv,zE=y0,jE=m0,YE=Jl,XE=1,KE=2;function qE(r,e){return HE(r)&&zE(e)?jE(YE(r),e):function(n){var a=BE(n,r);return a===void 0&&a===e?UE(n,r):WE(e,a,XE|KE)}}var VE=qE;function ZE(r){return r}var eu=ZE;function QE(r){return function(e){return e==null?void 0:e[r]}}var JE=QE,eA=uv;function tA(r){return function(e){return eA(e,r)}}var rA=tA,nA=JE,iA=rA,aA=sv,oA=Jl;function sA(r){return aA(r)?nA(oA(r)):iA(r)}var lA=sA,uA=G2,fA=VE,hA=eu,cA=kt,dA=lA;function vA(r){return typeof r=="function"?r:r==null?hA:typeof r=="object"?cA(r)?fA(r[0],r[1]):uA(r):dA(r)}var li=vA;function pA(r){return function(e,n,a){for(var l=-1,f=Object(e),h=a(e),v=h.length;v--;){var d=h[r?v:++l];if(n(f[d],d,f)===!1)break}return e}}var gA=pA,yA=gA,mA=yA(),_A=mA,bA=_A,SA=pn;function TA(r,e){return r&&bA(r,e,SA)}var CA=TA,EA=oi;function AA(r,e){return function(n,a){if(n==null)return n;if(!EA(n))return r(n,a);for(var l=n.length,f=e?l:-1,h=Object(n);(e?f--:++f<l)&&a(h[f],f,h)!==!1;);return n}}var wA=AA,kA=CA,OA=wA,xA=OA(kA),Va=xA,RA=Va,PA=oi;function LA(r,e){var n=-1,a=PA(r)?Array(r.length):[];return RA(r,function(l,f,h){a[++n]=e(l,f,h)}),a}var IA=LA,NA=Zl,MA=li,DA=IA,FA=kt;function $A(r,e){var n=FA(r)?NA:DA;return n(r,MA(e))}var Kr=$A;function GA(r,e){for(var n=-1,a=r==null?0:r.length;++n<a&&e(r[n],n,r)!==!1;);return r}var C0=GA,WA=eu;function BA(r){return typeof r=="function"?r:WA}var UA=BA,HA=C0,zA=Va,jA=UA,YA=kt;function XA(r,e){var n=YA(r)?HA:zA;return n(r,jA(e))}var Rr=XA,KA=Zl;function qA(r,e){return KA(e,function(n){return r[n]})}var VA=qA,ZA=VA,QA=pn;function JA(r){return r==null?[]:ZA(r,QA(r))}var Ii=JA,ew=Object.prototype,tw=ew.hasOwnProperty;function rw(r,e){return r!=null&&tw.call(r,e)}var nw=rw,iw=nw,aw=T0;function ow(r,e){return r!=null&&aw(r,e,iw)}var gn=ow,sw=qa,lw=function(){try{var r=sw(Object,"defineProperty");return r({},"",{}),r}catch{}}(),E0=lw,Lp=E0;function uw(r,e,n){e=="__proto__"&&Lp?Lp(r,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):r[e]=n}var fv=uw,fw=fv,hw=Ql,cw=Object.prototype,dw=cw.hasOwnProperty;function vw(r,e,n){var a=r[e];(!(dw.call(r,e)&&hw(a,n))||n===void 0&&!(e in r))&&fw(r,e,n)}var Ah=vw,pw=Ah,gw=fv;function yw(r,e,n,a){var l=!n;n||(n={});for(var f=-1,h=e.length;++f<h;){var v=e[f],d=a?a(n[v],r[v],v,n,r):void 0;d===void 0&&(d=r[v]),l?gw(n,v,d):pw(n,v,d)}return n}var tu=yw,mw=tu,_w=pn;function bw(r,e){return r&&mw(e,_w(e),r)}var Sw=bw;function Tw(r){var e=[];if(r!=null)for(var n in Object(r))e.push(n);return e}var Cw=Tw,Ew=ii,Aw=Xl,ww=Cw,kw=Object.prototype,Ow=kw.hasOwnProperty;function xw(r){if(!Ew(r))return ww(r);var e=Aw(r),n=[];for(var a in r)a=="constructor"&&(e||!Ow.call(r,a))||n.push(a);return n}var Rw=xw,Pw=d0,Lw=Rw,Iw=oi;function Nw(r){return Iw(r)?Pw(r,!0):Lw(r)}var wh=Nw,Mw=tu,Dw=wh;function Fw(r,e){return r&&Mw(e,Dw(e),r)}var $w=Fw,Nd={exports:{}};(function(r,e){var n=ni,a=e&&!e.nodeType&&e,l=a&&!0&&r&&!r.nodeType&&r,f=l&&l.exports===a,h=f?n.Buffer:void 0,v=h?h.allocUnsafe:void 0;function d(p,S){if(S)return p.slice();var E=p.length,A=v?v(E):new p.constructor(E);return p.copy(A),A}r.exports=d})(Nd,Nd.exports);function Gw(r,e){var n=-1,a=r.length;for(e||(e=Array(a));++n<a;)e[n]=r[n];return e}var Ww=Gw,Bw=tu,Uw=ov;function Hw(r,e){return Bw(r,Uw(r),e)}var zw=Hw,jw=e0,Yw=jw(Object.getPrototypeOf,Object),A0=Yw,Xw=iv,Kw=A0,qw=ov,Vw=c0,Zw=Object.getOwnPropertySymbols,Qw=Zw?function(r){for(var e=[];r;)Xw(e,qw(r)),r=Kw(r);return e}:Vw,w0=Qw,Jw=tu,ek=w0;function tk(r,e){return Jw(r,ek(r),e)}var rk=tk,nk=h0,ik=w0,ak=wh;function ok(r){return nk(r,ak,ik)}var k0=ok,sk=Object.prototype,lk=sk.hasOwnProperty;function uk(r){var e=r.length,n=new r.constructor(e);return e&&typeof r[0]=="string"&&lk.call(r,"index")&&(n.index=r.index,n.input=r.input),n}var fk=uk,Ip=f0;function hk(r){var e=new r.constructor(r.byteLength);return new Ip(e).set(new Ip(r)),e}var hv=hk,ck=hv;function dk(r,e){var n=e?ck(r.buffer):r.buffer;return new r.constructor(n,r.byteOffset,r.byteLength)}var vk=dk,pk=/\w*$/;function gk(r){var e=new r.constructor(r.source,pk.exec(r));return e.lastIndex=r.lastIndex,e}var yk=gk,Np=ls,Mp=Np?Np.prototype:void 0,Dp=Mp?Mp.valueOf:void 0;function mk(r){return Dp?Object(Dp.call(r)):{}}var _k=mk,bk=hv;function Sk(r,e){var n=e?bk(r.buffer):r.buffer;return new r.constructor(n,r.byteOffset,r.length)}var Tk=Sk,Ck=hv,Ek=vk,Ak=yk,wk=_k,kk=Tk,Ok="[object Boolean]",xk="[object Date]",Rk="[object Map]",Pk="[object Number]",Lk="[object RegExp]",Ik="[object Set]",Nk="[object String]",Mk="[object Symbol]",Dk="[object ArrayBuffer]",Fk="[object DataView]",$k="[object Float32Array]",Gk="[object Float64Array]",Wk="[object Int8Array]",Bk="[object Int16Array]",Uk="[object Int32Array]",Hk="[object Uint8Array]",zk="[object Uint8ClampedArray]",jk="[object Uint16Array]",Yk="[object Uint32Array]";function Xk(r,e,n){var a=r.constructor;switch(e){case Dk:return Ck(r);case Ok:case xk:return new a(+r);case Fk:return Ek(r,n);case $k:case Gk:case Wk:case Bk:case Uk:case Hk:case zk:case jk:case Yk:return kk(r,n);case Rk:return new a;case Pk:case Nk:return new a(r);case Lk:return Ak(r);case Ik:return new a;case Mk:return wk(r)}}var Kk=Xk,qk=ii,Fp=Object.create,Vk=function(){function r(){}return function(e){if(!qk(e))return{};if(Fp)return Fp(e);r.prototype=e;var n=new r;return r.prototype=void 0,n}}(),Zk=Vk,Qk=Zk,Jk=A0,eO=Xl;function tO(r){return typeof r.constructor=="function"&&!eO(r)?Qk(Jk(r)):{}}var rO=tO,nO=ql,iO=ai,aO="[object Map]";function oO(r){return iO(r)&&nO(r)==aO}var sO=oO,lO=sO,uO=Vl,$p=ts.exports,Gp=$p&&$p.isMap,fO=Gp?uO(Gp):lO,hO=fO,cO=ql,dO=ai,vO="[object Set]";function pO(r){return dO(r)&&cO(r)==vO}var gO=pO,yO=gO,mO=Vl,Wp=ts.exports,Bp=Wp&&Wp.isSet,_O=Bp?mO(Bp):yO,bO=_O,SO=ev,TO=C0,CO=Ah,EO=Sw,AO=$w,wO=Nd.exports,kO=Ww,OO=zw,xO=rk,RO=v0,PO=k0,LO=ql,IO=fk,NO=Kk,MO=rO,DO=kt,FO=es.exports,$O=hO,GO=ii,WO=bO,BO=pn,UO=wh,HO=1,zO=2,jO=4,O0="[object Arguments]",YO="[object Array]",XO="[object Boolean]",KO="[object Date]",qO="[object Error]",x0="[object Function]",VO="[object GeneratorFunction]",ZO="[object Map]",QO="[object Number]",R0="[object Object]",JO="[object RegExp]",ex="[object Set]",tx="[object String]",rx="[object Symbol]",nx="[object WeakMap]",ix="[object ArrayBuffer]",ax="[object DataView]",ox="[object Float32Array]",sx="[object Float64Array]",lx="[object Int8Array]",ux="[object Int16Array]",fx="[object Int32Array]",hx="[object Uint8Array]",cx="[object Uint8ClampedArray]",dx="[object Uint16Array]",vx="[object Uint32Array]",Pt={};Pt[O0]=Pt[YO]=Pt[ix]=Pt[ax]=Pt[XO]=Pt[KO]=Pt[ox]=Pt[sx]=Pt[lx]=Pt[ux]=Pt[fx]=Pt[ZO]=Pt[QO]=Pt[R0]=Pt[JO]=Pt[ex]=Pt[tx]=Pt[rx]=Pt[hx]=Pt[cx]=Pt[dx]=Pt[vx]=!0;Pt[qO]=Pt[x0]=Pt[nx]=!1;function ah(r,e,n,a,l,f){var h,v=e&HO,d=e&zO,p=e&jO;if(n&&(h=l?n(r,a,l,f):n(r)),h!==void 0)return h;if(!GO(r))return r;var S=DO(r);if(S){if(h=IO(r),!v)return kO(r,h)}else{var E=LO(r),A=E==x0||E==VO;if(FO(r))return wO(r,v);if(E==R0||E==O0||A&&!l){if(h=d||A?{}:MO(r),!v)return d?xO(r,AO(h,r)):OO(r,EO(h,r))}else{if(!Pt[E])return l?r:{};h=NO(r,E,v)}}f||(f=new SO);var O=f.get(r);if(O)return O;f.set(r,h),WO(r)?r.forEach(function(x){h.add(ah(x,e,n,x,r,f))}):$O(r)&&r.forEach(function(x,G){h.set(G,ah(x,e,n,G,r,f))});var k=p?d?PO:RO:d?UO:BO,T=S?void 0:k(r);return TO(T||r,function(x,G){T&&(G=x,x=r[G]),CO(h,G,ah(x,e,n,G,r,f))}),h}var px=ah,gx=px,yx=4;function mx(r){return gx(r,yx)}var fa=mx,vs={},rs={};Object.defineProperty(rs,"__esModule",{value:!0});rs.PRINT_WARNING=rs.PRINT_ERROR=void 0;function _x(r){console&&console.error&&console.error("Error: ".concat(r))}rs.PRINT_ERROR=_x;function bx(r){console&&console.warn&&console.warn("Warning: ".concat(r))}rs.PRINT_WARNING=bx;var kh={};Object.defineProperty(kh,"__esModule",{value:!0});kh.timer=void 0;function Sx(r){var e=new Date().getTime(),n=r(),a=new Date().getTime(),l=a-e;return{time:l,value:n}}kh.timer=Sx;var Oh={};Object.defineProperty(Oh,"__esModule",{value:!0});Oh.toFastProperties=void 0;function Tx(r){function e(){}e.prototype=r;var n=new e;function a(){return typeof n.bar}return a(),a(),r}Oh.toFastProperties=Tx;(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.toFastProperties=r.timer=r.PRINT_ERROR=r.PRINT_WARNING=void 0;var e=rs;Object.defineProperty(r,"PRINT_WARNING",{enumerable:!0,get:function(){return e.PRINT_WARNING}}),Object.defineProperty(r,"PRINT_ERROR",{enumerable:!0,get:function(){return e.PRINT_ERROR}});var n=kh;Object.defineProperty(r,"timer",{enumerable:!0,get:function(){return n.timer}});var a=Oh;Object.defineProperty(r,"toFastProperties",{enumerable:!0,get:function(){return a.toFastProperties}})})(vs);var ei={},ps={};function Cx(r,e,n){var a=-1,l=r.length;e<0&&(e=-e>l?0:l+e),n=n>l?l:n,n<0&&(n+=l),l=e>n?0:n-e>>>0,e>>>=0;for(var f=Array(l);++a<l;)f[a]=r[a+e];return f}var cv=Cx,Ex=/\s/;function Ax(r){for(var e=r.length;e--&&Ex.test(r.charAt(e)););return e}var wx=Ax,kx=wx,Ox=/^\s+/;function xx(r){return r&&r.slice(0,kx(r)+1).replace(Ox,"")}var Rx=xx,Px=Rx,Up=ii,Lx=Ch,Hp=0/0,Ix=/^[-+]0x[0-9a-f]+$/i,Nx=/^0b[01]+$/i,Mx=/^0o[0-7]+$/i,Dx=parseInt;function Fx(r){if(typeof r=="number")return r;if(Lx(r))return Hp;if(Up(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=Up(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=Px(r);var n=Nx.test(r);return n||Mx.test(r)?Dx(r.slice(2),n?2:8):Ix.test(r)?Hp:+r}var $x=Fx,Gx=$x,zp=1/0,Wx=17976931348623157e292;function Bx(r){if(!r)return r===0?r:0;if(r=Gx(r),r===zp||r===-zp){var e=r<0?-1:1;return e*Wx}return r===r?r:0}var Ux=Bx,Hx=Ux;function zx(r){var e=Hx(r),n=e%1;return e===e?n?e-n:e:0}var ru=zx,jx=cv,Yx=ru;function Xx(r,e,n){var a=r==null?0:r.length;return a?(e=n||e===void 0?1:Yx(e),jx(r,e<0?0:e,a)):[]}var dv=Xx,nr={},bt={},Kx=Ka,qx=kt,Vx=ai,Zx="[object String]";function Qx(r){return typeof r=="string"||!qx(r)&&Vx(r)&&Kx(r)==Zx}var xh=Qx,Jx=Ka,eR=ai,tR="[object RegExp]";function rR(r){return eR(r)&&Jx(r)==tR}var nR=rR,iR=nR,aR=Vl,jp=ts.exports,Yp=jp&&jp.isRegExp,oR=Yp?aR(Yp):iR,P0=oR,sR=Ah,lR=Eh,uR=Th,Xp=ii,fR=Jl;function hR(r,e,n,a){if(!Xp(r))return r;e=lR(e,r);for(var l=-1,f=e.length,h=f-1,v=r;v!=null&&++l<f;){var d=fR(e[l]),p=n;if(d==="__proto__"||d==="constructor"||d==="prototype")return r;if(l!=h){var S=v[d];p=a?a(S,d,v):void 0,p===void 0&&(p=Xp(S)?S:uR(e[l+1])?[]:{})}sR(v,d,p),v=v[d]}return r}var cR=hR,dR=uv,vR=cR,pR=Eh;function gR(r,e,n){for(var a=-1,l=e.length,f={};++a<l;){var h=e[a],v=dR(r,h);n(v,h)&&vR(f,pR(h,r),v)}return f}var yR=gR,mR=Zl,_R=li,bR=yR,SR=k0;function TR(r,e){if(r==null)return{};var n=mR(SR(r),function(a){return[a]});return e=_R(e),bR(r,n,function(a,l){return e(a,l[0])})}var L0=TR;function CR(r,e,n){switch(n.length){case 0:return r.call(e);case 1:return r.call(e,n[0]);case 2:return r.call(e,n[0],n[1]);case 3:return r.call(e,n[0],n[1],n[2])}return r.apply(e,n)}var ER=CR,AR=ER,Kp=Math.max;function wR(r,e,n){return e=Kp(e===void 0?r.length-1:e,0),function(){for(var a=arguments,l=-1,f=Kp(a.length-e,0),h=Array(f);++l<f;)h[l]=a[e+l];l=-1;for(var v=Array(e+1);++l<e;)v[l]=a[l];return v[e]=n(h),AR(r,this,v)}}var kR=wR;function OR(r){return function(){return r}}var xR=OR,RR=xR,qp=E0,PR=eu,LR=qp?function(r,e){return qp(r,"toString",{configurable:!0,enumerable:!1,value:RR(e),writable:!0})}:PR,IR=LR,NR=800,MR=16,DR=Date.now;function FR(r){var e=0,n=0;return function(){var a=DR(),l=MR-(a-n);if(n=a,l>0){if(++e>=NR)return arguments[0]}else e=0;return r.apply(void 0,arguments)}}var $R=FR,GR=IR,WR=$R,BR=WR(GR),UR=BR,HR=eu,zR=kR,jR=UR;function YR(r,e){return jR(zR(r,e,HR),r+"")}var vv=YR,XR=Ql,KR=oi,qR=Th,VR=ii;function ZR(r,e,n){if(!VR(n))return!1;var a=typeof e;return(a=="number"?KR(n)&&qR(e,n.length):a=="string"&&e in n)?XR(n[e],r):!1}var Rh=ZR,QR=vv,JR=Rh;function eP(r){return QR(function(e,n){var a=-1,l=n.length,f=l>1?n[l-1]:void 0,h=l>2?n[2]:void 0;for(f=r.length>3&&typeof f=="function"?(l--,f):void 0,h&&JR(n[0],n[1],h)&&(f=l<3?void 0:f,l=1),e=Object(e);++a<l;){var v=n[a];v&&r(e,v,a,f)}return e})}var tP=eP,rP=Ah,nP=tu,iP=tP,aP=oi,oP=Xl,sP=pn,lP=Object.prototype,uP=lP.hasOwnProperty,fP=iP(function(r,e){if(oP(e)||aP(e)){nP(e,sP(e),r);return}for(var n in e)uP.call(e,n)&&rP(r,n,e[n])}),Ph=fP,Ni=_e&&_e.__extends||function(){var r=function(e,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,l){a.__proto__=l}||function(a,l){for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(a[f]=l[f])},r(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");r(e,n);function a(){this.constructor=e}e.prototype=n===null?Object.create(n):(a.prototype=n.prototype,new a)}}(),gs=_e&&_e.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(bt,"__esModule",{value:!0});bt.serializeProduction=bt.serializeGrammar=bt.Terminal=bt.Alternation=bt.RepetitionWithSeparator=bt.Repetition=bt.RepetitionMandatoryWithSeparator=bt.RepetitionMandatory=bt.Option=bt.Alternative=bt.Rule=bt.NonTerminal=bt.AbstractProduction=void 0;var I0=gs(Kr),hP=gs(Rr),Md=gs(xh),cP=gs(P0),ui=gs(L0),fi=gs(Ph);function dP(r){return vP(r)?r.LABEL:r.name}function vP(r){return(0,Md.default)(r.LABEL)&&r.LABEL!==""}var hi=function(){function r(e){this._definition=e}return Object.defineProperty(r.prototype,"definition",{get:function(){return this._definition},set:function(e){this._definition=e},enumerable:!1,configurable:!0}),r.prototype.accept=function(e){e.visit(this),(0,hP.default)(this.definition,function(n){n.accept(e)})},r}();bt.AbstractProduction=hi;var N0=function(r){Ni(e,r);function e(n){var a=r.call(this,[])||this;return a.idx=1,(0,fi.default)(a,(0,ui.default)(n,function(l){return l!==void 0})),a}return Object.defineProperty(e.prototype,"definition",{get:function(){return this.referencedRule!==void 0?this.referencedRule.definition:[]},set:function(n){},enumerable:!1,configurable:!0}),e.prototype.accept=function(n){n.visit(this)},e}(hi);bt.NonTerminal=N0;var M0=function(r){Ni(e,r);function e(n){var a=r.call(this,n.definition)||this;return a.orgText="",(0,fi.default)(a,(0,ui.default)(n,function(l){return l!==void 0})),a}return e}(hi);bt.Rule=M0;var D0=function(r){Ni(e,r);function e(n){var a=r.call(this,n.definition)||this;return a.ignoreAmbiguities=!1,(0,fi.default)(a,(0,ui.default)(n,function(l){return l!==void 0})),a}return e}(hi);bt.Alternative=D0;var F0=function(r){Ni(e,r);function e(n){var a=r.call(this,n.definition)||this;return a.idx=1,(0,fi.default)(a,(0,ui.default)(n,function(l){return l!==void 0})),a}return e}(hi);bt.Option=F0;var $0=function(r){Ni(e,r);function e(n){var a=r.call(this,n.definition)||this;return a.idx=1,(0,fi.default)(a,(0,ui.default)(n,function(l){return l!==void 0})),a}return e}(hi);bt.RepetitionMandatory=$0;var G0=function(r){Ni(e,r);function e(n){var a=r.call(this,n.definition)||this;return a.idx=1,(0,fi.default)(a,(0,ui.default)(n,function(l){return l!==void 0})),a}return e}(hi);bt.RepetitionMandatoryWithSeparator=G0;var W0=function(r){Ni(e,r);function e(n){var a=r.call(this,n.definition)||this;return a.idx=1,(0,fi.default)(a,(0,ui.default)(n,function(l){return l!==void 0})),a}return e}(hi);bt.Repetition=W0;var B0=function(r){Ni(e,r);function e(n){var a=r.call(this,n.definition)||this;return a.idx=1,(0,fi.default)(a,(0,ui.default)(n,function(l){return l!==void 0})),a}return e}(hi);bt.RepetitionWithSeparator=B0;var U0=function(r){Ni(e,r);function e(n){var a=r.call(this,n.definition)||this;return a.idx=1,a.ignoreAmbiguities=!1,a.hasPredicates=!1,(0,fi.default)(a,(0,ui.default)(n,function(l){return l!==void 0})),a}return Object.defineProperty(e.prototype,"definition",{get:function(){return this._definition},set:function(n){this._definition=n},enumerable:!1,configurable:!0}),e}(hi);bt.Alternation=U0;var oh=function(){function r(e){this.idx=1,(0,fi.default)(this,(0,ui.default)(e,function(n){return n!==void 0}))}return r.prototype.accept=function(e){e.visit(this)},r}();bt.Terminal=oh;function pP(r){return(0,I0.default)(r,Dl)}bt.serializeGrammar=pP;function Dl(r){function e(f){return(0,I0.default)(f,Dl)}if(r instanceof N0){var n={type:"NonTerminal",name:r.nonTerminalName,idx:r.idx};return(0,Md.default)(r.label)&&(n.label=r.label),n}else{if(r instanceof D0)return{type:"Alternative",definition:e(r.definition)};if(r instanceof F0)return{type:"Option",idx:r.idx,definition:e(r.definition)};if(r instanceof $0)return{type:"RepetitionMandatory",idx:r.idx,definition:e(r.definition)};if(r instanceof G0)return{type:"RepetitionMandatoryWithSeparator",idx:r.idx,separator:Dl(new oh({terminalType:r.separator})),definition:e(r.definition)};if(r instanceof B0)return{type:"RepetitionWithSeparator",idx:r.idx,separator:Dl(new oh({terminalType:r.separator})),definition:e(r.definition)};if(r instanceof W0)return{type:"Repetition",idx:r.idx,definition:e(r.definition)};if(r instanceof U0)return{type:"Alternation",idx:r.idx,definition:e(r.definition)};if(r instanceof oh){var a={type:"Terminal",name:r.terminalType.name,label:dP(r.terminalType),idx:r.idx};(0,Md.default)(r.label)&&(a.terminalLabel=r.label);var l=r.terminalType.PATTERN;return r.terminalType.PATTERN&&(a.pattern=(0,cP.default)(l)?l.source:l),a}else{if(r instanceof M0)return{type:"Rule",name:r.name,orgText:r.orgText,definition:e(r.definition)};throw Error("non exhaustive match")}}}bt.serializeProduction=Dl;var Lh={};Object.defineProperty(Lh,"__esModule",{value:!0});Lh.GAstVisitor=void 0;var Qn=bt,gP=function(){function r(){}return r.prototype.visit=function(e){var n=e;switch(n.constructor){case Qn.NonTerminal:return this.visitNonTerminal(n);case Qn.Alternative:return this.visitAlternative(n);case Qn.Option:return this.visitOption(n);case Qn.RepetitionMandatory:return this.visitRepetitionMandatory(n);case Qn.RepetitionMandatoryWithSeparator:return this.visitRepetitionMandatoryWithSeparator(n);case Qn.RepetitionWithSeparator:return this.visitRepetitionWithSeparator(n);case Qn.Repetition:return this.visitRepetition(n);case Qn.Alternation:return this.visitAlternation(n);case Qn.Terminal:return this.visitTerminal(n);case Qn.Rule:return this.visitRule(n);default:throw Error("non exhaustive match")}},r.prototype.visitNonTerminal=function(e){},r.prototype.visitAlternative=function(e){},r.prototype.visitOption=function(e){},r.prototype.visitRepetition=function(e){},r.prototype.visitRepetitionMandatory=function(e){},r.prototype.visitRepetitionMandatoryWithSeparator=function(e){},r.prototype.visitRepetitionWithSeparator=function(e){},r.prototype.visitAlternation=function(e){},r.prototype.visitTerminal=function(e){},r.prototype.visitRule=function(e){},r}();Lh.GAstVisitor=gP;var ti={},yP=Va;function mP(r,e){var n;return yP(r,function(a,l,f){return n=e(a,l,f),!n}),!!n}var _P=mP,bP=l0,SP=li,TP=_P,CP=kt,EP=Rh;function AP(r,e,n){var a=CP(r)?bP:TP;return n&&EP(r,e,n)&&(e=void 0),a(r,SP(e))}var pv=AP;function wP(r,e){for(var n=-1,a=r==null?0:r.length;++n<a;)if(!e(r[n],n,r))return!1;return!0}var kP=wP,OP=Va;function xP(r,e){var n=!0;return OP(r,function(a,l,f){return n=!!e(a,l,f),n}),n}var RP=xP,PP=kP,LP=RP,IP=li,NP=kt,MP=Rh;function DP(r,e,n){var a=NP(r)?PP:LP;return n&&MP(r,e,n)&&(e=void 0),a(r,IP(e))}var Ih=DP;function FP(r,e,n,a){for(var l=r.length,f=n+(a?1:-1);a?f--:++f<l;)if(e(r[f],f,r))return f;return-1}var H0=FP;function $P(r){return r!==r}var GP=$P;function WP(r,e,n){for(var a=n-1,l=r.length;++a<l;)if(r[a]===e)return a;return-1}var BP=WP,UP=H0,HP=GP,zP=BP;function jP(r,e,n){return e===e?zP(r,e,n):UP(r,HP,n)}var gv=jP,YP=gv,XP=oi,KP=xh,qP=ru,VP=Ii,ZP=Math.max;function QP(r,e,n,a){r=XP(r)?r:VP(r),n=n&&!a?qP(n):0;var l=r.length;return n<0&&(n=ZP(l+n,0)),KP(r)?n<=l&&r.indexOf(e,n)>-1:!!l&&YP(r,e,n)>-1}var Mi=QP,yv=_e&&_e.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(ti,"__esModule",{value:!0});ti.getProductionDslName=ti.isBranchingProd=ti.isOptionalProd=ti.isSequenceProd=void 0;var JP=yv(pv),eL=yv(Ih),tL=yv(Mi),Dt=bt;function rL(r){return r instanceof Dt.Alternative||r instanceof Dt.Option||r instanceof Dt.Repetition||r instanceof Dt.RepetitionMandatory||r instanceof Dt.RepetitionMandatoryWithSeparator||r instanceof Dt.RepetitionWithSeparator||r instanceof Dt.Terminal||r instanceof Dt.Rule}ti.isSequenceProd=rL;function Dd(r,e){e===void 0&&(e=[]);var n=r instanceof Dt.Option||r instanceof Dt.Repetition||r instanceof Dt.RepetitionWithSeparator;return n?!0:r instanceof Dt.Alternation?(0,JP.default)(r.definition,function(a){return Dd(a,e)}):r instanceof Dt.NonTerminal&&(0,tL.default)(e,r)?!1:r instanceof Dt.AbstractProduction?(r instanceof Dt.NonTerminal&&e.push(r),(0,eL.default)(r.definition,function(a){return Dd(a,e)})):!1}ti.isOptionalProd=Dd;function nL(r){return r instanceof Dt.Alternation}ti.isBranchingProd=nL;function iL(r){if(r instanceof Dt.NonTerminal)return"SUBRULE";if(r instanceof Dt.Option)return"OPTION";if(r instanceof Dt.Alternation)return"OR";if(r instanceof Dt.RepetitionMandatory)return"AT_LEAST_ONE";if(r instanceof Dt.RepetitionMandatoryWithSeparator)return"AT_LEAST_ONE_SEP";if(r instanceof Dt.RepetitionWithSeparator)return"MANY_SEP";if(r instanceof Dt.Repetition)return"MANY";if(r instanceof Dt.Terminal)return"CONSUME";throw Error("non exhaustive match")}ti.getProductionDslName=iL;(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.isSequenceProd=r.isBranchingProd=r.isOptionalProd=r.getProductionDslName=r.GAstVisitor=r.serializeProduction=r.serializeGrammar=r.Alternative=r.Alternation=r.RepetitionWithSeparator=r.RepetitionMandatoryWithSeparator=r.RepetitionMandatory=r.Repetition=r.Option=r.NonTerminal=r.Terminal=r.Rule=void 0;var e=bt;Object.defineProperty(r,"Rule",{enumerable:!0,get:function(){return e.Rule}}),Object.defineProperty(r,"Terminal",{enumerable:!0,get:function(){return e.Terminal}}),Object.defineProperty(r,"NonTerminal",{enumerable:!0,get:function(){return e.NonTerminal}}),Object.defineProperty(r,"Option",{enumerable:!0,get:function(){return e.Option}}),Object.defineProperty(r,"Repetition",{enumerable:!0,get:function(){return e.Repetition}}),Object.defineProperty(r,"RepetitionMandatory",{enumerable:!0,get:function(){return e.RepetitionMandatory}}),Object.defineProperty(r,"RepetitionMandatoryWithSeparator",{enumerable:!0,get:function(){return e.RepetitionMandatoryWithSeparator}}),Object.defineProperty(r,"RepetitionWithSeparator",{enumerable:!0,get:function(){return e.RepetitionWithSeparator}}),Object.defineProperty(r,"Alternation",{enumerable:!0,get:function(){return e.Alternation}}),Object.defineProperty(r,"Alternative",{enumerable:!0,get:function(){return e.Alternative}}),Object.defineProperty(r,"serializeGrammar",{enumerable:!0,get:function(){return e.serializeGrammar}}),Object.defineProperty(r,"serializeProduction",{enumerable:!0,get:function(){return e.serializeProduction}});var n=Lh;Object.defineProperty(r,"GAstVisitor",{enumerable:!0,get:function(){return n.GAstVisitor}});var a=ti;Object.defineProperty(r,"getProductionDslName",{enumerable:!0,get:function(){return a.getProductionDslName}}),Object.defineProperty(r,"isOptionalProd",{enumerable:!0,get:function(){return a.isOptionalProd}}),Object.defineProperty(r,"isBranchingProd",{enumerable:!0,get:function(){return a.isBranchingProd}}),Object.defineProperty(r,"isSequenceProd",{enumerable:!0,get:function(){return a.isSequenceProd}})})(nr);var z0=_e&&_e.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(ps,"__esModule",{value:!0});ps.RestWalker=void 0;var aL=z0(dv),Vp=z0(Rr),Xr=nr,oL=function(){function r(){}return r.prototype.walk=function(e,n){var a=this;n===void 0&&(n=[]),(0,Vp.default)(e.definition,function(l,f){var h=(0,aL.default)(e.definition,f+1);if(l instanceof Xr.NonTerminal)a.walkProdRef(l,h,n);else if(l instanceof Xr.Terminal)a.walkTerminal(l,h,n);else if(l instanceof Xr.Alternative)a.walkFlat(l,h,n);else if(l instanceof Xr.Option)a.walkOption(l,h,n);else if(l instanceof Xr.RepetitionMandatory)a.walkAtLeastOne(l,h,n);else if(l instanceof Xr.RepetitionMandatoryWithSeparator)a.walkAtLeastOneSep(l,h,n);else if(l instanceof Xr.RepetitionWithSeparator)a.walkManySep(l,h,n);else if(l instanceof Xr.Repetition)a.walkMany(l,h,n);else if(l instanceof Xr.Alternation)a.walkOr(l,h,n);else throw Error("non exhaustive match")})},r.prototype.walkTerminal=function(e,n,a){},r.prototype.walkProdRef=function(e,n,a){},r.prototype.walkFlat=function(e,n,a){var l=n.concat(a);this.walk(e,l)},r.prototype.walkOption=function(e,n,a){var l=n.concat(a);this.walk(e,l)},r.prototype.walkAtLeastOne=function(e,n,a){var l=[new Xr.Option({definition:e.definition})].concat(n,a);this.walk(e,l)},r.prototype.walkAtLeastOneSep=function(e,n,a){var l=Zp(e,n,a);this.walk(e,l)},r.prototype.walkMany=function(e,n,a){var l=[new Xr.Option({definition:e.definition})].concat(n,a);this.walk(e,l)},r.prototype.walkManySep=function(e,n,a){var l=Zp(e,n,a);this.walk(e,l)},r.prototype.walkOr=function(e,n,a){var l=this,f=n.concat(a);(0,Vp.default)(e.definition,function(h){var v=new Xr.Alternative({definition:[h]});l.walk(v,f)})},r}();ps.RestWalker=oL;function Zp(r,e,n){var a=[new Xr.Option({definition:[new Xr.Terminal({terminalType:r.separator})].concat(r.definition)})],l=a.concat(e,n);return l}var $n={},Qp=ls,sL=yh,lL=kt,Jp=Qp?Qp.isConcatSpreadable:void 0;function uL(r){return lL(r)||sL(r)||!!(Jp&&r&&r[Jp])}var fL=uL,hL=iv,cL=fL;function j0(r,e,n,a,l){var f=-1,h=r.length;for(n||(n=cL),l||(l=[]);++f<h;){var v=r[f];e>0&&n(v)?e>1?j0(v,e-1,n,a,l):hL(l,v):a||(l[l.length]=v)}return l}var mv=j0,dL=mv;function vL(r){var e=r==null?0:r.length;return e?dL(r,1):[]}var Di=vL,pL=gv;function gL(r,e){var n=r==null?0:r.length;return!!n&&pL(r,e,0)>-1}var Y0=gL;function yL(r,e,n){for(var a=-1,l=r==null?0:r.length;++a<l;)if(n(e,r[a]))return!0;return!1}var X0=yL;function mL(){}var _v=mL,cd=a0,_L=_v,bL=nv,SL=1/0,TL=cd&&1/bL(new cd([,-0]))[1]==SL?function(r){return new cd(r)}:_L,CL=TL,EL=tv,AL=Y0,wL=X0,kL=rv,OL=CL,xL=nv,RL=200;function PL(r,e,n){var a=-1,l=AL,f=r.length,h=!0,v=[],d=v;if(n)h=!1,l=wL;else if(f>=RL){var p=e?null:OL(r);if(p)return xL(p);h=!1,l=kL,d=new EL}else d=e?[]:v;e:for(;++a<f;){var S=r[a],E=e?e(S):S;if(S=n||S!==0?S:0,h&&E===E){for(var A=d.length;A--;)if(d[A]===E)continue e;e&&d.push(E),v.push(S)}else l(d,E,n)||(d!==v&&d.push(E),v.push(S))}return v}var LL=PL,IL=LL;function NL(r){return r&&r.length?IL(r):[]}var bv=NL,Sv=_e&&_e.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty($n,"__esModule",{value:!0});$n.firstForTerminal=$n.firstForBranching=$n.firstForSequence=$n.first=void 0;var ML=Sv(Di),K0=Sv(bv),DL=Sv(Kr),eg=nr,Fd=nr;function Nh(r){if(r instanceof eg.NonTerminal)return Nh(r.referencedRule);if(r instanceof eg.Terminal)return Z0(r);if((0,Fd.isSequenceProd)(r))return q0(r);if((0,Fd.isBranchingProd)(r))return V0(r);throw Error("non exhaustive match")}$n.first=Nh;function q0(r){for(var e=[],n=r.definition,a=0,l=n.length>a,f,h=!0;l&&h;)f=n[a],h=(0,Fd.isOptionalProd)(f),e=e.concat(Nh(f)),a=a+1,l=n.length>a;return(0,K0.default)(e)}$n.firstForSequence=q0;function V0(r){var e=(0,DL.default)(r.definition,function(n){return Nh(n)});return(0,K0.default)((0,ML.default)(e))}$n.firstForBranching=V0;function Z0(r){return[r.terminalType]}$n.firstForTerminal=Z0;var nu={};Object.defineProperty(nu,"__esModule",{value:!0});nu.IN=void 0;nu.IN="_~IN~_";var FL=_e&&_e.__extends||function(){var r=function(e,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,l){a.__proto__=l}||function(a,l){for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(a[f]=l[f])},r(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");r(e,n);function a(){this.constructor=e}e.prototype=n===null?Object.create(n):(a.prototype=n.prototype,new a)}}(),Q0=_e&&_e.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(ei,"__esModule",{value:!0});ei.buildInProdFollowPrefix=ei.buildBetweenProdsFollowPrefix=ei.computeAllProdsFollows=ei.ResyncFollowsWalker=void 0;var $L=ps,GL=$n,WL=Q0(Rr),BL=Q0(Ph),J0=nu,UL=nr,ey=function(r){FL(e,r);function e(n){var a=r.call(this)||this;return a.topProd=n,a.follows={},a}return e.prototype.startWalking=function(){return this.walk(this.topProd),this.follows},e.prototype.walkTerminal=function(n,a,l){},e.prototype.walkProdRef=function(n,a,l){var f=ty(n.referencedRule,n.idx)+this.topProd.name,h=a.concat(l),v=new UL.Alternative({definition:h}),d=(0,GL.first)(v);this.follows[f]=d},e}($L.RestWalker);ei.ResyncFollowsWalker=ey;function HL(r){var e={};return(0,WL.default)(r,function(n){var a=new ey(n).startWalking();(0,BL.default)(e,a)}),e}ei.computeAllProdsFollows=HL;function ty(r,e){return r.name+e+J0.IN}ei.buildBetweenProdsFollowPrefix=ty;function zL(r){var e=r.terminalType.name;return e+r.idx+J0.IN}ei.buildInProdFollowPrefix=zL;var Za={};function jL(r){return r===void 0}var ys=jL,iu={},Tv={},Mh={exports:{}};(function(r){(function(e,n){r.exports?r.exports=n():e.regexpToAst=n()})(typeof self!="undefined"?self:_e,function(){function e(){}e.prototype.saveState=function(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}},e.prototype.restoreState=function(T){this.idx=T.idx,this.input=T.input,this.groupIdx=T.groupIdx},e.prototype.pattern=function(T){this.idx=0,this.input=T,this.groupIdx=0,this.consumeChar("/");var x=this.disjunction();this.consumeChar("/");for(var G={type:"Flags",loc:{begin:this.idx,end:T.length},global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};this.isRegExpFlag();)switch(this.popChar()){case"g":v(G,"global");break;case"i":v(G,"ignoreCase");break;case"m":v(G,"multiLine");break;case"u":v(G,"unicode");break;case"y":v(G,"sticky");break}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:G,value:x,loc:this.loc(0)}},e.prototype.disjunction=function(){var T=[],x=this.idx;for(T.push(this.alternative());this.peekChar()==="|";)this.consumeChar("|"),T.push(this.alternative());return{type:"Disjunction",value:T,loc:this.loc(x)}},e.prototype.alternative=function(){for(var T=[],x=this.idx;this.isTerm();)T.push(this.term());return{type:"Alternative",value:T,loc:this.loc(x)}},e.prototype.term=function(){return this.isAssertion()?this.assertion():this.atom()},e.prototype.assertion=function(){var T=this.idx;switch(this.popChar()){case"^":return{type:"StartAnchor",loc:this.loc(T)};case"$":return{type:"EndAnchor",loc:this.loc(T)};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary",loc:this.loc(T)};case"B":return{type:"NonWordBoundary",loc:this.loc(T)}}throw Error("Invalid Assertion Escape");case"(":this.consumeChar("?");var x;switch(this.popChar()){case"=":x="Lookahead";break;case"!":x="NegativeLookahead";break}d(x);var G=this.disjunction();return this.consumeChar(")"),{type:x,value:G,loc:this.loc(T)}}p()},e.prototype.quantifier=function(T){var x,G=this.idx;switch(this.popChar()){case"*":x={atLeast:0,atMost:1/0};break;case"+":x={atLeast:1,atMost:1/0};break;case"?":x={atLeast:0,atMost:1};break;case"{":var j=this.integerIncludingZero();switch(this.popChar()){case"}":x={atLeast:j,atMost:j};break;case",":var B;this.isDigit()?(B=this.integerIncludingZero(),x={atLeast:j,atMost:B}):x={atLeast:j,atMost:1/0},this.consumeChar("}");break}if(T===!0&&x===void 0)return;d(x);break}if(!(T===!0&&x===void 0))return d(x),this.peekChar(0)==="?"?(this.consumeChar("?"),x.greedy=!1):x.greedy=!0,x.type="Quantifier",x.loc=this.loc(G),x},e.prototype.atom=function(){var T,x=this.idx;switch(this.peekChar()){case".":T=this.dotAll();break;case"\\":T=this.atomEscape();break;case"[":T=this.characterClass();break;case"(":T=this.group();break}return T===void 0&&this.isPatternCharacter()&&(T=this.patternCharacter()),d(T),T.loc=this.loc(x),this.isQuantifier()&&(T.quantifier=this.quantifier()),T},e.prototype.dotAll=function(){return this.consumeChar("."),{type:"Set",complement:!0,value:[f(`
`),f("\r"),f("\u2028"),f("\u2029")]}},e.prototype.atomEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.decimalEscapeAtom=function(){var T=this.positiveInteger();return{type:"GroupBackReference",value:T}},e.prototype.characterClassEscape=function(){var T,x=!1;switch(this.popChar()){case"d":T=E;break;case"D":T=E,x=!0;break;case"s":T=O;break;case"S":T=O,x=!0;break;case"w":T=A;break;case"W":T=A,x=!0;break}return d(T),{type:"Set",value:T,complement:x}},e.prototype.controlEscapeAtom=function(){var T;switch(this.popChar()){case"f":T=f("\f");break;case"n":T=f(`
`);break;case"r":T=f("\r");break;case"t":T=f("	");break;case"v":T=f("\v");break}return d(T),{type:"Character",value:T}},e.prototype.controlLetterEscapeAtom=function(){this.consumeChar("c");var T=this.popChar();if(/[a-zA-Z]/.test(T)===!1)throw Error("Invalid ");var x=T.toUpperCase().charCodeAt(0)-64;return{type:"Character",value:x}},e.prototype.nulCharacterAtom=function(){return this.consumeChar("0"),{type:"Character",value:f("\0")}},e.prototype.hexEscapeSequenceAtom=function(){return this.consumeChar("x"),this.parseHexDigits(2)},e.prototype.regExpUnicodeEscapeSequenceAtom=function(){return this.consumeChar("u"),this.parseHexDigits(4)},e.prototype.identityEscapeAtom=function(){var T=this.popChar();return{type:"Character",value:f(T)}},e.prototype.classPatternCharacterAtom=function(){switch(this.peekChar()){case`
`:case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:var T=this.popChar();return{type:"Character",value:f(T)}}},e.prototype.characterClass=function(){var T=[],x=!1;for(this.consumeChar("["),this.peekChar(0)==="^"&&(this.consumeChar("^"),x=!0);this.isClassAtom();){var G=this.classAtom(),j=G.type==="Character";if(j&&this.isRangeDash()){this.consumeChar("-");var B=this.classAtom(),U=B.type==="Character";if(U){if(B.value<G.value)throw Error("Range out of order in character class");T.push({from:G.value,to:B.value})}else h(G.value,T),T.push(f("-")),h(B.value,T)}else h(G.value,T)}return this.consumeChar("]"),{type:"Set",complement:x,value:T}},e.prototype.classAtom=function(){switch(this.peekChar()){case"]":case`
`:case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}},e.prototype.classEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:f("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.group=function(){var T=!0;switch(this.consumeChar("("),this.peekChar(0)){case"?":this.consumeChar("?"),this.consumeChar(":"),T=!1;break;default:this.groupIdx++;break}var x=this.disjunction();this.consumeChar(")");var G={type:"Group",capturing:T,value:x};return T&&(G.idx=this.groupIdx),G},e.prototype.positiveInteger=function(){var T=this.popChar();if(l.test(T)===!1)throw Error("Expecting a positive integer");for(;a.test(this.peekChar(0));)T+=this.popChar();return parseInt(T,10)},e.prototype.integerIncludingZero=function(){var T=this.popChar();if(a.test(T)===!1)throw Error("Expecting an integer");for(;a.test(this.peekChar(0));)T+=this.popChar();return parseInt(T,10)},e.prototype.patternCharacter=function(){var T=this.popChar();switch(T){case`
`:case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:f(T)}}},e.prototype.isRegExpFlag=function(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}},e.prototype.isRangeDash=function(){return this.peekChar()==="-"&&this.isClassAtom(1)},e.prototype.isDigit=function(){return a.test(this.peekChar(0))},e.prototype.isClassAtom=function(T){switch(T===void 0&&(T=0),this.peekChar(T)){case"]":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.isTerm=function(){return this.isAtom()||this.isAssertion()},e.prototype.isAtom=function(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}},e.prototype.isAssertion=function(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return this.peekChar(1)==="?"&&(this.peekChar(2)==="="||this.peekChar(2)==="!");default:return!1}},e.prototype.isQuantifier=function(){var T=this.saveState();try{return this.quantifier(!0)!==void 0}catch{return!1}finally{this.restoreState(T)}},e.prototype.isPatternCharacter=function(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.parseHexDigits=function(T){for(var x="",G=0;G<T;G++){var j=this.popChar();if(n.test(j)===!1)throw Error("Expecting a HexDecimal digits");x+=j}var B=parseInt(x,16);return{type:"Character",value:B}},e.prototype.peekChar=function(T){return T===void 0&&(T=0),this.input[this.idx+T]},e.prototype.popChar=function(){var T=this.peekChar(0);return this.consumeChar(),T},e.prototype.consumeChar=function(T){if(T!==void 0&&this.input[this.idx]!==T)throw Error("Expected: '"+T+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++},e.prototype.loc=function(T){return{begin:T,end:this.idx}};var n=/[0-9a-fA-F]/,a=/[0-9]/,l=/[1-9]/;function f(T){return T.charCodeAt(0)}function h(T,x){T.length!==void 0?T.forEach(function(G){x.push(G)}):x.push(T)}function v(T,x){if(T[x]===!0)throw"duplicate flag "+x;T[x]=!0}function d(T){if(T===void 0)throw Error("Internal Error - Should never get here!")}function p(){throw Error("Internal Error - Should never get here!")}var S,E=[];for(S=f("0");S<=f("9");S++)E.push(S);var A=[f("_")].concat(E);for(S=f("a");S<=f("z");S++)A.push(S);for(S=f("A");S<=f("Z");S++)A.push(S);var O=[f(" "),f("\f"),f(`
`),f("\r"),f("	"),f("\v"),f("	"),f("\xA0"),f("\u1680"),f("\u2000"),f("\u2001"),f("\u2002"),f("\u2003"),f("\u2004"),f("\u2005"),f("\u2006"),f("\u2007"),f("\u2008"),f("\u2009"),f("\u200A"),f("\u2028"),f("\u2029"),f("\u202F"),f("\u205F"),f("\u3000"),f("\uFEFF")];function k(){}return k.prototype.visitChildren=function(T){for(var x in T){var G=T[x];T.hasOwnProperty(x)&&(G.type!==void 0?this.visit(G):Array.isArray(G)&&G.forEach(function(j){this.visit(j)},this))}},k.prototype.visit=function(T){switch(T.type){case"Pattern":this.visitPattern(T);break;case"Flags":this.visitFlags(T);break;case"Disjunction":this.visitDisjunction(T);break;case"Alternative":this.visitAlternative(T);break;case"StartAnchor":this.visitStartAnchor(T);break;case"EndAnchor":this.visitEndAnchor(T);break;case"WordBoundary":this.visitWordBoundary(T);break;case"NonWordBoundary":this.visitNonWordBoundary(T);break;case"Lookahead":this.visitLookahead(T);break;case"NegativeLookahead":this.visitNegativeLookahead(T);break;case"Character":this.visitCharacter(T);break;case"Set":this.visitSet(T);break;case"Group":this.visitGroup(T);break;case"GroupBackReference":this.visitGroupBackReference(T);break;case"Quantifier":this.visitQuantifier(T);break}this.visitChildren(T)},k.prototype.visitPattern=function(T){},k.prototype.visitFlags=function(T){},k.prototype.visitDisjunction=function(T){},k.prototype.visitAlternative=function(T){},k.prototype.visitStartAnchor=function(T){},k.prototype.visitEndAnchor=function(T){},k.prototype.visitWordBoundary=function(T){},k.prototype.visitNonWordBoundary=function(T){},k.prototype.visitLookahead=function(T){},k.prototype.visitNegativeLookahead=function(T){},k.prototype.visitCharacter=function(T){},k.prototype.visitSet=function(T){},k.prototype.visitGroup=function(T){},k.prototype.visitGroupBackReference=function(T){},k.prototype.visitQuantifier=function(T){},{RegExpParser:e,BaseRegExpVisitor:k,VERSION:"0.5.0"}})})(Mh);function YL(r){return r&&r.length?r[0]:void 0}var XL=YL,au=XL;function KL(r){for(var e=-1,n=r==null?0:r.length,a=0,l=[];++e<n;){var f=r[e];f&&(l[a++]=f)}return l}var Dh=KL,qL=Va;function VL(r,e){var n=[];return qL(r,function(a,l,f){e(a,l,f)&&n.push(a)}),n}var ry=VL,ZL="Expected a function";function QL(r){if(typeof r!="function")throw new TypeError(ZL);return function(){var e=arguments;switch(e.length){case 0:return!r.call(this);case 1:return!r.call(this,e[0]);case 2:return!r.call(this,e[0],e[1]);case 3:return!r.call(this,e[0],e[1],e[2])}return!r.apply(this,e)}}var JL=QL,eI=av,tI=ry,rI=li,nI=kt,iI=JL;function aI(r,e){var n=nI(r)?eI:tI;return n(r,iI(rI(e)))}var Cv=aI,oI=tv,sI=Y0,lI=X0,uI=Zl,fI=Vl,hI=rv,cI=200;function dI(r,e,n,a){var l=-1,f=sI,h=!0,v=r.length,d=[],p=e.length;if(!v)return d;n&&(e=uI(e,fI(n))),a?(f=lI,h=!1):e.length>=cI&&(f=hI,h=!1,e=new oI(e));e:for(;++l<v;){var S=r[l],E=n==null?S:n(S);if(S=a||S!==0?S:0,h&&E===E){for(var A=p;A--;)if(e[A]===E)continue e;d.push(S)}else f(e,E,a)||d.push(S)}return d}var vI=dI,pI=oi,gI=ai;function yI(r){return gI(r)&&pI(r)}var mI=yI,_I=vI,bI=mv,SI=vv,tg=mI,TI=SI(function(r,e){return tg(r)?_I(r,bI(e,1,tg,!0)):[]}),Ev=TI,CI=gv,EI=ru,AI=Math.max;function wI(r,e,n){var a=r==null?0:r.length;if(!a)return-1;var l=n==null?0:EI(n);return l<0&&(l=AI(a+l,0)),CI(r,e,l)}var kI=wI,OI=li,xI=oi,RI=pn;function PI(r){return function(e,n,a){var l=Object(e);if(!xI(e)){var f=OI(n);e=RI(e),n=function(v){return f(l[v],v,l)}}var h=r(e,n,a);return h>-1?l[f?e[h]:h]:void 0}}var LI=PI,II=H0,NI=li,MI=ru,DI=Math.max;function FI(r,e,n){var a=r==null?0:r.length;if(!a)return-1;var l=n==null?0:MI(n);return l<0&&(l=DI(a+l,0)),II(r,NI(e),l)}var $I=FI,GI=LI,WI=$I,BI=GI(WI),Av=BI,UI=av,HI=ry,zI=li,jI=kt;function YI(r,e){var n=jI(r)?UI:HI;return n(r,zI(e))}var wv=YI,XI=vv,KI=Ql,qI=Rh,VI=wh,ny=Object.prototype,ZI=ny.hasOwnProperty,QI=XI(function(r,e){r=Object(r);var n=-1,a=e.length,l=a>2?e[2]:void 0;for(l&&qI(e[0],e[1],l)&&(a=1);++n<a;)for(var f=e[n],h=VI(f),v=-1,d=h.length;++v<d;){var p=h[v],S=r[p];(S===void 0||KI(S,ny[p])&&!ZI.call(r,p))&&(r[p]=f[p])}return r}),iy=QI;function JI(r,e,n,a){var l=-1,f=r==null?0:r.length;for(a&&f&&(n=r[++l]);++l<f;)n=e(n,r[l],l,r);return n}var eN=JI;function tN(r,e,n,a,l){return l(r,function(f,h,v){n=a?(a=!1,f):e(n,f,h,v)}),n}var rN=tN,nN=eN,iN=Va,aN=li,oN=rN,sN=kt;function lN(r,e,n){var a=sN(r)?nN:oN,l=arguments.length<3;return a(r,aN(e),n,l,iN)}var Qa=lN,ay={},ua={};Object.defineProperty(ua,"__esModule",{value:!0});ua.clearRegExpParserCache=ua.getRegExpAst=void 0;var uN=Mh.exports,sh={},fN=new uN.RegExpParser;function hN(r){var e=r.toString();if(sh.hasOwnProperty(e))return sh[e];var n=fN.pattern(e);return sh[e]=n,n}ua.getRegExpAst=hN;function cN(){sh={}}ua.clearRegExpParserCache=cN;(function(r){var e=_e&&_e.__extends||function(){var P=function(I,D){return P=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(R,Y){R.__proto__=Y}||function(R,Y){for(var re in Y)Object.prototype.hasOwnProperty.call(Y,re)&&(R[re]=Y[re])},P(I,D)};return function(I,D){if(typeof D!="function"&&D!==null)throw new TypeError("Class extends value "+String(D)+" is not a constructor or null");P(I,D);function R(){this.constructor=I}I.prototype=D===null?Object.create(D):(R.prototype=D.prototype,new R)}}(),n=_e&&_e.__importDefault||function(P){return P&&P.__esModule?P:{default:P}};Object.defineProperty(r,"__esModule",{value:!0}),r.canMatchCharCode=r.firstCharOptimizedIndices=r.getOptimizedStartCodesIndices=r.failedOptimizationPrefixMsg=void 0;var a=Mh.exports,l=n(kt),f=n(Ih),h=n(Rr),v=n(Av),d=n(Ii),p=n(Mi),S=vs,E=ua,A=Tv,O="Complement Sets are not supported for first char optimization";r.failedOptimizationPrefixMsg=`Unable to use "first char" lexer optimizations:
`;function k(P,I){I===void 0&&(I=!1);try{var D=(0,E.getRegExpAst)(P),R=T(D.value,{},D.flags.ignoreCase);return R}catch(re){if(re.message===O)I&&(0,S.PRINT_WARNING)("".concat(r.failedOptimizationPrefixMsg)+"	Unable to optimize: < ".concat(P.toString(),` >
`)+`	Complement Sets cannot be automatically optimized.
	This will disable the lexer's first char optimizations.
	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.`);else{var Y="";I&&(Y=`
	This will disable the lexer's first char optimizations.
	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details.`),(0,S.PRINT_ERROR)("".concat(r.failedOptimizationPrefixMsg,`
`)+"	Failed parsing: < ".concat(P.toString(),` >
`)+"	Using the regexp-to-ast library version: ".concat(a.VERSION,`
`)+"	Please open an issue at: https://github.com/bd82/regexp-to-ast/issues"+Y)}}return[]}r.getOptimizedStartCodesIndices=k;function T(P,I,D){switch(P.type){case"Disjunction":for(var R=0;R<P.value.length;R++)T(P.value[R],I,D);break;case"Alternative":for(var Y=P.value,R=0;R<Y.length;R++){var re=Y[R];switch(re.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}var se=re;switch(se.type){case"Character":x(se.value,I,D);break;case"Set":if(se.complement===!0)throw Error(O);(0,h.default)(se.value,function(Ce){if(typeof Ce=="number")x(Ce,I,D);else{var K=Ce;if(D===!0)for(var ne=K.from;ne<=K.to;ne++)x(ne,I,D);else{for(var ne=K.from;ne<=K.to&&ne<A.minOptimizationVal;ne++)x(ne,I,D);if(K.to>=A.minOptimizationVal)for(var te=K.from>=A.minOptimizationVal?K.from:A.minOptimizationVal,pe=K.to,le=(0,A.charCodeToOptimizedIndex)(te),Ee=(0,A.charCodeToOptimizedIndex)(pe),Be=le;Be<=Ee;Be++)I[Be]=Be}}});break;case"Group":T(se.value,I,D);break;default:throw Error("Non Exhaustive Match")}var Q=se.quantifier!==void 0&&se.quantifier.atLeast===0;if(se.type==="Group"&&B(se)===!1||se.type!=="Group"&&Q===!1)break}break;default:throw Error("non exhaustive match!")}return(0,d.default)(I)}r.firstCharOptimizedIndices=T;function x(P,I,D){var R=(0,A.charCodeToOptimizedIndex)(P);I[R]=R,D===!0&&G(P,I)}function G(P,I){var D=String.fromCharCode(P),R=D.toUpperCase();if(R!==D){var Y=(0,A.charCodeToOptimizedIndex)(R.charCodeAt(0));I[Y]=Y}else{var re=D.toLowerCase();if(re!==D){var Y=(0,A.charCodeToOptimizedIndex)(re.charCodeAt(0));I[Y]=Y}}}function j(P,I){return(0,v.default)(P.value,function(D){if(typeof D=="number")return(0,p.default)(I,D);var R=D;return(0,v.default)(I,function(Y){return R.from<=Y&&Y<=R.to})!==void 0})}function B(P){var I=P.quantifier;return I&&I.atLeast===0?!0:P.value?(0,l.default)(P.value)?(0,f.default)(P.value,B):B(P.value):!1}var U=function(P){e(I,P);function I(D){var R=P.call(this)||this;return R.targetCharCodes=D,R.found=!1,R}return I.prototype.visitChildren=function(D){if(this.found!==!0){switch(D.type){case"Lookahead":this.visitLookahead(D);return;case"NegativeLookahead":this.visitNegativeLookahead(D);return}P.prototype.visitChildren.call(this,D)}},I.prototype.visitCharacter=function(D){(0,p.default)(this.targetCharCodes,D.value)&&(this.found=!0)},I.prototype.visitSet=function(D){D.complement?j(D,this.targetCharCodes)===void 0&&(this.found=!0):j(D,this.targetCharCodes)!==void 0&&(this.found=!0)},I}(a.BaseRegExpVisitor);function J(P,I){if(I instanceof RegExp){var D=(0,E.getRegExpAst)(I),R=new U(P);return R.visit(D),R.found}else return(0,v.default)(I,function(Y){return(0,p.default)(P,Y.charCodeAt(0))})!==void 0}r.canMatchCharCode=J})(ay);(function(r){var e=_e&&_e.__extends||function(){var ue=function(he,ge){return ue=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Se,Te){Se.__proto__=Te}||function(Se,Te){for(var Fe in Te)Object.prototype.hasOwnProperty.call(Te,Fe)&&(Se[Fe]=Te[Fe])},ue(he,ge)};return function(he,ge){if(typeof ge!="function"&&ge!==null)throw new TypeError("Class extends value "+String(ge)+" is not a constructor or null");ue(he,ge);function Se(){this.constructor=he}he.prototype=ge===null?Object.create(ge):(Se.prototype=ge.prototype,new Se)}}(),n=_e&&_e.__importDefault||function(ue){return ue&&ue.__esModule?ue:{default:ue}};Object.defineProperty(r,"__esModule",{value:!0}),r.charCodeToOptimizedIndex=r.minOptimizationVal=r.buildLineBreakIssueMessage=r.LineTerminatorOptimizedTester=r.isShortPattern=r.isCustomPattern=r.cloneEmptyGroups=r.performWarningRuntimeChecks=r.performRuntimeChecks=r.addStickyFlag=r.addStartOfInput=r.findUnreachablePatterns=r.findModesThatDoNotExist=r.findInvalidGroupType=r.findDuplicatePatterns=r.findUnsupportedFlags=r.findStartOfInputAnchor=r.findEmptyMatchRegExps=r.findEndOfInputAnchor=r.findInvalidPatterns=r.findMissingPatterns=r.validatePatterns=r.analyzeTokenTypes=r.enableSticky=r.disableSticky=r.SUPPORT_STICKY=r.MODES=r.DEFAULT_MODE=void 0;var a=Mh.exports,l=iu,f=n(au),h=n(si),v=n(Dh),d=n(kt),p=n(Ii),S=n(Di),E=n(Cv),A=n(Ev),O=n(kI),k=n(Kr),T=n(Rr),x=n(xh),G=n(Kl),j=n(ys),B=n(Av),U=n(gn),J=n(pn),P=n(P0),I=n(wv),D=n(iy),R=n(Qa),Y=n(Mi),re=vs,se=ay,Q=ua,q="PATTERN";r.DEFAULT_MODE="defaultMode",r.MODES="modes",r.SUPPORT_STICKY=typeof new RegExp("(?:)").sticky=="boolean";function Ce(){r.SUPPORT_STICKY=!1}r.disableSticky=Ce;function K(){r.SUPPORT_STICKY=!0}r.enableSticky=K;function ne(ue,he){he=(0,D.default)(he,{useSticky:r.SUPPORT_STICKY,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r",`
`],tracer:function(at,$e){return $e()}});var ge=he.tracer;ge("initCharCodeToOptimizedIndexMap",function(){Xt()});var Se;ge("Reject Lexer.NA",function(){Se=(0,E.default)(ue,function(at){return at[q]===l.Lexer.NA})});var Te=!1,Fe;ge("Transform Patterns",function(){Te=!1,Fe=(0,k.default)(Se,function(at){var $e=at[q];if((0,P.default)($e)){var Wt=$e.source;return Wt.length===1&&Wt!=="^"&&Wt!=="$"&&Wt!=="."&&!$e.ignoreCase?Wt:Wt.length===2&&Wt[0]==="\\"&&!(0,Y.default)(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],Wt[1])?Wt[1]:he.useSticky?Ve($e):Gt($e)}else{if((0,G.default)($e))return Te=!0,{exec:$e};if(typeof $e=="object")return Te=!0,$e;if(typeof $e=="string"){if($e.length===1)return $e;var _n=$e.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),Wi=new RegExp(_n);return he.useSticky?Ve(Wi):Gt(Wi)}else throw Error("non exhaustive match")}})});var be,ct,it,ot,yt;ge("misc mapping",function(){be=(0,k.default)(Se,function(at){return at.tokenTypeIdx}),ct=(0,k.default)(Se,function(at){var $e=at.GROUP;if($e!==l.Lexer.SKIPPED){if((0,x.default)($e))return $e;if((0,j.default)($e))return!1;throw Error("non exhaustive match")}}),it=(0,k.default)(Se,function(at){var $e=at.LONGER_ALT;if($e){var Wt=(0,d.default)($e)?(0,k.default)($e,function(_n){return(0,O.default)(Se,_n)}):[(0,O.default)(Se,$e)];return Wt}}),ot=(0,k.default)(Se,function(at){return at.PUSH_MODE}),yt=(0,k.default)(Se,function(at){return(0,U.default)(at,"POP_MODE")})});var Br;ge("Line Terminator Handling",function(){var at=yn(he.lineTerminatorCharacters);Br=(0,k.default)(Se,function($e){return!1}),he.positionTracking!=="onlyOffset"&&(Br=(0,k.default)(Se,function($e){return(0,U.default)($e,"LINE_BREAKS")?!!$e.LINE_BREAKS:an($e,at)===!1&&(0,se.canMatchCharCode)(at,$e.PATTERN)}))});var ir,Ur,xt,Hr;ge("Misc Mapping #2",function(){ir=(0,k.default)(Se,Tr),Ur=(0,k.default)(Fe,nn),xt=(0,R.default)(Se,function(at,$e){var Wt=$e.GROUP;return(0,x.default)(Wt)&&Wt!==l.Lexer.SKIPPED&&(at[Wt]=[]),at},{}),Hr=(0,k.default)(Fe,function(at,$e){return{pattern:Fe[$e],longerAlt:it[$e],canLineTerminator:Br[$e],isCustom:ir[$e],short:Ur[$e],group:ct[$e],push:ot[$e],pop:yt[$e],tokenTypeIdx:be[$e],tokenType:Se[$e]}})});var Nt=!0,Er=[];return he.safeMode||ge("First Char Optimization",function(){Er=(0,R.default)(Se,function(at,$e,Wt){if(typeof $e.PATTERN=="string"){var _n=$e.PATTERN.charCodeAt(0),Wi=on(_n);mn(at,Wi,Hr[Wt])}else if((0,d.default)($e.START_CHARS_HINT)){var Bi;(0,T.default)($e.START_CHARS_HINT,function(sn){var Cs=typeof sn=="string"?sn.charCodeAt(0):sn,pa=on(Cs);Bi!==pa&&(Bi=pa,mn(at,pa,Hr[Wt]))})}else if((0,P.default)($e.PATTERN))if($e.PATTERN.unicode)Nt=!1,he.ensureOptimizations&&(0,re.PRINT_ERROR)("".concat(se.failedOptimizationPrefixMsg)+"	Unable to analyze < ".concat($e.PATTERN.toString(),` > pattern.
`)+`	The regexp unicode flag is not currently supported by the regexp-to-ast library.
	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE`);else{var va=(0,se.getOptimizedStartCodesIndices)($e.PATTERN,he.ensureOptimizations);(0,h.default)(va)&&(Nt=!1),(0,T.default)(va,function(sn){mn(at,sn,Hr[Wt])})}else he.ensureOptimizations&&(0,re.PRINT_ERROR)("".concat(se.failedOptimizationPrefixMsg)+"	TokenType: <".concat($e.name,`> is using a custom token pattern without providing <start_chars_hint> parameter.
`)+`	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE`),Nt=!1;return at},[])}),{emptyGroups:xt,patternIdxToConfig:Hr,charCodeToPatternIdxToConfig:Er,hasCustom:Te,canBeOptimized:Nt}}r.analyzeTokenTypes=ne;function te(ue,he){var ge=[],Se=le(ue);ge=ge.concat(Se.errors);var Te=Ee(Se.valid),Fe=Te.valid;return ge=ge.concat(Te.errors),ge=ge.concat(pe(Fe)),ge=ge.concat(ht(Fe)),ge=ge.concat(Tt(Fe,he)),ge=ge.concat(Ft(Fe)),ge}r.validatePatterns=te;function pe(ue){var he=[],ge=(0,I.default)(ue,function(Se){return(0,P.default)(Se[q])});return he=he.concat(Ke(ge)),he=he.concat(Ue(ge)),he=he.concat(Xe(ge)),he=he.concat(lt(ge)),he=he.concat(Ne(ge)),he}function le(ue){var he=(0,I.default)(ue,function(Te){return!(0,U.default)(Te,q)}),ge=(0,k.default)(he,function(Te){return{message:"Token Type: ->"+Te.name+"<- missing static 'PATTERN' property",type:l.LexerDefinitionErrorType.MISSING_PATTERN,tokenTypes:[Te]}}),Se=(0,A.default)(ue,he);return{errors:ge,valid:Se}}r.findMissingPatterns=le;function Ee(ue){var he=(0,I.default)(ue,function(Te){var Fe=Te[q];return!(0,P.default)(Fe)&&!(0,G.default)(Fe)&&!(0,U.default)(Fe,"exec")&&!(0,x.default)(Fe)}),ge=(0,k.default)(he,function(Te){return{message:"Token Type: ->"+Te.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:l.LexerDefinitionErrorType.INVALID_PATTERN,tokenTypes:[Te]}}),Se=(0,A.default)(ue,he);return{errors:ge,valid:Se}}r.findInvalidPatterns=Ee;var Be=/[^\\][$]/;function Ke(ue){var he=function(Te){e(Fe,Te);function Fe(){var be=Te!==null&&Te.apply(this,arguments)||this;return be.found=!1,be}return Fe.prototype.visitEndAnchor=function(be){this.found=!0},Fe}(a.BaseRegExpVisitor),ge=(0,I.default)(ue,function(Te){var Fe=Te.PATTERN;try{var be=(0,Q.getRegExpAst)(Fe),ct=new he;return ct.visit(be),ct.found}catch{return Be.test(Fe.source)}}),Se=(0,k.default)(ge,function(Te){return{message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+Te.name+`<- static 'PATTERN' cannot contain end of input anchor '$'
	See chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:l.LexerDefinitionErrorType.EOI_ANCHOR_FOUND,tokenTypes:[Te]}});return Se}r.findEndOfInputAnchor=Ke;function Ne(ue){var he=(0,I.default)(ue,function(Se){var Te=Se.PATTERN;return Te.test("")}),ge=(0,k.default)(he,function(Se){return{message:"Token Type: ->"+Se.name+"<- static 'PATTERN' must not match an empty string",type:l.LexerDefinitionErrorType.EMPTY_MATCH_PATTERN,tokenTypes:[Se]}});return ge}r.findEmptyMatchRegExps=Ne;var Ye=/[^\\[][\^]|^\^/;function Ue(ue){var he=function(Te){e(Fe,Te);function Fe(){var be=Te!==null&&Te.apply(this,arguments)||this;return be.found=!1,be}return Fe.prototype.visitStartAnchor=function(be){this.found=!0},Fe}(a.BaseRegExpVisitor),ge=(0,I.default)(ue,function(Te){var Fe=Te.PATTERN;try{var be=(0,Q.getRegExpAst)(Fe),ct=new he;return ct.visit(be),ct.found}catch{return Ye.test(Fe.source)}}),Se=(0,k.default)(ge,function(Te){return{message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+Te.name+`<- static 'PATTERN' cannot contain start of input anchor '^'
	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:l.LexerDefinitionErrorType.SOI_ANCHOR_FOUND,tokenTypes:[Te]}});return Se}r.findStartOfInputAnchor=Ue;function Xe(ue){var he=(0,I.default)(ue,function(Se){var Te=Se[q];return Te instanceof RegExp&&(Te.multiline||Te.global)}),ge=(0,k.default)(he,function(Se){return{message:"Token Type: ->"+Se.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:l.LexerDefinitionErrorType.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[Se]}});return ge}r.findUnsupportedFlags=Xe;function lt(ue){var he=[],ge=(0,k.default)(ue,function(Fe){return(0,R.default)(ue,function(be,ct){return Fe.PATTERN.source===ct.PATTERN.source&&!(0,Y.default)(he,ct)&&ct.PATTERN!==l.Lexer.NA&&(he.push(ct),be.push(ct)),be},[])});ge=(0,v.default)(ge);var Se=(0,I.default)(ge,function(Fe){return Fe.length>1}),Te=(0,k.default)(Se,function(Fe){var be=(0,k.default)(Fe,function(it){return it.name}),ct=(0,f.default)(Fe).PATTERN;return{message:"The same RegExp pattern ->".concat(ct,"<-")+"has been used in all of the following Token Types: ".concat(be.join(", ")," <-"),type:l.LexerDefinitionErrorType.DUPLICATE_PATTERNS_FOUND,tokenTypes:Fe}});return Te}r.findDuplicatePatterns=lt;function ht(ue){var he=(0,I.default)(ue,function(Se){if(!(0,U.default)(Se,"GROUP"))return!1;var Te=Se.GROUP;return Te!==l.Lexer.SKIPPED&&Te!==l.Lexer.NA&&!(0,x.default)(Te)}),ge=(0,k.default)(he,function(Se){return{message:"Token Type: ->"+Se.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:l.LexerDefinitionErrorType.INVALID_GROUP_TYPE_FOUND,tokenTypes:[Se]}});return ge}r.findInvalidGroupType=ht;function Tt(ue,he){var ge=(0,I.default)(ue,function(Te){return Te.PUSH_MODE!==void 0&&!(0,Y.default)(he,Te.PUSH_MODE)}),Se=(0,k.default)(ge,function(Te){var Fe="Token Type: ->".concat(Te.name,"<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->").concat(Te.PUSH_MODE,"<-")+"which does not exist";return{message:Fe,type:l.LexerDefinitionErrorType.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[Te]}});return Se}r.findModesThatDoNotExist=Tt;function Ft(ue){var he=[],ge=(0,R.default)(ue,function(Se,Te,Fe){var be=Te.PATTERN;return be===l.Lexer.NA||((0,x.default)(be)?Se.push({str:be,idx:Fe,tokenType:Te}):(0,P.default)(be)&&$t(be)&&Se.push({str:be.source,idx:Fe,tokenType:Te})),Se},[]);return(0,T.default)(ue,function(Se,Te){(0,T.default)(ge,function(Fe){var be=Fe.str,ct=Fe.idx,it=Fe.tokenType;if(Te<ct&&mr(be,Se.PATTERN)){var ot="Token: ->".concat(it.name,`<- can never be matched.
`)+"Because it appears AFTER the Token Type ->".concat(Se.name,"<-")+`in the lexer's definition.
See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNREACHABLE`;he.push({message:ot,type:l.LexerDefinitionErrorType.UNREACHABLE_PATTERN,tokenTypes:[Se,it]})}})}),he}r.findUnreachablePatterns=Ft;function mr(ue,he){if((0,P.default)(he)){var ge=he.exec(ue);return ge!==null&&ge.index===0}else{if((0,G.default)(he))return he(ue,0,[],{});if((0,U.default)(he,"exec"))return he.exec(ue,0,[],{});if(typeof he=="string")return he===ue;throw Error("non exhaustive match")}}function $t(ue){var he=[".","\\","[","]","|","^","$","(",")","?","*","+","{"];return(0,B.default)(he,function(ge){return ue.source.indexOf(ge)!==-1})===void 0}function Gt(ue){var he=ue.ignoreCase?"i":"";return new RegExp("^(?:".concat(ue.source,")"),he)}r.addStartOfInput=Gt;function Ve(ue){var he=ue.ignoreCase?"iy":"y";return new RegExp("".concat(ue.source),he)}r.addStickyFlag=Ve;function Pr(ue,he,ge){var Se=[];return(0,U.default)(ue,r.DEFAULT_MODE)||Se.push({message:"A MultiMode Lexer cannot be initialized without a <"+r.DEFAULT_MODE+`> property in its definition
`,type:l.LexerDefinitionErrorType.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),(0,U.default)(ue,r.MODES)||Se.push({message:"A MultiMode Lexer cannot be initialized without a <"+r.MODES+`> property in its definition
`,type:l.LexerDefinitionErrorType.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),(0,U.default)(ue,r.MODES)&&(0,U.default)(ue,r.DEFAULT_MODE)&&!(0,U.default)(ue.modes,ue.defaultMode)&&Se.push({message:"A MultiMode Lexer cannot be initialized with a ".concat(r.DEFAULT_MODE,": <").concat(ue.defaultMode,">")+`which does not exist
`,type:l.LexerDefinitionErrorType.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),(0,U.default)(ue,r.MODES)&&(0,T.default)(ue.modes,function(Te,Fe){(0,T.default)(Te,function(be,ct){(0,j.default)(be)&&Se.push({message:"A Lexer cannot be initialized using an undefined Token Type. Mode:"+"<".concat(Fe,"> at index: <").concat(ct,`>
`),type:l.LexerDefinitionErrorType.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED})})}),Se}r.performRuntimeChecks=Pr;function rn(ue,he,ge){var Se=[],Te=!1,Fe=(0,v.default)((0,S.default)((0,p.default)(ue.modes))),be=(0,E.default)(Fe,function(it){return it[q]===l.Lexer.NA}),ct=yn(ge);return he&&(0,T.default)(be,function(it){var ot=an(it,ct);if(ot!==!1){var yt=Cr(it,ot),Br={message:yt,type:ot.issue,tokenType:it};Se.push(Br)}else(0,U.default)(it,"LINE_BREAKS")?it.LINE_BREAKS===!0&&(Te=!0):(0,se.canMatchCharCode)(ct,it.PATTERN)&&(Te=!0)}),he&&!Te&&Se.push({message:`Warning: No LINE_BREAKS Found.
	This Lexer has been defined to track line and column information,
	But none of the Token Types can be identified as matching a line terminator.
	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#LINE_BREAKS 
	for details.`,type:l.LexerDefinitionErrorType.NO_LINE_BREAKS_FLAGS}),Se}r.performWarningRuntimeChecks=rn;function sr(ue){var he={},ge=(0,J.default)(ue);return(0,T.default)(ge,function(Se){var Te=ue[Se];if((0,d.default)(Te))he[Se]=[];else throw Error("non exhaustive match")}),he}r.cloneEmptyGroups=sr;function Tr(ue){var he=ue.PATTERN;if((0,P.default)(he))return!1;if((0,G.default)(he))return!0;if((0,U.default)(he,"exec"))return!0;if((0,x.default)(he))return!1;throw Error("non exhaustive match")}r.isCustomPattern=Tr;function nn(ue){return(0,x.default)(ue)&&ue.length===1?ue.charCodeAt(0):!1}r.isShortPattern=nn,r.LineTerminatorOptimizedTester={test:function(ue){for(var he=ue.length,ge=this.lastIndex;ge<he;ge++){var Se=ue.charCodeAt(ge);if(Se===10)return this.lastIndex=ge+1,!0;if(Se===13)return ue.charCodeAt(ge+1)===10?this.lastIndex=ge+2:this.lastIndex=ge+1,!0}return!1},lastIndex:0};function an(ue,he){if((0,U.default)(ue,"LINE_BREAKS"))return!1;if((0,P.default)(ue.PATTERN)){try{(0,se.canMatchCharCode)(he,ue.PATTERN)}catch(ge){return{issue:l.LexerDefinitionErrorType.IDENTIFY_TERMINATOR,errMsg:ge.message}}return!1}else{if((0,x.default)(ue.PATTERN))return!1;if(Tr(ue))return{issue:l.LexerDefinitionErrorType.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}}function Cr(ue,he){if(he.issue===l.LexerDefinitionErrorType.IDENTIFY_TERMINATOR)return`Warning: unable to identify line terminator usage in pattern.
`+"	The problem is in the <".concat(ue.name,`> Token Type
`)+"	 Root cause: ".concat(he.errMsg,`.
`)+"	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR";if(he.issue===l.LexerDefinitionErrorType.CUSTOM_LINE_BREAK)return`Warning: A Custom Token Pattern should specify the <line_breaks> option.
`+"	The problem is in the <".concat(ue.name,`> Token Type
`)+"	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK";throw Error("non exhaustive match")}r.buildLineBreakIssueMessage=Cr;function yn(ue){var he=(0,k.default)(ue,function(ge){return(0,x.default)(ge)?ge.charCodeAt(0):ge});return he}function mn(ue,he,ge){ue[he]===void 0?ue[he]=[ge]:ue[he].push(ge)}r.minOptimizationVal=256;var qr=[];function on(ue){return ue<r.minOptimizationVal?ue:qr[ue]}r.charCodeToOptimizedIndex=on;function Xt(){if((0,h.default)(qr)){qr=new Array(65536);for(var ue=0;ue<65536;ue++)qr[ue]=ue>255?255+~~(ue/255):ue}}})(Tv);function dN(r){var e=r==null?0:r.length;return e?r[e-1]:void 0}var kv=dN,Ja={};(function(r){var e=_e&&_e.__importDefault||function(R){return R&&R.__esModule?R:{default:R}};Object.defineProperty(r,"__esModule",{value:!0}),r.isTokenType=r.hasExtendingTokensTypesMapProperty=r.hasExtendingTokensTypesProperty=r.hasCategoriesProperty=r.hasShortKeyProperty=r.singleAssignCategoriesToksMap=r.assignCategoriesMapProp=r.assignCategoriesTokensProp=r.assignTokenDefaultProps=r.expandCategories=r.augmentTokenTypes=r.tokenIdxToClass=r.tokenShortNameIdx=r.tokenStructuredMatcherNoCategories=r.tokenStructuredMatcher=void 0;var n=e(si),a=e(Dh),l=e(kt),f=e(Di),h=e(Ev),v=e(Kr),d=e(Rr),p=e(gn),S=e(Mi),E=e(fa);function A(R,Y){var re=R.tokenTypeIdx;return re===Y.tokenTypeIdx?!0:Y.isParent===!0&&Y.categoryMatchesMap[re]===!0}r.tokenStructuredMatcher=A;function O(R,Y){return R.tokenTypeIdx===Y.tokenTypeIdx}r.tokenStructuredMatcherNoCategories=O,r.tokenShortNameIdx=1,r.tokenIdxToClass={};function k(R){var Y=T(R);x(Y),j(Y),G(Y),(0,d.default)(Y,function(re){re.isParent=re.categoryMatches.length>0})}r.augmentTokenTypes=k;function T(R){for(var Y=(0,E.default)(R),re=R,se=!0;se;){re=(0,a.default)((0,f.default)((0,v.default)(re,function(q){return q.CATEGORIES})));var Q=(0,h.default)(re,Y);Y=Y.concat(Q),(0,n.default)(Q)?se=!1:re=Q}return Y}r.expandCategories=T;function x(R){(0,d.default)(R,function(Y){U(Y)||(r.tokenIdxToClass[r.tokenShortNameIdx]=Y,Y.tokenTypeIdx=r.tokenShortNameIdx++),J(Y)&&!(0,l.default)(Y.CATEGORIES)&&(Y.CATEGORIES=[Y.CATEGORIES]),J(Y)||(Y.CATEGORIES=[]),P(Y)||(Y.categoryMatches=[]),I(Y)||(Y.categoryMatchesMap={})})}r.assignTokenDefaultProps=x;function G(R){(0,d.default)(R,function(Y){Y.categoryMatches=[],(0,d.default)(Y.categoryMatchesMap,function(re,se){Y.categoryMatches.push(r.tokenIdxToClass[se].tokenTypeIdx)})})}r.assignCategoriesTokensProp=G;function j(R){(0,d.default)(R,function(Y){B([],Y)})}r.assignCategoriesMapProp=j;function B(R,Y){(0,d.default)(R,function(re){Y.categoryMatchesMap[re.tokenTypeIdx]=!0}),(0,d.default)(Y.CATEGORIES,function(re){var se=R.concat(Y);(0,S.default)(se,re)||B(se,re)})}r.singleAssignCategoriesToksMap=B;function U(R){return(0,p.default)(R,"tokenTypeIdx")}r.hasShortKeyProperty=U;function J(R){return(0,p.default)(R,"CATEGORIES")}r.hasCategoriesProperty=J;function P(R){return(0,p.default)(R,"categoryMatches")}r.hasExtendingTokensTypesProperty=P;function I(R){return(0,p.default)(R,"categoryMatchesMap")}r.hasExtendingTokensTypesMapProperty=I;function D(R){return(0,p.default)(R,"tokenTypeIdx")}r.isTokenType=D})(Ja);var ou={};Object.defineProperty(ou,"__esModule",{value:!0});ou.defaultLexerErrorProvider=void 0;ou.defaultLexerErrorProvider={buildUnableToPopLexerModeMessage:function(r){return"Unable to pop Lexer Mode after encountering Token ->".concat(r.image,"<- The Mode Stack is empty")},buildUnexpectedCharactersMessage:function(r,e,n,a,l){return"unexpected character: ->".concat(r.charAt(e),"<- at offset: ").concat(e,",")+" skipped ".concat(n," characters.")}};(function(r){var e=_e&&_e.__importDefault||function(P){return P&&P.__esModule?P:{default:P}};Object.defineProperty(r,"__esModule",{value:!0}),r.Lexer=r.LexerDefinitionErrorType=void 0;var n=Tv,a=e(_v),l=e(si),f=e(kt),h=e(kv),v=e(Cv),d=e(Kr),p=e(Rr),S=e(pn),E=e(ys),A=e(eu),O=e(Ph),k=e(Qa),T=e(fa),x=vs,G=Ja,j=ou,B=ua;(function(P){P[P.MISSING_PATTERN=0]="MISSING_PATTERN",P[P.INVALID_PATTERN=1]="INVALID_PATTERN",P[P.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",P[P.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",P[P.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",P[P.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",P[P.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",P[P.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",P[P.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",P[P.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",P[P.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",P[P.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",P[P.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",P[P.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",P[P.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",P[P.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",P[P.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK"})(r.LexerDefinitionErrorType||(r.LexerDefinitionErrorType={}));var U={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:[`
`,"\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:j.defaultLexerErrorProvider,traceInitPerf:!1,skipValidations:!1};Object.freeze(U);var J=function(){function P(I,D){D===void 0&&(D=U);var R=this;if(this.lexerDefinition=I,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},this.TRACE_INIT=function(re,se){if(R.traceInitPerf===!0){R.traceInitIndent++;var Q=new Array(R.traceInitIndent+1).join("	");R.traceInitIndent<R.traceInitMaxIdent&&console.log("".concat(Q,"--> <").concat(re,">"));var q=(0,x.timer)(se),Ce=q.time,K=q.value,ne=Ce>10?console.warn:console.log;return R.traceInitIndent<R.traceInitMaxIdent&&ne("".concat(Q,"<-- <").concat(re,"> time: ").concat(Ce,"ms")),R.traceInitIndent--,K}else return se()},typeof D=="boolean")throw Error(`The second argument to the Lexer constructor is now an ILexerConfig Object.
a boolean 2nd argument is no longer supported`);this.config=(0,O.default)({},U,D);var Y=this.config.traceInitPerf;Y===!0?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):typeof Y=="number"&&(this.traceInitMaxIdent=Y,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",function(){var re,se=!0;R.TRACE_INIT("Lexer Config handling",function(){if(R.config.lineTerminatorsPattern===U.lineTerminatorsPattern)R.config.lineTerminatorsPattern=n.LineTerminatorOptimizedTester;else if(R.config.lineTerminatorCharacters===U.lineTerminatorCharacters)throw Error(`Error: Missing <lineTerminatorCharacters> property on the Lexer config.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS`);if(D.safeMode&&D.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');R.trackStartLines=/full|onlyStart/i.test(R.config.positionTracking),R.trackEndLines=/full/i.test(R.config.positionTracking),(0,f.default)(I)?re={modes:{defaultMode:(0,T.default)(I)},defaultMode:n.DEFAULT_MODE}:(se=!1,re=(0,T.default)(I))}),R.config.skipValidations===!1&&(R.TRACE_INIT("performRuntimeChecks",function(){R.lexerDefinitionErrors=R.lexerDefinitionErrors.concat((0,n.performRuntimeChecks)(re,R.trackStartLines,R.config.lineTerminatorCharacters))}),R.TRACE_INIT("performWarningRuntimeChecks",function(){R.lexerDefinitionWarning=R.lexerDefinitionWarning.concat((0,n.performWarningRuntimeChecks)(re,R.trackStartLines,R.config.lineTerminatorCharacters))})),re.modes=re.modes?re.modes:{},(0,p.default)(re.modes,function(K,ne){re.modes[ne]=(0,v.default)(K,function(te){return(0,E.default)(te)})});var Q=(0,S.default)(re.modes);if((0,p.default)(re.modes,function(K,ne){R.TRACE_INIT("Mode: <".concat(ne,"> processing"),function(){if(R.modes.push(ne),R.config.skipValidations===!1&&R.TRACE_INIT("validatePatterns",function(){R.lexerDefinitionErrors=R.lexerDefinitionErrors.concat((0,n.validatePatterns)(K,Q))}),(0,l.default)(R.lexerDefinitionErrors)){(0,G.augmentTokenTypes)(K);var te;R.TRACE_INIT("analyzeTokenTypes",function(){te=(0,n.analyzeTokenTypes)(K,{lineTerminatorCharacters:R.config.lineTerminatorCharacters,positionTracking:D.positionTracking,ensureOptimizations:D.ensureOptimizations,safeMode:D.safeMode,tracer:R.TRACE_INIT})}),R.patternIdxToConfig[ne]=te.patternIdxToConfig,R.charCodeToPatternIdxToConfig[ne]=te.charCodeToPatternIdxToConfig,R.emptyGroups=(0,O.default)({},R.emptyGroups,te.emptyGroups),R.hasCustom=te.hasCustom||R.hasCustom,R.canModeBeOptimized[ne]=te.canBeOptimized}})}),R.defaultMode=re.defaultMode,!(0,l.default)(R.lexerDefinitionErrors)&&!R.config.deferDefinitionErrorsHandling){var q=(0,d.default)(R.lexerDefinitionErrors,function(K){return K.message}),Ce=q.join(`-----------------------
`);throw new Error(`Errors detected in definition of Lexer:
`+Ce)}(0,p.default)(R.lexerDefinitionWarning,function(K){(0,x.PRINT_WARNING)(K.message)}),R.TRACE_INIT("Choosing sub-methods implementations",function(){if(n.SUPPORT_STICKY?(R.chopInput=A.default,R.match=R.matchWithTest):(R.updateLastIndex=a.default,R.match=R.matchWithExec),se&&(R.handleModes=a.default),R.trackStartLines===!1&&(R.computeNewColumn=A.default),R.trackEndLines===!1&&(R.updateTokenEndLineColumnLocation=a.default),/full/i.test(R.config.positionTracking))R.createTokenInstance=R.createFullToken;else if(/onlyStart/i.test(R.config.positionTracking))R.createTokenInstance=R.createStartOnlyToken;else if(/onlyOffset/i.test(R.config.positionTracking))R.createTokenInstance=R.createOffsetOnlyToken;else throw Error('Invalid <positionTracking> config option: "'.concat(R.config.positionTracking,'"'));R.hasCustom?(R.addToken=R.addTokenUsingPush,R.handlePayload=R.handlePayloadWithCustom):(R.addToken=R.addTokenUsingMemberAccess,R.handlePayload=R.handlePayloadNoCustom)}),R.TRACE_INIT("Failed Optimization Warnings",function(){var K=(0,k.default)(R.canModeBeOptimized,function(ne,te,pe){return te===!1&&ne.push(pe),ne},[]);if(D.ensureOptimizations&&!(0,l.default)(K))throw Error("Lexer Modes: < ".concat(K.join(", "),` > cannot be optimized.
`)+`	 Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.
	 Or inspect the console log for details on how to resolve these issues.`)}),R.TRACE_INIT("clearRegExpParserCache",function(){(0,B.clearRegExpParserCache)()}),R.TRACE_INIT("toFastProperties",function(){(0,x.toFastProperties)(R)})})}return P.prototype.tokenize=function(I,D){if(D===void 0&&(D=this.defaultMode),!(0,l.default)(this.lexerDefinitionErrors)){var R=(0,d.default)(this.lexerDefinitionErrors,function(re){return re.message}),Y=R.join(`-----------------------
`);throw new Error(`Unable to Tokenize because Errors detected in definition of Lexer:
`+Y)}return this.tokenizeInternal(I,D)},P.prototype.tokenizeInternal=function(I,D){var R=this,Y,re,se,Q,q,Ce,K,ne,te,pe,le,Ee,Be,Ke,Ne,Ye=I,Ue=Ye.length,Xe=0,lt=0,ht=this.hasCustom?0:Math.floor(I.length/10),Tt=new Array(ht),Ft=[],mr=this.trackStartLines?1:void 0,$t=this.trackStartLines?1:void 0,Gt=(0,n.cloneEmptyGroups)(this.emptyGroups),Ve=this.trackStartLines,Pr=this.config.lineTerminatorsPattern,rn=0,sr=[],Tr=[],nn=[],an=[];Object.freeze(an);var Cr;function yn(){return sr}function mn(Nt){var Er=(0,n.charCodeToOptimizedIndex)(Nt),at=Tr[Er];return at===void 0?an:at}var qr=function(Nt){if(nn.length===1&&Nt.tokenType.PUSH_MODE===void 0){var Er=R.config.errorMessageProvider.buildUnableToPopLexerModeMessage(Nt);Ft.push({offset:Nt.startOffset,line:Nt.startLine,column:Nt.startColumn,length:Nt.image.length,message:Er})}else{nn.pop();var at=(0,h.default)(nn);sr=R.patternIdxToConfig[at],Tr=R.charCodeToPatternIdxToConfig[at],rn=sr.length;var $e=R.canModeBeOptimized[at]&&R.config.safeMode===!1;Tr&&$e?Cr=mn:Cr=yn}};function on(Nt){nn.push(Nt),Tr=this.charCodeToPatternIdxToConfig[Nt],sr=this.patternIdxToConfig[Nt],rn=sr.length,rn=sr.length;var Er=this.canModeBeOptimized[Nt]&&this.config.safeMode===!1;Tr&&Er?Cr=mn:Cr=yn}on.call(this,D);for(var Xt;Xe<Ue;){Ce=null;var ue=Ye.charCodeAt(Xe),he=Cr(ue),ge=he.length;for(Y=0;Y<ge;Y++){Xt=he[Y];var Se=Xt.pattern;K=null;var Te=Xt.short;if(Te!==!1?ue===Te&&(Ce=Se):Xt.isCustom===!0?(Ne=Se.exec(Ye,Xe,Tt,Gt),Ne!==null?(Ce=Ne[0],Ne.payload!==void 0&&(K=Ne.payload)):Ce=null):(this.updateLastIndex(Se,Xe),Ce=this.match(Se,I,Xe)),Ce!==null){if(q=Xt.longerAlt,q!==void 0){var Fe=q.length;for(se=0;se<Fe;se++){var be=sr[q[se]],ct=be.pattern;if(ne=null,be.isCustom===!0?(Ne=ct.exec(Ye,Xe,Tt,Gt),Ne!==null?(Q=Ne[0],Ne.payload!==void 0&&(ne=Ne.payload)):Q=null):(this.updateLastIndex(ct,Xe),Q=this.match(ct,I,Xe)),Q&&Q.length>Ce.length){Ce=Q,K=ne,Xt=be;break}}}break}}if(Ce!==null){if(te=Ce.length,pe=Xt.group,pe!==void 0&&(le=Xt.tokenTypeIdx,Ee=this.createTokenInstance(Ce,Xe,le,Xt.tokenType,mr,$t,te),this.handlePayload(Ee,K),pe===!1?lt=this.addToken(Tt,lt,Ee):Gt[pe].push(Ee)),I=this.chopInput(I,te),Xe=Xe+te,$t=this.computeNewColumn($t,te),Ve===!0&&Xt.canLineTerminator===!0){var it=0,ot=void 0,yt=void 0;Pr.lastIndex=0;do ot=Pr.test(Ce),ot===!0&&(yt=Pr.lastIndex-1,it++);while(ot===!0);it!==0&&(mr=mr+it,$t=te-yt,this.updateTokenEndLineColumnLocation(Ee,pe,yt,it,mr,$t,te))}this.handleModes(Xt,qr,on,Ee)}else{for(var Br=Xe,ir=mr,Ur=$t,xt=!1;!xt&&Xe<Ue;)for(Ye.charCodeAt(Xe),I=this.chopInput(I,1),Xe++,re=0;re<rn;re++){var Hr=sr[re],Se=Hr.pattern,Te=Hr.short;if(Te!==!1?Ye.charCodeAt(Xe)===Te&&(xt=!0):Hr.isCustom===!0?xt=Se.exec(Ye,Xe,Tt,Gt)!==null:(this.updateLastIndex(Se,Xe),xt=Se.exec(I)!==null),xt===!0)break}Be=Xe-Br,Ke=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(Ye,Br,Be,ir,Ur),Ft.push({offset:Br,line:ir,column:Ur,length:Be,message:Ke})}}return this.hasCustom||(Tt.length=lt),{tokens:Tt,groups:Gt,errors:Ft}},P.prototype.handleModes=function(I,D,R,Y){if(I.pop===!0){var re=I.push;D(Y),re!==void 0&&R.call(this,re)}else I.push!==void 0&&R.call(this,I.push)},P.prototype.chopInput=function(I,D){return I.substring(D)},P.prototype.updateLastIndex=function(I,D){I.lastIndex=D},P.prototype.updateTokenEndLineColumnLocation=function(I,D,R,Y,re,se,Q){var q,Ce;D!==void 0&&(q=R===Q-1,Ce=q?-1:0,Y===1&&q===!0||(I.endLine=re+Ce,I.endColumn=se-1+-Ce))},P.prototype.computeNewColumn=function(I,D){return I+D},P.prototype.createOffsetOnlyToken=function(I,D,R,Y){return{image:I,startOffset:D,tokenTypeIdx:R,tokenType:Y}},P.prototype.createStartOnlyToken=function(I,D,R,Y,re,se){return{image:I,startOffset:D,startLine:re,startColumn:se,tokenTypeIdx:R,tokenType:Y}},P.prototype.createFullToken=function(I,D,R,Y,re,se,Q){return{image:I,startOffset:D,endOffset:D+Q-1,startLine:re,endLine:re,startColumn:se,endColumn:se+Q-1,tokenTypeIdx:R,tokenType:Y}},P.prototype.addTokenUsingPush=function(I,D,R){return I.push(R),D},P.prototype.addTokenUsingMemberAccess=function(I,D,R){return I[D]=R,D++,D},P.prototype.handlePayloadNoCustom=function(I,D){},P.prototype.handlePayloadWithCustom=function(I,D){D!==null&&(I.payload=D)},P.prototype.matchWithTest=function(I,D,R){var Y=I.test(D);return Y===!0?D.substring(R,I.lastIndex):null},P.prototype.matchWithExec=function(I,D){var R=I.exec(D);return R!==null?R[0]:null},P.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",P.NA=/NOT_APPLICABLE/,P}();r.Lexer=J})(iu);(function(r){var e=_e&&_e.__importDefault||function(I){return I&&I.__esModule?I:{default:I}};Object.defineProperty(r,"__esModule",{value:!0}),r.tokenMatcher=r.createTokenInstance=r.EOF=r.createToken=r.hasTokenLabel=r.tokenName=r.tokenLabel=void 0;var n=e(xh),a=e(gn),l=e(ys),f=iu,h=Ja;function v(I){return p(I)?I.LABEL:I.name}r.tokenLabel=v;function d(I){return I.name}r.tokenName=d;function p(I){return(0,n.default)(I.LABEL)&&I.LABEL!==""}r.hasTokenLabel=p;var S="parent",E="categories",A="label",O="group",k="push_mode",T="pop_mode",x="longer_alt",G="line_breaks",j="start_chars_hint";function B(I){return U(I)}r.createToken=B;function U(I){var D=I.pattern,R={};if(R.name=I.name,(0,l.default)(D)||(R.PATTERN=D),(0,a.default)(I,S))throw`The parent property is no longer supported.
See: https://github.com/chevrotain/chevrotain/issues/564#issuecomment-349062346 for details.`;return(0,a.default)(I,E)&&(R.CATEGORIES=I[E]),(0,h.augmentTokenTypes)([R]),(0,a.default)(I,A)&&(R.LABEL=I[A]),(0,a.default)(I,O)&&(R.GROUP=I[O]),(0,a.default)(I,T)&&(R.POP_MODE=I[T]),(0,a.default)(I,k)&&(R.PUSH_MODE=I[k]),(0,a.default)(I,x)&&(R.LONGER_ALT=I[x]),(0,a.default)(I,G)&&(R.LINE_BREAKS=I[G]),(0,a.default)(I,j)&&(R.START_CHARS_HINT=I[j]),R}r.EOF=B({name:"EOF",pattern:f.Lexer.NA}),(0,h.augmentTokenTypes)([r.EOF]);function J(I,D,R,Y,re,se,Q,q){return{image:D,startOffset:R,endOffset:Y,startLine:re,endLine:se,startColumn:Q,endColumn:q,tokenTypeIdx:I.tokenTypeIdx,tokenType:I}}r.createTokenInstance=J;function P(I,D){return(0,h.tokenStructuredMatcher)(I,D)}r.tokenMatcher=P})(Za);var su={};(function(r){var e=_e&&_e.__importDefault||function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(r,"__esModule",{value:!0}),r.defaultGrammarValidatorErrorProvider=r.defaultGrammarResolverErrorProvider=r.defaultParserErrorProvider=void 0;var n=Za,a=e(au),l=e(Kr),f=e(Qa),h=nr,v=nr;r.defaultParserErrorProvider={buildMismatchTokenMessage:function(d){var p=d.expected,S=d.actual;d.previous,d.ruleName;var E=(0,n.hasTokenLabel)(p),A=E?"--> ".concat((0,n.tokenLabel)(p)," <--"):"token of type --> ".concat(p.name," <--"),O="Expecting ".concat(A," but found --> '").concat(S.image,"' <--");return O},buildNotAllInputParsedMessage:function(d){var p=d.firstRedundant;return d.ruleName,"Redundant input, expecting EOF but found: "+p.image},buildNoViableAltMessage:function(d){var p=d.expectedPathsPerAlt,S=d.actual;d.previous;var E=d.customUserDescription;d.ruleName;var A="Expecting: ",O=(0,a.default)(S).image,k=`
but found: '`+O+"'";if(E)return A+E+k;var T=(0,f.default)(p,function(B,U){return B.concat(U)},[]),x=(0,l.default)(T,function(B){return"[".concat((0,l.default)(B,function(U){return(0,n.tokenLabel)(U)}).join(", "),"]")}),G=(0,l.default)(x,function(B,U){return"  ".concat(U+1,". ").concat(B)}),j=`one of these possible Token sequences:
`.concat(G.join(`
`));return A+j+k},buildEarlyExitMessage:function(d){var p=d.expectedIterationPaths,S=d.actual,E=d.customUserDescription;d.ruleName;var A="Expecting: ",O=(0,a.default)(S).image,k=`
but found: '`+O+"'";if(E)return A+E+k;var T=(0,l.default)(p,function(G){return"[".concat((0,l.default)(G,function(j){return(0,n.tokenLabel)(j)}).join(","),"]")}),x=`expecting at least one iteration which starts with one of these possible Token sequences::
  `+"<".concat(T.join(" ,"),">");return A+x+k}},Object.freeze(r.defaultParserErrorProvider),r.defaultGrammarResolverErrorProvider={buildRuleNotFoundError:function(d,p){var S="Invalid grammar, reference to a rule which is not defined: ->"+p.nonTerminalName+`<-
inside top level rule: ->`+d.name+"<-";return S}},r.defaultGrammarValidatorErrorProvider={buildDuplicateFoundError:function(d,p){function S(j){return j instanceof h.Terminal?j.terminalType.name:j instanceof h.NonTerminal?j.nonTerminalName:""}var E=d.name,A=(0,a.default)(p),O=A.idx,k=(0,v.getProductionDslName)(A),T=S(A),x=O>0,G="->".concat(k).concat(x?O:"","<- ").concat(T?"with argument: ->".concat(T,"<-"):"",`
                  appears more than once (`).concat(p.length," times) in the top level rule: ->").concat(E,`<-.                  
                  For further details see: https://chevrotain.io/docs/FAQ.html#NUMERICAL_SUFFIXES 
                  `);return G=G.replace(/[ \t]+/g," "),G=G.replace(/\s\s+/g,`
`),G},buildNamespaceConflictError:function(d){var p=`Namespace conflict found in grammar.
`+"The grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <".concat(d.name,`>.
`)+`To resolve this make sure each Terminal and Non-Terminal names are unique
This is easy to accomplish by using the convention that Terminal names start with an uppercase letter
and Non-Terminal names start with a lower case letter.`;return p},buildAlternationPrefixAmbiguityError:function(d){var p=(0,l.default)(d.prefixPath,function(A){return(0,n.tokenLabel)(A)}).join(", "),S=d.alternation.idx===0?"":d.alternation.idx,E="Ambiguous alternatives: <".concat(d.ambiguityIndices.join(" ,"),`> due to common lookahead prefix
`)+"in <OR".concat(S,"> inside <").concat(d.topLevelRule.name,`> Rule,
`)+"<".concat(p,`> may appears as a prefix path in all these alternatives.
`)+`See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX
For Further details.`;return E},buildAlternationAmbiguityError:function(d){var p=(0,l.default)(d.prefixPath,function(A){return(0,n.tokenLabel)(A)}).join(", "),S=d.alternation.idx===0?"":d.alternation.idx,E="Ambiguous Alternatives Detected: <".concat(d.ambiguityIndices.join(" ,"),"> in <OR").concat(S,">")+" inside <".concat(d.topLevelRule.name,`> Rule,
`)+"<".concat(p,`> may appears as a prefix path in all these alternatives.
`);return E=E+`See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES
For Further details.`,E},buildEmptyRepetitionError:function(d){var p=(0,v.getProductionDslName)(d.repetition);d.repetition.idx!==0&&(p+=d.repetition.idx);var S="The repetition <".concat(p,"> within Rule <").concat(d.topLevelRule.name,`> can never consume any tokens.
`)+"This could lead to an infinite loop.";return S},buildTokenNameError:function(d){return"deprecated"},buildEmptyAlternationError:function(d){var p="Ambiguous empty alternative: <".concat(d.emptyChoiceIdx+1,">")+" in <OR".concat(d.alternation.idx,"> inside <").concat(d.topLevelRule.name,`> Rule.
`)+"Only the last alternative may be an empty alternative.";return p},buildTooManyAlternativesError:function(d){var p=`An Alternation cannot have more than 256 alternatives:
`+"<OR".concat(d.alternation.idx,"> inside <").concat(d.topLevelRule.name,`> Rule.
 has `).concat(d.alternation.definition.length+1," alternatives.");return p},buildLeftRecursionError:function(d){var p=d.topLevelRule.name,S=(0,l.default)(d.leftRecursionPath,function(O){return O.name}),E="".concat(p," --> ").concat(S.concat([p]).join(" --> ")),A=`Left Recursion found in grammar.
`+"rule: <".concat(p,`> can be invoked from itself (directly or indirectly)
`)+`without consuming any Tokens. The grammar path that causes this is: 
 `.concat(E,`
`)+` To fix this refactor your grammar to remove the left recursion.
see: https://en.wikipedia.org/wiki/LL_parser#Left_factoring.`;return A},buildInvalidRuleNameError:function(d){return"deprecated"},buildDuplicateRuleNameError:function(d){var p;d.topLevelRule instanceof h.Rule?p=d.topLevelRule.name:p=d.topLevelRule;var S="Duplicate definition, rule: ->".concat(p,"<- is already defined in the grammar: ->").concat(d.grammarName,"<-");return S}}})(su);var ns={},is={},vN=_e&&_e.__extends||function(){var r=function(e,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,l){a.__proto__=l}||function(a,l){for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(a[f]=l[f])},r(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");r(e,n);function a(){this.constructor=e}e.prototype=n===null?Object.create(n):(a.prototype=n.prototype,new a)}}(),oy=_e&&_e.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(is,"__esModule",{value:!0});is.GastRefResolverVisitor=is.resolveGrammar=void 0;var pN=tn,gN=oy(Rr),yN=oy(Ii),mN=nr;function _N(r,e){var n=new sy(r,e);return n.resolveRefs(),n.errors}is.resolveGrammar=_N;var sy=function(r){vN(e,r);function e(n,a){var l=r.call(this)||this;return l.nameToTopRule=n,l.errMsgProvider=a,l.errors=[],l}return e.prototype.resolveRefs=function(){var n=this;(0,gN.default)((0,yN.default)(this.nameToTopRule),function(a){n.currTopLevel=a,a.accept(n)})},e.prototype.visitNonTerminal=function(n){var a=this.nameToTopRule[n.nonTerminalName];if(a)n.referencedRule=a;else{var l=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,n);this.errors.push({message:l,type:pN.ParserDefinitionErrorType.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:n.nonTerminalName})}},e}(mN.GAstVisitor);is.GastRefResolverVisitor=sy;var Ct={};function bN(r,e,n,a){for(var l=-1,f=r==null?0:r.length;++l<f;){var h=r[l];e(a,h,n(h),r)}return a}var SN=bN,TN=Va;function CN(r,e,n,a){return TN(r,function(l,f,h){e(a,l,n(l),h)}),a}var EN=CN,AN=SN,wN=EN,kN=li,ON=kt;function xN(r,e){return function(n,a){var l=ON(n)?AN:wN,f=e?e():{};return l(n,r,kN(a),f)}}var RN=xN,PN=fv,LN=RN,IN=Object.prototype,NN=IN.hasOwnProperty,MN=LN(function(r,e,n){NN.call(r,n)?r[n].push(e):PN(r,n,[e])}),ly=MN,DN=mv,FN=Kr;function $N(r,e){return DN(FN(r,e),1)}var GN=$N,lu={},zt={},WN=cv,BN=ru;function UN(r,e,n){var a=r==null?0:r.length;return a?(e=n||e===void 0?1:BN(e),e=a-e,WN(r,0,e<0?0:e)):[]}var Ov=UN,eo=_e&&_e.__extends||function(){var r=function(e,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,l){a.__proto__=l}||function(a,l){for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(a[f]=l[f])},r(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");r(e,n);function a(){this.constructor=e}e.prototype=n===null?Object.create(n):(a.prototype=n.prototype,new a)}}(),to=_e&&_e.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(zt,"__esModule",{value:!0});zt.nextPossibleTokensAfter=zt.possiblePathsFrom=zt.NextTerminalAfterAtLeastOneSepWalker=zt.NextTerminalAfterAtLeastOneWalker=zt.NextTerminalAfterManySepWalker=zt.NextTerminalAfterManyWalker=zt.AbstractNextTerminalAfterProductionWalker=zt.NextAfterTokenWalker=zt.AbstractNextPossibleTokensWalker=void 0;var uy=ps,Fh=to(au),ch=to(si),rg=to(Ov),Wr=to(dv),HN=to(kv),zN=to(Rr),Ya=to(fa),jN=$n,st=nr,fy=function(r){eo(e,r);function e(n,a){var l=r.call(this)||this;return l.topProd=n,l.path=a,l.possibleTokTypes=[],l.nextProductionName="",l.nextProductionOccurrence=0,l.found=!1,l.isAtEndOfPath=!1,l}return e.prototype.startWalking=function(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=(0,Ya.default)(this.path.ruleStack).reverse(),this.occurrenceStack=(0,Ya.default)(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes},e.prototype.walk=function(n,a){a===void 0&&(a=[]),this.found||r.prototype.walk.call(this,n,a)},e.prototype.walkProdRef=function(n,a,l){if(n.referencedRule.name===this.nextProductionName&&n.idx===this.nextProductionOccurrence){var f=a.concat(l);this.updateExpectedNext(),this.walk(n.referencedRule,f)}},e.prototype.updateExpectedNext=function(){(0,ch.default)(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())},e}(uy.RestWalker);zt.AbstractNextPossibleTokensWalker=fy;var YN=function(r){eo(e,r);function e(n,a){var l=r.call(this,n,a)||this;return l.path=a,l.nextTerminalName="",l.nextTerminalOccurrence=0,l.nextTerminalName=l.path.lastTok.name,l.nextTerminalOccurrence=l.path.lastTokOccurrence,l}return e.prototype.walkTerminal=function(n,a,l){if(this.isAtEndOfPath&&n.terminalType.name===this.nextTerminalName&&n.idx===this.nextTerminalOccurrence&&!this.found){var f=a.concat(l),h=new st.Alternative({definition:f});this.possibleTokTypes=(0,jN.first)(h),this.found=!0}},e}(fy);zt.NextAfterTokenWalker=YN;var uu=function(r){eo(e,r);function e(n,a){var l=r.call(this)||this;return l.topRule=n,l.occurrence=a,l.result={token:void 0,occurrence:void 0,isEndOfRule:void 0},l}return e.prototype.startWalking=function(){return this.walk(this.topRule),this.result},e}(uy.RestWalker);zt.AbstractNextTerminalAfterProductionWalker=uu;var XN=function(r){eo(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.walkMany=function(n,a,l){if(n.idx===this.occurrence){var f=(0,Fh.default)(a.concat(l));this.result.isEndOfRule=f===void 0,f instanceof st.Terminal&&(this.result.token=f.terminalType,this.result.occurrence=f.idx)}else r.prototype.walkMany.call(this,n,a,l)},e}(uu);zt.NextTerminalAfterManyWalker=XN;var KN=function(r){eo(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.walkManySep=function(n,a,l){if(n.idx===this.occurrence){var f=(0,Fh.default)(a.concat(l));this.result.isEndOfRule=f===void 0,f instanceof st.Terminal&&(this.result.token=f.terminalType,this.result.occurrence=f.idx)}else r.prototype.walkManySep.call(this,n,a,l)},e}(uu);zt.NextTerminalAfterManySepWalker=KN;var qN=function(r){eo(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.walkAtLeastOne=function(n,a,l){if(n.idx===this.occurrence){var f=(0,Fh.default)(a.concat(l));this.result.isEndOfRule=f===void 0,f instanceof st.Terminal&&(this.result.token=f.terminalType,this.result.occurrence=f.idx)}else r.prototype.walkAtLeastOne.call(this,n,a,l)},e}(uu);zt.NextTerminalAfterAtLeastOneWalker=qN;var VN=function(r){eo(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.walkAtLeastOneSep=function(n,a,l){if(n.idx===this.occurrence){var f=(0,Fh.default)(a.concat(l));this.result.isEndOfRule=f===void 0,f instanceof st.Terminal&&(this.result.token=f.terminalType,this.result.occurrence=f.idx)}else r.prototype.walkAtLeastOneSep.call(this,n,a,l)},e}(uu);zt.NextTerminalAfterAtLeastOneSepWalker=VN;function hy(r,e,n){n===void 0&&(n=[]),n=(0,Ya.default)(n);var a=[],l=0;function f(p){return p.concat((0,Wr.default)(r,l+1))}function h(p){var S=hy(f(p),e,n);return a.concat(S)}for(;n.length<e&&l<r.length;){var v=r[l];if(v instanceof st.Alternative)return h(v.definition);if(v instanceof st.NonTerminal)return h(v.definition);if(v instanceof st.Option)a=h(v.definition);else if(v instanceof st.RepetitionMandatory){var d=v.definition.concat([new st.Repetition({definition:v.definition})]);return h(d)}else if(v instanceof st.RepetitionMandatoryWithSeparator){var d=[new st.Alternative({definition:v.definition}),new st.Repetition({definition:[new st.Terminal({terminalType:v.separator})].concat(v.definition)})];return h(d)}else if(v instanceof st.RepetitionWithSeparator){var d=v.definition.concat([new st.Repetition({definition:[new st.Terminal({terminalType:v.separator})].concat(v.definition)})]);a=h(d)}else if(v instanceof st.Repetition){var d=v.definition.concat([new st.Repetition({definition:v.definition})]);a=h(d)}else{if(v instanceof st.Alternation)return(0,zN.default)(v.definition,function(p){(0,ch.default)(p.definition)===!1&&(a=h(p.definition))}),a;if(v instanceof st.Terminal)n.push(v.terminalType);else throw Error("non exhaustive match")}l++}return a.push({partialPath:n,suffixDef:(0,Wr.default)(r,l)}),a}zt.possiblePathsFrom=hy;function ZN(r,e,n,a){var l="EXIT_NONE_TERMINAL",f=[l],h="EXIT_ALTERNATIVE",v=!1,d=e.length,p=d-a-1,S=[],E=[];for(E.push({idx:-1,def:r,ruleStack:[],occurrenceStack:[]});!(0,ch.default)(E);){var A=E.pop();if(A===h){v&&(0,HN.default)(E).idx<=p&&E.pop();continue}var O=A.def,k=A.idx,T=A.ruleStack,x=A.occurrenceStack;if(!(0,ch.default)(O)){var G=O[0];if(G===l){var j={idx:k,def:(0,Wr.default)(O),ruleStack:(0,rg.default)(T),occurrenceStack:(0,rg.default)(x)};E.push(j)}else if(G instanceof st.Terminal)if(k<d-1){var B=k+1,U=e[B];if(n(U,G.terminalType)){var j={idx:B,def:(0,Wr.default)(O),ruleStack:T,occurrenceStack:x};E.push(j)}}else if(k===d-1)S.push({nextTokenType:G.terminalType,nextTokenOccurrence:G.idx,ruleStack:T,occurrenceStack:x}),v=!0;else throw Error("non exhaustive match");else if(G instanceof st.NonTerminal){var J=(0,Ya.default)(T);J.push(G.nonTerminalName);var P=(0,Ya.default)(x);P.push(G.idx);var j={idx:k,def:G.definition.concat(f,(0,Wr.default)(O)),ruleStack:J,occurrenceStack:P};E.push(j)}else if(G instanceof st.Option){var I={idx:k,def:(0,Wr.default)(O),ruleStack:T,occurrenceStack:x};E.push(I),E.push(h);var D={idx:k,def:G.definition.concat((0,Wr.default)(O)),ruleStack:T,occurrenceStack:x};E.push(D)}else if(G instanceof st.RepetitionMandatory){var R=new st.Repetition({definition:G.definition,idx:G.idx}),Y=G.definition.concat([R],(0,Wr.default)(O)),j={idx:k,def:Y,ruleStack:T,occurrenceStack:x};E.push(j)}else if(G instanceof st.RepetitionMandatoryWithSeparator){var re=new st.Terminal({terminalType:G.separator}),R=new st.Repetition({definition:[re].concat(G.definition),idx:G.idx}),Y=G.definition.concat([R],(0,Wr.default)(O)),j={idx:k,def:Y,ruleStack:T,occurrenceStack:x};E.push(j)}else if(G instanceof st.RepetitionWithSeparator){var I={idx:k,def:(0,Wr.default)(O),ruleStack:T,occurrenceStack:x};E.push(I),E.push(h);var re=new st.Terminal({terminalType:G.separator}),se=new st.Repetition({definition:[re].concat(G.definition),idx:G.idx}),Y=G.definition.concat([se],(0,Wr.default)(O)),D={idx:k,def:Y,ruleStack:T,occurrenceStack:x};E.push(D)}else if(G instanceof st.Repetition){var I={idx:k,def:(0,Wr.default)(O),ruleStack:T,occurrenceStack:x};E.push(I),E.push(h);var se=new st.Repetition({definition:G.definition,idx:G.idx}),Y=G.definition.concat([se],(0,Wr.default)(O)),D={idx:k,def:Y,ruleStack:T,occurrenceStack:x};E.push(D)}else if(G instanceof st.Alternation)for(var Q=G.definition.length-1;Q>=0;Q--){var q=G.definition[Q],Ce={idx:k,def:q.definition.concat((0,Wr.default)(O)),ruleStack:T,occurrenceStack:x};E.push(Ce),E.push(h)}else if(G instanceof st.Alternative)E.push({idx:k,def:G.definition.concat((0,Wr.default)(O)),ruleStack:T,occurrenceStack:x});else if(G instanceof st.Rule)E.push(QN(G,k,T,x));else throw Error("non exhaustive match")}}return S}zt.nextPossibleTokensAfter=ZN;function QN(r,e,n,a){var l=(0,Ya.default)(n);l.push(r.name);var f=(0,Ya.default)(a);return f.push(1),{idx:e,def:r.definition,ruleStack:l,occurrenceStack:f}}(function(r){var e=_e&&_e.__extends||function(){var K=function(ne,te){return K=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(pe,le){pe.__proto__=le}||function(pe,le){for(var Ee in le)Object.prototype.hasOwnProperty.call(le,Ee)&&(pe[Ee]=le[Ee])},K(ne,te)};return function(ne,te){if(typeof te!="function"&&te!==null)throw new TypeError("Class extends value "+String(te)+" is not a constructor or null");K(ne,te);function pe(){this.constructor=ne}ne.prototype=te===null?Object.create(te):(pe.prototype=te.prototype,new pe)}}(),n=_e&&_e.__importDefault||function(K){return K&&K.__esModule?K:{default:K}};Object.defineProperty(r,"__esModule",{value:!0}),r.areTokenCategoriesNotUsed=r.isStrictPrefixOfPath=r.containsPath=r.getLookaheadPathsForOptionalProd=r.getLookaheadPathsForOr=r.lookAheadSequenceFromAlternatives=r.buildSingleAlternativeLookaheadFunction=r.buildAlternativesLookAheadFunc=r.buildLookaheadFuncForOptionalProd=r.buildLookaheadFuncForOr=r.getProdType=r.PROD_TYPE=void 0;var a=n(si),l=n(Di),f=n(Ih),h=n(Kr),v=n(Rr),d=n(gn),p=n(Qa),S=zt,E=ps,A=Ja,O=nr,k=nr,T;(function(K){K[K.OPTION=0]="OPTION",K[K.REPETITION=1]="REPETITION",K[K.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",K[K.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",K[K.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",K[K.ALTERNATION=5]="ALTERNATION"})(T=r.PROD_TYPE||(r.PROD_TYPE={}));function x(K){if(K instanceof O.Option)return T.OPTION;if(K instanceof O.Repetition)return T.REPETITION;if(K instanceof O.RepetitionMandatory)return T.REPETITION_MANDATORY;if(K instanceof O.RepetitionMandatoryWithSeparator)return T.REPETITION_MANDATORY_WITH_SEPARATOR;if(K instanceof O.RepetitionWithSeparator)return T.REPETITION_WITH_SEPARATOR;if(K instanceof O.Alternation)return T.ALTERNATION;throw Error("non exhaustive match")}r.getProdType=x;function G(K,ne,te,pe,le,Ee){var Be=re(K,ne,te),Ke=Ce(Be)?A.tokenStructuredMatcherNoCategories:A.tokenStructuredMatcher;return Ee(Be,pe,Ke,le)}r.buildLookaheadFuncForOr=G;function j(K,ne,te,pe,le,Ee){var Be=se(K,ne,le,te),Ke=Ce(Be)?A.tokenStructuredMatcherNoCategories:A.tokenStructuredMatcher;return Ee(Be[0],Ke,pe)}r.buildLookaheadFuncForOptionalProd=j;function B(K,ne,te,pe){var le=K.length,Ee=(0,f.default)(K,function(Ne){return(0,f.default)(Ne,function(Ye){return Ye.length===1})});if(ne)return function(Ne){for(var Ye=(0,h.default)(Ne,function(Ve){return Ve.GATE}),Ue=0;Ue<le;Ue++){var Xe=K[Ue],lt=Xe.length,ht=Ye[Ue];if(ht!==void 0&&ht.call(this)===!1)continue;e:for(var Tt=0;Tt<lt;Tt++){for(var Ft=Xe[Tt],mr=Ft.length,$t=0;$t<mr;$t++){var Gt=this.LA($t+1);if(te(Gt,Ft[$t])===!1)continue e}return Ue}}};if(Ee&&!pe){var Be=(0,h.default)(K,function(Ne){return(0,l.default)(Ne)}),Ke=(0,p.default)(Be,function(Ne,Ye,Ue){return(0,v.default)(Ye,function(Xe){(0,d.default)(Ne,Xe.tokenTypeIdx)||(Ne[Xe.tokenTypeIdx]=Ue),(0,v.default)(Xe.categoryMatches,function(lt){(0,d.default)(Ne,lt)||(Ne[lt]=Ue)})}),Ne},{});return function(){var Ne=this.LA(1);return Ke[Ne.tokenTypeIdx]}}else return function(){for(var Ne=0;Ne<le;Ne++){var Ye=K[Ne],Ue=Ye.length;e:for(var Xe=0;Xe<Ue;Xe++){for(var lt=Ye[Xe],ht=lt.length,Tt=0;Tt<ht;Tt++){var Ft=this.LA(Tt+1);if(te(Ft,lt[Tt])===!1)continue e}return Ne}}}}r.buildAlternativesLookAheadFunc=B;function U(K,ne,te){var pe=(0,f.default)(K,function(Ye){return Ye.length===1}),le=K.length;if(pe&&!te){var Ee=(0,l.default)(K);if(Ee.length===1&&(0,a.default)(Ee[0].categoryMatches)){var Be=Ee[0],Ke=Be.tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===Ke}}else{var Ne=(0,p.default)(Ee,function(Ye,Ue,Xe){return Ye[Ue.tokenTypeIdx]=!0,(0,v.default)(Ue.categoryMatches,function(lt){Ye[lt]=!0}),Ye},[]);return function(){var Ye=this.LA(1);return Ne[Ye.tokenTypeIdx]===!0}}}else return function(){e:for(var Ye=0;Ye<le;Ye++){for(var Ue=K[Ye],Xe=Ue.length,lt=0;lt<Xe;lt++){var ht=this.LA(lt+1);if(ne(ht,Ue[lt])===!1)continue e}return!0}return!1}}r.buildSingleAlternativeLookaheadFunction=U;var J=function(K){e(ne,K);function ne(te,pe,le){var Ee=K.call(this)||this;return Ee.topProd=te,Ee.targetOccurrence=pe,Ee.targetProdType=le,Ee}return ne.prototype.startWalking=function(){return this.walk(this.topProd),this.restDef},ne.prototype.checkIsTarget=function(te,pe,le,Ee){return te.idx===this.targetOccurrence&&this.targetProdType===pe?(this.restDef=le.concat(Ee),!0):!1},ne.prototype.walkOption=function(te,pe,le){this.checkIsTarget(te,T.OPTION,pe,le)||K.prototype.walkOption.call(this,te,pe,le)},ne.prototype.walkAtLeastOne=function(te,pe,le){this.checkIsTarget(te,T.REPETITION_MANDATORY,pe,le)||K.prototype.walkOption.call(this,te,pe,le)},ne.prototype.walkAtLeastOneSep=function(te,pe,le){this.checkIsTarget(te,T.REPETITION_MANDATORY_WITH_SEPARATOR,pe,le)||K.prototype.walkOption.call(this,te,pe,le)},ne.prototype.walkMany=function(te,pe,le){this.checkIsTarget(te,T.REPETITION,pe,le)||K.prototype.walkOption.call(this,te,pe,le)},ne.prototype.walkManySep=function(te,pe,le){this.checkIsTarget(te,T.REPETITION_WITH_SEPARATOR,pe,le)||K.prototype.walkOption.call(this,te,pe,le)},ne}(E.RestWalker),P=function(K){e(ne,K);function ne(te,pe,le){var Ee=K.call(this)||this;return Ee.targetOccurrence=te,Ee.targetProdType=pe,Ee.targetRef=le,Ee.result=[],Ee}return ne.prototype.checkIsTarget=function(te,pe){te.idx===this.targetOccurrence&&this.targetProdType===pe&&(this.targetRef===void 0||te===this.targetRef)&&(this.result=te.definition)},ne.prototype.visitOption=function(te){this.checkIsTarget(te,T.OPTION)},ne.prototype.visitRepetition=function(te){this.checkIsTarget(te,T.REPETITION)},ne.prototype.visitRepetitionMandatory=function(te){this.checkIsTarget(te,T.REPETITION_MANDATORY)},ne.prototype.visitRepetitionMandatoryWithSeparator=function(te){this.checkIsTarget(te,T.REPETITION_MANDATORY_WITH_SEPARATOR)},ne.prototype.visitRepetitionWithSeparator=function(te){this.checkIsTarget(te,T.REPETITION_WITH_SEPARATOR)},ne.prototype.visitAlternation=function(te){this.checkIsTarget(te,T.ALTERNATION)},ne}(k.GAstVisitor);function I(K){for(var ne=new Array(K),te=0;te<K;te++)ne[te]=[];return ne}function D(K){for(var ne=[""],te=0;te<K.length;te++){for(var pe=K[te],le=[],Ee=0;Ee<ne.length;Ee++){var Be=ne[Ee];le.push(Be+"_"+pe.tokenTypeIdx);for(var Ke=0;Ke<pe.categoryMatches.length;Ke++){var Ne="_"+pe.categoryMatches[Ke];le.push(Be+Ne)}}ne=le}return ne}function R(K,ne,te){for(var pe=0;pe<K.length;pe++)if(pe!==te)for(var le=K[pe],Ee=0;Ee<ne.length;Ee++){var Be=ne[Ee];if(le[Be]===!0)return!1}return!0}function Y(K,ne){for(var te=(0,h.default)(K,function(Ue){return(0,S.possiblePathsFrom)([Ue],1)}),pe=I(te.length),le=(0,h.default)(te,function(Ue){var Xe={};return(0,v.default)(Ue,function(lt){var ht=D(lt.partialPath);(0,v.default)(ht,function(Tt){Xe[Tt]=!0})}),Xe}),Ee=te,Be=1;Be<=ne;Be++){var Ke=Ee;Ee=I(Ke.length);for(var Ne=function(Ue){for(var Xe=Ke[Ue],lt=0;lt<Xe.length;lt++){var ht=Xe[lt].partialPath,Tt=Xe[lt].suffixDef,Ft=D(ht),mr=R(le,Ft,Ue);if(mr||(0,a.default)(Tt)||ht.length===ne){var $t=pe[Ue];if(Q($t,ht)===!1){$t.push(ht);for(var Gt=0;Gt<Ft.length;Gt++){var Ve=Ft[Gt];le[Ue][Ve]=!0}}}else{var Pr=(0,S.possiblePathsFrom)(Tt,Be+1,ht);Ee[Ue]=Ee[Ue].concat(Pr),(0,v.default)(Pr,function(rn){var sr=D(rn.partialPath);(0,v.default)(sr,function(Tr){le[Ue][Tr]=!0})})}}},Ye=0;Ye<Ke.length;Ye++)Ne(Ye)}return pe}r.lookAheadSequenceFromAlternatives=Y;function re(K,ne,te,pe){var le=new P(K,T.ALTERNATION,pe);return ne.accept(le),Y(le.result,te)}r.getLookaheadPathsForOr=re;function se(K,ne,te,pe){var le=new P(K,te);ne.accept(le);var Ee=le.result,Be=new J(ne,K,te),Ke=Be.startWalking(),Ne=new O.Alternative({definition:Ee}),Ye=new O.Alternative({definition:Ke});return Y([Ne,Ye],pe)}r.getLookaheadPathsForOptionalProd=se;function Q(K,ne){e:for(var te=0;te<K.length;te++){var pe=K[te];if(pe.length===ne.length){for(var le=0;le<pe.length;le++){var Ee=ne[le],Be=pe[le],Ke=Ee===Be||Be.categoryMatchesMap[Ee.tokenTypeIdx]!==void 0;if(Ke===!1)continue e}return!0}}return!1}r.containsPath=Q;function q(K,ne){return K.length<ne.length&&(0,f.default)(K,function(te,pe){var le=ne[pe];return te===le||le.categoryMatchesMap[te.tokenTypeIdx]})}r.isStrictPrefixOfPath=q;function Ce(K){return(0,f.default)(K,function(ne){return(0,f.default)(ne,function(te){return(0,f.default)(te,function(pe){return(0,a.default)(pe.categoryMatches)})})})}r.areTokenCategoriesNotUsed=Ce})(lu);var xv=_e&&_e.__extends||function(){var r=function(e,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,l){a.__proto__=l}||function(a,l){for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(a[f]=l[f])},r(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");r(e,n);function a(){this.constructor=e}e.prototype=n===null?Object.create(n):(a.prototype=n.prototype,new a)}}(),yr=_e&&_e.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Ct,"__esModule",{value:!0});Ct.checkPrefixAlternativesAmbiguities=Ct.validateSomeNonEmptyLookaheadPath=Ct.validateTooManyAlts=Ct.RepetitionCollector=Ct.validateAmbiguousAlternationAlternatives=Ct.validateEmptyOrAlternative=Ct.getFirstNoneTerminal=Ct.validateNoLeftRecursion=Ct.validateRuleIsOverridden=Ct.validateRuleDoesNotAlreadyExist=Ct.OccurrenceValidationCollector=Ct.identifyProductionForDuplicates=Ct.validateGrammar=void 0;var cy=yr(au),fu=yr(si),JN=yr(dv),dy=yr(Di),eM=yr(wv),tM=yr(Cv),rM=yr(Ev),Xa=yr(Kr),Hl=yr(Rr),nM=yr(ly),Rv=yr(Qa),iM=yr(L0),aM=yr(Ii),Pv=yr(Mi),dn=yr(GN),oM=yr(fa),ci=tn,Lv=nr,as=lu,sM=zt,Fn=nr,Iv=nr,lM=yr(Ov),uM=yr(Dh),fM=Ja;function hM(r,e,n,a,l){var f=(0,dn.default)(r,function(O){return cM(O,a)}),h=(0,dn.default)(r,function(O){return Nv(O,O,a)}),v=[],d=[],p=[];(0,fu.default)(h)&&(v=(0,dn.default)(r,function(O){return my(O,a)}),d=(0,dn.default)(r,function(O){return _y(O,e,a)}),p=Ty(r,e,a));var S=pM(r,n,a),E=(0,dn.default)(r,function(O){return Sy(O,a)}),A=(0,dn.default)(r,function(O){return yy(O,r,l,a)});return f.concat(p,h,v,d,S,E,A)}Ct.validateGrammar=hM;function cM(r,e){var n=new gy;r.accept(n);var a=n.allProductions,l=(0,nM.default)(a,vy),f=(0,iM.default)(l,function(v){return v.length>1}),h=(0,Xa.default)((0,aM.default)(f),function(v){var d=(0,cy.default)(v),p=e.buildDuplicateFoundError(r,v),S=(0,Lv.getProductionDslName)(d),E={message:p,type:ci.ParserDefinitionErrorType.DUPLICATE_PRODUCTIONS,ruleName:r.name,dslName:S,occurrence:d.idx},A=py(d);return A&&(E.parameter=A),E});return h}function vy(r){return"".concat((0,Lv.getProductionDslName)(r),"_#_").concat(r.idx,"_#_").concat(py(r))}Ct.identifyProductionForDuplicates=vy;function py(r){return r instanceof Fn.Terminal?r.terminalType.name:r instanceof Fn.NonTerminal?r.nonTerminalName:""}var gy=function(r){xv(e,r);function e(){var n=r!==null&&r.apply(this,arguments)||this;return n.allProductions=[],n}return e.prototype.visitNonTerminal=function(n){this.allProductions.push(n)},e.prototype.visitOption=function(n){this.allProductions.push(n)},e.prototype.visitRepetitionWithSeparator=function(n){this.allProductions.push(n)},e.prototype.visitRepetitionMandatory=function(n){this.allProductions.push(n)},e.prototype.visitRepetitionMandatoryWithSeparator=function(n){this.allProductions.push(n)},e.prototype.visitRepetition=function(n){this.allProductions.push(n)},e.prototype.visitAlternation=function(n){this.allProductions.push(n)},e.prototype.visitTerminal=function(n){this.allProductions.push(n)},e}(Iv.GAstVisitor);Ct.OccurrenceValidationCollector=gy;function yy(r,e,n,a){var l=[],f=(0,Rv.default)(e,function(v,d){return d.name===r.name?v+1:v},0);if(f>1){var h=a.buildDuplicateRuleNameError({topLevelRule:r,grammarName:n});l.push({message:h,type:ci.ParserDefinitionErrorType.DUPLICATE_RULE_NAME,ruleName:r.name})}return l}Ct.validateRuleDoesNotAlreadyExist=yy;function dM(r,e,n){var a=[],l;return(0,Pv.default)(e,r)||(l="Invalid rule override, rule: ->".concat(r,"<- cannot be overridden in the grammar: ->").concat(n,"<-")+"as it is not defined in any of the super grammars ",a.push({message:l,type:ci.ParserDefinitionErrorType.INVALID_RULE_OVERRIDE,ruleName:r})),a}Ct.validateRuleIsOverridden=dM;function Nv(r,e,n,a){a===void 0&&(a=[]);var l=[],f=Fl(e.definition);if((0,fu.default)(f))return[];var h=r.name,v=(0,Pv.default)(f,r);v&&l.push({message:n.buildLeftRecursionError({topLevelRule:r,leftRecursionPath:a}),type:ci.ParserDefinitionErrorType.LEFT_RECURSION,ruleName:h});var d=(0,rM.default)(f,a.concat([r])),p=(0,dn.default)(d,function(S){var E=(0,oM.default)(a);return E.push(S),Nv(r,S,n,E)});return l.concat(p)}Ct.validateNoLeftRecursion=Nv;function Fl(r){var e=[];if((0,fu.default)(r))return e;var n=(0,cy.default)(r);if(n instanceof Fn.NonTerminal)e.push(n.referencedRule);else if(n instanceof Fn.Alternative||n instanceof Fn.Option||n instanceof Fn.RepetitionMandatory||n instanceof Fn.RepetitionMandatoryWithSeparator||n instanceof Fn.RepetitionWithSeparator||n instanceof Fn.Repetition)e=e.concat(Fl(n.definition));else if(n instanceof Fn.Alternation)e=(0,dy.default)((0,Xa.default)(n.definition,function(h){return Fl(h.definition)}));else if(!(n instanceof Fn.Terminal))throw Error("non exhaustive match");var a=(0,Lv.isOptionalProd)(n),l=r.length>1;if(a&&l){var f=(0,JN.default)(r);return e.concat(Fl(f))}else return e}Ct.getFirstNoneTerminal=Fl;var Mv=function(r){xv(e,r);function e(){var n=r!==null&&r.apply(this,arguments)||this;return n.alternations=[],n}return e.prototype.visitAlternation=function(n){this.alternations.push(n)},e}(Iv.GAstVisitor);function my(r,e){var n=new Mv;r.accept(n);var a=n.alternations,l=(0,dn.default)(a,function(f){var h=(0,lM.default)(f.definition);return(0,dn.default)(h,function(v,d){var p=(0,sM.nextPossibleTokensAfter)([v],[],fM.tokenStructuredMatcher,1);return(0,fu.default)(p)?[{message:e.buildEmptyAlternationError({topLevelRule:r,alternation:f,emptyChoiceIdx:d}),type:ci.ParserDefinitionErrorType.NONE_LAST_EMPTY_ALT,ruleName:r.name,occurrence:f.idx,alternative:d+1}]:[]})});return l}Ct.validateEmptyOrAlternative=my;function _y(r,e,n){var a=new Mv;r.accept(a);var l=a.alternations;l=(0,tM.default)(l,function(h){return h.ignoreAmbiguities===!0});var f=(0,dn.default)(l,function(h){var v=h.idx,d=h.maxLookahead||e,p=(0,as.getLookaheadPathsForOr)(v,r,d,h),S=vM(p,h,r,n),E=Cy(p,h,r,n);return S.concat(E)});return f}Ct.validateAmbiguousAlternationAlternatives=_y;var by=function(r){xv(e,r);function e(){var n=r!==null&&r.apply(this,arguments)||this;return n.allProductions=[],n}return e.prototype.visitRepetitionWithSeparator=function(n){this.allProductions.push(n)},e.prototype.visitRepetitionMandatory=function(n){this.allProductions.push(n)},e.prototype.visitRepetitionMandatoryWithSeparator=function(n){this.allProductions.push(n)},e.prototype.visitRepetition=function(n){this.allProductions.push(n)},e}(Iv.GAstVisitor);Ct.RepetitionCollector=by;function Sy(r,e){var n=new Mv;r.accept(n);var a=n.alternations,l=(0,dn.default)(a,function(f){return f.definition.length>255?[{message:e.buildTooManyAlternativesError({topLevelRule:r,alternation:f}),type:ci.ParserDefinitionErrorType.TOO_MANY_ALTS,ruleName:r.name,occurrence:f.idx}]:[]});return l}Ct.validateTooManyAlts=Sy;function Ty(r,e,n){var a=[];return(0,Hl.default)(r,function(l){var f=new by;l.accept(f);var h=f.allProductions;(0,Hl.default)(h,function(v){var d=(0,as.getProdType)(v),p=v.maxLookahead||e,S=v.idx,E=(0,as.getLookaheadPathsForOptionalProd)(S,l,d,p),A=E[0];if((0,fu.default)((0,dy.default)(A))){var O=n.buildEmptyRepetitionError({topLevelRule:l,repetition:v});a.push({message:O,type:ci.ParserDefinitionErrorType.NO_NON_EMPTY_LOOKAHEAD,ruleName:l.name})}})}),a}Ct.validateSomeNonEmptyLookaheadPath=Ty;function vM(r,e,n,a){var l=[],f=(0,Rv.default)(r,function(v,d,p){return e.definition[p].ignoreAmbiguities===!0||(0,Hl.default)(d,function(S){var E=[p];(0,Hl.default)(r,function(A,O){p!==O&&(0,as.containsPath)(A,S)&&e.definition[O].ignoreAmbiguities!==!0&&E.push(O)}),E.length>1&&!(0,as.containsPath)(l,S)&&(l.push(S),v.push({alts:E,path:S}))}),v},[]),h=(0,Xa.default)(f,function(v){var d=(0,Xa.default)(v.alts,function(S){return S+1}),p=a.buildAlternationAmbiguityError({topLevelRule:n,alternation:e,ambiguityIndices:d,prefixPath:v.path});return{message:p,type:ci.ParserDefinitionErrorType.AMBIGUOUS_ALTS,ruleName:n.name,occurrence:e.idx,alternatives:v.alts}});return h}function Cy(r,e,n,a){var l=(0,Rv.default)(r,function(h,v,d){var p=(0,Xa.default)(v,function(S){return{idx:d,path:S}});return h.concat(p)},[]),f=(0,uM.default)((0,dn.default)(l,function(h){var v=e.definition[h.idx];if(v.ignoreAmbiguities===!0)return[];var d=h.idx,p=h.path,S=(0,eM.default)(l,function(A){return e.definition[A.idx].ignoreAmbiguities!==!0&&A.idx<d&&(0,as.isStrictPrefixOfPath)(A.path,p)}),E=(0,Xa.default)(S,function(A){var O=[A.idx+1,d+1],k=e.idx===0?"":e.idx,T=a.buildAlternationPrefixAmbiguityError({topLevelRule:n,alternation:e,ambiguityIndices:O,prefixPath:A.path});return{message:T,type:ci.ParserDefinitionErrorType.AMBIGUOUS_PREFIX_ALTS,ruleName:n.name,occurrence:k,alternatives:O}});return E}));return f}Ct.checkPrefixAlternativesAmbiguities=Cy;function pM(r,e,n){var a=[],l=(0,Xa.default)(e,function(f){return f.name});return(0,Hl.default)(r,function(f){var h=f.name;if((0,Pv.default)(l,h)){var v=n.buildNamespaceConflictError(f);a.push({message:v,type:ci.ParserDefinitionErrorType.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:h})}}),a}var Ey=_e&&_e.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(ns,"__esModule",{value:!0});ns.validateGrammar=ns.resolveGrammar=void 0;var gM=Ey(Rr),Ay=Ey(iy),yM=is,mM=Ct,wy=su;function _M(r){var e=(0,Ay.default)(r,{errMsgProvider:wy.defaultGrammarResolverErrorProvider}),n={};return(0,gM.default)(r.rules,function(a){n[a.name]=a}),(0,yM.resolveGrammar)(n,e.errMsgProvider)}ns.resolveGrammar=_M;function bM(r){return r=(0,Ay.default)(r,{errMsgProvider:wy.defaultGrammarValidatorErrorProvider}),(0,mM.validateGrammar)(r.rules,r.maxLookahead,r.tokenTypes,r.errMsgProvider,r.grammarName)}ns.validateGrammar=bM;var Dv={},xr={},hu=_e&&_e.__extends||function(){var r=function(e,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,l){a.__proto__=l}||function(a,l){for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(a[f]=l[f])},r(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");r(e,n);function a(){this.constructor=e}e.prototype=n===null?Object.create(n):(a.prototype=n.prototype,new a)}}(),SM=_e&&_e.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(xr,"__esModule",{value:!0});xr.EarlyExitException=xr.NotAllInputParsedException=xr.NoViableAltException=xr.MismatchedTokenException=xr.isRecognitionException=void 0;var TM=SM(Mi),ky="MismatchedTokenException",Oy="NoViableAltException",xy="EarlyExitException",Ry="NotAllInputParsedException",Py=[ky,Oy,xy,Ry];Object.freeze(Py);function CM(r){return(0,TM.default)(Py,r.name)}xr.isRecognitionException=CM;var $h=function(r){hu(e,r);function e(n,a){var l=this.constructor,f=r.call(this,n)||this;return f.token=a,f.resyncedTokens=[],Object.setPrototypeOf(f,l.prototype),Error.captureStackTrace&&Error.captureStackTrace(f,f.constructor),f}return e}(Error),EM=function(r){hu(e,r);function e(n,a,l){var f=r.call(this,n,a)||this;return f.previousToken=l,f.name=ky,f}return e}($h);xr.MismatchedTokenException=EM;var AM=function(r){hu(e,r);function e(n,a,l){var f=r.call(this,n,a)||this;return f.previousToken=l,f.name=Oy,f}return e}($h);xr.NoViableAltException=AM;var wM=function(r){hu(e,r);function e(n,a){var l=r.call(this,n,a)||this;return l.name=Ry,l}return e}($h);xr.NotAllInputParsedException=wM;var kM=function(r){hu(e,r);function e(n,a,l){var f=r.call(this,n,a)||this;return f.previousToken=l,f.name=xy,f}return e}($h);xr.EarlyExitException=kM;(function(r){var e=_e&&_e.__extends||function(){var j=function(B,U){return j=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(J,P){J.__proto__=P}||function(J,P){for(var I in P)Object.prototype.hasOwnProperty.call(P,I)&&(J[I]=P[I])},j(B,U)};return function(B,U){if(typeof U!="function"&&U!==null)throw new TypeError("Class extends value "+String(U)+" is not a constructor or null");j(B,U);function J(){this.constructor=B}B.prototype=U===null?Object.create(U):(J.prototype=U.prototype,new J)}}(),n=_e&&_e.__importDefault||function(j){return j&&j.__esModule?j:{default:j}};Object.defineProperty(r,"__esModule",{value:!0}),r.attemptInRepetitionRecovery=r.Recoverable=r.InRuleRecoveryException=r.IN_RULE_RECOVERY_EXCEPTION=r.EOF_FOLLOW_KEY=void 0;var a=Za,l=n(si),f=n(Ov),h=n(Di),v=n(Kr),d=n(Av),p=n(gn),S=n(Mi),E=n(fa),A=xr,O=nu,k=tn;r.EOF_FOLLOW_KEY={},r.IN_RULE_RECOVERY_EXCEPTION="InRuleRecoveryException";var T=function(j){e(B,j);function B(U){var J=j.call(this,U)||this;return J.name=r.IN_RULE_RECOVERY_EXCEPTION,J}return B}(Error);r.InRuleRecoveryException=T;var x=function(){function j(){}return j.prototype.initRecoverable=function(B){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=(0,p.default)(B,"recoveryEnabled")?B.recoveryEnabled:k.DEFAULT_PARSER_CONFIG.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=G)},j.prototype.getTokenToInsert=function(B){var U=(0,a.createTokenInstance)(B,"",NaN,NaN,NaN,NaN,NaN,NaN);return U.isInsertedInRecovery=!0,U},j.prototype.canTokenTypeBeInsertedInRecovery=function(B){return!0},j.prototype.canTokenTypeBeDeletedInRecovery=function(B){return!0},j.prototype.tryInRepetitionRecovery=function(B,U,J,P){for(var I=this,D=this.findReSyncTokenType(),R=this.exportLexerState(),Y=[],re=!1,se=this.LA(1),Q=this.LA(1),q=function(){var Ce=I.LA(0),K=I.errorMessageProvider.buildMismatchTokenMessage({expected:P,actual:se,previous:Ce,ruleName:I.getCurrRuleFullName()}),ne=new A.MismatchedTokenException(K,se,I.LA(0));ne.resyncedTokens=(0,f.default)(Y),I.SAVE_ERROR(ne)};!re;)if(this.tokenMatcher(Q,P)){q();return}else if(J.call(this)){q(),B.apply(this,U);return}else this.tokenMatcher(Q,D)?re=!0:(Q=this.SKIP_TOKEN(),this.addToResyncTokens(Q,Y));this.importLexerState(R)},j.prototype.shouldInRepetitionRecoveryBeTried=function(B,U,J){return!(J===!1||this.tokenMatcher(this.LA(1),B)||this.isBackTracking()||this.canPerformInRuleRecovery(B,this.getFollowsForInRuleRecovery(B,U)))},j.prototype.getFollowsForInRuleRecovery=function(B,U){var J=this.getCurrentGrammarPath(B,U),P=this.getNextPossibleTokenTypes(J);return P},j.prototype.tryInRuleRecovery=function(B,U){if(this.canRecoverWithSingleTokenInsertion(B,U)){var J=this.getTokenToInsert(B);return J}if(this.canRecoverWithSingleTokenDeletion(B)){var P=this.SKIP_TOKEN();return this.consumeToken(),P}throw new T("sad sad panda")},j.prototype.canPerformInRuleRecovery=function(B,U){return this.canRecoverWithSingleTokenInsertion(B,U)||this.canRecoverWithSingleTokenDeletion(B)},j.prototype.canRecoverWithSingleTokenInsertion=function(B,U){var J=this;if(!this.canTokenTypeBeInsertedInRecovery(B)||(0,l.default)(U))return!1;var P=this.LA(1),I=(0,d.default)(U,function(D){return J.tokenMatcher(P,D)})!==void 0;return I},j.prototype.canRecoverWithSingleTokenDeletion=function(B){if(!this.canTokenTypeBeDeletedInRecovery(B))return!1;var U=this.tokenMatcher(this.LA(2),B);return U},j.prototype.isInCurrentRuleReSyncSet=function(B){var U=this.getCurrFollowKey(),J=this.getFollowSetFromFollowKey(U);return(0,S.default)(J,B)},j.prototype.findReSyncTokenType=function(){for(var B=this.flattenFollowSet(),U=this.LA(1),J=2;;){var P=(0,d.default)(B,function(I){var D=(0,a.tokenMatcher)(U,I);return D});if(P!==void 0)return P;U=this.LA(J),J++}},j.prototype.getCurrFollowKey=function(){if(this.RULE_STACK.length===1)return r.EOF_FOLLOW_KEY;var B=this.getLastExplicitRuleShortName(),U=this.getLastExplicitRuleOccurrenceIndex(),J=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(B),idxInCallingRule:U,inRule:this.shortRuleNameToFullName(J)}},j.prototype.buildFullFollowKeyStack=function(){var B=this,U=this.RULE_STACK,J=this.RULE_OCCURRENCE_STACK;return(0,v.default)(U,function(P,I){return I===0?r.EOF_FOLLOW_KEY:{ruleName:B.shortRuleNameToFullName(P),idxInCallingRule:J[I],inRule:B.shortRuleNameToFullName(U[I-1])}})},j.prototype.flattenFollowSet=function(){var B=this,U=(0,v.default)(this.buildFullFollowKeyStack(),function(J){return B.getFollowSetFromFollowKey(J)});return(0,h.default)(U)},j.prototype.getFollowSetFromFollowKey=function(B){if(B===r.EOF_FOLLOW_KEY)return[a.EOF];var U=B.ruleName+B.idxInCallingRule+O.IN+B.inRule;return this.resyncFollows[U]},j.prototype.addToResyncTokens=function(B,U){return this.tokenMatcher(B,a.EOF)||U.push(B),U},j.prototype.reSyncTo=function(B){for(var U=[],J=this.LA(1);this.tokenMatcher(J,B)===!1;)J=this.SKIP_TOKEN(),this.addToResyncTokens(J,U);return(0,f.default)(U)},j.prototype.attemptInRepetitionRecovery=function(B,U,J,P,I,D,R){},j.prototype.getCurrentGrammarPath=function(B,U){var J=this.getHumanReadableRuleStack(),P=(0,E.default)(this.RULE_OCCURRENCE_STACK),I={ruleStack:J,occurrenceStack:P,lastTok:B,lastTokOccurrence:U};return I},j.prototype.getHumanReadableRuleStack=function(){var B=this;return(0,v.default)(this.RULE_STACK,function(U){return B.shortRuleNameToFullName(U)})},j}();r.Recoverable=x;function G(j,B,U,J,P,I,D){var R=this.getKeyForAutomaticLookahead(J,P),Y=this.firstAfterRepMap[R];if(Y===void 0){var re=this.getCurrRuleFullName(),se=this.getGAstProductions()[re],Q=new I(se,P);Y=Q.startWalking(),this.firstAfterRepMap[R]=Y}var q=Y.token,Ce=Y.occurrence,K=Y.isEndOfRule;this.RULE_STACK.length===1&&K&&q===void 0&&(q=a.EOF,Ce=1),!(q===void 0||Ce===void 0)&&this.shouldInRepetitionRecoveryBeTried(q,Ce,D)&&this.tryInRepetitionRecovery(j,B,U,q)}r.attemptInRepetitionRecovery=G})(Dv);var os={},Gh={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.getKeyForAutomaticLookahead=r.AT_LEAST_ONE_SEP_IDX=r.MANY_SEP_IDX=r.AT_LEAST_ONE_IDX=r.MANY_IDX=r.OPTION_IDX=r.OR_IDX=r.BITS_FOR_ALT_IDX=r.BITS_FOR_RULE_IDX=r.BITS_FOR_OCCURRENCE_IDX=r.BITS_FOR_METHOD_TYPE=void 0,r.BITS_FOR_METHOD_TYPE=4,r.BITS_FOR_OCCURRENCE_IDX=8,r.BITS_FOR_RULE_IDX=12,r.BITS_FOR_ALT_IDX=8,r.OR_IDX=1<<r.BITS_FOR_OCCURRENCE_IDX,r.OPTION_IDX=2<<r.BITS_FOR_OCCURRENCE_IDX,r.MANY_IDX=3<<r.BITS_FOR_OCCURRENCE_IDX,r.AT_LEAST_ONE_IDX=4<<r.BITS_FOR_OCCURRENCE_IDX,r.MANY_SEP_IDX=5<<r.BITS_FOR_OCCURRENCE_IDX,r.AT_LEAST_ONE_SEP_IDX=6<<r.BITS_FOR_OCCURRENCE_IDX;function e(n,a,l){return l|a|n}r.getKeyForAutomaticLookahead=e,32-r.BITS_FOR_ALT_IDX})(Gh);var OM=_e&&_e.__extends||function(){var r=function(e,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,l){a.__proto__=l}||function(a,l){for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(a[f]=l[f])},r(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");r(e,n);function a(){this.constructor=e}e.prototype=n===null?Object.create(n):(a.prototype=n.prototype,new a)}}(),Ly=_e&&_e.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(os,"__esModule",{value:!0});os.collectMethods=os.LooksAhead=void 0;var Ri=lu,Ua=Ly(Rr),ng=Ly(gn),ig=tn,Pi=Gh,xM=nr,Xo=nr,RM=function(){function r(){}return r.prototype.initLooksAhead=function(e){this.dynamicTokensEnabled=(0,ng.default)(e,"dynamicTokensEnabled")?e.dynamicTokensEnabled:ig.DEFAULT_PARSER_CONFIG.dynamicTokensEnabled,this.maxLookahead=(0,ng.default)(e,"maxLookahead")?e.maxLookahead:ig.DEFAULT_PARSER_CONFIG.maxLookahead,this.lookAheadFuncsCache=new Map},r.prototype.preComputeLookaheadFunctions=function(e){var n=this;(0,Ua.default)(e,function(a){n.TRACE_INIT("".concat(a.name," Rule Lookahead"),function(){var l=Iy(a),f=l.alternation,h=l.repetition,v=l.option,d=l.repetitionMandatory,p=l.repetitionMandatoryWithSeparator,S=l.repetitionWithSeparator;(0,Ua.default)(f,function(E){var A=E.idx===0?"":E.idx;n.TRACE_INIT("".concat((0,Xo.getProductionDslName)(E)).concat(A),function(){var O=(0,Ri.buildLookaheadFuncForOr)(E.idx,a,E.maxLookahead||n.maxLookahead,E.hasPredicates,n.dynamicTokensEnabled,n.lookAheadBuilderForAlternatives),k=(0,Pi.getKeyForAutomaticLookahead)(n.fullRuleNameToShort[a.name],Pi.OR_IDX,E.idx);n.setLaFuncCache(k,O)})}),(0,Ua.default)(h,function(E){n.computeLookaheadFunc(a,E.idx,Pi.MANY_IDX,Ri.PROD_TYPE.REPETITION,E.maxLookahead,(0,Xo.getProductionDslName)(E))}),(0,Ua.default)(v,function(E){n.computeLookaheadFunc(a,E.idx,Pi.OPTION_IDX,Ri.PROD_TYPE.OPTION,E.maxLookahead,(0,Xo.getProductionDslName)(E))}),(0,Ua.default)(d,function(E){n.computeLookaheadFunc(a,E.idx,Pi.AT_LEAST_ONE_IDX,Ri.PROD_TYPE.REPETITION_MANDATORY,E.maxLookahead,(0,Xo.getProductionDslName)(E))}),(0,Ua.default)(p,function(E){n.computeLookaheadFunc(a,E.idx,Pi.AT_LEAST_ONE_SEP_IDX,Ri.PROD_TYPE.REPETITION_MANDATORY_WITH_SEPARATOR,E.maxLookahead,(0,Xo.getProductionDslName)(E))}),(0,Ua.default)(S,function(E){n.computeLookaheadFunc(a,E.idx,Pi.MANY_SEP_IDX,Ri.PROD_TYPE.REPETITION_WITH_SEPARATOR,E.maxLookahead,(0,Xo.getProductionDslName)(E))})})})},r.prototype.computeLookaheadFunc=function(e,n,a,l,f,h){var v=this;this.TRACE_INIT("".concat(h).concat(n===0?"":n),function(){var d=(0,Ri.buildLookaheadFuncForOptionalProd)(n,e,f||v.maxLookahead,v.dynamicTokensEnabled,l,v.lookAheadBuilderForOptional),p=(0,Pi.getKeyForAutomaticLookahead)(v.fullRuleNameToShort[e.name],a,n);v.setLaFuncCache(p,d)})},r.prototype.lookAheadBuilderForOptional=function(e,n,a){return(0,Ri.buildSingleAlternativeLookaheadFunction)(e,n,a)},r.prototype.lookAheadBuilderForAlternatives=function(e,n,a,l){return(0,Ri.buildAlternativesLookAheadFunc)(e,n,a,l)},r.prototype.getKeyForAutomaticLookahead=function(e,n){var a=this.getLastExplicitRuleShortName();return(0,Pi.getKeyForAutomaticLookahead)(a,e,n)},r.prototype.getLaFuncFromCache=function(e){return this.lookAheadFuncsCache.get(e)},r.prototype.setLaFuncCache=function(e,n){this.lookAheadFuncsCache.set(e,n)},r}();os.LooksAhead=RM;var PM=function(r){OM(e,r);function e(){var n=r!==null&&r.apply(this,arguments)||this;return n.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]},n}return e.prototype.reset=function(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}},e.prototype.visitOption=function(n){this.dslMethods.option.push(n)},e.prototype.visitRepetitionWithSeparator=function(n){this.dslMethods.repetitionWithSeparator.push(n)},e.prototype.visitRepetitionMandatory=function(n){this.dslMethods.repetitionMandatory.push(n)},e.prototype.visitRepetitionMandatoryWithSeparator=function(n){this.dslMethods.repetitionMandatoryWithSeparator.push(n)},e.prototype.visitRepetition=function(n){this.dslMethods.repetition.push(n)},e.prototype.visitAlternation=function(n){this.dslMethods.alternation.push(n)},e}(xM.GAstVisitor),Uf=new PM;function Iy(r){Uf.reset(),r.accept(Uf);var e=Uf.dslMethods;return Uf.reset(),e}os.collectMethods=Iy;var Wh={},ri={};Object.defineProperty(ri,"__esModule",{value:!0});ri.addNoneTerminalToCst=ri.addTerminalToCst=ri.setNodeLocationFull=ri.setNodeLocationOnlyOffset=void 0;function LM(r,e){isNaN(r.startOffset)===!0?(r.startOffset=e.startOffset,r.endOffset=e.endOffset):r.endOffset<e.endOffset&&(r.endOffset=e.endOffset)}ri.setNodeLocationOnlyOffset=LM;function IM(r,e){isNaN(r.startOffset)===!0?(r.startOffset=e.startOffset,r.startColumn=e.startColumn,r.startLine=e.startLine,r.endOffset=e.endOffset,r.endColumn=e.endColumn,r.endLine=e.endLine):r.endOffset<e.endOffset&&(r.endOffset=e.endOffset,r.endColumn=e.endColumn,r.endLine=e.endLine)}ri.setNodeLocationFull=IM;function NM(r,e,n){r.children[n]===void 0?r.children[n]=[e]:r.children[n].push(e)}ri.addTerminalToCst=NM;function MM(r,e,n){r.children[e]===void 0?r.children[e]=[n]:r.children[e].push(n)}ri.addNoneTerminalToCst=MM;var Ny={},Bh={};Object.defineProperty(Bh,"__esModule",{value:!0});Bh.defineNameProp=void 0;var DM="name";function FM(r,e){Object.defineProperty(r,DM,{enumerable:!1,configurable:!0,writable:!1,value:e})}Bh.defineNameProp=FM;(function(r){var e=_e&&_e.__importDefault||function(J){return J&&J.__esModule?J:{default:J}};Object.defineProperty(r,"__esModule",{value:!0}),r.validateRedundantMethods=r.validateMissingCstMethods=r.validateVisitor=r.CstVisitorDefinitionError=r.createBaseVisitorConstructorWithDefaults=r.createBaseSemanticVisitorConstructor=r.defaultVisit=void 0;var n=e(si),a=e(Dh),l=e(kt),f=e(Kr),h=e(Rr),v=e(wv),d=e(pn),p=e(Kl),S=e(ys),E=e(Mi),A=Bh;function O(J,P){for(var I=(0,d.default)(J),D=I.length,R=0;R<D;R++)for(var Y=I[R],re=J[Y],se=re.length,Q=0;Q<se;Q++){var q=re[Q];q.tokenTypeIdx===void 0&&this[q.name](q.children,P)}}r.defaultVisit=O;function k(J,P){var I=function(){};(0,A.defineNameProp)(I,J+"BaseSemantics");var D={visit:function(R,Y){if((0,l.default)(R)&&(R=R[0]),!(0,S.default)(R))return this[R.name](R.children,Y)},validateVisitor:function(){var R=G(this,P);if(!(0,n.default)(R)){var Y=(0,f.default)(R,function(re){return re.msg});throw Error("Errors Detected in CST Visitor <".concat(this.constructor.name,`>:
	`)+"".concat(Y.join(`

`).replace(/\n/g,`
	`)))}}};return I.prototype=D,I.prototype.constructor=I,I._RULE_NAMES=P,I}r.createBaseSemanticVisitorConstructor=k;function T(J,P,I){var D=function(){};(0,A.defineNameProp)(D,J+"BaseSemanticsWithDefaults");var R=Object.create(I.prototype);return(0,h.default)(P,function(Y){R[Y]=O}),D.prototype=R,D.prototype.constructor=D,D}r.createBaseVisitorConstructorWithDefaults=T;var x;(function(J){J[J.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",J[J.MISSING_METHOD=1]="MISSING_METHOD"})(x=r.CstVisitorDefinitionError||(r.CstVisitorDefinitionError={}));function G(J,P){var I=j(J,P),D=U(J,P);return I.concat(D)}r.validateVisitor=G;function j(J,P){var I=(0,v.default)(P,function(R){return(0,p.default)(J[R])===!1}),D=(0,f.default)(I,function(R){return{msg:"Missing visitor method: <".concat(R,"> on ").concat(J.constructor.name," CST Visitor."),type:x.MISSING_METHOD,methodName:R}});return(0,a.default)(D)}r.validateMissingCstMethods=j;var B=["constructor","visit","validateVisitor"];function U(J,P){var I=[];for(var D in J)(0,p.default)(J[D])&&!(0,E.default)(B,D)&&!(0,E.default)(P,D)&&I.push({msg:"Redundant visitor method: <".concat(D,"> on ").concat(J.constructor.name,` CST Visitor
`)+`There is no Grammar Rule corresponding to this method's name.
`,type:x.REDUNDANT_METHOD,methodName:D});return I}r.validateRedundantMethods=U})(Ny);var Uh=_e&&_e.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Wh,"__esModule",{value:!0});Wh.TreeBuilder=void 0;var Ko=ri,Gr=Uh(_v),$M=Uh(gn),ag=Uh(pn),og=Uh(ys),sg=Ny,GM=tn,WM=function(){function r(){}return r.prototype.initTreeBuilder=function(e){if(this.CST_STACK=[],this.outputCst=e.outputCst,this.nodeLocationTracking=(0,$M.default)(e,"nodeLocationTracking")?e.nodeLocationTracking:GM.DEFAULT_PARSER_CONFIG.nodeLocationTracking,!this.outputCst)this.cstInvocationStateUpdate=Gr.default,this.cstFinallyStateUpdate=Gr.default,this.cstPostTerminal=Gr.default,this.cstPostNonTerminal=Gr.default,this.cstPostRule=Gr.default;else if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=Ko.setNodeLocationFull,this.setNodeLocationFromNode=Ko.setNodeLocationFull,this.cstPostRule=Gr.default,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=Gr.default,this.setNodeLocationFromNode=Gr.default,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=Ko.setNodeLocationOnlyOffset,this.setNodeLocationFromNode=Ko.setNodeLocationOnlyOffset,this.cstPostRule=Gr.default,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=Gr.default,this.setNodeLocationFromNode=Gr.default,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else if(/none/i.test(this.nodeLocationTracking))this.setNodeLocationFromToken=Gr.default,this.setNodeLocationFromNode=Gr.default,this.cstPostRule=Gr.default,this.setInitialNodeLocation=Gr.default;else throw Error('Invalid <nodeLocationTracking> config option: "'.concat(e.nodeLocationTracking,'"'))},r.prototype.setInitialNodeLocationOnlyOffsetRecovery=function(e){e.location={startOffset:NaN,endOffset:NaN}},r.prototype.setInitialNodeLocationOnlyOffsetRegular=function(e){e.location={startOffset:this.LA(1).startOffset,endOffset:NaN}},r.prototype.setInitialNodeLocationFullRecovery=function(e){e.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}},r.prototype.setInitialNodeLocationFullRegular=function(e){var n=this.LA(1);e.location={startOffset:n.startOffset,startLine:n.startLine,startColumn:n.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}},r.prototype.cstInvocationStateUpdate=function(e){var n={name:e,children:Object.create(null)};this.setInitialNodeLocation(n),this.CST_STACK.push(n)},r.prototype.cstFinallyStateUpdate=function(){this.CST_STACK.pop()},r.prototype.cstPostRuleFull=function(e){var n=this.LA(0),a=e.location;a.startOffset<=n.startOffset?(a.endOffset=n.endOffset,a.endLine=n.endLine,a.endColumn=n.endColumn):(a.startOffset=NaN,a.startLine=NaN,a.startColumn=NaN)},r.prototype.cstPostRuleOnlyOffset=function(e){var n=this.LA(0),a=e.location;a.startOffset<=n.startOffset?a.endOffset=n.endOffset:a.startOffset=NaN},r.prototype.cstPostTerminal=function(e,n){var a=this.CST_STACK[this.CST_STACK.length-1];(0,Ko.addTerminalToCst)(a,n,e),this.setNodeLocationFromToken(a.location,n)},r.prototype.cstPostNonTerminal=function(e,n){var a=this.CST_STACK[this.CST_STACK.length-1];(0,Ko.addNoneTerminalToCst)(a,n,e),this.setNodeLocationFromNode(a.location,e.location)},r.prototype.getBaseCstVisitorConstructor=function(){if((0,og.default)(this.baseCstVisitorConstructor)){var e=(0,sg.createBaseSemanticVisitorConstructor)(this.className,(0,ag.default)(this.gastProductionsCache));return this.baseCstVisitorConstructor=e,e}return this.baseCstVisitorConstructor},r.prototype.getBaseCstVisitorConstructorWithDefaults=function(){if((0,og.default)(this.baseCstVisitorWithDefaultsConstructor)){var e=(0,sg.createBaseVisitorConstructorWithDefaults)(this.className,(0,ag.default)(this.gastProductionsCache),this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=e,e}return this.baseCstVisitorWithDefaultsConstructor},r.prototype.getLastExplicitRuleShortName=function(){var e=this.RULE_STACK;return e[e.length-1]},r.prototype.getPreviousExplicitRuleShortName=function(){var e=this.RULE_STACK;return e[e.length-2]},r.prototype.getLastExplicitRuleOccurrenceIndex=function(){var e=this.RULE_OCCURRENCE_STACK;return e[e.length-1]},r}();Wh.TreeBuilder=WM;var Hh={};Object.defineProperty(Hh,"__esModule",{value:!0});Hh.LexerAdapter=void 0;var lg=tn,BM=function(){function r(){}return r.prototype.initLexerAdapter=function(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1},Object.defineProperty(r.prototype,"input",{get:function(){return this.tokVector},set:function(e){if(this.selfAnalysisDone!==!0)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=e,this.tokVectorLength=e.length},enumerable:!1,configurable:!0}),r.prototype.SKIP_TOKEN=function(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):lg.END_OF_FILE},r.prototype.LA=function(e){var n=this.currIdx+e;return n<0||this.tokVectorLength<=n?lg.END_OF_FILE:this.tokVector[n]},r.prototype.consumeToken=function(){this.currIdx++},r.prototype.exportLexerState=function(){return this.currIdx},r.prototype.importLexerState=function(e){this.currIdx=e},r.prototype.resetLexerState=function(){this.currIdx=-1},r.prototype.moveToTerminatedState=function(){this.currIdx=this.tokVector.length-1},r.prototype.getLexerPosition=function(){return this.exportLexerState()},r}();Hh.LexerAdapter=BM;var zh={},My=_e&&_e.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(zh,"__esModule",{value:!0});zh.RecognizerApi=void 0;var UM=My(Ii),HM=My(Mi),zM=xr,dd=tn,jM=su,YM=Ct,XM=nr,KM=function(){function r(){}return r.prototype.ACTION=function(e){return e.call(this)},r.prototype.consume=function(e,n,a){return this.consumeInternal(n,e,a)},r.prototype.subrule=function(e,n,a){return this.subruleInternal(n,e,a)},r.prototype.option=function(e,n){return this.optionInternal(n,e)},r.prototype.or=function(e,n){return this.orInternal(n,e)},r.prototype.many=function(e,n){return this.manyInternal(e,n)},r.prototype.atLeastOne=function(e,n){return this.atLeastOneInternal(e,n)},r.prototype.CONSUME=function(e,n){return this.consumeInternal(e,0,n)},r.prototype.CONSUME1=function(e,n){return this.consumeInternal(e,1,n)},r.prototype.CONSUME2=function(e,n){return this.consumeInternal(e,2,n)},r.prototype.CONSUME3=function(e,n){return this.consumeInternal(e,3,n)},r.prototype.CONSUME4=function(e,n){return this.consumeInternal(e,4,n)},r.prototype.CONSUME5=function(e,n){return this.consumeInternal(e,5,n)},r.prototype.CONSUME6=function(e,n){return this.consumeInternal(e,6,n)},r.prototype.CONSUME7=function(e,n){return this.consumeInternal(e,7,n)},r.prototype.CONSUME8=function(e,n){return this.consumeInternal(e,8,n)},r.prototype.CONSUME9=function(e,n){return this.consumeInternal(e,9,n)},r.prototype.SUBRULE=function(e,n){return this.subruleInternal(e,0,n)},r.prototype.SUBRULE1=function(e,n){return this.subruleInternal(e,1,n)},r.prototype.SUBRULE2=function(e,n){return this.subruleInternal(e,2,n)},r.prototype.SUBRULE3=function(e,n){return this.subruleInternal(e,3,n)},r.prototype.SUBRULE4=function(e,n){return this.subruleInternal(e,4,n)},r.prototype.SUBRULE5=function(e,n){return this.subruleInternal(e,5,n)},r.prototype.SUBRULE6=function(e,n){return this.subruleInternal(e,6,n)},r.prototype.SUBRULE7=function(e,n){return this.subruleInternal(e,7,n)},r.prototype.SUBRULE8=function(e,n){return this.subruleInternal(e,8,n)},r.prototype.SUBRULE9=function(e,n){return this.subruleInternal(e,9,n)},r.prototype.OPTION=function(e){return this.optionInternal(e,0)},r.prototype.OPTION1=function(e){return this.optionInternal(e,1)},r.prototype.OPTION2=function(e){return this.optionInternal(e,2)},r.prototype.OPTION3=function(e){return this.optionInternal(e,3)},r.prototype.OPTION4=function(e){return this.optionInternal(e,4)},r.prototype.OPTION5=function(e){return this.optionInternal(e,5)},r.prototype.OPTION6=function(e){return this.optionInternal(e,6)},r.prototype.OPTION7=function(e){return this.optionInternal(e,7)},r.prototype.OPTION8=function(e){return this.optionInternal(e,8)},r.prototype.OPTION9=function(e){return this.optionInternal(e,9)},r.prototype.OR=function(e){return this.orInternal(e,0)},r.prototype.OR1=function(e){return this.orInternal(e,1)},r.prototype.OR2=function(e){return this.orInternal(e,2)},r.prototype.OR3=function(e){return this.orInternal(e,3)},r.prototype.OR4=function(e){return this.orInternal(e,4)},r.prototype.OR5=function(e){return this.orInternal(e,5)},r.prototype.OR6=function(e){return this.orInternal(e,6)},r.prototype.OR7=function(e){return this.orInternal(e,7)},r.prototype.OR8=function(e){return this.orInternal(e,8)},r.prototype.OR9=function(e){return this.orInternal(e,9)},r.prototype.MANY=function(e){this.manyInternal(0,e)},r.prototype.MANY1=function(e){this.manyInternal(1,e)},r.prototype.MANY2=function(e){this.manyInternal(2,e)},r.prototype.MANY3=function(e){this.manyInternal(3,e)},r.prototype.MANY4=function(e){this.manyInternal(4,e)},r.prototype.MANY5=function(e){this.manyInternal(5,e)},r.prototype.MANY6=function(e){this.manyInternal(6,e)},r.prototype.MANY7=function(e){this.manyInternal(7,e)},r.prototype.MANY8=function(e){this.manyInternal(8,e)},r.prototype.MANY9=function(e){this.manyInternal(9,e)},r.prototype.MANY_SEP=function(e){this.manySepFirstInternal(0,e)},r.prototype.MANY_SEP1=function(e){this.manySepFirstInternal(1,e)},r.prototype.MANY_SEP2=function(e){this.manySepFirstInternal(2,e)},r.prototype.MANY_SEP3=function(e){this.manySepFirstInternal(3,e)},r.prototype.MANY_SEP4=function(e){this.manySepFirstInternal(4,e)},r.prototype.MANY_SEP5=function(e){this.manySepFirstInternal(5,e)},r.prototype.MANY_SEP6=function(e){this.manySepFirstInternal(6,e)},r.prototype.MANY_SEP7=function(e){this.manySepFirstInternal(7,e)},r.prototype.MANY_SEP8=function(e){this.manySepFirstInternal(8,e)},r.prototype.MANY_SEP9=function(e){this.manySepFirstInternal(9,e)},r.prototype.AT_LEAST_ONE=function(e){this.atLeastOneInternal(0,e)},r.prototype.AT_LEAST_ONE1=function(e){return this.atLeastOneInternal(1,e)},r.prototype.AT_LEAST_ONE2=function(e){this.atLeastOneInternal(2,e)},r.prototype.AT_LEAST_ONE3=function(e){this.atLeastOneInternal(3,e)},r.prototype.AT_LEAST_ONE4=function(e){this.atLeastOneInternal(4,e)},r.prototype.AT_LEAST_ONE5=function(e){this.atLeastOneInternal(5,e)},r.prototype.AT_LEAST_ONE6=function(e){this.atLeastOneInternal(6,e)},r.prototype.AT_LEAST_ONE7=function(e){this.atLeastOneInternal(7,e)},r.prototype.AT_LEAST_ONE8=function(e){this.atLeastOneInternal(8,e)},r.prototype.AT_LEAST_ONE9=function(e){this.atLeastOneInternal(9,e)},r.prototype.AT_LEAST_ONE_SEP=function(e){this.atLeastOneSepFirstInternal(0,e)},r.prototype.AT_LEAST_ONE_SEP1=function(e){this.atLeastOneSepFirstInternal(1,e)},r.prototype.AT_LEAST_ONE_SEP2=function(e){this.atLeastOneSepFirstInternal(2,e)},r.prototype.AT_LEAST_ONE_SEP3=function(e){this.atLeastOneSepFirstInternal(3,e)},r.prototype.AT_LEAST_ONE_SEP4=function(e){this.atLeastOneSepFirstInternal(4,e)},r.prototype.AT_LEAST_ONE_SEP5=function(e){this.atLeastOneSepFirstInternal(5,e)},r.prototype.AT_LEAST_ONE_SEP6=function(e){this.atLeastOneSepFirstInternal(6,e)},r.prototype.AT_LEAST_ONE_SEP7=function(e){this.atLeastOneSepFirstInternal(7,e)},r.prototype.AT_LEAST_ONE_SEP8=function(e){this.atLeastOneSepFirstInternal(8,e)},r.prototype.AT_LEAST_ONE_SEP9=function(e){this.atLeastOneSepFirstInternal(9,e)},r.prototype.RULE=function(e,n,a){if(a===void 0&&(a=dd.DEFAULT_RULE_CONFIG),(0,HM.default)(this.definedRulesNames,e)){var l=jM.defaultGrammarValidatorErrorProvider.buildDuplicateRuleNameError({topLevelRule:e,grammarName:this.className}),f={message:l,type:dd.ParserDefinitionErrorType.DUPLICATE_RULE_NAME,ruleName:e};this.definitionErrors.push(f)}this.definedRulesNames.push(e);var h=this.defineRule(e,n,a);return this[e]=h,h},r.prototype.OVERRIDE_RULE=function(e,n,a){a===void 0&&(a=dd.DEFAULT_RULE_CONFIG);var l=(0,YM.validateRuleIsOverridden)(e,this.definedRulesNames,this.className);this.definitionErrors=this.definitionErrors.concat(l);var f=this.defineRule(e,n,a);return this[e]=f,f},r.prototype.BACKTRACK=function(e,n){return function(){this.isBackTrackingStack.push(1);var a=this.saveRecogState();try{return e.apply(this,n),!0}catch(l){if((0,zM.isRecognitionException)(l))return!1;throw l}finally{this.reloadRecogState(a),this.isBackTrackingStack.pop()}}},r.prototype.getGAstProductions=function(){return this.gastProductionsCache},r.prototype.getSerializedGastProductions=function(){return(0,XM.serializeGrammar)((0,UM.default)(this.gastProductionsCache))},r}();zh.RecognizerApi=KM;var jh={},di=_e&&_e.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(jh,"__esModule",{value:!0});jh.RecognizerEngine=void 0;var ug=di(si),vd=di(kt),pd=di(Di),fg=di(Ih),qM=di(bv),VM=di(ii),bl=di(gn),Sl=di(Ii),hg=di(Qa),cg=di(fa),Qr=Gh,Hf=xr,dg=lu,qo=zt,vg=tn,ZM=Dv,pg=Za,Tl=Ja,QM=function(){function r(){}return r.prototype.initRecognizerEngine=function(e,n){if(this.className=this.constructor.name,this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=Tl.tokenStructuredMatcherNoCategories,this.subruleIdx=0,this.definedRulesNames=[],this.tokensMap={},this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},(0,bl.default)(n,"serializedGrammar"))throw Error(`The Parser's configuration can no longer contain a <serializedGrammar> property.
	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_6-0-0
	For Further details.`);if((0,vd.default)(e)){if((0,ug.default)(e))throw Error(`A Token Vocabulary cannot be empty.
	Note that the first argument for the parser constructor
	is no longer a Token vector (since v4.0).`);if(typeof e[0].startOffset=="number")throw Error(`The Parser constructor no longer accepts a token vector as the first argument.
	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_4-0-0
	For Further details.`)}if((0,vd.default)(e))this.tokensMap=(0,hg.default)(e,function(v,d){return v[d.name]=d,v},{});else if((0,bl.default)(e,"modes")&&(0,fg.default)((0,pd.default)((0,Sl.default)(e.modes)),Tl.isTokenType)){var a=(0,pd.default)((0,Sl.default)(e.modes)),l=(0,qM.default)(a);this.tokensMap=(0,hg.default)(l,function(v,d){return v[d.name]=d,v},{})}else if((0,VM.default)(e))this.tokensMap=(0,cg.default)(e);else throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap.EOF=pg.EOF;var f=(0,bl.default)(e,"modes")?(0,pd.default)((0,Sl.default)(e.modes)):(0,Sl.default)(e),h=(0,fg.default)(f,function(v){return(0,ug.default)(v.categoryMatches)});this.tokenMatcher=h?Tl.tokenStructuredMatcherNoCategories:Tl.tokenStructuredMatcher,(0,Tl.augmentTokenTypes)((0,Sl.default)(this.tokensMap))},r.prototype.defineRule=function(e,n,a){if(this.selfAnalysisDone)throw Error("Grammar rule <".concat(e,`> may not be defined after the 'performSelfAnalysis' method has been called'
`)+"Make sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.");var l=(0,bl.default)(a,"resyncEnabled")?a.resyncEnabled:vg.DEFAULT_RULE_CONFIG.resyncEnabled,f=(0,bl.default)(a,"recoveryValueFunc")?a.recoveryValueFunc:vg.DEFAULT_RULE_CONFIG.recoveryValueFunc,h=this.ruleShortNameIdx<<Qr.BITS_FOR_METHOD_TYPE+Qr.BITS_FOR_OCCURRENCE_IDX;this.ruleShortNameIdx++,this.shortRuleNameToFull[h]=e,this.fullRuleNameToShort[e]=h;var v;this.outputCst===!0?v=function(){for(var S=[],E=0;E<arguments.length;E++)S[E]=arguments[E];try{this.ruleInvocationStateUpdate(h,e,this.subruleIdx),n.apply(this,S);var A=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(A),A}catch(O){return this.invokeRuleCatch(O,l,f)}finally{this.ruleFinallyStateUpdate()}}:v=function(){for(var S=[],E=0;E<arguments.length;E++)S[E]=arguments[E];try{return this.ruleInvocationStateUpdate(h,e,this.subruleIdx),n.apply(this,S)}catch(A){return this.invokeRuleCatch(A,l,f)}finally{this.ruleFinallyStateUpdate()}};var d=Object.assign(v,{ruleName:e,originalGrammarAction:n});return d},r.prototype.invokeRuleCatch=function(e,n,a){var l=this.RULE_STACK.length===1,f=n&&!this.isBackTracking()&&this.recoveryEnabled;if((0,Hf.isRecognitionException)(e)){var h=e;if(f){var v=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(v))if(h.resyncedTokens=this.reSyncTo(v),this.outputCst){var d=this.CST_STACK[this.CST_STACK.length-1];return d.recoveredNode=!0,d}else return a();else{if(this.outputCst){var d=this.CST_STACK[this.CST_STACK.length-1];d.recoveredNode=!0,h.partialCstResult=d}throw h}}else{if(l)return this.moveToTerminatedState(),a();throw h}}else throw e},r.prototype.optionInternal=function(e,n){var a=this.getKeyForAutomaticLookahead(Qr.OPTION_IDX,n);return this.optionInternalLogic(e,n,a)},r.prototype.optionInternalLogic=function(e,n,a){var l=this,f=this.getLaFuncFromCache(a),h;if(typeof e!="function"){h=e.DEF;var v=e.GATE;if(v!==void 0){var d=f;f=function(){return v.call(l)&&d.call(l)}}}else h=e;if(f.call(this)===!0)return h.call(this)},r.prototype.atLeastOneInternal=function(e,n){var a=this.getKeyForAutomaticLookahead(Qr.AT_LEAST_ONE_IDX,e);return this.atLeastOneInternalLogic(e,n,a)},r.prototype.atLeastOneInternalLogic=function(e,n,a){var l=this,f=this.getLaFuncFromCache(a),h;if(typeof n!="function"){h=n.DEF;var v=n.GATE;if(v!==void 0){var d=f;f=function(){return v.call(l)&&d.call(l)}}}else h=n;if(f.call(this)===!0)for(var p=this.doSingleRepetition(h);f.call(this)===!0&&p===!0;)p=this.doSingleRepetition(h);else throw this.raiseEarlyExitException(e,dg.PROD_TYPE.REPETITION_MANDATORY,n.ERR_MSG);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[e,n],f,Qr.AT_LEAST_ONE_IDX,e,qo.NextTerminalAfterAtLeastOneWalker)},r.prototype.atLeastOneSepFirstInternal=function(e,n){var a=this.getKeyForAutomaticLookahead(Qr.AT_LEAST_ONE_SEP_IDX,e);this.atLeastOneSepFirstInternalLogic(e,n,a)},r.prototype.atLeastOneSepFirstInternalLogic=function(e,n,a){var l=this,f=n.DEF,h=n.SEP,v=this.getLaFuncFromCache(a);if(v.call(this)===!0){f.call(this);for(var d=function(){return l.tokenMatcher(l.LA(1),h)};this.tokenMatcher(this.LA(1),h)===!0;)this.CONSUME(h),f.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,h,d,f,qo.NextTerminalAfterAtLeastOneSepWalker],d,Qr.AT_LEAST_ONE_SEP_IDX,e,qo.NextTerminalAfterAtLeastOneSepWalker)}else throw this.raiseEarlyExitException(e,dg.PROD_TYPE.REPETITION_MANDATORY_WITH_SEPARATOR,n.ERR_MSG)},r.prototype.manyInternal=function(e,n){var a=this.getKeyForAutomaticLookahead(Qr.MANY_IDX,e);return this.manyInternalLogic(e,n,a)},r.prototype.manyInternalLogic=function(e,n,a){var l=this,f=this.getLaFuncFromCache(a),h;if(typeof n!="function"){h=n.DEF;var v=n.GATE;if(v!==void 0){var d=f;f=function(){return v.call(l)&&d.call(l)}}}else h=n;for(var p=!0;f.call(this)===!0&&p===!0;)p=this.doSingleRepetition(h);this.attemptInRepetitionRecovery(this.manyInternal,[e,n],f,Qr.MANY_IDX,e,qo.NextTerminalAfterManyWalker,p)},r.prototype.manySepFirstInternal=function(e,n){var a=this.getKeyForAutomaticLookahead(Qr.MANY_SEP_IDX,e);this.manySepFirstInternalLogic(e,n,a)},r.prototype.manySepFirstInternalLogic=function(e,n,a){var l=this,f=n.DEF,h=n.SEP,v=this.getLaFuncFromCache(a);if(v.call(this)===!0){f.call(this);for(var d=function(){return l.tokenMatcher(l.LA(1),h)};this.tokenMatcher(this.LA(1),h)===!0;)this.CONSUME(h),f.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,h,d,f,qo.NextTerminalAfterManySepWalker],d,Qr.MANY_SEP_IDX,e,qo.NextTerminalAfterManySepWalker)}},r.prototype.repetitionSepSecondInternal=function(e,n,a,l,f){for(;a();)this.CONSUME(n),l.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,n,a,l,f],a,Qr.AT_LEAST_ONE_SEP_IDX,e,f)},r.prototype.doSingleRepetition=function(e){var n=this.getLexerPosition();e.call(this);var a=this.getLexerPosition();return a>n},r.prototype.orInternal=function(e,n){var a=this.getKeyForAutomaticLookahead(Qr.OR_IDX,n),l=(0,vd.default)(e)?e:e.DEF,f=this.getLaFuncFromCache(a),h=f.call(this,l);if(h!==void 0){var v=l[h];return v.ALT.call(this)}this.raiseNoAltException(n,e.ERR_MSG)},r.prototype.ruleFinallyStateUpdate=function(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),this.RULE_STACK.length===0&&this.isAtEndOfInput()===!1){var e=this.LA(1),n=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:e,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new Hf.NotAllInputParsedException(n,e))}},r.prototype.subruleInternal=function(e,n,a){var l;try{var f=a!==void 0?a.ARGS:void 0;return this.subruleIdx=n,l=e.apply(this,f),this.cstPostNonTerminal(l,a!==void 0&&a.LABEL!==void 0?a.LABEL:e.ruleName),l}catch(h){throw this.subruleInternalError(h,a,e.ruleName)}},r.prototype.subruleInternalError=function(e,n,a){throw(0,Hf.isRecognitionException)(e)&&e.partialCstResult!==void 0&&(this.cstPostNonTerminal(e.partialCstResult,n!==void 0&&n.LABEL!==void 0?n.LABEL:a),delete e.partialCstResult),e},r.prototype.consumeInternal=function(e,n,a){var l;try{var f=this.LA(1);this.tokenMatcher(f,e)===!0?(this.consumeToken(),l=f):this.consumeInternalError(e,f,a)}catch(h){l=this.consumeInternalRecovery(e,n,h)}return this.cstPostTerminal(a!==void 0&&a.LABEL!==void 0?a.LABEL:e.name,l),l},r.prototype.consumeInternalError=function(e,n,a){var l,f=this.LA(0);throw a!==void 0&&a.ERR_MSG?l=a.ERR_MSG:l=this.errorMessageProvider.buildMismatchTokenMessage({expected:e,actual:n,previous:f,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new Hf.MismatchedTokenException(l,n,f))},r.prototype.consumeInternalRecovery=function(e,n,a){if(this.recoveryEnabled&&a.name==="MismatchedTokenException"&&!this.isBackTracking()){var l=this.getFollowsForInRuleRecovery(e,n);try{return this.tryInRuleRecovery(e,l)}catch(f){throw f.name===ZM.IN_RULE_RECOVERY_EXCEPTION?a:f}}else throw a},r.prototype.saveRecogState=function(){var e=this.errors,n=(0,cg.default)(this.RULE_STACK);return{errors:e,lexerState:this.exportLexerState(),RULE_STACK:n,CST_STACK:this.CST_STACK}},r.prototype.reloadRecogState=function(e){this.errors=e.errors,this.importLexerState(e.lexerState),this.RULE_STACK=e.RULE_STACK},r.prototype.ruleInvocationStateUpdate=function(e,n,a){this.RULE_OCCURRENCE_STACK.push(a),this.RULE_STACK.push(e),this.cstInvocationStateUpdate(n)},r.prototype.isBackTracking=function(){return this.isBackTrackingStack.length!==0},r.prototype.getCurrRuleFullName=function(){var e=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[e]},r.prototype.shortRuleNameToFullName=function(e){return this.shortRuleNameToFull[e]},r.prototype.isAtEndOfInput=function(){return this.tokenMatcher(this.LA(1),pg.EOF)},r.prototype.reset=function(){this.resetLexerState(),this.subruleIdx=0,this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]},r}();jh.RecognizerEngine=QM;var Yh={},Dy=_e&&_e.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Yh,"__esModule",{value:!0});Yh.ErrorHandler=void 0;var gd=xr,JM=Dy(gn),gg=Dy(fa),yg=lu,e5=tn,t5=function(){function r(){}return r.prototype.initErrorHandler=function(e){this._errors=[],this.errorMessageProvider=(0,JM.default)(e,"errorMessageProvider")?e.errorMessageProvider:e5.DEFAULT_PARSER_CONFIG.errorMessageProvider},r.prototype.SAVE_ERROR=function(e){if((0,gd.isRecognitionException)(e))return e.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:(0,gg.default)(this.RULE_OCCURRENCE_STACK)},this._errors.push(e),e;throw Error("Trying to save an Error which is not a RecognitionException")},Object.defineProperty(r.prototype,"errors",{get:function(){return(0,gg.default)(this._errors)},set:function(e){this._errors=e},enumerable:!1,configurable:!0}),r.prototype.raiseEarlyExitException=function(e,n,a){for(var l=this.getCurrRuleFullName(),f=this.getGAstProductions()[l],h=(0,yg.getLookaheadPathsForOptionalProd)(e,f,n,this.maxLookahead),v=h[0],d=[],p=1;p<=this.maxLookahead;p++)d.push(this.LA(p));var S=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:v,actual:d,previous:this.LA(0),customUserDescription:a,ruleName:l});throw this.SAVE_ERROR(new gd.EarlyExitException(S,this.LA(1),this.LA(0)))},r.prototype.raiseNoAltException=function(e,n){for(var a=this.getCurrRuleFullName(),l=this.getGAstProductions()[a],f=(0,yg.getLookaheadPathsForOr)(e,l,this.maxLookahead),h=[],v=1;v<=this.maxLookahead;v++)h.push(this.LA(v));var d=this.LA(0),p=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:f,actual:h,previous:d,customUserDescription:n,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new gd.NoViableAltException(p,this.LA(1),d))},r}();Yh.ErrorHandler=t5;var Xh={},Fy=_e&&_e.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Xh,"__esModule",{value:!0});Xh.ContentAssist=void 0;var mg=zt,r5=Fy(au),n5=Fy(ys),i5=function(){function r(){}return r.prototype.initContentAssist=function(){},r.prototype.computeContentAssist=function(e,n){var a=this.gastProductionsCache[e];if((0,n5.default)(a))throw Error("Rule ->".concat(e,"<- does not exist in this grammar."));return(0,mg.nextPossibleTokensAfter)([a],n,this.tokenMatcher,this.maxLookahead)},r.prototype.getNextPossibleTokenTypes=function(e){var n=(0,r5.default)(e.ruleStack),a=this.getGAstProductions(),l=a[n],f=new mg.NextAfterTokenWalker(l,e).startWalking();return f},r}();Xh.ContentAssist=i5;var Kh={},ms=_e&&_e.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Kh,"__esModule",{value:!0});Kh.GastRecorder=void 0;var dh=ms(kv),a5=ms(kt),o5=ms(pv),s5=ms(Rr),$y=ms(Kl),$l=ms(gn),Jn=nr,l5=iu,Gy=Ja,Wy=Za,u5=tn,f5=Gh,qh={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(qh);var _g=!0,bg=Math.pow(2,f5.BITS_FOR_OCCURRENCE_IDX)-1,By=(0,Wy.createToken)({name:"RECORDING_PHASE_TOKEN",pattern:l5.Lexer.NA});(0,Gy.augmentTokenTypes)([By]);var Uy=(0,Wy.createTokenInstance)(By,`This IToken indicates the Parser is in Recording Phase
	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details`,-1,-1,-1,-1,-1,-1);Object.freeze(Uy);var h5={name:`This CSTNode indicates the Parser is in Recording Phase
	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details`,children:{}},c5=function(){function r(){}return r.prototype.initGastRecorder=function(e){this.recordingProdStack=[],this.RECORDING_PHASE=!1},r.prototype.enableRecording=function(){var e=this;this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",function(){for(var n=function(l){var f=l>0?l:"";e["CONSUME".concat(f)]=function(h,v){return this.consumeInternalRecord(h,l,v)},e["SUBRULE".concat(f)]=function(h,v){return this.subruleInternalRecord(h,l,v)},e["OPTION".concat(f)]=function(h){return this.optionInternalRecord(h,l)},e["OR".concat(f)]=function(h){return this.orInternalRecord(h,l)},e["MANY".concat(f)]=function(h){this.manyInternalRecord(l,h)},e["MANY_SEP".concat(f)]=function(h){this.manySepFirstInternalRecord(l,h)},e["AT_LEAST_ONE".concat(f)]=function(h){this.atLeastOneInternalRecord(l,h)},e["AT_LEAST_ONE_SEP".concat(f)]=function(h){this.atLeastOneSepFirstInternalRecord(l,h)}},a=0;a<10;a++)n(a);e.consume=function(l,f,h){return this.consumeInternalRecord(f,l,h)},e.subrule=function(l,f,h){return this.subruleInternalRecord(f,l,h)},e.option=function(l,f){return this.optionInternalRecord(f,l)},e.or=function(l,f){return this.orInternalRecord(f,l)},e.many=function(l,f){this.manyInternalRecord(l,f)},e.atLeastOne=function(l,f){this.atLeastOneInternalRecord(l,f)},e.ACTION=e.ACTION_RECORD,e.BACKTRACK=e.BACKTRACK_RECORD,e.LA=e.LA_RECORD})},r.prototype.disableRecording=function(){var e=this;this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",function(){for(var n=e,a=0;a<10;a++){var l=a>0?a:"";delete n["CONSUME".concat(l)],delete n["SUBRULE".concat(l)],delete n["OPTION".concat(l)],delete n["OR".concat(l)],delete n["MANY".concat(l)],delete n["MANY_SEP".concat(l)],delete n["AT_LEAST_ONE".concat(l)],delete n["AT_LEAST_ONE_SEP".concat(l)]}delete n.consume,delete n.subrule,delete n.option,delete n.or,delete n.many,delete n.atLeastOne,delete n.ACTION,delete n.BACKTRACK,delete n.LA})},r.prototype.ACTION_RECORD=function(e){},r.prototype.BACKTRACK_RECORD=function(e,n){return function(){return!0}},r.prototype.LA_RECORD=function(e){return u5.END_OF_FILE},r.prototype.topLevelRuleRecord=function(e,n){try{var a=new Jn.Rule({definition:[],name:e});return a.name=e,this.recordingProdStack.push(a),n.call(this),this.recordingProdStack.pop(),a}catch(l){if(l.KNOWN_RECORDER_ERROR!==!0)try{l.message=l.message+`
	 This error was thrown during the "grammar recording phase" For more info see:
	https://chevrotain.io/docs/guide/internals.html#grammar-recording`}catch{throw l}throw l}},r.prototype.optionInternalRecord=function(e,n){return Cl.call(this,Jn.Option,e,n)},r.prototype.atLeastOneInternalRecord=function(e,n){Cl.call(this,Jn.RepetitionMandatory,n,e)},r.prototype.atLeastOneSepFirstInternalRecord=function(e,n){Cl.call(this,Jn.RepetitionMandatoryWithSeparator,n,e,_g)},r.prototype.manyInternalRecord=function(e,n){Cl.call(this,Jn.Repetition,n,e)},r.prototype.manySepFirstInternalRecord=function(e,n){Cl.call(this,Jn.RepetitionWithSeparator,n,e,_g)},r.prototype.orInternalRecord=function(e,n){return d5.call(this,e,n)},r.prototype.subruleInternalRecord=function(e,n,a){if(vh(n),!e||(0,$l.default)(e,"ruleName")===!1){var l=new Error("<SUBRULE".concat(Sg(n),"> argument is invalid")+" expecting a Parser method reference but got: <".concat(JSON.stringify(e),">")+`
 inside top level rule: <`.concat(this.recordingProdStack[0].name,">"));throw l.KNOWN_RECORDER_ERROR=!0,l}var f=(0,dh.default)(this.recordingProdStack),h=e.ruleName,v=new Jn.NonTerminal({idx:n,nonTerminalName:h,label:a==null?void 0:a.LABEL,referencedRule:void 0});return f.definition.push(v),this.outputCst?h5:qh},r.prototype.consumeInternalRecord=function(e,n,a){if(vh(n),!(0,Gy.hasShortKeyProperty)(e)){var l=new Error("<CONSUME".concat(Sg(n),"> argument is invalid")+" expecting a TokenType reference but got: <".concat(JSON.stringify(e),">")+`
 inside top level rule: <`.concat(this.recordingProdStack[0].name,">"));throw l.KNOWN_RECORDER_ERROR=!0,l}var f=(0,dh.default)(this.recordingProdStack),h=new Jn.Terminal({idx:n,terminalType:e,label:a==null?void 0:a.LABEL});return f.definition.push(h),Uy},r}();Kh.GastRecorder=c5;function Cl(r,e,n,a){a===void 0&&(a=!1),vh(n);var l=(0,dh.default)(this.recordingProdStack),f=(0,$y.default)(e)?e:e.DEF,h=new r({definition:[],idx:n});return a&&(h.separator=e.SEP),(0,$l.default)(e,"MAX_LOOKAHEAD")&&(h.maxLookahead=e.MAX_LOOKAHEAD),this.recordingProdStack.push(h),f.call(this),l.definition.push(h),this.recordingProdStack.pop(),qh}function d5(r,e){var n=this;vh(e);var a=(0,dh.default)(this.recordingProdStack),l=(0,a5.default)(r)===!1,f=l===!1?r:r.DEF,h=new Jn.Alternation({definition:[],idx:e,ignoreAmbiguities:l&&r.IGNORE_AMBIGUITIES===!0});(0,$l.default)(r,"MAX_LOOKAHEAD")&&(h.maxLookahead=r.MAX_LOOKAHEAD);var v=(0,o5.default)(f,function(d){return(0,$y.default)(d.GATE)});return h.hasPredicates=v,a.definition.push(h),(0,s5.default)(f,function(d){var p=new Jn.Alternative({definition:[]});h.definition.push(p),(0,$l.default)(d,"IGNORE_AMBIGUITIES")?p.ignoreAmbiguities=d.IGNORE_AMBIGUITIES:(0,$l.default)(d,"GATE")&&(p.ignoreAmbiguities=!0),n.recordingProdStack.push(p),d.ALT.call(n),n.recordingProdStack.pop()}),qh}function Sg(r){return r===0?"":"".concat(r)}function vh(r){if(r<0||r>bg){var e=new Error("Invalid DSL Method idx value: <".concat(r,`>
	`)+"Idx value must be a none negative value smaller than ".concat(bg+1));throw e.KNOWN_RECORDER_ERROR=!0,e}}var Vh={},v5=_e&&_e.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Vh,"__esModule",{value:!0});Vh.PerformanceTracer=void 0;var p5=v5(gn),g5=vs,y5=tn,m5=function(){function r(){}return r.prototype.initPerformanceTracer=function(e){if((0,p5.default)(e,"traceInitPerf")){var n=e.traceInitPerf,a=typeof n=="number";this.traceInitMaxIdent=a?n:1/0,this.traceInitPerf=a?n>0:n}else this.traceInitMaxIdent=0,this.traceInitPerf=y5.DEFAULT_PARSER_CONFIG.traceInitPerf;this.traceInitIndent=-1},r.prototype.TRACE_INIT=function(e,n){if(this.traceInitPerf===!0){this.traceInitIndent++;var a=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log("".concat(a,"--> <").concat(e,">"));var l=(0,g5.timer)(n),f=l.time,h=l.value,v=f>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&v("".concat(a,"<-- <").concat(e,"> time: ").concat(f,"ms")),this.traceInitIndent--,h}else return n()},r}();Vh.PerformanceTracer=m5;var Zh={};Object.defineProperty(Zh,"__esModule",{value:!0});Zh.applyMixins=void 0;function _5(r,e){e.forEach(function(n){var a=n.prototype;Object.getOwnPropertyNames(a).forEach(function(l){if(l!=="constructor"){var f=Object.getOwnPropertyDescriptor(a,l);f&&(f.get||f.set)?Object.defineProperty(r.prototype,l,f):r.prototype[l]=n.prototype[l]}})})}Zh.applyMixins=_5;(function(r){var e=_e&&_e.__extends||function(){var Q=function(q,Ce){return Q=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(K,ne){K.__proto__=ne}||function(K,ne){for(var te in ne)Object.prototype.hasOwnProperty.call(ne,te)&&(K[te]=ne[te])},Q(q,Ce)};return function(q,Ce){if(typeof Ce!="function"&&Ce!==null)throw new TypeError("Class extends value "+String(Ce)+" is not a constructor or null");Q(q,Ce);function K(){this.constructor=q}q.prototype=Ce===null?Object.create(Ce):(K.prototype=Ce.prototype,new K)}}(),n=_e&&_e.__importDefault||function(Q){return Q&&Q.__esModule?Q:{default:Q}};Object.defineProperty(r,"__esModule",{value:!0}),r.EmbeddedActionsParser=r.CstParser=r.Parser=r.EMPTY_ALT=r.ParserDefinitionErrorType=r.DEFAULT_RULE_CONFIG=r.DEFAULT_PARSER_CONFIG=r.END_OF_FILE=void 0;var a=n(si),l=n(Kr),f=n(Rr),h=n(Ii),v=n(gn),d=n(fa),p=vs,S=ei,E=Za,A=su,O=ns,k=Dv,T=os,x=Wh,G=Hh,j=zh,B=jh,U=Yh,J=Xh,P=Kh,I=Vh,D=Zh;r.END_OF_FILE=(0,E.createTokenInstance)(E.EOF,"",NaN,NaN,NaN,NaN,NaN,NaN),Object.freeze(r.END_OF_FILE),r.DEFAULT_PARSER_CONFIG=Object.freeze({recoveryEnabled:!1,maxLookahead:3,dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:A.defaultParserErrorProvider,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),r.DEFAULT_RULE_CONFIG=Object.freeze({recoveryValueFunc:function(){},resyncEnabled:!0}),function(Q){Q[Q.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",Q[Q.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",Q[Q.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",Q[Q.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",Q[Q.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",Q[Q.LEFT_RECURSION=5]="LEFT_RECURSION",Q[Q.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",Q[Q.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",Q[Q.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",Q[Q.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",Q[Q.NO_NON_EMPTY_LOOKAHEAD=10]="NO_NON_EMPTY_LOOKAHEAD",Q[Q.AMBIGUOUS_PREFIX_ALTS=11]="AMBIGUOUS_PREFIX_ALTS",Q[Q.TOO_MANY_ALTS=12]="TOO_MANY_ALTS"}(r.ParserDefinitionErrorType||(r.ParserDefinitionErrorType={}));function R(Q){return Q===void 0&&(Q=void 0),function(){return Q}}r.EMPTY_ALT=R;var Y=function(){function Q(q,Ce){this.definitionErrors=[],this.selfAnalysisDone=!1;var K=this;if(K.initErrorHandler(Ce),K.initLexerAdapter(),K.initLooksAhead(Ce),K.initRecognizerEngine(q,Ce),K.initRecoverable(Ce),K.initTreeBuilder(Ce),K.initContentAssist(),K.initGastRecorder(Ce),K.initPerformanceTracer(Ce),(0,v.default)(Ce,"ignoredIssues"))throw new Error(`The <ignoredIssues> IParserConfig property has been deprecated.
	Please use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.
	See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#IGNORING_AMBIGUITIES
	For further details.`);this.skipValidations=(0,v.default)(Ce,"skipValidations")?Ce.skipValidations:r.DEFAULT_PARSER_CONFIG.skipValidations}return Q.performSelfAnalysis=function(q){throw Error("The **static** `performSelfAnalysis` method has been deprecated.	\nUse the **instance** method with the same name instead.")},Q.prototype.performSelfAnalysis=function(){var q=this;this.TRACE_INIT("performSelfAnalysis",function(){var Ce;q.selfAnalysisDone=!0;var K=q.className;q.TRACE_INIT("toFastProps",function(){(0,p.toFastProperties)(q)}),q.TRACE_INIT("Grammar Recording",function(){try{q.enableRecording(),(0,f.default)(q.definedRulesNames,function(te){var pe=q[te],le=pe.originalGrammarAction,Ee;q.TRACE_INIT("".concat(te," Rule"),function(){Ee=q.topLevelRuleRecord(te,le)}),q.gastProductionsCache[te]=Ee})}finally{q.disableRecording()}});var ne=[];if(q.TRACE_INIT("Grammar Resolving",function(){ne=(0,O.resolveGrammar)({rules:(0,h.default)(q.gastProductionsCache)}),q.definitionErrors=q.definitionErrors.concat(ne)}),q.TRACE_INIT("Grammar Validations",function(){if((0,a.default)(ne)&&q.skipValidations===!1){var te=(0,O.validateGrammar)({rules:(0,h.default)(q.gastProductionsCache),maxLookahead:q.maxLookahead,tokenTypes:(0,h.default)(q.tokensMap),errMsgProvider:A.defaultGrammarValidatorErrorProvider,grammarName:K});q.definitionErrors=q.definitionErrors.concat(te)}}),(0,a.default)(q.definitionErrors)&&(q.recoveryEnabled&&q.TRACE_INIT("computeAllProdsFollows",function(){var te=(0,S.computeAllProdsFollows)((0,h.default)(q.gastProductionsCache));q.resyncFollows=te}),q.TRACE_INIT("ComputeLookaheadFunctions",function(){q.preComputeLookaheadFunctions((0,h.default)(q.gastProductionsCache))})),!Q.DEFER_DEFINITION_ERRORS_HANDLING&&!(0,a.default)(q.definitionErrors))throw Ce=(0,l.default)(q.definitionErrors,function(te){return te.message}),new Error(`Parser Definition Errors detected:
 `.concat(Ce.join(`
-------------------------------
`)))})},Q.DEFER_DEFINITION_ERRORS_HANDLING=!1,Q}();r.Parser=Y,(0,D.applyMixins)(Y,[k.Recoverable,T.LooksAhead,x.TreeBuilder,G.LexerAdapter,B.RecognizerEngine,j.RecognizerApi,U.ErrorHandler,J.ContentAssist,P.GastRecorder,I.PerformanceTracer]);var re=function(Q){e(q,Q);function q(Ce,K){K===void 0&&(K=r.DEFAULT_PARSER_CONFIG);var ne=(0,d.default)(K);return ne.outputCst=!0,Q.call(this,Ce,ne)||this}return q}(Y);r.CstParser=re;var se=function(Q){e(q,Q);function q(Ce,K){K===void 0&&(K=r.DEFAULT_PARSER_CONFIG);var ne=(0,d.default)(K);return ne.outputCst=!1,Q.call(this,Ce,ne)||this}return q}(Y);r.EmbeddedActionsParser=se})(tn);var Qh={},Jh={},b5=_e&&_e.__extends||function(){var r=function(e,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,l){a.__proto__=l}||function(a,l){for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(a[f]=l[f])},r(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");r(e,n);function a(){this.constructor=e}e.prototype=n===null?Object.create(n):(a.prototype=n.prototype,new a)}}(),_s=_e&&_e.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Jh,"__esModule",{value:!0});Jh.buildModel=void 0;var Hy=nr,Rl=_s(Kr),S5=_s(Di),T5=_s(Ii),C5=_s(pv),E5=_s(ly),A5=_s(Ph);function w5(r){var e=new k5,n=(0,T5.default)(r);return(0,Rl.default)(n,function(a){return e.visitRule(a)})}Jh.buildModel=w5;var k5=function(r){b5(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.visitRule=function(n){var a=this.visitEach(n.definition),l=(0,E5.default)(a,function(h){return h.propertyName}),f=(0,Rl.default)(l,function(h,v){var d=!(0,C5.default)(h,function(S){return!S.canBeNull}),p=h[0].type;return h.length>1&&(p=(0,Rl.default)(h,function(S){return S.type})),{name:v,type:p,optional:d}});return{name:n.name,properties:f}},e.prototype.visitAlternative=function(n){return this.visitEachAndOverrideWith(n.definition,{canBeNull:!0})},e.prototype.visitOption=function(n){return this.visitEachAndOverrideWith(n.definition,{canBeNull:!0})},e.prototype.visitRepetition=function(n){return this.visitEachAndOverrideWith(n.definition,{canBeNull:!0})},e.prototype.visitRepetitionMandatory=function(n){return this.visitEach(n.definition)},e.prototype.visitRepetitionMandatoryWithSeparator=function(n){return this.visitEach(n.definition).concat({propertyName:n.separator.name,canBeNull:!0,type:zf(n.separator)})},e.prototype.visitRepetitionWithSeparator=function(n){return this.visitEachAndOverrideWith(n.definition,{canBeNull:!0}).concat({propertyName:n.separator.name,canBeNull:!0,type:zf(n.separator)})},e.prototype.visitAlternation=function(n){return this.visitEachAndOverrideWith(n.definition,{canBeNull:!0})},e.prototype.visitTerminal=function(n){return[{propertyName:n.label||n.terminalType.name,canBeNull:!1,type:zf(n)}]},e.prototype.visitNonTerminal=function(n){return[{propertyName:n.label||n.nonTerminalName,canBeNull:!1,type:zf(n)}]},e.prototype.visitEachAndOverrideWith=function(n,a){return(0,Rl.default)(this.visitEach(n),function(l){return(0,A5.default)({},l,a)})},e.prototype.visitEach=function(n){var a=this;return(0,S5.default)((0,Rl.default)(n,function(l){return a.visit(l)}))},e}(Hy.GAstVisitor);function zf(r){return r instanceof Hy.NonTerminal?{kind:"rule",name:r.referencedRule.name}:{kind:"token"}}var ec={},O5=cv;function x5(r,e,n){var a=r.length;return n=n===void 0?a:n,!e&&n>=a?r:O5(r,e,n)}var R5=x5,P5="\\ud800-\\udfff",L5="\\u0300-\\u036f",I5="\\ufe20-\\ufe2f",N5="\\u20d0-\\u20ff",M5=L5+I5+N5,D5="\\ufe0e\\ufe0f",F5="\\u200d",$5=RegExp("["+F5+P5+M5+D5+"]");function G5(r){return $5.test(r)}var zy=G5;function W5(r){return r.split("")}var B5=W5,jy="\\ud800-\\udfff",U5="\\u0300-\\u036f",H5="\\ufe20-\\ufe2f",z5="\\u20d0-\\u20ff",j5=U5+H5+z5,Y5="\\ufe0e\\ufe0f",X5="["+jy+"]",$d="["+j5+"]",Gd="\\ud83c[\\udffb-\\udfff]",K5="(?:"+$d+"|"+Gd+")",Yy="[^"+jy+"]",Xy="(?:\\ud83c[\\udde6-\\uddff]){2}",Ky="[\\ud800-\\udbff][\\udc00-\\udfff]",q5="\\u200d",qy=K5+"?",Vy="["+Y5+"]?",V5="(?:"+q5+"(?:"+[Yy,Xy,Ky].join("|")+")"+Vy+qy+")*",Z5=Vy+qy+V5,Q5="(?:"+[Yy+$d+"?",$d,Xy,Ky,X5].join("|")+")",J5=RegExp(Gd+"(?="+Gd+")|"+Q5+Z5,"g");function eD(r){return r.match(J5)||[]}var tD=eD,rD=B5,nD=zy,iD=tD;function aD(r){return nD(r)?iD(r):rD(r)}var oD=aD,sD=R5,lD=zy,uD=oD,fD=S0;function hD(r){return function(e){e=fD(e);var n=lD(e)?uD(e):void 0,a=n?n[0]:e.charAt(0),l=n?sD(n,1).join(""):e.slice(1);return a[r]()+l}}var cD=hD,dD=cD,vD=dD("toUpperCase"),pD=vD,bs=_e&&_e.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(ec,"__esModule",{value:!0});ec.genDts=void 0;var gD=bs(Di),yD=bs(kt),tc=bs(Kr),mD=bs(Qa),_D=bs(bv),Zy=bs(pD);function bD(r,e){var n=[];return n=n.concat('import type { CstNode, ICstVisitor, IToken } from "chevrotain";'),n=n.concat((0,gD.default)((0,tc.default)(r,function(a){return SD(a)}))),e.includeVisitorInterface&&(n=n.concat(AD(e.visitorInterfaceName,r))),n.join(`

`)+`
`}ec.genDts=bD;function SD(r){var e=TD(r),n=CD(r);return[e,n]}function TD(r){var e=Qy(r.name),n=Fv(r.name);return"export interface ".concat(e,` extends CstNode {
  name: "`).concat(r.name,`";
  children: `).concat(n,`;
}`)}function CD(r){var e=Fv(r.name);return"export type ".concat(e,` = {
  `).concat((0,tc.default)(r.properties,function(n){return ED(n)}).join(`
  `),`
};`)}function ED(r){var e=kD(r.type);return"".concat(r.name).concat(r.optional?"?":"",": ").concat(e,"[];")}function AD(r,e){return"export interface ".concat(r,`<IN, OUT> extends ICstVisitor<IN, OUT> {
  `).concat((0,tc.default)(e,function(n){return wD(n)}).join(`
  `),`
}`)}function wD(r){var e=Fv(r.name);return"".concat(r.name,"(children: ").concat(e,", param?: IN): OUT;")}function kD(r){if((0,yD.default)(r)){var e=(0,_D.default)((0,tc.default)(r,function(a){return Tg(a)})),n=(0,mD.default)(e,function(a,l){return a+" | "+l});return"("+n+")"}else return Tg(r)}function Tg(r){return r.kind==="token"?"IToken":Qy(r.name)}function Qy(r){return(0,Zy.default)(r)+"CstNode"}function Fv(r){return(0,Zy.default)(r)+"CstChildren"}var ph=_e&&_e.__assign||function(){return ph=Object.assign||function(r){for(var e,n=1,a=arguments.length;n<a;n++){e=arguments[n];for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&(r[l]=e[l])}return r},ph.apply(this,arguments)};Object.defineProperty(Qh,"__esModule",{value:!0});Qh.generateCstDts=void 0;var OD=Jh,xD=ec,RD={includeVisitorInterface:!0,visitorInterfaceName:"ICstNodeVisitor"};function PD(r,e){var n=ph(ph({},RD),e),a=(0,OD.buildModel)(r);return(0,xD.genDts)(a,n)}Qh.generateCstDts=PD;var rc={};Object.defineProperty(rc,"__esModule",{value:!0});rc.createSyntaxDiagramsCode=void 0;var Cg=Yl;function LD(r,e){var n=e===void 0?{}:e,a=n.resourceBase,l=a===void 0?"https://unpkg.com/chevrotain@".concat(Cg.VERSION,"/diagrams/"):a,f=n.css,h=f===void 0?"https://unpkg.com/chevrotain@".concat(Cg.VERSION,"/diagrams/diagrams.css"):f,v=`
<!-- This is a generated file -->
<!DOCTYPE html>
<meta charset="utf-8">
<style>
  body {
    background-color: hsl(30, 20%, 95%)
  }
</style>

`,d=`
<link rel='stylesheet' href='`.concat(h,`'>
`),p=`
<script src='`.concat(l,`vendor/railroad-diagrams.js'><\/script>
<script src='`).concat(l,`src/diagrams_builder.js'><\/script>
<script src='`).concat(l,`src/diagrams_behavior.js'><\/script>
<script src='`).concat(l,`src/main.js'><\/script>
`),S=`
<div id="diagrams" align="center"></div>    
`,E=`
<script>
    window.serializedGrammar = `.concat(JSON.stringify(r,null,"  "),`;
<\/script>
`),A=`
<script>
    var diagramsDiv = document.getElementById("diagrams");
    main.drawDiagramsFromSerializedGrammar(serializedGrammar, diagramsDiv);
<\/script>
`;return v+d+p+S+E+A}rc.createSyntaxDiagramsCode=LD;(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Parser=r.createSyntaxDiagramsCode=r.clearCache=r.generateCstDts=r.GAstVisitor=r.serializeProduction=r.serializeGrammar=r.Terminal=r.Rule=r.RepetitionWithSeparator=r.RepetitionMandatoryWithSeparator=r.RepetitionMandatory=r.Repetition=r.Option=r.NonTerminal=r.Alternative=r.Alternation=r.defaultLexerErrorProvider=r.NoViableAltException=r.NotAllInputParsedException=r.MismatchedTokenException=r.isRecognitionException=r.EarlyExitException=r.defaultParserErrorProvider=r.tokenName=r.tokenMatcher=r.tokenLabel=r.EOF=r.createTokenInstance=r.createToken=r.LexerDefinitionErrorType=r.Lexer=r.EMPTY_ALT=r.ParserDefinitionErrorType=r.EmbeddedActionsParser=r.CstParser=r.VERSION=void 0;var e=Yl;Object.defineProperty(r,"VERSION",{enumerable:!0,get:function(){return e.VERSION}});var n=tn;Object.defineProperty(r,"CstParser",{enumerable:!0,get:function(){return n.CstParser}}),Object.defineProperty(r,"EmbeddedActionsParser",{enumerable:!0,get:function(){return n.EmbeddedActionsParser}}),Object.defineProperty(r,"ParserDefinitionErrorType",{enumerable:!0,get:function(){return n.ParserDefinitionErrorType}}),Object.defineProperty(r,"EMPTY_ALT",{enumerable:!0,get:function(){return n.EMPTY_ALT}});var a=iu;Object.defineProperty(r,"Lexer",{enumerable:!0,get:function(){return a.Lexer}}),Object.defineProperty(r,"LexerDefinitionErrorType",{enumerable:!0,get:function(){return a.LexerDefinitionErrorType}});var l=Za;Object.defineProperty(r,"createToken",{enumerable:!0,get:function(){return l.createToken}}),Object.defineProperty(r,"createTokenInstance",{enumerable:!0,get:function(){return l.createTokenInstance}}),Object.defineProperty(r,"EOF",{enumerable:!0,get:function(){return l.EOF}}),Object.defineProperty(r,"tokenLabel",{enumerable:!0,get:function(){return l.tokenLabel}}),Object.defineProperty(r,"tokenMatcher",{enumerable:!0,get:function(){return l.tokenMatcher}}),Object.defineProperty(r,"tokenName",{enumerable:!0,get:function(){return l.tokenName}});var f=su;Object.defineProperty(r,"defaultParserErrorProvider",{enumerable:!0,get:function(){return f.defaultParserErrorProvider}});var h=xr;Object.defineProperty(r,"EarlyExitException",{enumerable:!0,get:function(){return h.EarlyExitException}}),Object.defineProperty(r,"isRecognitionException",{enumerable:!0,get:function(){return h.isRecognitionException}}),Object.defineProperty(r,"MismatchedTokenException",{enumerable:!0,get:function(){return h.MismatchedTokenException}}),Object.defineProperty(r,"NotAllInputParsedException",{enumerable:!0,get:function(){return h.NotAllInputParsedException}}),Object.defineProperty(r,"NoViableAltException",{enumerable:!0,get:function(){return h.NoViableAltException}});var v=ou;Object.defineProperty(r,"defaultLexerErrorProvider",{enumerable:!0,get:function(){return v.defaultLexerErrorProvider}});var d=nr;Object.defineProperty(r,"Alternation",{enumerable:!0,get:function(){return d.Alternation}}),Object.defineProperty(r,"Alternative",{enumerable:!0,get:function(){return d.Alternative}}),Object.defineProperty(r,"NonTerminal",{enumerable:!0,get:function(){return d.NonTerminal}}),Object.defineProperty(r,"Option",{enumerable:!0,get:function(){return d.Option}}),Object.defineProperty(r,"Repetition",{enumerable:!0,get:function(){return d.Repetition}}),Object.defineProperty(r,"RepetitionMandatory",{enumerable:!0,get:function(){return d.RepetitionMandatory}}),Object.defineProperty(r,"RepetitionMandatoryWithSeparator",{enumerable:!0,get:function(){return d.RepetitionMandatoryWithSeparator}}),Object.defineProperty(r,"RepetitionWithSeparator",{enumerable:!0,get:function(){return d.RepetitionWithSeparator}}),Object.defineProperty(r,"Rule",{enumerable:!0,get:function(){return d.Rule}}),Object.defineProperty(r,"Terminal",{enumerable:!0,get:function(){return d.Terminal}});var p=nr;Object.defineProperty(r,"serializeGrammar",{enumerable:!0,get:function(){return p.serializeGrammar}}),Object.defineProperty(r,"serializeProduction",{enumerable:!0,get:function(){return p.serializeProduction}}),Object.defineProperty(r,"GAstVisitor",{enumerable:!0,get:function(){return p.GAstVisitor}});var S=Qh;Object.defineProperty(r,"generateCstDts",{enumerable:!0,get:function(){return S.generateCstDts}});function E(){console.warn(`The clearCache function was 'soft' removed from the Chevrotain API.
	 It performs no action other than printing this message.
	 Please avoid using it as it will be completely removed in the future`)}r.clearCache=E;var A=rc;Object.defineProperty(r,"createSyntaxDiagramsCode",{enumerable:!0,get:function(){return A.createSyntaxDiagramsCode}});var O=function(){function k(){throw new Error(`The Parser class has been deprecated, use CstParser or EmbeddedActionsParser instead.	
See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_7-0-0`)}return k}();r.Parser=O})(l_);var ID=Math.PI/180;function ND(){return typeof window!="undefined"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}const Qo=typeof global!="undefined"?global:typeof window!="undefined"?window:typeof WorkerGlobalScope!="undefined"?self:{},De={_global:Qo,version:"8.3.4",isBrowser:ND(),isUnminified:/param/.test(function(r){}.toString()),dblClickWindow:400,getAngle(r){return De.angleDeg?r*ID:r},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,pixelRatio:typeof window!="undefined"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return De.DD.isDragging},isDragReady(){return!!De.DD.node},document:Qo.document,_injectGlobal(r){Qo.Konva=r}},Yt=r=>{De[r.prototype.getClassName()]=r};De._injectGlobal(De);class Jr{constructor(e=[1,0,0,1,0,0]){this.dirty=!1,this.m=e&&e.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new Jr(this.m)}copyInto(e){e.m[0]=this.m[0],e.m[1]=this.m[1],e.m[2]=this.m[2],e.m[3]=this.m[3],e.m[4]=this.m[4],e.m[5]=this.m[5]}point(e){var n=this.m;return{x:n[0]*e.x+n[2]*e.y+n[4],y:n[1]*e.x+n[3]*e.y+n[5]}}translate(e,n){return this.m[4]+=this.m[0]*e+this.m[2]*n,this.m[5]+=this.m[1]*e+this.m[3]*n,this}scale(e,n){return this.m[0]*=e,this.m[1]*=e,this.m[2]*=n,this.m[3]*=n,this}rotate(e){var n=Math.cos(e),a=Math.sin(e),l=this.m[0]*n+this.m[2]*a,f=this.m[1]*n+this.m[3]*a,h=this.m[0]*-a+this.m[2]*n,v=this.m[1]*-a+this.m[3]*n;return this.m[0]=l,this.m[1]=f,this.m[2]=h,this.m[3]=v,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(e,n){var a=this.m[0]+this.m[2]*n,l=this.m[1]+this.m[3]*n,f=this.m[2]+this.m[0]*e,h=this.m[3]+this.m[1]*e;return this.m[0]=a,this.m[1]=l,this.m[2]=f,this.m[3]=h,this}multiply(e){var n=this.m[0]*e.m[0]+this.m[2]*e.m[1],a=this.m[1]*e.m[0]+this.m[3]*e.m[1],l=this.m[0]*e.m[2]+this.m[2]*e.m[3],f=this.m[1]*e.m[2]+this.m[3]*e.m[3],h=this.m[0]*e.m[4]+this.m[2]*e.m[5]+this.m[4],v=this.m[1]*e.m[4]+this.m[3]*e.m[5]+this.m[5];return this.m[0]=n,this.m[1]=a,this.m[2]=l,this.m[3]=f,this.m[4]=h,this.m[5]=v,this}invert(){var e=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),n=this.m[3]*e,a=-this.m[1]*e,l=-this.m[2]*e,f=this.m[0]*e,h=e*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),v=e*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=n,this.m[1]=a,this.m[2]=l,this.m[3]=f,this.m[4]=h,this.m[5]=v,this}getMatrix(){return this.m}setAbsolutePosition(e,n){var a=this.m[0],l=this.m[1],f=this.m[2],h=this.m[3],v=this.m[4],d=this.m[5],p=(a*(n-d)-l*(e-v))/(a*h-l*f),S=(e-v-f*p)/a;return this.translate(S,p)}decompose(){var e=this.m[0],n=this.m[1],a=this.m[2],l=this.m[3],f=this.m[4],h=this.m[5],v=e*l-n*a;let d={x:f,y:h,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(e!=0||n!=0){var p=Math.sqrt(e*e+n*n);d.rotation=n>0?Math.acos(e/p):-Math.acos(e/p),d.scaleX=p,d.scaleY=v/p,d.skewX=(e*a+n*l)/v,d.skewY=0}else if(a!=0||l!=0){var S=Math.sqrt(a*a+l*l);d.rotation=Math.PI/2-(l>0?Math.acos(-a/S):-Math.acos(a/S)),d.scaleX=v/S,d.scaleY=S,d.skewX=0,d.skewY=(e*a+n*l)/v}return d.rotation=ee._getRotation(d.rotation),d}}var MD="[object Array]",DD="[object Number]",FD="[object String]",$D="[object Boolean]",GD=Math.PI/180,WD=180/Math.PI,yd="#",BD="",UD="0",HD="Konva warning: ",Eg="Konva error: ",zD="rgb(",md={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},jD=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/,jf=[];const YD=typeof requestAnimationFrame!="undefined"&&requestAnimationFrame||function(r){setTimeout(r,60)},ee={_isElement(r){return!!(r&&r.nodeType==1)},_isFunction(r){return!!(r&&r.constructor&&r.call&&r.apply)},_isPlainObject(r){return!!r&&r.constructor===Object},_isArray(r){return Object.prototype.toString.call(r)===MD},_isNumber(r){return Object.prototype.toString.call(r)===DD&&!isNaN(r)&&isFinite(r)},_isString(r){return Object.prototype.toString.call(r)===FD},_isBoolean(r){return Object.prototype.toString.call(r)===$D},isObject(r){return r instanceof Object},isValidSelector(r){if(typeof r!="string")return!1;var e=r[0];return e==="#"||e==="."||e===e.toUpperCase()},_sign(r){return r===0||r>0?1:-1},requestAnimFrame(r){jf.push(r),jf.length===1&&YD(function(){const e=jf;jf=[],e.forEach(function(n){n()})})},createCanvasElement(){var r=document.createElement("canvas");try{r.style=r.style||{}}catch{}return r},createImageElement(){return document.createElement("img")},_isInDocument(r){for(;r=r.parentNode;)if(r==document)return!0;return!1},_urlToImage(r,e){var n=ee.createImageElement();n.onload=function(){e(n)},n.src=r},_rgbToHex(r,e,n){return((1<<24)+(r<<16)+(e<<8)+n).toString(16).slice(1)},_hexToRgb(r){r=r.replace(yd,BD);var e=parseInt(r,16);return{r:e>>16&255,g:e>>8&255,b:e&255}},getRandomColor(){for(var r=(Math.random()*16777215<<0).toString(16);r.length<6;)r=UD+r;return yd+r},getRGB(r){var e;return r in md?(e=md[r],{r:e[0],g:e[1],b:e[2]}):r[0]===yd?this._hexToRgb(r.substring(1)):r.substr(0,4)===zD?(e=jD.exec(r.replace(/ /g,"")),{r:parseInt(e[1],10),g:parseInt(e[2],10),b:parseInt(e[3],10)}):{r:0,g:0,b:0}},colorToRGBA(r){return r=r||"black",ee._namedColorToRBA(r)||ee._hex3ColorToRGBA(r)||ee._hex6ColorToRGBA(r)||ee._rgbColorToRGBA(r)||ee._rgbaColorToRGBA(r)||ee._hslColorToRGBA(r)},_namedColorToRBA(r){var e=md[r.toLowerCase()];return e?{r:e[0],g:e[1],b:e[2],a:1}:null},_rgbColorToRGBA(r){if(r.indexOf("rgb(")===0){r=r.match(/rgb\(([^)]+)\)/)[1];var e=r.split(/ *, */).map(Number);return{r:e[0],g:e[1],b:e[2],a:1}}},_rgbaColorToRGBA(r){if(r.indexOf("rgba(")===0){r=r.match(/rgba\(([^)]+)\)/)[1];var e=r.split(/ *, */).map((n,a)=>n.slice(-1)==="%"?a===3?parseInt(n)/100:parseInt(n)/100*255:Number(n));return{r:e[0],g:e[1],b:e[2],a:e[3]}}},_hex6ColorToRGBA(r){if(r[0]==="#"&&r.length===7)return{r:parseInt(r.slice(1,3),16),g:parseInt(r.slice(3,5),16),b:parseInt(r.slice(5,7),16),a:1}},_hex3ColorToRGBA(r){if(r[0]==="#"&&r.length===4)return{r:parseInt(r[1]+r[1],16),g:parseInt(r[2]+r[2],16),b:parseInt(r[3]+r[3],16),a:1}},_hslColorToRGBA(r){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(r)){const[e,...n]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(r),a=Number(n[0])/360,l=Number(n[1])/100,f=Number(n[2])/100;let h,v,d;if(l===0)return d=f*255,{r:Math.round(d),g:Math.round(d),b:Math.round(d),a:1};f<.5?h=f*(1+l):h=f+l-f*l;const p=2*f-h,S=[0,0,0];for(let E=0;E<3;E++)v=a+1/3*-(E-1),v<0&&v++,v>1&&v--,6*v<1?d=p+(h-p)*6*v:2*v<1?d=h:3*v<2?d=p+(h-p)*(2/3-v)*6:d=p,S[E]=d*255;return{r:Math.round(S[0]),g:Math.round(S[1]),b:Math.round(S[2]),a:1}}},haveIntersection(r,e){return!(e.x>r.x+r.width||e.x+e.width<r.x||e.y>r.y+r.height||e.y+e.height<r.y)},cloneObject(r){var e={};for(var n in r)this._isPlainObject(r[n])?e[n]=this.cloneObject(r[n]):this._isArray(r[n])?e[n]=this.cloneArray(r[n]):e[n]=r[n];return e},cloneArray(r){return r.slice(0)},degToRad(r){return r*GD},radToDeg(r){return r*WD},_degToRad(r){return ee.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),ee.degToRad(r)},_radToDeg(r){return ee.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),ee.radToDeg(r)},_getRotation(r){return De.angleDeg?ee.radToDeg(r):r},_capitalize(r){return r.charAt(0).toUpperCase()+r.slice(1)},throw(r){throw new Error(Eg+r)},error(r){console.error(Eg+r)},warn(r){!De.showWarnings||console.warn(HD+r)},each(r,e){for(var n in r)e(n,r[n])},_inRange(r,e,n){return e<=r&&r<n},_getProjectionToSegment(r,e,n,a,l,f){var h,v,d,p=(r-n)*(r-n)+(e-a)*(e-a);if(p==0)h=r,v=e,d=(l-n)*(l-n)+(f-a)*(f-a);else{var S=((l-r)*(n-r)+(f-e)*(a-e))/p;S<0?(h=r,v=e,d=(r-l)*(r-l)+(e-f)*(e-f)):S>1?(h=n,v=a,d=(n-l)*(n-l)+(a-f)*(a-f)):(h=r+S*(n-r),v=e+S*(a-e),d=(h-l)*(h-l)+(v-f)*(v-f))}return[h,v,d]},_getProjectionToLine(r,e,n){var a=ee.cloneObject(r),l=Number.MAX_VALUE;return e.forEach(function(f,h){if(!(!n&&h===e.length-1)){var v=e[(h+1)%e.length],d=ee._getProjectionToSegment(f.x,f.y,v.x,v.y,r.x,r.y),p=d[0],S=d[1],E=d[2];E<l&&(a.x=p,a.y=S,l=E)}}),a},_prepareArrayForTween(r,e,n){var a,l=[],f=[];if(r.length>e.length){var h=e;e=r,r=h}for(a=0;a<r.length;a+=2)l.push({x:r[a],y:r[a+1]});for(a=0;a<e.length;a+=2)f.push({x:e[a],y:e[a+1]});var v=[];return f.forEach(function(d){var p=ee._getProjectionToLine(d,l,n);v.push(p.x),v.push(p.y)}),v},_prepareToStringify(r){var e;r.visitedByCircularReferenceRemoval=!0;for(var n in r)if(!!(r.hasOwnProperty(n)&&r[n]&&typeof r[n]=="object")){if(e=Object.getOwnPropertyDescriptor(r,n),r[n].visitedByCircularReferenceRemoval||ee._isElement(r[n]))if(e.configurable)delete r[n];else return null;else if(ee._prepareToStringify(r[n])===null)if(e.configurable)delete r[n];else return null}return delete r.visitedByCircularReferenceRemoval,r},_assign(r,e){for(var n in e)r[n]=e[n];return r},_getFirstPointerId(r){return r.touches?r.changedTouches[0].identifier:r.pointerId||999}};function ha(r){return ee._isString(r)?'"'+r+'"':Object.prototype.toString.call(r)==="[object Number]"||ee._isBoolean(r)?r:Object.prototype.toString.call(r)}function Jy(r){return r>255?255:r<0?0:Math.round(r)}function Ae(){if(De.isUnminified)return function(r,e){return ee._isNumber(r)||ee.warn(ha(r)+' is a not valid value for "'+e+'" attribute. The value should be a number.'),r}}function em(r){if(De.isUnminified)return function(e,n){let a=ee._isNumber(e),l=ee._isArray(e)&&e.length==r;return!a&&!l&&ee.warn(ha(e)+' is a not valid value for "'+n+'" attribute. The value should be a number or Array<number>('+r+")"),e}}function $v(){if(De.isUnminified)return function(r,e){var n=ee._isNumber(r),a=r==="auto";return n||a||ee.warn(ha(r)+' is a not valid value for "'+e+'" attribute. The value should be a number or "auto".'),r}}function Ss(){if(De.isUnminified)return function(r,e){return ee._isString(r)||ee.warn(ha(r)+' is a not valid value for "'+e+'" attribute. The value should be a string.'),r}}function tm(){if(De.isUnminified)return function(r,e){const n=ee._isString(r),a=Object.prototype.toString.call(r)==="[object CanvasGradient]"||r&&r.addColorStop;return n||a||ee.warn(ha(r)+' is a not valid value for "'+e+'" attribute. The value should be a string or a native gradient.'),r}}function XD(){if(De.isUnminified)return function(r,e){return ee._isArray(r)?r.forEach(function(n){ee._isNumber(n)||ee.warn('"'+e+'" attribute has non numeric element '+n+". Make sure that all elements are numbers.")}):ee.warn(ha(r)+' is a not valid value for "'+e+'" attribute. The value should be a array of numbers.'),r}}function Gn(){if(De.isUnminified)return function(r,e){var n=r===!0||r===!1;return n||ee.warn(ha(r)+' is a not valid value for "'+e+'" attribute. The value should be a boolean.'),r}}function KD(r){if(De.isUnminified)return function(e,n){return ee.isObject(e)||ee.warn(ha(e)+' is a not valid value for "'+n+'" attribute. The value should be an object with properties '+r),e}}var El="get",Al="set";const F={addGetterSetter(r,e,n,a,l){F.addGetter(r,e,n),F.addSetter(r,e,a,l),F.addOverloadedGetterSetter(r,e)},addGetter(r,e,n){var a=El+ee._capitalize(e);r.prototype[a]=r.prototype[a]||function(){var l=this.attrs[e];return l===void 0?n:l}},addSetter(r,e,n,a){var l=Al+ee._capitalize(e);r.prototype[l]||F.overWriteSetter(r,e,n,a)},overWriteSetter(r,e,n,a){var l=Al+ee._capitalize(e);r.prototype[l]=function(f){return n&&f!==void 0&&f!==null&&(f=n.call(this,f,e)),this._setAttr(e,f),a&&a.call(this),this}},addComponentsGetterSetter(r,e,n,a,l){var f=n.length,h=ee._capitalize,v=El+h(e),d=Al+h(e),p,S;r.prototype[v]=function(){var A={};for(p=0;p<f;p++)S=n[p],A[S]=this.getAttr(e+h(S));return A};var E=KD(n);r.prototype[d]=function(A){var O=this.attrs[e],k;a&&(A=a.call(this,A)),E&&E.call(this,A,e);for(k in A)!A.hasOwnProperty(k)||this._setAttr(e+h(k),A[k]);return this._fireChangeEvent(e,O,A),l&&l.call(this),this},F.addOverloadedGetterSetter(r,e)},addOverloadedGetterSetter(r,e){var n=ee._capitalize(e),a=Al+n,l=El+n;r.prototype[e]=function(){return arguments.length?(this[a](arguments[0]),this):this[l]()}},addDeprecatedGetterSetter(r,e,n,a){ee.error("Adding deprecated "+e);var l=El+ee._capitalize(e),f=e+" property is deprecated and will be removed soon. Look at Konva change log for more information.";r.prototype[l]=function(){ee.error(f);var h=this.attrs[e];return h===void 0?n:h},F.addSetter(r,e,a,function(){ee.error(f)}),F.addOverloadedGetterSetter(r,e)},backCompat(r,e){ee.each(e,function(n,a){var l=r.prototype[a],f=El+ee._capitalize(n),h=Al+ee._capitalize(n);function v(){l.apply(this,arguments),ee.error('"'+n+'" method is deprecated and will be removed soon. Use ""'+a+'" instead.')}r.prototype[n]=v,r.prototype[f]=v,r.prototype[h]=v})},afterSetFilter(){this._filterUpToDate=!1}};function qD(r){var e=[],n=r.length,a=ee,l,f;for(l=0;l<n;l++)f=r[l],a._isNumber(f)?f=Math.round(f*1e3)/1e3:a._isString(f)||(f=f+""),e.push(f);return e}var Ag=",",VD="(",ZD=")",QD="([",JD="])",e3=";",t3="()",r3="=",wg=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],n3=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"];const i3=100;class nc{constructor(e){this.canvas=e,this._context=e._canvas.getContext("2d"),De.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(e){e.fillEnabled()&&this._fill(e)}_fill(e){}strokeShape(e){e.hasStroke()&&this._stroke(e)}_stroke(e){}fillStrokeShape(e){e.attrs.fillAfterStrokeEnabled?(this.strokeShape(e),this.fillShape(e)):(this.fillShape(e),this.strokeShape(e))}getTrace(e,n){var a=this.traceArr,l=a.length,f="",h,v,d,p;for(h=0;h<l;h++)v=a[h],d=v.method,d?(p=v.args,f+=d,e?f+=t3:ee._isArray(p[0])?f+=QD+p.join(Ag)+JD:(n&&(p=p.map(S=>typeof S=="number"?Math.floor(S):S)),f+=VD+p.join(Ag)+ZD)):(f+=v.property,e||(f+=r3+v.val)),f+=e3;return f}clearTrace(){this.traceArr=[]}_trace(e){var n=this.traceArr,a;n.push(e),a=n.length,a>=i3&&n.shift()}reset(){var e=this.getCanvas().getPixelRatio();this.setTransform(1*e,0,0,1*e,0,0)}getCanvas(){return this.canvas}clear(e){var n=this.getCanvas();e?this.clearRect(e.x||0,e.y||0,e.width||0,e.height||0):this.clearRect(0,0,n.getWidth()/n.pixelRatio,n.getHeight()/n.pixelRatio)}_applyLineCap(e){var n=e.getLineCap();n&&this.setAttr("lineCap",n)}_applyOpacity(e){var n=e.getAbsoluteOpacity();n!==1&&this.setAttr("globalAlpha",n)}_applyLineJoin(e){var n=e.attrs.lineJoin;n&&this.setAttr("lineJoin",n)}setAttr(e,n){this._context[e]=n}arc(e,n,a,l,f,h){this._context.arc(e,n,a,l,f,h)}arcTo(e,n,a,l,f){this._context.arcTo(e,n,a,l,f)}beginPath(){this._context.beginPath()}bezierCurveTo(e,n,a,l,f,h){this._context.bezierCurveTo(e,n,a,l,f,h)}clearRect(e,n,a,l){this._context.clearRect(e,n,a,l)}clip(){this._context.clip()}closePath(){this._context.closePath()}createImageData(e,n){var a=arguments;if(a.length===2)return this._context.createImageData(e,n);if(a.length===1)return this._context.createImageData(e)}createLinearGradient(e,n,a,l){return this._context.createLinearGradient(e,n,a,l)}createPattern(e,n){return this._context.createPattern(e,n)}createRadialGradient(e,n,a,l,f,h){return this._context.createRadialGradient(e,n,a,l,f,h)}drawImage(e,n,a,l,f,h,v,d,p){var S=arguments,E=this._context;S.length===3?E.drawImage(e,n,a):S.length===5?E.drawImage(e,n,a,l,f):S.length===9&&E.drawImage(e,n,a,l,f,h,v,d,p)}ellipse(e,n,a,l,f,h,v,d){this._context.ellipse(e,n,a,l,f,h,v,d)}isPointInPath(e,n){return this._context.isPointInPath(e,n)}fill(e){e?this._context.fill(e):this._context.fill()}fillRect(e,n,a,l){this._context.fillRect(e,n,a,l)}strokeRect(e,n,a,l){this._context.strokeRect(e,n,a,l)}fillText(e,n,a,l){l?this._context.fillText(e,n,a,l):this._context.fillText(e,n,a)}measureText(e){return this._context.measureText(e)}getImageData(e,n,a,l){return this._context.getImageData(e,n,a,l)}lineTo(e,n){this._context.lineTo(e,n)}moveTo(e,n){this._context.moveTo(e,n)}rect(e,n,a,l){this._context.rect(e,n,a,l)}putImageData(e,n,a){this._context.putImageData(e,n,a)}quadraticCurveTo(e,n,a,l){this._context.quadraticCurveTo(e,n,a,l)}restore(){this._context.restore()}rotate(e){this._context.rotate(e)}save(){this._context.save()}scale(e,n){this._context.scale(e,n)}setLineDash(e){this._context.setLineDash?this._context.setLineDash(e):"mozDash"in this._context?this._context.mozDash=e:"webkitLineDash"in this._context&&(this._context.webkitLineDash=e)}getLineDash(){return this._context.getLineDash()}setTransform(e,n,a,l,f,h){this._context.setTransform(e,n,a,l,f,h)}stroke(e){e?this._context.stroke(e):this._context.stroke()}strokeText(e,n,a,l){this._context.strokeText(e,n,a,l)}transform(e,n,a,l,f,h){this._context.transform(e,n,a,l,f,h)}translate(e,n){this._context.translate(e,n)}_enableTrace(){var e=this,n=wg.length,a=this.setAttr,l,f,h=function(v){var d=e[v],p;e[v]=function(){return f=qD(Array.prototype.slice.call(arguments,0)),p=d.apply(e,arguments),e._trace({method:v,args:f}),p}};for(l=0;l<n;l++)h(wg[l]);e.setAttr=function(){a.apply(e,arguments);var v=arguments[0],d=arguments[1];(v==="shadowOffsetX"||v==="shadowOffsetY"||v==="shadowBlur")&&(d=d/this.canvas.getPixelRatio()),e._trace({property:v,val:d})}}_applyGlobalCompositeOperation(e){const n=e.attrs.globalCompositeOperation;var a=!n||n==="source-over";a||this.setAttr("globalCompositeOperation",n)}}n3.forEach(function(r){Object.defineProperty(nc.prototype,r,{get(){return this._context[r]},set(e){this._context[r]=e}})});class a3 extends nc{_fillColor(e){var n=e.fill();this.setAttr("fillStyle",n),e._fillFunc(this)}_fillPattern(e){this.setAttr("fillStyle",e._getFillPattern()),e._fillFunc(this)}_fillLinearGradient(e){var n=e._getLinearGradient();n&&(this.setAttr("fillStyle",n),e._fillFunc(this))}_fillRadialGradient(e){var n=e._getRadialGradient();n&&(this.setAttr("fillStyle",n),e._fillFunc(this))}_fill(e){var n=e.fill(),a=e.getFillPriority();if(n&&a==="color"){this._fillColor(e);return}var l=e.getFillPatternImage();if(l&&a==="pattern"){this._fillPattern(e);return}var f=e.getFillLinearGradientColorStops();if(f&&a==="linear-gradient"){this._fillLinearGradient(e);return}var h=e.getFillRadialGradientColorStops();if(h&&a==="radial-gradient"){this._fillRadialGradient(e);return}n?this._fillColor(e):l?this._fillPattern(e):f?this._fillLinearGradient(e):h&&this._fillRadialGradient(e)}_strokeLinearGradient(e){var n=e.getStrokeLinearGradientStartPoint(),a=e.getStrokeLinearGradientEndPoint(),l=e.getStrokeLinearGradientColorStops(),f=this.createLinearGradient(n.x,n.y,a.x,a.y);if(l){for(var h=0;h<l.length;h+=2)f.addColorStop(l[h],l[h+1]);this.setAttr("strokeStyle",f)}}_stroke(e){var n=e.dash(),a=e.getStrokeScaleEnabled();if(e.hasStroke()){if(!a){this.save();var l=this.getCanvas().getPixelRatio();this.setTransform(l,0,0,l,0,0)}this._applyLineCap(e),n&&e.dashEnabled()&&(this.setLineDash(n),this.setAttr("lineDashOffset",e.dashOffset())),this.setAttr("lineWidth",e.strokeWidth()),e.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)");var f=e.getStrokeLinearGradientColorStops();f?this._strokeLinearGradient(e):this.setAttr("strokeStyle",e.stroke()),e._strokeFunc(this),a||this.restore()}}_applyShadow(e){var n,a,l,f=(n=e.getShadowRGBA())!==null&&n!==void 0?n:"black",h=(a=e.getShadowBlur())!==null&&a!==void 0?a:5,v=(l=e.getShadowOffset())!==null&&l!==void 0?l:{x:0,y:0},d=e.getAbsoluteScale(),p=this.canvas.getPixelRatio(),S=d.x*p,E=d.y*p;this.setAttr("shadowColor",f),this.setAttr("shadowBlur",h*Math.min(Math.abs(S),Math.abs(E))),this.setAttr("shadowOffsetX",v.x*S),this.setAttr("shadowOffsetY",v.y*E)}}class o3 extends nc{_fill(e){this.save(),this.setAttr("fillStyle",e.colorKey),e._fillFuncHit(this),this.restore()}strokeShape(e){e.hasHitStroke()&&this._stroke(e)}_stroke(e){if(e.hasHitStroke()){var n=e.getStrokeScaleEnabled();if(!n){this.save();var a=this.getCanvas().getPixelRatio();this.setTransform(a,0,0,a,0,0)}this._applyLineCap(e);var l=e.hitStrokeWidth(),f=l==="auto"?e.strokeWidth():l;this.setAttr("lineWidth",f),this.setAttr("strokeStyle",e.colorKey),e._strokeFuncHit(this),n||this.restore()}}}var Yf;function s3(){if(Yf)return Yf;var r=ee.createCanvasElement(),e=r.getContext("2d");return Yf=function(){var n=De._global.devicePixelRatio||1,a=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return n/a}(),Yf}class ic{constructor(e){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;var n=e||{},a=n.pixelRatio||De.pixelRatio||s3();this.pixelRatio=a,this._canvas=ee.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(e){var n=this.pixelRatio;this.pixelRatio=e,this.setSize(this.getWidth()/n,this.getHeight()/n)}setWidth(e){this.width=this._canvas.width=e*this.pixelRatio,this._canvas.style.width=e+"px";var n=this.pixelRatio,a=this.getContext()._context;a.scale(n,n)}setHeight(e){this.height=this._canvas.height=e*this.pixelRatio,this._canvas.style.height=e+"px";var n=this.pixelRatio,a=this.getContext()._context;a.scale(n,n)}getWidth(){return this.width}getHeight(){return this.height}setSize(e,n){this.setWidth(e||0),this.setHeight(n||0)}toDataURL(e,n){try{return this._canvas.toDataURL(e,n)}catch{try{return this._canvas.toDataURL()}catch(l){return ee.error("Unable to get data URL. "+l.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}F.addGetterSetter(ic,"pixelRatio",void 0,Ae());class Jo extends ic{constructor(e={width:0,height:0}){super(e);this.context=new a3(this),this.setSize(e.width,e.height)}}class Gv extends ic{constructor(e={width:0,height:0}){super(e);this.hitCanvas=!0,this.context=new o3(this),this.setSize(e.width,e.height)}}const gt={get isDragging(){var r=!1;return gt._dragElements.forEach(e=>{e.dragStatus==="dragging"&&(r=!0)}),r},justDragged:!1,get node(){var r;return gt._dragElements.forEach(e=>{r=e.node}),r},_dragElements:new Map,_drag(r){const e=[];gt._dragElements.forEach((n,a)=>{const{node:l}=n,f=l.getStage();f.setPointersPositions(r),n.pointerId===void 0&&(n.pointerId=ee._getFirstPointerId(r));const h=f._changedPointerPositions.find(p=>p.id===n.pointerId);if(!!h){if(n.dragStatus!=="dragging"){var v=l.dragDistance(),d=Math.max(Math.abs(h.x-n.startPointerPos.x),Math.abs(h.y-n.startPointerPos.y));if(d<v||(l.startDrag({evt:r}),!l.isDragging()))return}l._setDragPosition(r,n),e.push(l)}}),e.forEach(n=>{n.fire("dragmove",{type:"dragmove",target:n,evt:r},!0)})},_endDragBefore(r){gt._dragElements.forEach(e=>{const{node:n}=e,a=n.getStage();if(r&&a.setPointersPositions(r),!a._changedPointerPositions.find(h=>h.id===e.pointerId))return;(e.dragStatus==="dragging"||e.dragStatus==="stopped")&&(gt.justDragged=!0,De._mouseListenClick=!1,De._touchListenClick=!1,De._pointerListenClick=!1,e.dragStatus="stopped");const f=e.node.getLayer()||e.node instanceof De.Stage&&e.node;f&&f.batchDraw()})},_endDragAfter(r){gt._dragElements.forEach((e,n)=>{e.dragStatus==="stopped"&&e.node.fire("dragend",{type:"dragend",target:e.node,evt:r},!0),e.dragStatus!=="dragging"&&gt._dragElements.delete(n)})}};De.isBrowser&&(window.addEventListener("mouseup",gt._endDragBefore,!0),window.addEventListener("touchend",gt._endDragBefore,!0),window.addEventListener("mousemove",gt._drag),window.addEventListener("touchmove",gt._drag),window.addEventListener("mouseup",gt._endDragAfter,!1),window.addEventListener("touchend",gt._endDragAfter,!1));var lh="absoluteOpacity",Xf="allEventListeners",Li="absoluteTransform",kg="absoluteScale",wl="canvas",l3="Change",u3="children",f3="konva",Wd="listening",Og="mouseenter",xg="mouseleave",Rg="set",Pg="Shape",uh=" ",Lg="stage",la="transform",h3="Stage",Bd="visible",c3=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(uh);let d3=1;class we{constructor(e){this._id=d3++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(e),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(e){(e===la||e===Li)&&this._cache.get(e)?this._cache.get(e).dirty=!0:e?this._cache.delete(e):this._cache.clear()}_getCache(e,n){var a=this._cache.get(e),l=e===la||e===Li,f=a===void 0||l&&a.dirty===!0;return f&&(a=n.call(this),this._cache.set(e,a)),a}_calculate(e,n,a){if(!this._attachedDepsListeners.get(e)){const l=n.map(f=>f+"Change.konva").join(uh);this.on(l,()=>{this._clearCache(e)}),this._attachedDepsListeners.set(e,!0)}return this._getCache(e,a)}_getCanvasCache(){return this._cache.get(wl)}_clearSelfAndDescendantCache(e){this._clearCache(e),e===Li&&this.fire("absoluteTransformChange")}clearCache(){return this._cache.delete(wl),this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(e){var n=e||{},a={};(n.x===void 0||n.y===void 0||n.width===void 0||n.height===void 0)&&(a=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()}));var l=Math.ceil(n.width||a.width),f=Math.ceil(n.height||a.height),h=n.pixelRatio,v=n.x===void 0?Math.floor(a.x):n.x,d=n.y===void 0?Math.floor(a.y):n.y,p=n.offset||0,S=n.drawBorder||!1,E=n.hitCanvasPixelRatio||1;if(!l||!f){ee.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}l+=p*2+1,f+=p*2+1,v-=p,d-=p;var A=new Jo({pixelRatio:h,width:l,height:f}),O=new Jo({pixelRatio:h,width:0,height:0}),k=new Gv({pixelRatio:E,width:l,height:f}),T=A.getContext(),x=k.getContext();return k.isCache=!0,A.isCache=!0,this._cache.delete(wl),this._filterUpToDate=!1,n.imageSmoothingEnabled===!1&&(A.getContext()._context.imageSmoothingEnabled=!1,O.getContext()._context.imageSmoothingEnabled=!1),T.save(),x.save(),T.translate(-v,-d),x.translate(-v,-d),this._isUnderCache=!0,this._clearSelfAndDescendantCache(lh),this._clearSelfAndDescendantCache(kg),this.drawScene(A,this),this.drawHit(k,this),this._isUnderCache=!1,T.restore(),x.restore(),S&&(T.save(),T.beginPath(),T.rect(0,0,l,f),T.closePath(),T.setAttr("strokeStyle","red"),T.setAttr("lineWidth",5),T.stroke(),T.restore()),this._cache.set(wl,{scene:A,filter:O,hit:k,x:v,y:d}),this._requestDraw(),this}isCached(){return this._cache.has(wl)}getClientRect(e){throw new Error('abstract "getClientRect" method call')}_transformedRect(e,n){var a=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}],l,f,h,v,d=this.getAbsoluteTransform(n);return a.forEach(function(p){var S=d.point(p);l===void 0&&(l=h=S.x,f=v=S.y),l=Math.min(l,S.x),f=Math.min(f,S.y),h=Math.max(h,S.x),v=Math.max(v,S.y)}),{x:l,y:f,width:h-l,height:v-f}}_drawCachedSceneCanvas(e){e.save(),e._applyOpacity(this),e._applyGlobalCompositeOperation(this);const n=this._getCanvasCache();e.translate(n.x,n.y);var a=this._getCachedSceneCanvas(),l=a.pixelRatio;e.drawImage(a._canvas,0,0,a.width/l,a.height/l),e.restore()}_drawCachedHitCanvas(e){var n=this._getCanvasCache(),a=n.hit;e.save(),e.translate(n.x,n.y),e.drawImage(a._canvas,0,0,a.width/a.pixelRatio,a.height/a.pixelRatio),e.restore()}_getCachedSceneCanvas(){var e=this.filters(),n=this._getCanvasCache(),a=n.scene,l=n.filter,f=l.getContext(),h,v,d,p;if(e){if(!this._filterUpToDate){var S=a.pixelRatio;l.setSize(a.width/a.pixelRatio,a.height/a.pixelRatio);try{for(h=e.length,f.clear(),f.drawImage(a._canvas,0,0,a.getWidth()/S,a.getHeight()/S),v=f.getImageData(0,0,l.getWidth(),l.getHeight()),d=0;d<h;d++){if(p=e[d],typeof p!="function"){ee.error("Filter should be type of function, but got "+typeof p+" instead. Please check correct filters");continue}p.call(this,v),f.putImageData(v,0,0)}}catch(E){ee.error("Unable to apply filter. "+E.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return l}return a}on(e,n){if(this._cache&&this._cache.delete(Xf),arguments.length===3)return this._delegate.apply(this,arguments);var a=e.split(uh),l=a.length,f,h,v,d,p;for(f=0;f<l;f++)h=a[f],v=h.split("."),d=v[0],p=v[1]||"",this.eventListeners[d]||(this.eventListeners[d]=[]),this.eventListeners[d].push({name:p,handler:n});return this}off(e,n){var a=(e||"").split(uh),l=a.length,f,h,v,d,p,S;if(this._cache&&this._cache.delete(Xf),!e)for(h in this.eventListeners)this._off(h);for(f=0;f<l;f++)if(v=a[f],d=v.split("."),p=d[0],S=d[1],p)this.eventListeners[p]&&this._off(p,S,n);else for(h in this.eventListeners)this._off(h,S,n);return this}dispatchEvent(e){var n={target:this,type:e.type,evt:e};return this.fire(e.type,n),this}addEventListener(e,n){return this.on(e,function(a){n.call(this,a.evt)}),this}removeEventListener(e){return this.off(e),this}_delegate(e,n,a){var l=this;this.on(e,function(f){for(var h=f.target.findAncestors(n,!0,l),v=0;v<h.length;v++)f=ee.cloneObject(f),f.currentTarget=h[v],a.call(h[v],f)})}remove(){return this.isDragging()&&this.stopDrag(),gt._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(Li),this._clearSelfAndDescendantCache(lh),this._clearSelfAndDescendantCache(kg),this._clearSelfAndDescendantCache(Lg),this._clearSelfAndDescendantCache(Bd),this._clearSelfAndDescendantCache(Wd)}_remove(){this._clearCaches();var e=this.getParent();e&&e.children&&(e.children.splice(this.index,1),e._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this}getAttr(e){var n="get"+ee._capitalize(e);return ee._isFunction(this[n])?this[n]():this.attrs[e]}getAncestors(){for(var e=this.getParent(),n=[];e;)n.push(e),e=e.getParent();return n}getAttrs(){return this.attrs||{}}setAttrs(e){return this._batchTransformChanges(()=>{var n,a;if(!e)return this;for(n in e)n!==u3&&(a=Rg+ee._capitalize(n),ee._isFunction(this[a])?this[a](e[n]):this._setAttr(n,e[n]))}),this}isListening(){return this._getCache(Wd,this._isListening)}_isListening(e){if(!this.listening())return!1;const a=this.getParent();return a&&a!==e&&this!==e?a._isListening(e):!0}isVisible(){return this._getCache(Bd,this._isVisible)}_isVisible(e){if(!this.visible())return!1;const a=this.getParent();return a&&a!==e&&this!==e?a._isVisible(e):!0}shouldDrawHit(e,n=!1){if(e)return this._isVisible(e)&&this._isListening(e);var a=this.getLayer(),l=!1;gt._dragElements.forEach(h=>{h.dragStatus==="dragging"&&(h.node.nodeType==="Stage"||h.node.getLayer()===a)&&(l=!0)});var f=!n&&!De.hitOnDragEnabled&&l;return this.isListening()&&this.isVisible()&&!f}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){var e=this.getDepth(),n=this,a=0,l,f,h,v;function d(p){for(l=[],f=p.length,h=0;h<f;h++)v=p[h],a++,v.nodeType!==Pg&&(l=l.concat(v.getChildren().slice())),v._id===n._id&&(h=f);l.length>0&&l[0].getDepth()<=e&&d(l)}return n.nodeType!==h3&&d(n.getStage().getChildren()),a}getDepth(){for(var e=0,n=this.parent;n;)e++,n=n.parent;return e}_batchTransformChanges(e){this._batchingTransformChange=!0,e(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(la),this._clearSelfAndDescendantCache(Li)),this._needClearTransformCache=!1}setPosition(e){return this._batchTransformChanges(()=>{this.x(e.x),this.y(e.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){if(!this.getStage())return null;var e=this.getStage().getPointerPosition();if(!e)return null;var n=this.getAbsoluteTransform().copy();return n.invert(),n.point(e)}getAbsolutePosition(e){let n=!1,a=this.parent;for(;a;){if(a.isCached()){n=!0;break}a=a.parent}n&&!e&&(e=!0);var l=this.getAbsoluteTransform(e).getMatrix(),f=new Jr,h=this.offset();return f.m=l.slice(),f.translate(h.x,h.y),f.getTranslation()}setAbsolutePosition(e){var n=this._clearTransform();this.attrs.x=n.x,this.attrs.y=n.y,delete n.x,delete n.y,this._clearCache(la);var a=this._getAbsoluteTransform().copy();return a.invert(),a.translate(e.x,e.y),e={x:this.attrs.x+a.getTranslation().x,y:this.attrs.y+a.getTranslation().y},this._setTransform(n),this.setPosition({x:e.x,y:e.y}),this._clearCache(la),this._clearSelfAndDescendantCache(Li),this}_setTransform(e){var n;for(n in e)this.attrs[n]=e[n]}_clearTransform(){var e={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,e}move(e){var n=e.x,a=e.y,l=this.x(),f=this.y();return n!==void 0&&(l+=n),a!==void 0&&(f+=a),this.setPosition({x:l,y:f}),this}_eachAncestorReverse(e,n){var a=[],l=this.getParent(),f,h;if(!(n&&n._id===this._id)){for(a.unshift(this);l&&(!n||l._id!==n._id);)a.unshift(l),l=l.parent;for(f=a.length,h=0;h<f;h++)e(a[h])}}rotate(e){return this.rotation(this.rotation()+e),this}moveToTop(){if(!this.parent)return ee.warn("Node has no parent. moveToTop function is ignored."),!1;var e=this.index,n=this.parent.getChildren().length;return e<n-1?(this.parent.children.splice(e,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return ee.warn("Node has no parent. moveUp function is ignored."),!1;var e=this.index,n=this.parent.getChildren().length;return e<n-1?(this.parent.children.splice(e,1),this.parent.children.splice(e+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return ee.warn("Node has no parent. moveDown function is ignored."),!1;var e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.splice(e-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return ee.warn("Node has no parent. moveToBottom function is ignored."),!1;var e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(e){if(!this.parent)return ee.warn("Node has no parent. zIndex parameter is ignored."),this;(e<0||e>=this.parent.children.length)&&ee.warn("Unexpected value "+e+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");var n=this.index;return this.parent.children.splice(n,1),this.parent.children.splice(e,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(lh,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){var e=this.opacity(),n=this.getParent();return n&&!n._isUnderCache&&(e*=n.getAbsoluteOpacity()),e}moveTo(e){return this.getParent()!==e&&(this._remove(),e.add(this)),this}toObject(){var e={},n=this.getAttrs(),a,l,f,h,v;e.attrs={};for(a in n)l=n[a],v=ee.isObject(l)&&!ee._isPlainObject(l)&&!ee._isArray(l),!v&&(f=typeof this[a]=="function"&&this[a],delete n[a],h=f?f.call(this):null,n[a]=l,h!==l&&(e.attrs[a]=l));return e.className=this.getClassName(),ee._prepareToStringify(e)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(e,n,a){var l=[];n&&this._isMatch(e)&&l.push(this);for(var f=this.parent;f;){if(f===a)return l;f._isMatch(e)&&l.push(f),f=f.parent}return l}isAncestorOf(e){return!1}findAncestor(e,n,a){return this.findAncestors(e,n,a)[0]}_isMatch(e){if(!e)return!1;if(typeof e=="function")return e(this);var n=e.replace(/ /g,"").split(","),a=n.length,l,f;for(l=0;l<a;l++)if(f=n[l],ee.isValidSelector(f)||(ee.warn('Selector "'+f+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),ee.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),ee.warn("Konva is awesome, right?")),f.charAt(0)==="#"){if(this.id()===f.slice(1))return!0}else if(f.charAt(0)==="."){if(this.hasName(f.slice(1)))return!0}else if(this.className===f||this.nodeType===f)return!0;return!1}getLayer(){var e=this.getParent();return e?e.getLayer():null}getStage(){return this._getCache(Lg,this._getStage)}_getStage(){var e=this.getParent();if(e)return e.getStage()}fire(e,n={},a){return n.target=n.target||this,a?this._fireAndBubble(e,n):this._fire(e,n),this}getAbsoluteTransform(e){return e?this._getAbsoluteTransform(e):this._getCache(Li,this._getAbsoluteTransform)}_getAbsoluteTransform(e){var n;if(e)return n=new Jr,this._eachAncestorReverse(function(l){var f=l.transformsEnabled();f==="all"?n.multiply(l.getTransform()):f==="position"&&n.translate(l.x()-l.offsetX(),l.y()-l.offsetY())},e),n;n=this._cache.get(Li)||new Jr,this.parent?this.parent.getAbsoluteTransform().copyInto(n):n.reset();var a=this.transformsEnabled();if(a==="all")n.multiply(this.getTransform());else if(a==="position"){const l=this.attrs.x||0,f=this.attrs.y||0,h=this.attrs.offsetX||0,v=this.attrs.offsetY||0;n.translate(l-h,f-v)}return n.dirty=!1,n}getAbsoluteScale(e){for(var n=this;n;)n._isUnderCache&&(e=n),n=n.getParent();const l=this.getAbsoluteTransform(e).decompose();return{x:l.scaleX,y:l.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(la,this._getTransform)}_getTransform(){var e,n,a=this._cache.get(la)||new Jr;a.reset();var l=this.x(),f=this.y(),h=De.getAngle(this.rotation()),v=(e=this.attrs.scaleX)!==null&&e!==void 0?e:1,d=(n=this.attrs.scaleY)!==null&&n!==void 0?n:1,p=this.attrs.skewX||0,S=this.attrs.skewY||0,E=this.attrs.offsetX||0,A=this.attrs.offsetY||0;return(l!==0||f!==0)&&a.translate(l,f),h!==0&&a.rotate(h),(p!==0||S!==0)&&a.skew(p,S),(v!==1||d!==1)&&a.scale(v,d),(E!==0||A!==0)&&a.translate(-1*E,-1*A),a.dirty=!1,a}clone(e){var n=ee.cloneObject(this.attrs),a,l,f,h,v;for(a in e)n[a]=e[a];var d=new this.constructor(n);for(a in this.eventListeners)for(l=this.eventListeners[a],f=l.length,h=0;h<f;h++)v=l[h],v.name.indexOf(f3)<0&&(d.eventListeners[a]||(d.eventListeners[a]=[]),d.eventListeners[a].push(v));return d}_toKonvaCanvas(e){e=e||{};var n=this.getClientRect(),a=this.getStage(),l=e.x!==void 0?e.x:n.x,f=e.y!==void 0?e.y:n.y,h=e.pixelRatio||1,v=new Jo({width:e.width||n.width||(a?a.width():0),height:e.height||n.height||(a?a.height():0),pixelRatio:h}),d=v.getContext();return d.save(),(l||f)&&d.translate(-1*l,-1*f),this.drawScene(v),d.restore(),v}toCanvas(e){return this._toKonvaCanvas(e)._canvas}toDataURL(e){e=e||{};var n=e.mimeType||null,a=e.quality||null,l=this._toKonvaCanvas(e).toDataURL(n,a);return e.callback&&e.callback(l),l}toImage(e){if(!e||!e.callback)throw"callback required for toImage method config argument";var n=e.callback;delete e.callback,ee._urlToImage(this.toDataURL(e),function(a){n(a)})}setSize(e){return this.width(e.width),this.height(e.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():De.dragDistance}_off(e,n,a){var l=this.eventListeners[e],f,h,v;for(f=0;f<l.length;f++)if(h=l[f].name,v=l[f].handler,(h!=="konva"||n==="konva")&&(!n||h===n)&&(!a||a===v)){if(l.splice(f,1),l.length===0){delete this.eventListeners[e];break}f--}}_fireChangeEvent(e,n,a){this._fire(e+l3,{oldVal:n,newVal:a})}addName(e){if(!this.hasName(e)){var n=this.name(),a=n?n+" "+e:e;this.name(a)}return this}hasName(e){if(!e)return!1;const n=this.name();if(!n)return!1;var a=(n||"").split(/\s/g);return a.indexOf(e)!==-1}removeName(e){var n=(this.name()||"").split(/\s/g),a=n.indexOf(e);return a!==-1&&(n.splice(a,1),this.name(n.join(" "))),this}setAttr(e,n){var a=this[Rg+ee._capitalize(e)];return ee._isFunction(a)?a.call(this,n):this._setAttr(e,n),this}_requestDraw(){if(De.autoDrawEnabled){const e=this.getLayer()||this.getStage();e==null||e.batchDraw()}}_setAttr(e,n){var a=this.attrs[e];a===n&&!ee.isObject(n)||(n==null?delete this.attrs[e]:this.attrs[e]=n,this._shouldFireChangeEvents&&this._fireChangeEvent(e,a,n),this._requestDraw())}_setComponentAttr(e,n,a){var l;a!==void 0&&(l=this.attrs[e],l||(this.attrs[e]=this.getAttr(e)),this.attrs[e][n]=a,this._fireChangeEvent(e,l,a))}_fireAndBubble(e,n,a){n&&this.nodeType===Pg&&(n.target=this);var l=(e===Og||e===xg)&&(a&&(this===a||this.isAncestorOf&&this.isAncestorOf(a))||this.nodeType==="Stage"&&!a);if(!l){this._fire(e,n);var f=(e===Og||e===xg)&&a&&a.isAncestorOf&&a.isAncestorOf(this)&&!a.isAncestorOf(this.parent);(n&&!n.cancelBubble||!n)&&this.parent&&this.parent.isListening()&&!f&&(a&&a.parent?this._fireAndBubble.call(this.parent,e,n,a):this._fireAndBubble.call(this.parent,e,n))}}_getProtoListeners(e){let n=this._cache.get(Xf);if(!n){n={};let l=Object.getPrototypeOf(this);for(;l;){if(!l.eventListeners){l=Object.getPrototypeOf(l);continue}for(var a in l.eventListeners){const f=l.eventListeners[a],h=n[a]||[];n[a]=f.concat(h)}l=Object.getPrototypeOf(l)}this._cache.set(Xf,n)}return n[e]}_fire(e,n){n=n||{},n.currentTarget=this,n.type=e;const a=this._getProtoListeners(e);if(a)for(var l=0;l<a.length;l++)a[l].handler.call(this,n);const f=this.eventListeners[e];if(f)for(var l=0;l<f.length;l++)f[l].handler.call(this,n)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(e){var n=e?e.pointerId:void 0,a=this.getStage(),l=this.getAbsolutePosition(),f=a._getPointerById(n)||a._changedPointerPositions[0]||l;gt._dragElements.set(this._id,{node:this,startPointerPos:f,offset:{x:f.x-l.x,y:f.y-l.y},dragStatus:"ready",pointerId:n})}startDrag(e,n=!0){gt._dragElements.has(this._id)||this._createDragElement(e);const a=gt._dragElements.get(this._id);a.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:e&&e.evt},n)}_setDragPosition(e,n){const a=this.getStage()._getPointerById(n.pointerId);if(!!a){var l={x:a.x-n.offset.x,y:a.y-n.offset.y},f=this.dragBoundFunc();if(f!==void 0){const h=f.call(this,l,e);h?l=h:ee.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==l.x||this._lastPos.y!==l.y)&&(this.setAbsolutePosition(l),this._requestDraw()),this._lastPos=l}}stopDrag(e){const n=gt._dragElements.get(this._id);n&&(n.dragStatus="stopped"),gt._endDragBefore(e),gt._endDragAfter(e)}setDraggable(e){this._setAttr("draggable",e),this._dragChange()}isDragging(){const e=gt._dragElements.get(this._id);return e?e.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(e){var n=e.evt.button!==void 0,a=!n||De.dragButtons.indexOf(e.evt.button)>=0;if(!!a&&!this.isDragging()){var l=!1;gt._dragElements.forEach(f=>{this.isAncestorOf(f.node)&&(l=!0)}),l||this._createDragElement(e)}})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{this._dragCleanup();var e=this.getStage();if(!e)return;const n=gt._dragElements.get(this._id),a=n&&n.dragStatus==="dragging",l=n&&n.dragStatus==="ready";a?this.stopDrag():l&&gt._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(e={x:0,y:0}){const n=this.getStage();if(!n)return!1;const a={x:-e.x,y:-e.y,width:n.width()+2*e.x,height:n.height()+2*e.y};return ee.haveIntersection(a,this.getClientRect())}static create(e,n){return ee._isString(e)&&(e=JSON.parse(e)),this._createNode(e,n)}static _createNode(e,n){var a=we.prototype.getClassName.call(e),l=e.children,f,h,v;n&&(e.attrs.container=n),De[a]||(ee.warn('Can not find a node with class name "'+a+'". Fallback to "Shape".'),a="Shape");const d=De[a];if(f=new d(e.attrs),l)for(h=l.length,v=0;v<h;v++)f.add(we._createNode(l[v]));return f}}we.prototype.nodeType="Node";we.prototype._attrsAffectingSize=[];we.prototype.eventListeners={};we.prototype.on.call(we.prototype,c3,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(la),this._clearSelfAndDescendantCache(Li)});we.prototype.on.call(we.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(Bd)});we.prototype.on.call(we.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(Wd)});we.prototype.on.call(we.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(lh)});const Ot=F.addGetterSetter;Ot(we,"zIndex");Ot(we,"absolutePosition");Ot(we,"position");Ot(we,"x",0,Ae());Ot(we,"y",0,Ae());Ot(we,"globalCompositeOperation","source-over",Ss());Ot(we,"opacity",1,Ae());Ot(we,"name","",Ss());Ot(we,"id","",Ss());Ot(we,"rotation",0,Ae());F.addComponentsGetterSetter(we,"scale",["x","y"]);Ot(we,"scaleX",1,Ae());Ot(we,"scaleY",1,Ae());F.addComponentsGetterSetter(we,"skew",["x","y"]);Ot(we,"skewX",0,Ae());Ot(we,"skewY",0,Ae());F.addComponentsGetterSetter(we,"offset",["x","y"]);Ot(we,"offsetX",0,Ae());Ot(we,"offsetY",0,Ae());Ot(we,"dragDistance",null,Ae());Ot(we,"width",0,Ae());Ot(we,"height",0,Ae());Ot(we,"listening",!0,Gn());Ot(we,"preventDefault",!0,Gn());Ot(we,"filters",null,function(r){return this._filterUpToDate=!1,r});Ot(we,"visible",!0,Gn());Ot(we,"transformsEnabled","all",Ss());Ot(we,"size");Ot(we,"dragBoundFunc");Ot(we,"draggable",!1,Gn());F.backCompat(we,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});class en extends we{constructor(){super(...arguments);this.children=[]}getChildren(e){if(!e)return this.children||[];const n=this.children||[];var a=[];return n.forEach(function(l){e(l)&&a.push(l)}),a}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.destroy()}),this.children=[],this._requestDraw(),this}add(...e){if(arguments.length>1){for(var n=0;n<arguments.length;n++)this.add(arguments[n]);return this}var a=e[0];return a.getParent()?(a.moveTo(this),this):(this._validateAdd(a),a.index=this.getChildren().length,a.parent=this,a._clearCaches(),this.getChildren().push(a),this._fire("add",{child:a}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(e){return this._generalFind(e,!1)}findOne(e){var n=this._generalFind(e,!0);return n.length>0?n[0]:void 0}_generalFind(e,n){var a=[];return this._descendants(l=>{const f=l._isMatch(e);return f&&a.push(l),!!(f&&n)}),a}_descendants(e){let n=!1;const a=this.getChildren();for(const l of a){if(n=e(l),n)return!0;if(!!l.hasChildren()&&(n=l._descendants(e),n))return!0}return!1}toObject(){var e=we.prototype.toObject.call(this);return e.children=[],this.getChildren().forEach(n=>{e.children.push(n.toObject())}),e}isAncestorOf(e){for(var n=e.getParent();n;){if(n._id===this._id)return!0;n=n.getParent()}return!1}clone(e){var n=we.prototype.clone.call(this,e);return this.getChildren().forEach(function(a){n.add(a.clone())}),n}getAllIntersections(e){var n=[];return this.find("Shape").forEach(function(a){a.isVisible()&&a.intersects(e)&&n.push(a)}),n}_clearSelfAndDescendantCache(e){var n;super._clearSelfAndDescendantCache(e),!this.isCached()&&((n=this.children)===null||n===void 0||n.forEach(function(a){a._clearSelfAndDescendantCache(e)}))}_setChildrenIndices(){var e;(e=this.children)===null||e===void 0||e.forEach(function(n,a){n.index=a}),this._requestDraw()}drawScene(e,n){var a=this.getLayer(),l=e||a&&a.getCanvas(),f=l&&l.getContext(),h=this._getCanvasCache(),v=h&&h.scene,d=l&&l.isCache;if(!this.isVisible()&&!d)return this;if(v){f.save();var p=this.getAbsoluteTransform(n).getMatrix();f.transform(p[0],p[1],p[2],p[3],p[4],p[5]),this._drawCachedSceneCanvas(f),f.restore()}else this._drawChildren("drawScene",l,n);return this}drawHit(e,n){if(!this.shouldDrawHit(n))return this;var a=this.getLayer(),l=e||a&&a.hitCanvas,f=l&&l.getContext(),h=this._getCanvasCache(),v=h&&h.hit;if(v){f.save();var d=this.getAbsoluteTransform(n).getMatrix();f.transform(d[0],d[1],d[2],d[3],d[4],d[5]),this._drawCachedHitCanvas(f),f.restore()}else this._drawChildren("drawHit",l,n);return this}_drawChildren(e,n,a){var l,f=n&&n.getContext(),h=this.clipWidth(),v=this.clipHeight(),d=this.clipFunc(),p=h&&v||d;const S=a===this;if(p){f.save();var E=this.getAbsoluteTransform(a),A=E.getMatrix();if(f.transform(A[0],A[1],A[2],A[3],A[4],A[5]),f.beginPath(),d)d.call(this,f,this);else{var O=this.clipX(),k=this.clipY();f.rect(O,k,h,v)}f.clip(),A=E.copy().invert().getMatrix(),f.transform(A[0],A[1],A[2],A[3],A[4],A[5])}var T=!S&&this.globalCompositeOperation()!=="source-over"&&e==="drawScene";T&&(f.save(),f._applyGlobalCompositeOperation(this)),(l=this.children)===null||l===void 0||l.forEach(function(x){x[e](n,a)}),T&&f.restore(),p&&f.restore()}getClientRect(e){var n;e=e||{};var a=e.skipTransform,l=e.relativeTo,f,h,v,d,p={x:1/0,y:1/0,width:0,height:0},S=this;(n=this.children)===null||n===void 0||n.forEach(function(T){if(!!T.visible()){var x=T.getClientRect({relativeTo:S,skipShadow:e.skipShadow,skipStroke:e.skipStroke});x.width===0&&x.height===0||(f===void 0?(f=x.x,h=x.y,v=x.x+x.width,d=x.y+x.height):(f=Math.min(f,x.x),h=Math.min(h,x.y),v=Math.max(v,x.x+x.width),d=Math.max(d,x.y+x.height)))}});for(var E=this.find("Shape"),A=!1,O=0;O<E.length;O++){var k=E[O];if(k._isVisible(this)){A=!0;break}}return A&&f!==void 0?p={x:f,y:h,width:v-f,height:d-h}:p={x:0,y:0,width:0,height:0},a?p:this._transformedRect(p,l)}}F.addComponentsGetterSetter(en,"clip",["x","y","width","height"]);F.addGetterSetter(en,"clipX",void 0,Ae());F.addGetterSetter(en,"clipY",void 0,Ae());F.addGetterSetter(en,"clipWidth",void 0,Ae());F.addGetterSetter(en,"clipHeight",void 0,Ae());F.addGetterSetter(en,"clipFunc");const zl=new Map,rm=De._global.PointerEvent!==void 0;function _d(r){return zl.get(r)}function Wv(r){return{evt:r,pointerId:r.pointerId}}function nm(r,e){return zl.get(r)===e}function im(r,e){Gl(r),e.getStage()&&(zl.set(r,e),rm&&e._fire("gotpointercapture",Wv(new PointerEvent("gotpointercapture"))))}function Gl(r,e){const n=zl.get(r);if(!n)return;const a=n.getStage();a&&a.content,zl.delete(r),rm&&n._fire("lostpointercapture",Wv(new PointerEvent("lostpointercapture")))}var v3="Stage",p3="string",Ig="px",g3="mouseout",am="mouseleave",om="mouseover",sm="mouseenter",lm="mousemove",um="mousedown",fm="mouseup",Pl="pointermove",Ll="pointerdown",Zo="pointerup",Il="pointercancel",y3="lostpointercapture",Kf="pointerout",qf="pointerleave",Vf="pointerover",Zf="pointerenter",Ud="contextmenu",hm="touchstart",cm="touchend",dm="touchmove",vm="touchcancel",Hd="wheel",m3=5,_3=[[sm,"_pointerenter"],[um,"_pointerdown"],[lm,"_pointermove"],[fm,"_pointerup"],[am,"_pointerleave"],[hm,"_pointerdown"],[dm,"_pointermove"],[cm,"_pointerup"],[vm,"_pointercancel"],[om,"_pointerover"],[Hd,"_wheel"],[Ud,"_contextmenu"],[Ll,"_pointerdown"],[Pl,"_pointermove"],[Zo,"_pointerup"],[Il,"_pointercancel"],[y3,"_lostpointercapture"]];const bd={mouse:{[Kf]:g3,[qf]:am,[Vf]:om,[Zf]:sm,[Pl]:lm,[Ll]:um,[Zo]:fm,[Il]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[Kf]:"touchout",[qf]:"touchleave",[Vf]:"touchover",[Zf]:"touchenter",[Pl]:dm,[Ll]:hm,[Zo]:cm,[Il]:vm,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[Kf]:Kf,[qf]:qf,[Vf]:Vf,[Zf]:Zf,[Pl]:Pl,[Ll]:Ll,[Zo]:Zo,[Il]:Il,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},Nl=r=>r.indexOf("pointer")>=0?"pointer":r.indexOf("touch")>=0?"touch":"mouse",Vo=r=>{const e=Nl(r);if(e==="pointer")return De.pointerEventsEnabled&&bd.pointer;if(e==="touch")return bd.touch;if(e==="mouse")return bd.mouse};function Ng(r={}){return(r.clipFunc||r.clipWidth||r.clipHeight)&&ee.warn("Stage does not support clipping. Please use clip for Layers or Groups."),r}const b3="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);",fh=[];class ac extends en{constructor(e){super(Ng(e));this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),fh.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{Ng(this.attrs)}),this._checkVisibility()}_validateAdd(e){const n=e.getType()==="Layer",a=e.getType()==="FastLayer";n||a||ee.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const e=this.visible()?"":"none";this.content.style.display=e}setContainer(e){if(typeof e===p3){if(e.charAt(0)==="."){var n=e.slice(1);e=document.getElementsByClassName(n)[0]}else{var a;e.charAt(0)!=="#"?a=e:a=e.slice(1),e=document.getElementById(a)}if(!e)throw"Can not find container in document with id "+a}return this._setAttr("container",e),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),e.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){var e=this.children,n=e.length,a;for(a=0;a<n;a++)e[a].clear();return this}clone(e){return e||(e={}),e.container=typeof document!="undefined"&&document.createElement("div"),en.prototype.clone.call(this,e)}destroy(){super.destroy();var e=this.content;e&&ee._isInDocument(e)&&this.container().removeChild(e);var n=fh.indexOf(this);return n>-1&&fh.splice(n,1),this}getPointerPosition(){const e=this._pointerPositions[0]||this._changedPointerPositions[0];return e?{x:e.x,y:e.y}:(ee.warn(b3),null)}_getPointerById(e){return this._pointerPositions.find(n=>n.id===e)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(e){e=e||{},e.x=e.x||0,e.y=e.y||0,e.width=e.width||this.width(),e.height=e.height||this.height();var n=new Jo({width:e.width,height:e.height,pixelRatio:e.pixelRatio||1}),a=n.getContext()._context,l=this.children;return(e.x||e.y)&&a.translate(-1*e.x,-1*e.y),l.forEach(function(f){if(!!f.isVisible()){var h=f._toKonvaCanvas(e);a.drawImage(h._canvas,e.x,e.y,h.getWidth()/h.getPixelRatio(),h.getHeight()/h.getPixelRatio())}}),n}getIntersection(e){if(!e)return null;var n=this.children,a=n.length,l=a-1,f;for(f=l;f>=0;f--){const h=n[f].getIntersection(e);if(h)return h}return null}_resizeDOM(){var e=this.width(),n=this.height();this.content&&(this.content.style.width=e+Ig,this.content.style.height=n+Ig),this.bufferCanvas.setSize(e,n),this.bufferHitCanvas.setSize(e,n),this.children.forEach(a=>{a.setSize({width:e,height:n}),a.draw()})}add(e,...n){if(arguments.length>1){for(var a=0;a<arguments.length;a++)this.add(arguments[a]);return this}super.add(e);var l=this.children.length;return l>m3&&ee.warn("The stage has "+l+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),e.setSize({width:this.width(),height:this.height()}),e.draw(),De.isBrowser&&this.content.appendChild(e.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(e){return nm(e,this)}setPointerCapture(e){im(e,this)}releaseCapture(e){Gl(e)}getLayers(){return this.children}_bindContentEvents(){!De.isBrowser||_3.forEach(([e,n])=>{this.content.addEventListener(e,a=>{this[n](a)})})}_pointerenter(e){this.setPointersPositions(e);const n=Vo(e.type);this._fire(n.pointerenter,{evt:e,target:this,currentTarget:this})}_pointerover(e){this.setPointersPositions(e);const n=Vo(e.type);this._fire(n.pointerover,{evt:e,target:this,currentTarget:this})}_getTargetShape(e){let n=this[e+"targetShape"];return n&&!n.getStage()&&(n=null),n}_pointerleave(e){const n=Vo(e.type),a=Nl(e.type);if(!!n){this.setPointersPositions(e);var l=this._getTargetShape(a),f=!gt.isDragging||De.hitOnDragEnabled;l&&f?(l._fireAndBubble(n.pointerout,{evt:e}),l._fireAndBubble(n.pointerleave,{evt:e}),this._fire(n.pointerleave,{evt:e,target:this,currentTarget:this}),this[a+"targetShape"]=null):f&&(this._fire(n.pointerleave,{evt:e,target:this,currentTarget:this}),this._fire(n.pointerout,{evt:e,target:this,currentTarget:this})),this.pointerPos=void 0,this._pointerPositions=[]}}_pointerdown(e){const n=Vo(e.type),a=Nl(e.type);if(!!n){this.setPointersPositions(e);var l=!1;this._changedPointerPositions.forEach(f=>{var h=this.getIntersection(f);if(gt.justDragged=!1,De["_"+a+"ListenClick"]=!0,!(h&&h.isListening()))return;De.capturePointerEventsEnabled&&h.setPointerCapture(f.id),this[a+"ClickStartShape"]=h,h._fireAndBubble(n.pointerdown,{evt:e,pointerId:f.id}),l=!0;const d=e.type.indexOf("touch")>=0;h.preventDefault()&&e.cancelable&&d&&e.preventDefault()}),l||this._fire(n.pointerdown,{evt:e,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}}_pointermove(e){const n=Vo(e.type),a=Nl(e.type);if(!n)return;gt.isDragging&&gt.node.preventDefault()&&e.cancelable&&e.preventDefault(),this.setPointersPositions(e);var l=!gt.isDragging||De.hitOnDragEnabled;if(!l)return;var f={};let h=!1;var v=this._getTargetShape(a);this._changedPointerPositions.forEach(d=>{const p=_d(d.id)||this.getIntersection(d),S=d.id,E={evt:e,pointerId:S};var A=v!==p;if(A&&v&&(v._fireAndBubble(n.pointerout,Object.assign({},E),p),v._fireAndBubble(n.pointerleave,Object.assign({},E),p)),p){if(f[p._id])return;f[p._id]=!0}p&&p.isListening()?(h=!0,A&&(p._fireAndBubble(n.pointerover,Object.assign({},E),v),p._fireAndBubble(n.pointerenter,Object.assign({},E),v),this[a+"targetShape"]=p),p._fireAndBubble(n.pointermove,Object.assign({},E))):v&&(this._fire(n.pointerover,{evt:e,target:this,currentTarget:this,pointerId:S}),this[a+"targetShape"]=null)}),h||this._fire(n.pointermove,{evt:e,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(e){const n=Vo(e.type),a=Nl(e.type);if(!n)return;this.setPointersPositions(e);const l=this[a+"ClickStartShape"],f=this[a+"ClickEndShape"];var h={};let v=!1;this._changedPointerPositions.forEach(d=>{const p=_d(d.id)||this.getIntersection(d);if(p){if(p.releaseCapture(d.id),h[p._id])return;h[p._id]=!0}const S=d.id,E={evt:e,pointerId:S};let A=!1;De["_"+a+"InDblClickWindow"]?(A=!0,clearTimeout(this[a+"DblTimeout"])):gt.justDragged||(De["_"+a+"InDblClickWindow"]=!0,clearTimeout(this[a+"DblTimeout"])),this[a+"DblTimeout"]=setTimeout(function(){De["_"+a+"InDblClickWindow"]=!1},De.dblClickWindow),p&&p.isListening()?(v=!0,this[a+"ClickEndShape"]=p,p._fireAndBubble(n.pointerup,Object.assign({},E)),De["_"+a+"ListenClick"]&&l&&l===p&&(p._fireAndBubble(n.pointerclick,Object.assign({},E)),A&&f&&f===p&&p._fireAndBubble(n.pointerdblclick,Object.assign({},E)))):(this[a+"ClickEndShape"]=null,De["_"+a+"ListenClick"]&&this._fire(n.pointerclick,{evt:e,target:this,currentTarget:this,pointerId:S}),A&&this._fire(n.pointerdblclick,{evt:e,target:this,currentTarget:this,pointerId:S}))}),v||this._fire(n.pointerup,{evt:e,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),De["_"+a+"ListenClick"]=!1,e.cancelable&&e.preventDefault()}_contextmenu(e){this.setPointersPositions(e);var n=this.getIntersection(this.getPointerPosition());n&&n.isListening()?n._fireAndBubble(Ud,{evt:e}):this._fire(Ud,{evt:e,target:this,currentTarget:this})}_wheel(e){this.setPointersPositions(e);var n=this.getIntersection(this.getPointerPosition());n&&n.isListening()?n._fireAndBubble(Hd,{evt:e}):this._fire(Hd,{evt:e,target:this,currentTarget:this})}_pointercancel(e){this.setPointersPositions(e);const n=_d(e.pointerId)||this.getIntersection(this.getPointerPosition());n&&n._fireAndBubble(Zo,Wv(e)),Gl(e.pointerId)}_lostpointercapture(e){Gl(e.pointerId)}setPointersPositions(e){var n=this._getContentPosition(),a=null,l=null;e=e||window.event,e.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(e.touches,f=>{this._pointerPositions.push({id:f.identifier,x:(f.clientX-n.left)/n.scaleX,y:(f.clientY-n.top)/n.scaleY})}),Array.prototype.forEach.call(e.changedTouches||e.touches,f=>{this._changedPointerPositions.push({id:f.identifier,x:(f.clientX-n.left)/n.scaleX,y:(f.clientY-n.top)/n.scaleY})})):(a=(e.clientX-n.left)/n.scaleX,l=(e.clientY-n.top)/n.scaleY,this.pointerPos={x:a,y:l},this._pointerPositions=[{x:a,y:l,id:ee._getFirstPointerId(e)}],this._changedPointerPositions=[{x:a,y:l,id:ee._getFirstPointerId(e)}])}_setPointerPosition(e){ee.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(e)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};var e=this.content.getBoundingClientRect();return{top:e.top,left:e.left,scaleX:e.width/this.content.clientWidth||1,scaleY:e.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new Jo({width:this.width(),height:this.height()}),this.bufferHitCanvas=new Gv({pixelRatio:1,width:this.width(),height:this.height()}),!!De.isBrowser){var e=this.container();if(!e)throw"Stage has no container. A container is required.";e.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),e.appendChild(this.content),this._resizeDOM()}}cache(){return ee.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(e){e.batchDraw()}),this}}ac.prototype.nodeType=v3;Yt(ac);F.addGetterSetter(ac,"container");var pm="hasShadow",gm="shadowRGBA",ym="patternImage",mm="linearGradient",_m="radialGradient";let Qf;function Sd(){return Qf||(Qf=ee.createCanvasElement().getContext("2d"),Qf)}const Wl={};function S3(r){r.fill()}function T3(r){r.stroke()}function C3(r){r.fill()}function E3(r){r.stroke()}function A3(){this._clearCache(pm)}function w3(){this._clearCache(gm)}function k3(){this._clearCache(ym)}function O3(){this._clearCache(mm)}function x3(){this._clearCache(_m)}class me extends we{constructor(e){super(e);let n;for(;n=ee.getRandomColor(),!(n&&!(n in Wl)););this.colorKey=n,Wl[n]=this}getContext(){return ee.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return ee.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(pm,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(ym,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){var e=Sd();const n=e.createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(n&&n.setTransform){const a=new Jr;a.translate(this.fillPatternX(),this.fillPatternY()),a.rotate(De.getAngle(this.fillPatternRotation())),a.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),a.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const l=a.getMatrix(),f=typeof DOMMatrix=="undefined"?{a:l[0],b:l[1],c:l[2],d:l[3],e:l[4],f:l[5]}:new DOMMatrix(l);n.setTransform(f)}return n}}_getLinearGradient(){return this._getCache(mm,this.__getLinearGradient)}__getLinearGradient(){var e=this.fillLinearGradientColorStops();if(e){for(var n=Sd(),a=this.fillLinearGradientStartPoint(),l=this.fillLinearGradientEndPoint(),f=n.createLinearGradient(a.x,a.y,l.x,l.y),h=0;h<e.length;h+=2)f.addColorStop(e[h],e[h+1]);return f}}_getRadialGradient(){return this._getCache(_m,this.__getRadialGradient)}__getRadialGradient(){var e=this.fillRadialGradientColorStops();if(e){for(var n=Sd(),a=this.fillRadialGradientStartPoint(),l=this.fillRadialGradientEndPoint(),f=n.createRadialGradient(a.x,a.y,this.fillRadialGradientStartRadius(),l.x,l.y,this.fillRadialGradientEndRadius()),h=0;h<e.length;h+=2)f.addColorStop(e[h],e[h+1]);return f}}getShadowRGBA(){return this._getCache(gm,this._getShadowRGBA)}_getShadowRGBA(){if(this.hasShadow()){var e=ee.colorToRGBA(this.shadowColor());return"rgba("+e.r+","+e.g+","+e.b+","+e.a*(this.shadowOpacity()||1)+")"}}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const e=this.hitStrokeWidth();return e==="auto"?this.hasStroke():this.strokeEnabled()&&!!e}intersects(e){var n=this.getStage(),a=n.bufferHitCanvas,l;return a.getContext().clear(),this.drawHit(a,null,!0),l=a.context.getImageData(Math.round(e.x),Math.round(e.y),1,1).data,l[3]>0}destroy(){return we.prototype.destroy.call(this),delete Wl[this.colorKey],delete this.colorKey,this}_useBufferCanvas(e){var n;if(!this.getStage()||!((n=this.attrs.perfectDrawEnabled)!==null&&n!==void 0?n:!0))return!1;const l=e||this.hasFill(),f=this.hasStroke(),h=this.getAbsoluteOpacity()!==1;if(l&&f&&h)return!0;const v=this.hasShadow(),d=this.shadowForStrokeEnabled();return!!(l&&f&&v&&d)}setStrokeHitEnabled(e){ee.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),e?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){var e=this.size();return{x:this._centroid?-e.width/2:0,y:this._centroid?-e.height/2:0,width:e.width,height:e.height}}getClientRect(e={}){const n=e.skipTransform,a=e.relativeTo,l=this.getSelfRect(),h=!e.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,v=l.width+h,d=l.height+h,p=!e.skipShadow&&this.hasShadow(),S=p?this.shadowOffsetX():0,E=p?this.shadowOffsetY():0,A=v+Math.abs(S),O=d+Math.abs(E),k=p&&this.shadowBlur()||0,T=A+k*2,x=O+k*2,G={width:T,height:x,x:-(h/2+k)+Math.min(S,0)+l.x,y:-(h/2+k)+Math.min(E,0)+l.y};return n?G:this._transformedRect(G,a)}drawScene(e,n){var a=this.getLayer(),l=e||a.getCanvas(),f=l.getContext(),h=this._getCanvasCache(),v=this.getSceneFunc(),d=this.hasShadow(),p,S,E,A=l.isCache,O=n===this;if(!this.isVisible()&&!O)return this;if(h){f.save();var k=this.getAbsoluteTransform(n).getMatrix();return f.transform(k[0],k[1],k[2],k[3],k[4],k[5]),this._drawCachedSceneCanvas(f),f.restore(),this}if(!v)return this;if(f.save(),this._useBufferCanvas()&&!A){p=this.getStage(),S=p.bufferCanvas,E=S.getContext(),E.clear(),E.save(),E._applyLineJoin(this);var T=this.getAbsoluteTransform(n).getMatrix();E.transform(T[0],T[1],T[2],T[3],T[4],T[5]),v.call(this,E,this),E.restore();var x=S.pixelRatio;d&&f._applyShadow(this),f._applyOpacity(this),f._applyGlobalCompositeOperation(this),f.drawImage(S._canvas,0,0,S.width/x,S.height/x)}else{if(f._applyLineJoin(this),!O){var T=this.getAbsoluteTransform(n).getMatrix();f.transform(T[0],T[1],T[2],T[3],T[4],T[5]),f._applyOpacity(this),f._applyGlobalCompositeOperation(this)}d&&f._applyShadow(this),v.call(this,f,this)}return f.restore(),this}drawHit(e,n,a=!1){if(!this.shouldDrawHit(n,a))return this;var l=this.getLayer(),f=e||l.hitCanvas,h=f&&f.getContext(),v=this.hitFunc()||this.sceneFunc(),d=this._getCanvasCache(),p=d&&d.hit;if(this.colorKey||ee.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),p){h.save();var S=this.getAbsoluteTransform(n).getMatrix();return h.transform(S[0],S[1],S[2],S[3],S[4],S[5]),this._drawCachedHitCanvas(h),h.restore(),this}if(!v)return this;if(h.save(),h._applyLineJoin(this),!(this===n)){var A=this.getAbsoluteTransform(n).getMatrix();h.transform(A[0],A[1],A[2],A[3],A[4],A[5])}return v.call(this,h,this),h.restore(),this}drawHitFromCache(e=0){var n=this._getCanvasCache(),a=this._getCachedSceneCanvas(),l=n.hit,f=l.getContext(),h=l.getWidth(),v=l.getHeight(),d,p,S,E,A,O;f.clear(),f.drawImage(a._canvas,0,0,h,v);try{for(d=f.getImageData(0,0,h,v),p=d.data,S=p.length,E=ee._hexToRgb(this.colorKey),A=0;A<S;A+=4)O=p[A+3],O>e?(p[A]=E.r,p[A+1]=E.g,p[A+2]=E.b,p[A+3]=255):p[A+3]=0;f.putImageData(d,0,0)}catch(k){ee.error("Unable to draw hit graph from cached scene canvas. "+k.message)}return this}hasPointerCapture(e){return nm(e,this)}setPointerCapture(e){im(e,this)}releaseCapture(e){Gl(e)}}me.prototype._fillFunc=S3;me.prototype._strokeFunc=T3;me.prototype._fillFuncHit=C3;me.prototype._strokeFuncHit=E3;me.prototype._centroid=!1;me.prototype.nodeType="Shape";Yt(me);me.prototype.eventListeners={};me.prototype.on.call(me.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",A3);me.prototype.on.call(me.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",w3);me.prototype.on.call(me.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",k3);me.prototype.on.call(me.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",O3);me.prototype.on.call(me.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",x3);F.addGetterSetter(me,"stroke",void 0,tm());F.addGetterSetter(me,"strokeWidth",2,Ae());F.addGetterSetter(me,"fillAfterStrokeEnabled",!1);F.addGetterSetter(me,"hitStrokeWidth","auto",$v());F.addGetterSetter(me,"strokeHitEnabled",!0,Gn());F.addGetterSetter(me,"perfectDrawEnabled",!0,Gn());F.addGetterSetter(me,"shadowForStrokeEnabled",!0,Gn());F.addGetterSetter(me,"lineJoin");F.addGetterSetter(me,"lineCap");F.addGetterSetter(me,"sceneFunc");F.addGetterSetter(me,"hitFunc");F.addGetterSetter(me,"dash");F.addGetterSetter(me,"dashOffset",0,Ae());F.addGetterSetter(me,"shadowColor",void 0,Ss());F.addGetterSetter(me,"shadowBlur",0,Ae());F.addGetterSetter(me,"shadowOpacity",1,Ae());F.addComponentsGetterSetter(me,"shadowOffset",["x","y"]);F.addGetterSetter(me,"shadowOffsetX",0,Ae());F.addGetterSetter(me,"shadowOffsetY",0,Ae());F.addGetterSetter(me,"fillPatternImage");F.addGetterSetter(me,"fill",void 0,tm());F.addGetterSetter(me,"fillPatternX",0,Ae());F.addGetterSetter(me,"fillPatternY",0,Ae());F.addGetterSetter(me,"fillLinearGradientColorStops");F.addGetterSetter(me,"strokeLinearGradientColorStops");F.addGetterSetter(me,"fillRadialGradientStartRadius",0);F.addGetterSetter(me,"fillRadialGradientEndRadius",0);F.addGetterSetter(me,"fillRadialGradientColorStops");F.addGetterSetter(me,"fillPatternRepeat","repeat");F.addGetterSetter(me,"fillEnabled",!0);F.addGetterSetter(me,"strokeEnabled",!0);F.addGetterSetter(me,"shadowEnabled",!0);F.addGetterSetter(me,"dashEnabled",!0);F.addGetterSetter(me,"strokeScaleEnabled",!0);F.addGetterSetter(me,"fillPriority","color");F.addComponentsGetterSetter(me,"fillPatternOffset",["x","y"]);F.addGetterSetter(me,"fillPatternOffsetX",0,Ae());F.addGetterSetter(me,"fillPatternOffsetY",0,Ae());F.addComponentsGetterSetter(me,"fillPatternScale",["x","y"]);F.addGetterSetter(me,"fillPatternScaleX",1,Ae());F.addGetterSetter(me,"fillPatternScaleY",1,Ae());F.addComponentsGetterSetter(me,"fillLinearGradientStartPoint",["x","y"]);F.addComponentsGetterSetter(me,"strokeLinearGradientStartPoint",["x","y"]);F.addGetterSetter(me,"fillLinearGradientStartPointX",0);F.addGetterSetter(me,"strokeLinearGradientStartPointX",0);F.addGetterSetter(me,"fillLinearGradientStartPointY",0);F.addGetterSetter(me,"strokeLinearGradientStartPointY",0);F.addComponentsGetterSetter(me,"fillLinearGradientEndPoint",["x","y"]);F.addComponentsGetterSetter(me,"strokeLinearGradientEndPoint",["x","y"]);F.addGetterSetter(me,"fillLinearGradientEndPointX",0);F.addGetterSetter(me,"strokeLinearGradientEndPointX",0);F.addGetterSetter(me,"fillLinearGradientEndPointY",0);F.addGetterSetter(me,"strokeLinearGradientEndPointY",0);F.addComponentsGetterSetter(me,"fillRadialGradientStartPoint",["x","y"]);F.addGetterSetter(me,"fillRadialGradientStartPointX",0);F.addGetterSetter(me,"fillRadialGradientStartPointY",0);F.addComponentsGetterSetter(me,"fillRadialGradientEndPoint",["x","y"]);F.addGetterSetter(me,"fillRadialGradientEndPointX",0);F.addGetterSetter(me,"fillRadialGradientEndPointY",0);F.addGetterSetter(me,"fillPatternRotation",0);F.backCompat(me,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"});var R3="#",P3="beforeDraw",L3="draw",bm=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],I3=bm.length;class ro extends en{constructor(e){super(e);this.canvas=new Jo,this.hitCanvas=new Gv({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(e){return this.getContext().clear(e),this.getHitCanvas().getContext().clear(e),this}setZIndex(e){super.setZIndex(e);var n=this.getStage();return n&&n.content&&(n.content.removeChild(this.getNativeCanvasElement()),e<n.children.length-1?n.content.insertBefore(this.getNativeCanvasElement(),n.children[e+1].getCanvas()._canvas):n.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){we.prototype.moveToTop.call(this);var e=this.getStage();return e&&e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){var e=we.prototype.moveUp.call(this);if(!e)return!1;var n=this.getStage();return!n||!n.content?!1:(n.content.removeChild(this.getNativeCanvasElement()),this.index<n.children.length-1?n.content.insertBefore(this.getNativeCanvasElement(),n.children[this.index+1].getCanvas()._canvas):n.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(we.prototype.moveDown.call(this)){var e=this.getStage();if(e){var n=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),n[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(we.prototype.moveToBottom.call(this)){var e=this.getStage();if(e){var n=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),n[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){var e=this.getNativeCanvasElement();return we.prototype.remove.call(this),e&&e.parentNode&&ee._isInDocument(e)&&e.parentNode.removeChild(e),this}getStage(){return this.parent}setSize({width:e,height:n}){return this.canvas.setSize(e,n),this.hitCanvas.setSize(e,n),this._setSmoothEnabled(),this}_validateAdd(e){var n=e.getType();n!=="Group"&&n!=="Shape"&&ee.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(e){return e=e||{},e.width=e.width||this.getWidth(),e.height=e.height||this.getHeight(),e.x=e.x!==void 0?e.x:this.x(),e.y=e.y!==void 0?e.y:this.y(),we.prototype._toKonvaCanvas.call(this,e)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){ee.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){ee.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,ee.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(e){if(!this.isListening()||!this.isVisible())return null;for(var n=1,a=!1;;){for(let l=0;l<I3;l++){const f=bm[l],h=this._getIntersection({x:e.x+f.x*n,y:e.y+f.y*n}),v=h.shape;if(v)return v;if(a=!!h.antialiased,!h.antialiased)break}if(a)n+=1;else return null}}_getIntersection(e){const n=this.hitCanvas.pixelRatio,a=this.hitCanvas.context.getImageData(Math.round(e.x*n),Math.round(e.y*n),1,1).data,l=a[3];if(l===255){const f=ee._rgbToHex(a[0],a[1],a[2]),h=Wl[R3+f];return h?{shape:h}:{antialiased:!0}}else if(l>0)return{antialiased:!0};return{}}drawScene(e,n){var a=this.getLayer(),l=e||a&&a.getCanvas();return this._fire(P3,{node:this}),this.clearBeforeDraw()&&l.getContext().clear(),en.prototype.drawScene.call(this,l,n),this._fire(L3,{node:this}),this}drawHit(e,n){var a=this.getLayer(),l=e||a&&a.hitCanvas;return a&&a.clearBeforeDraw()&&a.getHitCanvas().getContext().clear(),en.prototype.drawHit.call(this,l,n),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(e){ee.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(e)}getHitGraphEnabled(e){return ee.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!(!this.parent||!this.parent.content)){var e=this.parent,n=!!this.hitCanvas._canvas.parentNode;n?e.content.removeChild(this.hitCanvas._canvas):e.content.appendChild(this.hitCanvas._canvas)}}}ro.prototype.nodeType="Layer";Yt(ro);F.addGetterSetter(ro,"imageSmoothingEnabled",!0);F.addGetterSetter(ro,"clearBeforeDraw",!0);F.addGetterSetter(ro,"hitGraphEnabled",!0,Gn());class Bv extends ro{constructor(e){super(e);this.listening(!1),ee.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}Bv.prototype.nodeType="FastLayer";Yt(Bv);class ss extends en{_validateAdd(e){var n=e.getType();n!=="Group"&&n!=="Shape"&&ee.throw("You may only add groups and shapes to groups.")}}ss.prototype.nodeType="Group";Yt(ss);var Td=function(){return Qo.performance&&Qo.performance.now?function(){return Qo.performance.now()}:function(){return new Date().getTime()}}();class vn{constructor(e,n){this.id=vn.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:Td(),frameRate:0},this.func=e,this.setLayers(n)}setLayers(e){var n=[];return e?e.length>0?n=e:n=[e]:n=[],this.layers=n,this}getLayers(){return this.layers}addLayer(e){var n=this.layers,a=n.length,l;for(l=0;l<a;l++)if(n[l]._id===e._id)return!1;return this.layers.push(e),!0}isRunning(){var e=vn,n=e.animations,a=n.length,l;for(l=0;l<a;l++)if(n[l].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=Td(),vn._addAnimation(this),this}stop(){return vn._removeAnimation(this),this}_updateFrameObject(e){this.frame.timeDiff=e-this.frame.lastTime,this.frame.lastTime=e,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(e){this.animations.push(e),this._handleAnimation()}static _removeAnimation(e){var n=e.id,a=this.animations,l=a.length,f;for(f=0;f<l;f++)if(a[f].id===n){this.animations.splice(f,1);break}}static _runFrames(){var e={},n=this.animations,a,l,f,h,v,d,p,S,E;for(h=0;h<n.length;h++)if(a=n[h],l=a.layers,f=a.func,a._updateFrameObject(Td()),d=l.length,f?E=f.call(a,a.frame)!==!1:E=!0,!!E)for(v=0;v<d;v++)p=l[v],p._id!==void 0&&(e[p._id]=p);for(S in e)!e.hasOwnProperty(S)||e[S].batchDraw()}static _animationLoop(){var e=vn;e.animations.length?(e._runFrames(),ee.requestAnimFrame(e._animationLoop)):e.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,ee.requestAnimFrame(this._animationLoop))}}vn.animations=[];vn.animIdCounter=0;vn.animRunning=!1;var N3={node:1,duration:1,easing:1,onFinish:1,yoyo:1},M3=1,Mg=2,Dg=3,D3=0,Fg=["fill","stroke","shadowColor"];class F3{constructor(e,n,a,l,f,h,v){this.prop=e,this.propFunc=n,this.begin=l,this._pos=l,this.duration=h,this._change=0,this.prevPos=0,this.yoyo=v,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=a,this._change=f-this.begin,this.pause()}fire(e){var n=this[e];n&&n()}setTime(e){e>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():e<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=e,this.update())}getTime(){return this._time}setPosition(e){this.prevPos=this._pos,this.propFunc(e),this._pos=e}getPosition(e){return e===void 0&&(e=this._time),this.func(e,this.begin,this._change,this.duration)}play(){this.state=Mg,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=Dg,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(e){this.pause(),this._time=e,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){var e=this.getTimer()-this._startTime;this.state===Mg?this.setTime(e):this.state===Dg&&this.setTime(this.duration-e)}pause(){this.state=M3,this.fire("onPause")}getTimer(){return new Date().getTime()}}class rr{constructor(e){var n=this,a=e.node,l=a._id,f,h=e.easing||Bl.Linear,v=!!e.yoyo,d;typeof e.duration=="undefined"?f=.3:e.duration===0?f=.001:f=e.duration,this.node=a,this._id=D3++;var p=a.getLayer()||(a instanceof De.Stage?a.getLayers():null);p||ee.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new vn(function(){n.tween.onEnterFrame()},p),this.tween=new F3(d,function(S){n._tweenFunc(S)},h,0,1,f*1e3,v),this._addListeners(),rr.attrs[l]||(rr.attrs[l]={}),rr.attrs[l][this._id]||(rr.attrs[l][this._id]={}),rr.tweens[l]||(rr.tweens[l]={});for(d in e)N3[d]===void 0&&this._addAttr(d,e[d]);this.reset(),this.onFinish=e.onFinish,this.onReset=e.onReset,this.onUpdate=e.onUpdate}_addAttr(e,n){var a=this.node,l=a._id,f,h,v,d,p,S,E,A;if(v=rr.tweens[l][e],v&&delete rr.attrs[l][v][e],f=a.getAttr(e),ee._isArray(n))if(h=[],p=Math.max(n.length,f.length),e==="points"&&n.length!==f.length&&(n.length>f.length?(E=f,f=ee._prepareArrayForTween(f,n,a.closed())):(S=n,n=ee._prepareArrayForTween(n,f,a.closed()))),e.indexOf("fill")===0)for(d=0;d<p;d++)if(d%2===0)h.push(n[d]-f[d]);else{var O=ee.colorToRGBA(f[d]);A=ee.colorToRGBA(n[d]),f[d]=O,h.push({r:A.r-O.r,g:A.g-O.g,b:A.b-O.b,a:A.a-O.a})}else for(d=0;d<p;d++)h.push(n[d]-f[d]);else Fg.indexOf(e)!==-1?(f=ee.colorToRGBA(f),A=ee.colorToRGBA(n),h={r:A.r-f.r,g:A.g-f.g,b:A.b-f.b,a:A.a-f.a}):h=n-f;rr.attrs[l][this._id][e]={start:f,diff:h,end:n,trueEnd:S,trueStart:E},rr.tweens[l][e]=this._id}_tweenFunc(e){var n=this.node,a=rr.attrs[n._id][this._id],l,f,h,v,d,p,S,E;for(l in a){if(f=a[l],h=f.start,v=f.diff,E=f.end,ee._isArray(h))if(d=[],S=Math.max(h.length,E.length),l.indexOf("fill")===0)for(p=0;p<S;p++)p%2===0?d.push((h[p]||0)+v[p]*e):d.push("rgba("+Math.round(h[p].r+v[p].r*e)+","+Math.round(h[p].g+v[p].g*e)+","+Math.round(h[p].b+v[p].b*e)+","+(h[p].a+v[p].a*e)+")");else for(p=0;p<S;p++)d.push((h[p]||0)+v[p]*e);else Fg.indexOf(l)!==-1?d="rgba("+Math.round(h.r+v.r*e)+","+Math.round(h.g+v.g*e)+","+Math.round(h.b+v.b*e)+","+(h.a+v.a*e)+")":d=h+v*e;n.setAttr(l,d)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{var e=this.node,n=rr.attrs[e._id][this._id];n.points&&n.points.trueEnd&&e.setAttr("points",n.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{var e=this.node,n=rr.attrs[e._id][this._id];n.points&&n.points.trueStart&&e.points(n.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(e){return this.tween.seek(e*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){var e=this.node._id,n=this._id,a=rr.tweens[e],l;this.pause();for(l in a)delete rr.tweens[e][l];delete rr.attrs[e][n]}}rr.attrs={};rr.tweens={};we.prototype.to=function(r){var e=r.onFinish;r.node=this,r.onFinish=function(){this.destroy(),e&&e()};var n=new rr(r);n.play()};const Bl={BackEaseIn(r,e,n,a){var l=1.70158;return n*(r/=a)*r*((l+1)*r-l)+e},BackEaseOut(r,e,n,a){var l=1.70158;return n*((r=r/a-1)*r*((l+1)*r+l)+1)+e},BackEaseInOut(r,e,n,a){var l=1.70158;return(r/=a/2)<1?n/2*(r*r*(((l*=1.525)+1)*r-l))+e:n/2*((r-=2)*r*(((l*=1.525)+1)*r+l)+2)+e},ElasticEaseIn(r,e,n,a,l,f){var h=0;return r===0?e:(r/=a)===1?e+n:(f||(f=a*.3),!l||l<Math.abs(n)?(l=n,h=f/4):h=f/(2*Math.PI)*Math.asin(n/l),-(l*Math.pow(2,10*(r-=1))*Math.sin((r*a-h)*(2*Math.PI)/f))+e)},ElasticEaseOut(r,e,n,a,l,f){var h=0;return r===0?e:(r/=a)===1?e+n:(f||(f=a*.3),!l||l<Math.abs(n)?(l=n,h=f/4):h=f/(2*Math.PI)*Math.asin(n/l),l*Math.pow(2,-10*r)*Math.sin((r*a-h)*(2*Math.PI)/f)+n+e)},ElasticEaseInOut(r,e,n,a,l,f){var h=0;return r===0?e:(r/=a/2)===2?e+n:(f||(f=a*(.3*1.5)),!l||l<Math.abs(n)?(l=n,h=f/4):h=f/(2*Math.PI)*Math.asin(n/l),r<1?-.5*(l*Math.pow(2,10*(r-=1))*Math.sin((r*a-h)*(2*Math.PI)/f))+e:l*Math.pow(2,-10*(r-=1))*Math.sin((r*a-h)*(2*Math.PI)/f)*.5+n+e)},BounceEaseOut(r,e,n,a){return(r/=a)<1/2.75?n*(7.5625*r*r)+e:r<2/2.75?n*(7.5625*(r-=1.5/2.75)*r+.75)+e:r<2.5/2.75?n*(7.5625*(r-=2.25/2.75)*r+.9375)+e:n*(7.5625*(r-=2.625/2.75)*r+.984375)+e},BounceEaseIn(r,e,n,a){return n-Bl.BounceEaseOut(a-r,0,n,a)+e},BounceEaseInOut(r,e,n,a){return r<a/2?Bl.BounceEaseIn(r*2,0,n,a)*.5+e:Bl.BounceEaseOut(r*2-a,0,n,a)*.5+n*.5+e},EaseIn(r,e,n,a){return n*(r/=a)*r+e},EaseOut(r,e,n,a){return-n*(r/=a)*(r-2)+e},EaseInOut(r,e,n,a){return(r/=a/2)<1?n/2*r*r+e:-n/2*(--r*(r-2)-1)+e},StrongEaseIn(r,e,n,a){return n*(r/=a)*r*r*r*r+e},StrongEaseOut(r,e,n,a){return n*((r=r/a-1)*r*r*r*r+1)+e},StrongEaseInOut(r,e,n,a){return(r/=a/2)<1?n/2*r*r*r*r*r+e:n/2*((r-=2)*r*r*r*r+2)+e},Linear(r,e,n,a){return n*r/a+e}},$g=ee._assign(De,{Util:ee,Transform:Jr,Node:we,Container:en,Stage:ac,stages:fh,Layer:ro,FastLayer:Bv,Group:ss,DD:gt,Shape:me,shapes:Wl,Animation:vn,Tween:rr,Easings:Bl,Context:nc,Canvas:ic});class Fi extends me{_sceneFunc(e){var n=De.getAngle(this.angle()),a=this.clockwise();e.beginPath(),e.arc(0,0,this.outerRadius(),0,n,a),e.arc(0,0,this.innerRadius(),n,0,!a),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}getSelfRect(){const e=this.innerRadius(),n=this.outerRadius(),a=this.clockwise(),l=De.getAngle(a?360-this.angle():this.angle()),f=Math.cos(Math.min(l,Math.PI)),h=1,v=Math.sin(Math.min(Math.max(Math.PI,l),3*Math.PI/2)),d=Math.sin(Math.min(l,Math.PI/2)),p=f*(f>0?e:n),S=h*n,E=v*(v>0?e:n),A=d*(d>0?n:e);return{x:p,y:a?-1*A:E,width:S-p,height:A-E}}}Fi.prototype._centroid=!0;Fi.prototype.className="Arc";Fi.prototype._attrsAffectingSize=["innerRadius","outerRadius"];Yt(Fi);F.addGetterSetter(Fi,"innerRadius",0,Ae());F.addGetterSetter(Fi,"outerRadius",0,Ae());F.addGetterSetter(Fi,"angle",0,Ae());F.addGetterSetter(Fi,"clockwise",!1,Gn());function zd(r,e,n,a,l,f,h){var v=Math.sqrt(Math.pow(n-r,2)+Math.pow(a-e,2)),d=Math.sqrt(Math.pow(l-n,2)+Math.pow(f-a,2)),p=h*v/(v+d),S=h*d/(v+d),E=n-p*(l-r),A=a-p*(f-e),O=n+S*(l-r),k=a+S*(f-e);return[E,A,O,k]}function Gg(r,e){var n=r.length,a=[],l,f;for(l=2;l<n-2;l+=2)f=zd(r[l-2],r[l-1],r[l],r[l+1],r[l+2],r[l+3],e),!isNaN(f[0])&&(a.push(f[0]),a.push(f[1]),a.push(r[l]),a.push(r[l+1]),a.push(f[2]),a.push(f[3]));return a}class $i extends me{constructor(e){super(e);this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(e){var n=this.points(),a=n.length,l=this.tension(),f=this.closed(),h=this.bezier(),v,d,p;if(!!a){if(e.beginPath(),e.moveTo(n[0],n[1]),l!==0&&a>4){for(v=this.getTensionPoints(),d=v.length,p=f?0:4,f||e.quadraticCurveTo(v[0],v[1],v[2],v[3]);p<d-2;)e.bezierCurveTo(v[p++],v[p++],v[p++],v[p++],v[p++],v[p++]);f||e.quadraticCurveTo(v[d-2],v[d-1],n[a-2],n[a-1])}else if(h)for(p=2;p<a;)e.bezierCurveTo(n[p++],n[p++],n[p++],n[p++],n[p++],n[p++]);else for(p=2;p<a;p+=2)e.lineTo(n[p],n[p+1]);f?(e.closePath(),e.fillStrokeShape(this)):e.strokeShape(this)}}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():Gg(this.points(),this.tension())}_getTensionPointsClosed(){var e=this.points(),n=e.length,a=this.tension(),l=zd(e[n-2],e[n-1],e[0],e[1],e[2],e[3],a),f=zd(e[n-4],e[n-3],e[n-2],e[n-1],e[0],e[1],a),h=Gg(e,a),v=[l[2],l[3]].concat(h).concat([f[0],f[1],e[n-2],e[n-1],f[2],f[3],l[0],l[1],e[0],e[1]]);return v}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){var e=this.points();if(e.length<4)return{x:e[0]||0,y:e[1]||0,width:0,height:0};this.tension()!==0?e=[e[0],e[1],...this._getTensionPoints(),e[e.length-2],e[e.length-1]]:e=this.points();for(var n=e[0],a=e[0],l=e[1],f=e[1],h,v,d=0;d<e.length/2;d++)h=e[d*2],v=e[d*2+1],n=Math.min(n,h),a=Math.max(a,h),l=Math.min(l,v),f=Math.max(f,v);return{x:n,y:l,width:a-n,height:f-l}}}$i.prototype.className="Line";$i.prototype._attrsAffectingSize=["points","bezier","tension"];Yt($i);F.addGetterSetter($i,"closed",!1);F.addGetterSetter($i,"bezier",!1);F.addGetterSetter($i,"tension",0,Ae());F.addGetterSetter($i,"points",[],XD());class wt extends me{constructor(e){super(e);this.dataArray=[],this.pathLength=0,this.dataArray=wt.parsePathData(this.data()),this.pathLength=0;for(var n=0;n<this.dataArray.length;++n)this.pathLength+=this.dataArray[n].pathLength;this.on("dataChange.konva",function(){this.dataArray=wt.parsePathData(this.data()),this.pathLength=0;for(var a=0;a<this.dataArray.length;++a)this.pathLength+=this.dataArray[a].pathLength})}_sceneFunc(e){var n=this.dataArray;e.beginPath();for(var a=!1,l=0;l<n.length;l++){var f=n[l].command,h=n[l].points;switch(f){case"L":e.lineTo(h[0],h[1]);break;case"M":e.moveTo(h[0],h[1]);break;case"C":e.bezierCurveTo(h[0],h[1],h[2],h[3],h[4],h[5]);break;case"Q":e.quadraticCurveTo(h[0],h[1],h[2],h[3]);break;case"A":var v=h[0],d=h[1],p=h[2],S=h[3],E=h[4],A=h[5],O=h[6],k=h[7],T=p>S?p:S,x=p>S?1:p/S,G=p>S?S/p:1;e.translate(v,d),e.rotate(O),e.scale(x,G),e.arc(0,0,T,E,E+A,1-k),e.scale(1/x,1/G),e.rotate(-O),e.translate(-v,-d);break;case"z":a=!0,e.closePath();break}}!a&&!this.hasFill()?e.strokeShape(this):e.fillStrokeShape(this)}getSelfRect(){var e=[];this.dataArray.forEach(function(p){if(p.command==="A"){var S=p.points[4],E=p.points[5],A=p.points[4]+E,O=Math.PI/180;if(Math.abs(S-A)<O&&(O=Math.abs(S-A)),E<0)for(let k=S-O;k>A;k-=O){const T=wt.getPointOnEllipticalArc(p.points[0],p.points[1],p.points[2],p.points[3],k,0);e.push(T.x,T.y)}else for(let k=S+O;k<A;k+=O){const T=wt.getPointOnEllipticalArc(p.points[0],p.points[1],p.points[2],p.points[3],k,0);e.push(T.x,T.y)}}else if(p.command==="C")for(let k=0;k<=1;k+=.01){const T=wt.getPointOnCubicBezier(k,p.start.x,p.start.y,p.points[0],p.points[1],p.points[2],p.points[3],p.points[4],p.points[5]);e.push(T.x,T.y)}else e=e.concat(p.points)});for(var n=e[0],a=e[0],l=e[1],f=e[1],h,v,d=0;d<e.length/2;d++)h=e[d*2],v=e[d*2+1],isNaN(h)||(n=Math.min(n,h),a=Math.max(a,h)),isNaN(v)||(l=Math.min(l,v),f=Math.max(f,v));return{x:n,y:l,width:a-n,height:f-l}}getLength(){return this.pathLength}getPointAtLength(e){var n,a=0,l=this.dataArray.length;if(!l)return null;for(;a<l&&e>this.dataArray[a].pathLength;)e-=this.dataArray[a].pathLength,++a;if(a===l)return n=this.dataArray[a-1].points.slice(-2),{x:n[0],y:n[1]};if(e<.01)return n=this.dataArray[a].points.slice(0,2),{x:n[0],y:n[1]};var f=this.dataArray[a],h=f.points;switch(f.command){case"L":return wt.getPointOnLine(e,f.start.x,f.start.y,h[0],h[1]);case"C":return wt.getPointOnCubicBezier(e/f.pathLength,f.start.x,f.start.y,h[0],h[1],h[2],h[3],h[4],h[5]);case"Q":return wt.getPointOnQuadraticBezier(e/f.pathLength,f.start.x,f.start.y,h[0],h[1],h[2],h[3]);case"A":var v=h[0],d=h[1],p=h[2],S=h[3],E=h[4],A=h[5],O=h[6];return E+=A*e/f.pathLength,wt.getPointOnEllipticalArc(v,d,p,S,E,O)}return null}static getLineLength(e,n,a,l){return Math.sqrt((a-e)*(a-e)+(l-n)*(l-n))}static getPointOnLine(e,n,a,l,f,h,v){h===void 0&&(h=n),v===void 0&&(v=a);var d=(f-a)/(l-n+1e-8),p=Math.sqrt(e*e/(1+d*d));l<n&&(p*=-1);var S=d*p,E;if(l===n)E={x:h,y:v+S};else if((v-a)/(h-n+1e-8)===d)E={x:h+p,y:v+S};else{var A,O,k=this.getLineLength(n,a,l,f),T=(h-n)*(l-n)+(v-a)*(f-a);T=T/(k*k),A=n+T*(l-n),O=a+T*(f-a);var x=this.getLineLength(h,v,A,O),G=Math.sqrt(e*e-x*x);p=Math.sqrt(G*G/(1+d*d)),l<n&&(p*=-1),S=d*p,E={x:A+p,y:O+S}}return E}static getPointOnCubicBezier(e,n,a,l,f,h,v,d,p){function S(x){return x*x*x}function E(x){return 3*x*x*(1-x)}function A(x){return 3*x*(1-x)*(1-x)}function O(x){return(1-x)*(1-x)*(1-x)}var k=d*S(e)+h*E(e)+l*A(e)+n*O(e),T=p*S(e)+v*E(e)+f*A(e)+a*O(e);return{x:k,y:T}}static getPointOnQuadraticBezier(e,n,a,l,f,h,v){function d(O){return O*O}function p(O){return 2*O*(1-O)}function S(O){return(1-O)*(1-O)}var E=h*d(e)+l*p(e)+n*S(e),A=v*d(e)+f*p(e)+a*S(e);return{x:E,y:A}}static getPointOnEllipticalArc(e,n,a,l,f,h){var v=Math.cos(h),d=Math.sin(h),p={x:a*Math.cos(f),y:l*Math.sin(f)};return{x:e+(p.x*v-p.y*d),y:n+(p.x*d+p.y*v)}}static parsePathData(e){if(!e)return[];var n=e,a=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];n=n.replace(new RegExp(" ","g"),",");for(var l=0;l<a.length;l++)n=n.replace(new RegExp(a[l],"g"),"|"+a[l]);var f=n.split("|"),h=[],v=[],d=0,p=0,S=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi,E;for(l=1;l<f.length;l++){var A=f[l],O=A.charAt(0);for(A=A.slice(1),v.length=0;E=S.exec(A);)v.push(E[0]);for(var k=[],T=0,x=v.length;T<x;T++){if(v[T]==="00"){k.push(0,0);continue}var G=parseFloat(v[T]);isNaN(G)?k.push(0):k.push(G)}for(;k.length>0&&!isNaN(k[0]);){var j=null,B=[],U=d,J=p,P,I,D,R,Y,re,se,Q,q,Ce;switch(O){case"l":d+=k.shift(),p+=k.shift(),j="L",B.push(d,p);break;case"L":d=k.shift(),p=k.shift(),B.push(d,p);break;case"m":var K=k.shift(),ne=k.shift();if(d+=K,p+=ne,j="M",h.length>2&&h[h.length-1].command==="z"){for(var te=h.length-2;te>=0;te--)if(h[te].command==="M"){d=h[te].points[0]+K,p=h[te].points[1]+ne;break}}B.push(d,p),O="l";break;case"M":d=k.shift(),p=k.shift(),j="M",B.push(d,p),O="L";break;case"h":d+=k.shift(),j="L",B.push(d,p);break;case"H":d=k.shift(),j="L",B.push(d,p);break;case"v":p+=k.shift(),j="L",B.push(d,p);break;case"V":p=k.shift(),j="L",B.push(d,p);break;case"C":B.push(k.shift(),k.shift(),k.shift(),k.shift()),d=k.shift(),p=k.shift(),B.push(d,p);break;case"c":B.push(d+k.shift(),p+k.shift(),d+k.shift(),p+k.shift()),d+=k.shift(),p+=k.shift(),j="C",B.push(d,p);break;case"S":I=d,D=p,P=h[h.length-1],P.command==="C"&&(I=d+(d-P.points[2]),D=p+(p-P.points[3])),B.push(I,D,k.shift(),k.shift()),d=k.shift(),p=k.shift(),j="C",B.push(d,p);break;case"s":I=d,D=p,P=h[h.length-1],P.command==="C"&&(I=d+(d-P.points[2]),D=p+(p-P.points[3])),B.push(I,D,d+k.shift(),p+k.shift()),d+=k.shift(),p+=k.shift(),j="C",B.push(d,p);break;case"Q":B.push(k.shift(),k.shift()),d=k.shift(),p=k.shift(),B.push(d,p);break;case"q":B.push(d+k.shift(),p+k.shift()),d+=k.shift(),p+=k.shift(),j="Q",B.push(d,p);break;case"T":I=d,D=p,P=h[h.length-1],P.command==="Q"&&(I=d+(d-P.points[0]),D=p+(p-P.points[1])),d=k.shift(),p=k.shift(),j="Q",B.push(I,D,d,p);break;case"t":I=d,D=p,P=h[h.length-1],P.command==="Q"&&(I=d+(d-P.points[0]),D=p+(p-P.points[1])),d+=k.shift(),p+=k.shift(),j="Q",B.push(I,D,d,p);break;case"A":R=k.shift(),Y=k.shift(),re=k.shift(),se=k.shift(),Q=k.shift(),q=d,Ce=p,d=k.shift(),p=k.shift(),j="A",B=this.convertEndpointToCenterParameterization(q,Ce,d,p,se,Q,R,Y,re);break;case"a":R=k.shift(),Y=k.shift(),re=k.shift(),se=k.shift(),Q=k.shift(),q=d,Ce=p,d+=k.shift(),p+=k.shift(),j="A",B=this.convertEndpointToCenterParameterization(q,Ce,d,p,se,Q,R,Y,re);break}h.push({command:j||O,points:B,start:{x:U,y:J},pathLength:this.calcLength(U,J,j||O,B)})}(O==="z"||O==="Z")&&h.push({command:"z",points:[],start:void 0,pathLength:0})}return h}static calcLength(e,n,a,l){var f,h,v,d,p=wt;switch(a){case"L":return p.getLineLength(e,n,l[0],l[1]);case"C":for(f=0,h=p.getPointOnCubicBezier(0,e,n,l[0],l[1],l[2],l[3],l[4],l[5]),d=.01;d<=1;d+=.01)v=p.getPointOnCubicBezier(d,e,n,l[0],l[1],l[2],l[3],l[4],l[5]),f+=p.getLineLength(h.x,h.y,v.x,v.y),h=v;return f;case"Q":for(f=0,h=p.getPointOnQuadraticBezier(0,e,n,l[0],l[1],l[2],l[3]),d=.01;d<=1;d+=.01)v=p.getPointOnQuadraticBezier(d,e,n,l[0],l[1],l[2],l[3]),f+=p.getLineLength(h.x,h.y,v.x,v.y),h=v;return f;case"A":f=0;var S=l[4],E=l[5],A=l[4]+E,O=Math.PI/180;if(Math.abs(S-A)<O&&(O=Math.abs(S-A)),h=p.getPointOnEllipticalArc(l[0],l[1],l[2],l[3],S,0),E<0)for(d=S-O;d>A;d-=O)v=p.getPointOnEllipticalArc(l[0],l[1],l[2],l[3],d,0),f+=p.getLineLength(h.x,h.y,v.x,v.y),h=v;else for(d=S+O;d<A;d+=O)v=p.getPointOnEllipticalArc(l[0],l[1],l[2],l[3],d,0),f+=p.getLineLength(h.x,h.y,v.x,v.y),h=v;return v=p.getPointOnEllipticalArc(l[0],l[1],l[2],l[3],A,0),f+=p.getLineLength(h.x,h.y,v.x,v.y),f}return 0}static convertEndpointToCenterParameterization(e,n,a,l,f,h,v,d,p){var S=p*(Math.PI/180),E=Math.cos(S)*(e-a)/2+Math.sin(S)*(n-l)/2,A=-1*Math.sin(S)*(e-a)/2+Math.cos(S)*(n-l)/2,O=E*E/(v*v)+A*A/(d*d);O>1&&(v*=Math.sqrt(O),d*=Math.sqrt(O));var k=Math.sqrt((v*v*(d*d)-v*v*(A*A)-d*d*(E*E))/(v*v*(A*A)+d*d*(E*E)));f===h&&(k*=-1),isNaN(k)&&(k=0);var T=k*v*A/d,x=k*-d*E/v,G=(e+a)/2+Math.cos(S)*T-Math.sin(S)*x,j=(n+l)/2+Math.sin(S)*T+Math.cos(S)*x,B=function(Y){return Math.sqrt(Y[0]*Y[0]+Y[1]*Y[1])},U=function(Y,re){return(Y[0]*re[0]+Y[1]*re[1])/(B(Y)*B(re))},J=function(Y,re){return(Y[0]*re[1]<Y[1]*re[0]?-1:1)*Math.acos(U(Y,re))},P=J([1,0],[(E-T)/v,(A-x)/d]),I=[(E-T)/v,(A-x)/d],D=[(-1*E-T)/v,(-1*A-x)/d],R=J(I,D);return U(I,D)<=-1&&(R=Math.PI),U(I,D)>=1&&(R=0),h===0&&R>0&&(R=R-2*Math.PI),h===1&&R<0&&(R=R+2*Math.PI),[G,j,v,d,P,R,S,h]}}wt.prototype.className="Path";wt.prototype._attrsAffectingSize=["data"];Yt(wt);F.addGetterSetter(wt,"data");class no extends $i{_sceneFunc(e){super._sceneFunc(e);var n=Math.PI*2,a=this.points(),l=a,f=this.tension()!==0&&a.length>4;f&&(l=this.getTensionPoints());var h=this.pointerLength(),v=a.length,d,p;if(f){const A=[l[l.length-4],l[l.length-3],l[l.length-2],l[l.length-1],a[v-2],a[v-1]],O=wt.calcLength(l[l.length-4],l[l.length-3],"C",A),k=wt.getPointOnQuadraticBezier(Math.min(1,1-h/O),A[0],A[1],A[2],A[3],A[4],A[5]);d=a[v-2]-k.x,p=a[v-1]-k.y}else d=a[v-2]-a[v-4],p=a[v-1]-a[v-3];var S=(Math.atan2(p,d)+n)%n,E=this.pointerWidth();this.pointerAtEnding()&&(e.save(),e.beginPath(),e.translate(a[v-2],a[v-1]),e.rotate(S),e.moveTo(0,0),e.lineTo(-h,E/2),e.lineTo(-h,-E/2),e.closePath(),e.restore(),this.__fillStroke(e)),this.pointerAtBeginning()&&(e.save(),e.beginPath(),e.translate(a[0],a[1]),f?(d=(l[0]+l[2])/2-a[0],p=(l[1]+l[3])/2-a[1]):(d=a[2]-a[0],p=a[3]-a[1]),e.rotate((Math.atan2(-p,-d)+n)%n),e.moveTo(0,0),e.lineTo(-h,E/2),e.lineTo(-h,-E/2),e.closePath(),e.restore(),this.__fillStroke(e))}__fillStroke(e){var n=this.dashEnabled();n&&(this.attrs.dashEnabled=!1,e.setLineDash([])),e.fillStrokeShape(this),n&&(this.attrs.dashEnabled=!0)}getSelfRect(){const e=super.getSelfRect(),n=this.pointerWidth()/2;return{x:e.x-n,y:e.y-n,width:e.width+n*2,height:e.height+n*2}}}no.prototype.className="Arrow";Yt(no);F.addGetterSetter(no,"pointerLength",10,Ae());F.addGetterSetter(no,"pointerWidth",10,Ae());F.addGetterSetter(no,"pointerAtBeginning",!1);F.addGetterSetter(no,"pointerAtEnding",!0);class Ts extends me{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius()!==e/2&&this.radius(e/2)}setHeight(e){this.radius()!==e/2&&this.radius(e/2)}}Ts.prototype._centroid=!0;Ts.prototype.className="Circle";Ts.prototype._attrsAffectingSize=["radius"];Yt(Ts);F.addGetterSetter(Ts,"radius",0,Ae());class ca extends me{_sceneFunc(e){var n=this.radiusX(),a=this.radiusY();e.beginPath(),e.save(),n!==a&&e.scale(1,a/n),e.arc(0,0,n,0,Math.PI*2,!1),e.restore(),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(e){this.radiusX(e/2)}setHeight(e){this.radiusY(e/2)}}ca.prototype.className="Ellipse";ca.prototype._centroid=!0;ca.prototype._attrsAffectingSize=["radiusX","radiusY"];Yt(ca);F.addComponentsGetterSetter(ca,"radius",["x","y"]);F.addGetterSetter(ca,"radiusX",0,Ae());F.addGetterSetter(ca,"radiusY",0,Ae());class Wn extends me{constructor(e){super(e);this.on("imageChange.konva",()=>{this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const e=this.image();e&&e.complete||e&&e.readyState===4||e&&e.addEventListener&&e.addEventListener("load",()=>{this._requestDraw()})}_useBufferCanvas(){return super._useBufferCanvas(!0)}_sceneFunc(e){const n=this.getWidth(),a=this.getHeight(),l=this.attrs.image;let f;if(l){const h=this.attrs.cropWidth,v=this.attrs.cropHeight;h&&v?f=[l,this.cropX(),this.cropY(),h,v,0,0,n,a]:f=[l,0,0,n,a]}(this.hasFill()||this.hasStroke())&&(e.beginPath(),e.rect(0,0,n,a),e.closePath(),e.fillStrokeShape(this)),l&&e.drawImage.apply(e,f)}_hitFunc(e){var n=this.width(),a=this.height();e.beginPath(),e.rect(0,0,n,a),e.closePath(),e.fillStrokeShape(this)}getWidth(){var e,n;return(e=this.attrs.width)!==null&&e!==void 0?e:(n=this.image())===null||n===void 0?void 0:n.width}getHeight(){var e,n;return(e=this.attrs.height)!==null&&e!==void 0?e:(n=this.image())===null||n===void 0?void 0:n.height}static fromURL(e,n,a=null){var l=ee.createImageElement();l.onload=function(){var f=new Wn({image:l});n(f)},l.onerror=a,l.crossOrigin="Anonymous",l.src=e}}Wn.prototype.className="Image";Yt(Wn);F.addGetterSetter(Wn,"image");F.addComponentsGetterSetter(Wn,"crop",["x","y","width","height"]);F.addGetterSetter(Wn,"cropX",0,Ae());F.addGetterSetter(Wn,"cropY",0,Ae());F.addGetterSetter(Wn,"cropWidth",0,Ae());F.addGetterSetter(Wn,"cropHeight",0,Ae());var Sm=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height"],$3="Change.konva",G3="none",jd="up",Yd="right",Xd="down",Kd="left",W3=Sm.length;class Uv extends ss{constructor(e){super(e);this.on("add.konva",function(n){this._addListeners(n.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(e){var n=this,a,l=function(){n._sync()};for(a=0;a<W3;a++)e.on(Sm[a]+$3,l)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){var e=this.getText(),n=this.getTag(),a,l,f,h,v,d,p;if(e&&n){switch(a=e.width(),l=e.height(),f=n.pointerDirection(),h=n.pointerWidth(),p=n.pointerHeight(),v=0,d=0,f){case jd:v=a/2,d=-1*p;break;case Yd:v=a+h,d=l/2;break;case Xd:v=a/2,d=l+p;break;case Kd:v=-1*h,d=l/2;break}n.setAttrs({x:-1*v,y:-1*d,width:a,height:l}),e.setAttrs({x:-1*v,y:-1*d})}}}Uv.prototype.className="Label";Yt(Uv);class io extends me{_sceneFunc(e){var n=this.width(),a=this.height(),l=this.pointerDirection(),f=this.pointerWidth(),h=this.pointerHeight(),v=this.cornerRadius();let d=0,p=0,S=0,E=0;typeof v=="number"?d=p=S=E=Math.min(v,n/2,a/2):(d=Math.min(v[0]||0,n/2,a/2),p=Math.min(v[1]||0,n/2,a/2),E=Math.min(v[2]||0,n/2,a/2),S=Math.min(v[3]||0,n/2,a/2)),e.beginPath(),e.moveTo(d,0),l===jd&&(e.lineTo((n-f)/2,0),e.lineTo(n/2,-1*h),e.lineTo((n+f)/2,0)),e.lineTo(n-p,0),e.arc(n-p,p,p,Math.PI*3/2,0,!1),l===Yd&&(e.lineTo(n,(a-h)/2),e.lineTo(n+f,a/2),e.lineTo(n,(a+h)/2)),e.lineTo(n,a-E),e.arc(n-E,a-E,E,0,Math.PI/2,!1),l===Xd&&(e.lineTo((n+f)/2,a),e.lineTo(n/2,a+h),e.lineTo((n-f)/2,a)),e.lineTo(S,a),e.arc(S,a-S,S,Math.PI/2,Math.PI,!1),l===Kd&&(e.lineTo(0,(a+h)/2),e.lineTo(-1*f,a/2),e.lineTo(0,(a-h)/2)),e.lineTo(0,d),e.arc(d,d,d,Math.PI,Math.PI*3/2,!1),e.closePath(),e.fillStrokeShape(this)}getSelfRect(){var e=0,n=0,a=this.pointerWidth(),l=this.pointerHeight(),f=this.pointerDirection(),h=this.width(),v=this.height();return f===jd?(n-=l,v+=l):f===Xd?v+=l:f===Kd?(e-=a*1.5,h+=a):f===Yd&&(h+=a*1.5),{x:e,y:n,width:h,height:v}}}io.prototype.className="Tag";Yt(io);F.addGetterSetter(io,"pointerDirection",G3);F.addGetterSetter(io,"pointerWidth",0,Ae());F.addGetterSetter(io,"pointerHeight",0,Ae());F.addGetterSetter(io,"cornerRadius",0,em(4));class cu extends me{_sceneFunc(e){var n=this.cornerRadius(),a=this.width(),l=this.height();if(e.beginPath(),!n)e.rect(0,0,a,l);else{let f=0,h=0,v=0,d=0;typeof n=="number"?f=h=v=d=Math.min(n,a/2,l/2):(f=Math.min(n[0]||0,a/2,l/2),h=Math.min(n[1]||0,a/2,l/2),d=Math.min(n[2]||0,a/2,l/2),v=Math.min(n[3]||0,a/2,l/2)),e.moveTo(f,0),e.lineTo(a-h,0),e.arc(a-h,h,h,Math.PI*3/2,0,!1),e.lineTo(a,l-d),e.arc(a-d,l-d,d,0,Math.PI/2,!1),e.lineTo(v,l),e.arc(v,l-v,v,Math.PI/2,Math.PI,!1),e.lineTo(0,f),e.arc(f,f,f,Math.PI,Math.PI*3/2,!1)}e.closePath(),e.fillStrokeShape(this)}}cu.prototype.className="Rect";Yt(cu);F.addGetterSetter(cu,"cornerRadius",0,em(4));class ao extends me{_sceneFunc(e){const n=this._getPoints();e.beginPath(),e.moveTo(n[0].x,n[0].y);for(var a=1;a<n.length;a++)e.lineTo(n[a].x,n[a].y);e.closePath(),e.fillStrokeShape(this)}_getPoints(){const e=this.attrs.sides,n=this.attrs.radius||0,a=[];for(var l=0;l<e;l++)a.push({x:n*Math.sin(l*2*Math.PI/e),y:-1*n*Math.cos(l*2*Math.PI/e)});return a}getSelfRect(){const e=this._getPoints();var n=e[0].x,a=e[0].y,l=e[0].x,f=e[0].y;return e.forEach(h=>{n=Math.min(n,h.x),a=Math.max(a,h.x),l=Math.min(l,h.y),f=Math.max(f,h.y)}),{x:n,y:l,width:a-n,height:f-l}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}}ao.prototype.className="RegularPolygon";ao.prototype._centroid=!0;ao.prototype._attrsAffectingSize=["radius"];Yt(ao);F.addGetterSetter(ao,"radius",0,Ae());F.addGetterSetter(ao,"sides",0,Ae());var Wg=Math.PI*2;class oo extends me{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.innerRadius(),0,Wg,!1),e.moveTo(this.outerRadius(),0),e.arc(0,0,this.outerRadius(),Wg,0,!0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}}oo.prototype.className="Ring";oo.prototype._centroid=!0;oo.prototype._attrsAffectingSize=["innerRadius","outerRadius"];Yt(oo);F.addGetterSetter(oo,"innerRadius",0,Ae());F.addGetterSetter(oo,"outerRadius",0,Ae());class vi extends me{constructor(e){super(e);this._updated=!0,this.anim=new vn(()=>{var n=this._updated;return this._updated=!1,n}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){!this.anim.isRunning()||(clearInterval(this.interval),this._setInterval())})}_sceneFunc(e){var n=this.animation(),a=this.frameIndex(),l=a*4,f=this.animations()[n],h=this.frameOffsets(),v=f[l+0],d=f[l+1],p=f[l+2],S=f[l+3],E=this.image();if((this.hasFill()||this.hasStroke())&&(e.beginPath(),e.rect(0,0,p,S),e.closePath(),e.fillStrokeShape(this)),E)if(h){var A=h[n],O=a*2;e.drawImage(E,v,d,p,S,A[O+0],A[O+1],p,S)}else e.drawImage(E,v,d,p,S,0,0,p,S)}_hitFunc(e){var n=this.animation(),a=this.frameIndex(),l=a*4,f=this.animations()[n],h=this.frameOffsets(),v=f[l+2],d=f[l+3];if(e.beginPath(),h){var p=h[n],S=a*2;e.rect(p[S+0],p[S+1],v,d)}else e.rect(0,0,v,d);e.closePath(),e.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){var e=this;this.interval=setInterval(function(){e._updateIndex()},1e3/this.frameRate())}start(){if(!this.isRunning()){var e=this.getLayer();this.anim.setLayers(e),this._setInterval(),this.anim.start()}}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){var e=this.frameIndex(),n=this.animation(),a=this.animations(),l=a[n],f=l.length/4;e<f-1?this.frameIndex(e+1):this.frameIndex(0)}}vi.prototype.className="Sprite";Yt(vi);F.addGetterSetter(vi,"animation");F.addGetterSetter(vi,"animations");F.addGetterSetter(vi,"frameOffsets");F.addGetterSetter(vi,"image");F.addGetterSetter(vi,"frameIndex",0,Ae());F.addGetterSetter(vi,"frameRate",17,Ae());F.backCompat(vi,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});class da extends me{_sceneFunc(e){var n=this.innerRadius(),a=this.outerRadius(),l=this.numPoints();e.beginPath(),e.moveTo(0,0-a);for(var f=1;f<l*2;f++){var h=f%2===0?a:n,v=h*Math.sin(f*Math.PI/l),d=-1*h*Math.cos(f*Math.PI/l);e.lineTo(v,d)}e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}}da.prototype.className="Star";da.prototype._centroid=!0;da.prototype._attrsAffectingSize=["innerRadius","outerRadius"];Yt(da);F.addGetterSetter(da,"numPoints",5,Ae());F.addGetterSetter(da,"innerRadius",0,Ae());F.addGetterSetter(da,"outerRadius",0,Ae());function Tm(r){return Array.from(r)}var Jf="auto",B3="center",kl="justify",U3="Change.konva",H3="2d",Bg="-",Cm="left",z3="text",j3="Text",Y3="top",X3="bottom",Ug="middle",Em="normal",K3="px ",eh=" ",q3="right",V3="word",Z3="char",Q3="none",Cd="\u2026",Am=["fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],J3=Am.length;function eF(r){return r.split(",").map(e=>{e=e.trim();const n=e.indexOf(" ")>=0,a=e.indexOf('"')>=0||e.indexOf("'")>=0;return n&&!a&&(e=`"${e}"`),e}).join(", ")}var th;function Ed(){return th||(th=ee.createCanvasElement().getContext(H3),th)}function tF(r){r.fillText(this._partialText,this._partialTextX,this._partialTextY)}function rF(r){r.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function nF(r){return r=r||{},!r.fillLinearGradientColorStops&&!r.fillRadialGradientColorStops&&!r.fillPatternImage&&(r.fill=r.fill||"black"),r}class jt extends me{constructor(e){super(nF(e));this._partialTextX=0,this._partialTextY=0;for(var n=0;n<J3;n++)this.on(Am[n]+U3,this._setTextData);this._setTextData()}_sceneFunc(e){var n=this.textArr,a=n.length;if(!!this.text()){var l=this.padding(),f=this.fontSize(),h=this.lineHeight()*f,v=this.verticalAlign(),d=0,p=this.align(),S=this.getWidth(),E=this.letterSpacing(),A=this.fill(),O=this.textDecoration(),k=O.indexOf("underline")!==-1,T=O.indexOf("line-through")!==-1,x,G=0,G=h/2,j=0,B=0;for(e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",Ug),e.setAttr("textAlign",Cm),v===Ug?d=(this.getHeight()-a*h-l*2)/2:v===X3&&(d=this.getHeight()-a*h-l*2),e.translate(l,d+l),x=0;x<a;x++){var j=0,B=0,U=n[x],J=U.text,P=U.width,I=U.lastInParagraph,D,R,Y;if(e.save(),p===q3?j+=S-P-l*2:p===B3&&(j+=(S-P-l*2)/2),k&&(e.save(),e.beginPath(),e.moveTo(j,G+B+Math.round(f/2)),D=J.split(" ").length-1,R=D===0,Y=p===kl&&I&&!R?S-l*2:P,e.lineTo(j+Math.round(Y),G+B+Math.round(f/2)),e.lineWidth=f/15,e.strokeStyle=A,e.stroke(),e.restore()),T&&(e.save(),e.beginPath(),e.moveTo(j,G+B),D=J.split(" ").length-1,R=D===0,Y=p===kl&&I&&!R?S-l*2:P,e.lineTo(j+Math.round(Y),G+B),e.lineWidth=f/15,e.strokeStyle=A,e.stroke(),e.restore()),E!==0||p===kl){D=J.split(" ").length-1;for(var re=Tm(J),se=0;se<re.length;se++){var Q=re[se];Q===" "&&!I&&p===kl&&(j+=(S-l*2-P)/D),this._partialTextX=j,this._partialTextY=G+B,this._partialText=Q,e.fillStrokeShape(this),j+=this.measureSize(Q).width+E}}else this._partialTextX=j,this._partialTextY=G+B,this._partialText=J,e.fillStrokeShape(this);e.restore(),a>1&&(G+=h)}}}_hitFunc(e){var n=this.getWidth(),a=this.getHeight();e.beginPath(),e.rect(0,0,n,a),e.closePath(),e.fillStrokeShape(this)}setText(e){var n=ee._isString(e)?e:e==null?"":e+"";return this._setAttr(z3,n),this}getWidth(){var e=this.attrs.width===Jf||this.attrs.width===void 0;return e?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){var e=this.attrs.height===Jf||this.attrs.height===void 0;return e?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return ee.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(e){var n=Ed(),a=this.fontSize(),l;return n.save(),n.font=this._getContextFont(),l=n.measureText(e),n.restore(),{width:l.width,height:a}}_getContextFont(){return this.fontStyle()+eh+this.fontVariant()+eh+(this.fontSize()+K3)+eF(this.fontFamily())}_addTextLine(e){this.align()===kl&&(e=e.trim());var n=this._getTextWidth(e);return this.textArr.push({text:e,width:n,lastInParagraph:!1})}_getTextWidth(e){var n=this.letterSpacing(),a=e.length;return Ed().measureText(e).width+(a?n*(a-1):0)}_setTextData(){var e=this.text().split(`
`),n=+this.fontSize(),a=0,l=this.lineHeight()*n,f=this.attrs.width,h=this.attrs.height,v=f!==Jf&&f!==void 0,d=h!==Jf&&h!==void 0,p=this.padding(),S=f-p*2,E=h-p*2,A=0,O=this.wrap(),k=O!==Q3,T=O!==Z3&&k,x=this.ellipsis();this.textArr=[],Ed().font=this._getContextFont();for(var G=x?this._getTextWidth(Cd):0,j=0,B=e.length;j<B;++j){var U=e[j],J=this._getTextWidth(U);if(v&&J>S)for(;U.length>0;){for(var P=0,I=U.length,D="",R=0;P<I;){var Y=P+I>>>1,re=U.slice(0,Y+1),se=this._getTextWidth(re)+G;se<=S?(P=Y+1,D=re,R=se):I=Y}if(D){if(T){var Q,q=U[D.length],Ce=q===eh||q===Bg;Ce&&R<=S?Q=D.length:Q=Math.max(D.lastIndexOf(eh),D.lastIndexOf(Bg))+1,Q>0&&(P=Q,D=D.slice(0,P),R=this._getTextWidth(D))}if(D=D.trimRight(),this._addTextLine(D),a=Math.max(a,R),A+=l,!k||d&&A+l>E){var K=this.textArr[this.textArr.length-1];if(K&&x){var ne=this._getTextWidth(K.text+Cd)<S;ne||(K.text=K.text.slice(0,K.text.length-3)),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(K.text+Cd)}break}if(U=U.slice(P),U=U.trimLeft(),U.length>0&&(J=this._getTextWidth(U),J<=S)){this._addTextLine(U),A+=l,a=Math.max(a,J);break}}else break}else this._addTextLine(U),A+=l,a=Math.max(a,J);if(d&&A+l>E)break;this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0)}this.textHeight=n,this.textWidth=a}getStrokeScaleEnabled(){return!0}}jt.prototype._fillFunc=tF;jt.prototype._strokeFunc=rF;jt.prototype.className=j3;jt.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];Yt(jt);F.overWriteSetter(jt,"width",$v());F.overWriteSetter(jt,"height",$v());F.addGetterSetter(jt,"fontFamily","Arial");F.addGetterSetter(jt,"fontSize",12,Ae());F.addGetterSetter(jt,"fontStyle",Em);F.addGetterSetter(jt,"fontVariant",Em);F.addGetterSetter(jt,"padding",0,Ae());F.addGetterSetter(jt,"align",Cm);F.addGetterSetter(jt,"verticalAlign",Y3);F.addGetterSetter(jt,"lineHeight",1,Ae());F.addGetterSetter(jt,"wrap",V3);F.addGetterSetter(jt,"ellipsis",!1,Gn());F.addGetterSetter(jt,"letterSpacing",0,Ae());F.addGetterSetter(jt,"text","",Ss());F.addGetterSetter(jt,"textDecoration","");var iF="",wm="normal";function km(r){r.fillText(this.partialText,0,0)}function Om(r){r.strokeText(this.partialText,0,0)}class dr extends me{constructor(e){super(e);this.dummyCanvas=ee.createCanvasElement(),this.dataArray=[],this.dataArray=wt.parsePathData(this.attrs.data),this.on("dataChange.konva",function(){this.dataArray=wt.parsePathData(this.attrs.data),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_sceneFunc(e){e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",this.textBaseline()),e.setAttr("textAlign","left"),e.save();var n=this.textDecoration(),a=this.fill(),l=this.fontSize(),f=this.glyphInfo;n==="underline"&&e.beginPath();for(var h=0;h<f.length;h++){e.save();var v=f[h].p0;e.translate(v.x,v.y),e.rotate(f[h].rotation),this.partialText=f[h].text,e.fillStrokeShape(this),n==="underline"&&(h===0&&e.moveTo(0,l/2+1),e.lineTo(l,l/2+1)),e.restore()}n==="underline"&&(e.strokeStyle=a,e.lineWidth=l/20,e.stroke()),e.restore()}_hitFunc(e){e.beginPath();var n=this.glyphInfo;if(n.length>=1){var a=n[0].p0;e.moveTo(a.x,a.y)}for(var l=0;l<n.length;l++){var f=n[l].p1;e.lineTo(f.x,f.y)}e.setAttr("lineWidth",this.fontSize()),e.setAttr("strokeStyle",this.colorKey),e.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return ee.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(e){return jt.prototype.setText.call(this,e)}_getContextFont(){return jt.prototype._getContextFont.call(this)}_getTextSize(e){var n=this.dummyCanvas,a=n.getContext("2d");a.save(),a.font=this._getContextFont();var l=a.measureText(e);return a.restore(),{width:l.width,height:parseInt(this.attrs.fontSize,10)}}_setTextData(){var e=this,n=this._getTextSize(this.attrs.text),a=this.letterSpacing(),l=this.align(),f=this.kerningFunc();this.textWidth=n.width,this.textHeight=n.height;var h=Math.max(this.textWidth+((this.attrs.text||"").length-1)*a,0);this.glyphInfo=[];for(var v=0,d=0;d<e.dataArray.length;d++)e.dataArray[d].pathLength>0&&(v+=e.dataArray[d].pathLength);var p=0;l==="center"&&(p=Math.max(0,v/2-h/2)),l==="right"&&(p=Math.max(0,v-h));for(var S=Tm(this.text()),E=this.text().split(" ").length-1,A,O,k,T=-1,x=0,G=function(){x=0;for(var se=e.dataArray,Q=T+1;Q<se.length;Q++){if(se[Q].pathLength>0)return T=Q,se[Q];se[Q].command==="M"&&(A={x:se[Q].points[0],y:se[Q].points[1]})}return{}},j=function(se){var Q=e._getTextSize(se).width+a;se===" "&&l==="justify"&&(Q+=(v-h)/E);var q=0,Ce=0;for(O=void 0;Math.abs(Q-q)/Q>.01&&Ce<20;){Ce++;for(var K=q;k===void 0;)k=G(),k&&K+k.pathLength<Q&&(K+=k.pathLength,k=void 0);if(k==={}||A===void 0)return;var ne=!1;switch(k.command){case"L":wt.getLineLength(A.x,A.y,k.points[0],k.points[1])>Q?O=wt.getPointOnLine(Q,A.x,A.y,k.points[0],k.points[1],A.x,A.y):k=void 0;break;case"A":var te=k.points[4],pe=k.points[5],le=k.points[4]+pe;x===0?x=te+1e-8:Q>q?x+=Math.PI/180*pe/Math.abs(pe):x-=Math.PI/360*pe/Math.abs(pe),(pe<0&&x<le||pe>=0&&x>le)&&(x=le,ne=!0),O=wt.getPointOnEllipticalArc(k.points[0],k.points[1],k.points[2],k.points[3],x,k.points[6]);break;case"C":x===0?Q>k.pathLength?x=1e-8:x=Q/k.pathLength:Q>q?x+=(Q-q)/k.pathLength/2:x=Math.max(x-(q-Q)/k.pathLength/2,0),x>1&&(x=1,ne=!0),O=wt.getPointOnCubicBezier(x,k.start.x,k.start.y,k.points[0],k.points[1],k.points[2],k.points[3],k.points[4],k.points[5]);break;case"Q":x===0?x=Q/k.pathLength:Q>q?x+=(Q-q)/k.pathLength:x-=(q-Q)/k.pathLength,x>1&&(x=1,ne=!0),O=wt.getPointOnQuadraticBezier(x,k.start.x,k.start.y,k.points[0],k.points[1],k.points[2],k.points[3]);break}O!==void 0&&(q=wt.getLineLength(A.x,A.y,O.x,O.y)),ne&&(ne=!1,k=void 0)}},B="C",U=e._getTextSize(B).width+a,J=p/U-1,P=0;P<J&&(j(B),!(A===void 0||O===void 0));P++)A=O;for(var I=0;I<S.length&&(j(S[I]),!(A===void 0||O===void 0));I++){var D=wt.getLineLength(A.x,A.y,O.x,O.y),R=0;if(f)try{R=f(S[I-1],S[I])*this.fontSize()}catch{R=0}A.x+=R,O.x+=R,this.textWidth+=R;var Y=wt.getPointOnLine(R+D/2,A.x,A.y,O.x,O.y),re=Math.atan2(O.y-A.y,O.x-A.x);this.glyphInfo.push({transposeX:Y.x,transposeY:Y.y,text:S[I],rotation:re,p0:A,p1:O}),A=O}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};var e=[];this.glyphInfo.forEach(function(S){e.push(S.p0.x),e.push(S.p0.y),e.push(S.p1.x),e.push(S.p1.y)});for(var n=e[0]||0,a=e[0]||0,l=e[1]||0,f=e[1]||0,h,v,d=0;d<e.length/2;d++)h=e[d*2],v=e[d*2+1],n=Math.min(n,h),a=Math.max(a,h),l=Math.min(l,v),f=Math.max(f,v);var p=this.fontSize();return{x:n-p/2,y:l-p/2,width:a-n+p,height:f-l+p}}}dr.prototype._fillFunc=km;dr.prototype._strokeFunc=Om;dr.prototype._fillFuncHit=km;dr.prototype._strokeFuncHit=Om;dr.prototype.className="TextPath";dr.prototype._attrsAffectingSize=["text","fontSize","data"];Yt(dr);F.addGetterSetter(dr,"data");F.addGetterSetter(dr,"fontFamily","Arial");F.addGetterSetter(dr,"fontSize",12,Ae());F.addGetterSetter(dr,"fontStyle",wm);F.addGetterSetter(dr,"align","left");F.addGetterSetter(dr,"letterSpacing",0,Ae());F.addGetterSetter(dr,"textBaseline","middle");F.addGetterSetter(dr,"fontVariant",wm);F.addGetterSetter(dr,"text",iF);F.addGetterSetter(dr,"textDecoration",null);F.addGetterSetter(dr,"kerningFunc",null);var xm="tr-konva",aF=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange"].map(r=>r+`.${xm}`).join(" "),Hg="nodesRect",oF=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],sF={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135};const lF="ontouchstart"in De._global;function uF(r,e){if(r==="rotater")return"crosshair";e+=ee.degToRad(sF[r]||0);var n=(ee.radToDeg(e)%360+360)%360;return ee._inRange(n,315+22.5,360)||ee._inRange(n,0,22.5)?"ns-resize":ee._inRange(n,45-22.5,45+22.5)?"nesw-resize":ee._inRange(n,90-22.5,90+22.5)?"ew-resize":ee._inRange(n,135-22.5,135+22.5)?"nwse-resize":ee._inRange(n,180-22.5,180+22.5)?"ns-resize":ee._inRange(n,225-22.5,225+22.5)?"nesw-resize":ee._inRange(n,270-22.5,270+22.5)?"ew-resize":ee._inRange(n,315-22.5,315+22.5)?"nwse-resize":(ee.error("Transformer has unknown angle for cursor detection: "+n),"pointer")}var gh=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"],zg=1e8;function fF(r){return{x:r.x+r.width/2*Math.cos(r.rotation)+r.height/2*Math.sin(-r.rotation),y:r.y+r.height/2*Math.cos(r.rotation)+r.width/2*Math.sin(r.rotation)}}function Rm(r,e,n){const a=n.x+(r.x-n.x)*Math.cos(e)-(r.y-n.y)*Math.sin(e),l=n.y+(r.x-n.x)*Math.sin(e)+(r.y-n.y)*Math.cos(e);return Object.assign(Object.assign({},r),{rotation:r.rotation+e,x:a,y:l})}function hF(r,e){const n=fF(r);return Rm(r,e,n)}function cF(r,e,n){let a=e;for(let l=0;l<r.length;l++){const f=De.getAngle(r[l]),h=Math.abs(f-e)%(Math.PI*2);Math.min(h,Math.PI*2-h)<n&&(a=f)}return a}class St extends ss{constructor(e){super(e);this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(aF,this.update),this.getNode()&&this.update()}attachTo(e){return this.setNode(e),this}setNode(e){return ee.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([e])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return xm+this._id}setNodes(e=[]){this._nodes&&this._nodes.length&&this.detach(),this._nodes=e,e.length===1&&this.useSingleNodeRotation()?this.rotation(e[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(a=>{const l=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()},f=a._attrsAffectingSize.map(h=>h+"Change."+this._getEventNamespace()).join(" ");a.on(f,l),a.on(oF.map(h=>h+`.${this._getEventNamespace()}`).join(" "),l),a.on(`absoluteTransformChange.${this._getEventNamespace()}`,l),this._proxyDrag(a)}),this._resetTransformCache();var n=!!this.findOne(".top-left");return n&&this.update(),this}_proxyDrag(e){let n;e.on(`dragstart.${this._getEventNamespace()}`,a=>{n=e.getAbsolutePosition(),!this.isDragging()&&e!==this.findOne(".back")&&this.startDrag(a,!1)}),e.on(`dragmove.${this._getEventNamespace()}`,a=>{if(!n)return;const l=e.getAbsolutePosition(),f=l.x-n.x,h=l.y-n.y;this.nodes().forEach(v=>{if(v===e||v.isDragging())return;const d=v.getAbsolutePosition();v.setAbsolutePosition({x:d.x+f,y:d.y+h}),v.startDrag(a)}),n=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(e=>{e.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(Hg),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(Hg,this.__getNodeRect)}__getNodeShape(e,n=this.rotation(),a){var l=e.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),f=e.getAbsoluteScale(a),h=e.getAbsolutePosition(a),v=l.x*f.x-e.offsetX()*f.x,d=l.y*f.y-e.offsetY()*f.y;const p=(De.getAngle(e.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),S={x:h.x+v*Math.cos(p)+d*Math.sin(-p),y:h.y+d*Math.cos(p)+v*Math.sin(p),width:l.width*f.x,height:l.height*f.y,rotation:p};return Rm(S,-De.getAngle(n),{x:0,y:0})}__getNodeRect(){var e=this.getNode();if(!e)return{x:-zg,y:-zg,width:0,height:0,rotation:0};const n=[];this.nodes().map(p=>{const S=p.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()});var E=[{x:S.x,y:S.y},{x:S.x+S.width,y:S.y},{x:S.x+S.width,y:S.y+S.height},{x:S.x,y:S.y+S.height}],A=p.getAbsoluteTransform();E.forEach(function(O){var k=A.point(O);n.push(k)})});const a=new Jr;a.rotate(-De.getAngle(this.rotation()));var l,f,h,v;n.forEach(function(p){var S=a.point(p);l===void 0&&(l=h=S.x,f=v=S.y),l=Math.min(l,S.x),f=Math.min(f,S.y),h=Math.max(h,S.x),v=Math.max(v,S.y)}),a.invert();const d=a.point({x:l,y:f});return{x:d.x,y:d.y,width:h-l,height:v-f,rotation:De.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),gh.forEach(function(e){this._createAnchor(e)}.bind(this)),this._createAnchor("rotater")}_createAnchor(e){var n=new cu({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:e+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:lF?10:"auto"}),a=this;n.on("mousedown touchstart",function(l){a._handleMouseDown(l)}),n.on("dragstart",l=>{n.stopDrag(),l.cancelBubble=!0}),n.on("dragend",l=>{l.cancelBubble=!0}),n.on("mouseenter",()=>{var l=De.getAngle(this.rotation()),f=uF(e,l);n.getStage().content&&(n.getStage().content.style.cursor=f),this._cursorChange=!0}),n.on("mouseout",()=>{n.getStage().content&&(n.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(n)}_createBack(){var e=new me({name:"back",width:0,height:0,draggable:!0,sceneFunc(n){var a=this.getParent(),l=a.padding();n.beginPath(),n.rect(-l,-l,this.width()+l*2,this.height()+l*2),n.moveTo(this.width()/2,-l),a.rotateEnabled()&&n.lineTo(this.width()/2,-a.rotateAnchorOffset()*ee._sign(this.height())-l),n.fillStrokeShape(this)},hitFunc:(n,a)=>{if(!!this.shouldOverdrawWholeArea()){var l=this.padding();n.beginPath(),n.rect(-l,-l,a.width()+l*2,a.height()+l*2),n.fillStrokeShape(a)}}});this.add(e),this._proxyDrag(e),e.on("dragstart",n=>{n.cancelBubble=!0}),e.on("dragmove",n=>{n.cancelBubble=!0}),e.on("dragend",n=>{n.cancelBubble=!0}),this.on("dragmove",n=>{this.update()})}_handleMouseDown(e){this._movingAnchorName=e.target.name().split(" ")[0];var n=this._getNodeRect(),a=n.width,l=n.height,f=Math.sqrt(Math.pow(a,2)+Math.pow(l,2));this.sin=Math.abs(l/f),this.cos=Math.abs(a/f),typeof window!="undefined"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;var h=e.target.getAbsolutePosition(),v=e.target.getStage().getPointerPosition();this._anchorDragOffset={x:v.x-h.x,y:v.y-h.y},this._fire("transformstart",{evt:e.evt,target:this.getNode()}),this._nodes.forEach(d=>{d._fire("transformstart",{evt:e.evt,target:d})})}_handleMouseMove(e){var n,a,l,f=this.findOne("."+this._movingAnchorName),h=f.getStage();h.setPointersPositions(e);const v=h.getPointerPosition();let d={x:v.x-this._anchorDragOffset.x,y:v.y-this._anchorDragOffset.y};const p=f.getAbsolutePosition();this.anchorDragBoundFunc()&&(d=this.anchorDragBoundFunc()(p,d,e)),f.setAbsolutePosition(d);const S=f.getAbsolutePosition();if(!(p.x===S.x&&p.y===S.y)){if(this._movingAnchorName==="rotater"){var E=this._getNodeRect();n=f.x()-E.width/2,a=-f.y()+E.height/2;let se=Math.atan2(-a,n)+Math.PI/2;E.height<0&&(se-=Math.PI);var A=De.getAngle(this.rotation());const Q=A+se,q=De.getAngle(this.rotationSnapTolerance()),K=cF(this.rotationSnaps(),Q,q)-E.rotation,ne=hF(E,K);this._fitNodesInto(ne,e);return}var O=this.keepRatio()||e.shiftKey,j=this.centeredScaling()||e.altKey;if(this._movingAnchorName==="top-left"){if(O){var k=j?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};l=Math.sqrt(Math.pow(k.x-f.x(),2)+Math.pow(k.y-f.y(),2));var T=this.findOne(".top-left").x()>k.x?-1:1,x=this.findOne(".top-left").y()>k.y?-1:1;n=l*this.cos*T,a=l*this.sin*x,this.findOne(".top-left").x(k.x-n),this.findOne(".top-left").y(k.y-a)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(f.y());else if(this._movingAnchorName==="top-right"){if(O){var k=j?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};l=Math.sqrt(Math.pow(f.x()-k.x,2)+Math.pow(k.y-f.y(),2));var T=this.findOne(".top-right").x()<k.x?-1:1,x=this.findOne(".top-right").y()>k.y?-1:1;n=l*this.cos*T,a=l*this.sin*x,this.findOne(".top-right").x(k.x+n),this.findOne(".top-right").y(k.y-a)}var G=f.position();this.findOne(".top-left").y(G.y),this.findOne(".bottom-right").x(G.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(f.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(f.x());else if(this._movingAnchorName==="bottom-left"){if(O){var k=j?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};l=Math.sqrt(Math.pow(k.x-f.x(),2)+Math.pow(f.y()-k.y,2));var T=k.x<f.x()?-1:1,x=f.y()<k.y?-1:1;n=l*this.cos*T,a=l*this.sin*x,f.x(k.x-n),f.y(k.y+a)}G=f.position(),this.findOne(".top-left").x(G.x),this.findOne(".bottom-right").y(G.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(f.y());else if(this._movingAnchorName==="bottom-right"){if(O){var k=j?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};l=Math.sqrt(Math.pow(f.x()-k.x,2)+Math.pow(f.y()-k.y,2));var T=this.findOne(".bottom-right").x()<k.x?-1:1,x=this.findOne(".bottom-right").y()<k.y?-1:1;n=l*this.cos*T,a=l*this.sin*x,this.findOne(".bottom-right").x(k.x+n),this.findOne(".bottom-right").y(k.y+a)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));var j=this.centeredScaling()||e.altKey;if(j){var B=this.findOne(".top-left"),U=this.findOne(".bottom-right"),J=B.x(),P=B.y(),I=this.getWidth()-U.x(),D=this.getHeight()-U.y();U.move({x:-J,y:-P}),B.move({x:I,y:D})}var R=this.findOne(".top-left").getAbsolutePosition();n=R.x,a=R.y;var Y=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),re=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:n,y:a,width:Y,height:re,rotation:De.getAngle(this.rotation())},e)}}_handleMouseUp(e){this._removeEvents(e)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(e){if(this._transforming){this._transforming=!1,typeof window!="undefined"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));var n=this.getNode();this._fire("transformend",{evt:e,target:n}),n&&this._nodes.forEach(a=>{a._fire("transformend",{evt:e,target:a})}),this._movingAnchorName=null}}_fitNodesInto(e,n){var a=this._getNodeRect();const l=1;if(ee._inRange(e.width,-this.padding()*2-l,l)){this.update();return}if(ee._inRange(e.height,-this.padding()*2-l,l)){this.update();return}const f=this.flipEnabled();var h=new Jr;if(h.rotate(De.getAngle(this.rotation())),this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("left")>=0){const E=h.point({x:-this.padding()*2,y:0});if(e.x+=E.x,e.y+=E.y,e.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=E.x,this._anchorDragOffset.y-=E.y,!f){this.update();return}}else if(this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("right")>=0){const E=h.point({x:this.padding()*2,y:0});if(this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=E.x,this._anchorDragOffset.y-=E.y,e.width+=this.padding()*2,!f){this.update();return}}if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("top")>=0){const E=h.point({x:0,y:-this.padding()*2});if(e.x+=E.x,e.y+=E.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=E.x,this._anchorDragOffset.y-=E.y,e.height+=this.padding()*2,!f){this.update();return}}else if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const E=h.point({x:0,y:this.padding()*2});if(this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=E.x,this._anchorDragOffset.y-=E.y,e.height+=this.padding()*2,!f){this.update();return}}if(this.boundBoxFunc()){const E=this.boundBoxFunc()(a,e);E?e=E:ee.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const v=1e7,d=new Jr;d.translate(a.x,a.y),d.rotate(a.rotation),d.scale(a.width/v,a.height/v);const p=new Jr;p.translate(e.x,e.y),p.rotate(e.rotation),p.scale(e.width/v,e.height/v);const S=p.multiply(d.invert());this._nodes.forEach(E=>{var A;const O=E.getParent().getAbsoluteTransform(),k=E.getTransform().copy();k.translate(E.offsetX(),E.offsetY());const T=new Jr;T.multiply(O.copy().invert()).multiply(S).multiply(O).multiply(k);const x=T.decompose();E.setAttrs(x),this._fire("transform",{evt:n,target:E}),E._fire("transform",{evt:n,target:E}),(A=E.getLayer())===null||A===void 0||A.batchDraw()}),this.rotation(ee._getRotation(e.rotation)),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(e,n){this.findOne(e).setAttrs(n)}update(){var e,n=this._getNodeRect();this.rotation(ee._getRotation(n.rotation));var a=n.width,l=n.height,f=this.enabledAnchors(),h=this.resizeEnabled(),v=this.padding(),d=this.anchorSize();this.find("._anchor").forEach(p=>{p.setAttrs({width:d,height:d,offsetX:d/2,offsetY:d/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:d/2+v,offsetY:d/2+v,visible:h&&f.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:a/2,y:0,offsetY:d/2+v,visible:h&&f.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:a,y:0,offsetX:d/2-v,offsetY:d/2+v,visible:h&&f.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:l/2,offsetX:d/2+v,visible:h&&f.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:a,y:l/2,offsetX:d/2-v,visible:h&&f.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:l,offsetX:d/2+v,offsetY:d/2-v,visible:h&&f.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:a/2,y:l,offsetY:d/2-v,visible:h&&f.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:a,y:l,offsetX:d/2-v,offsetY:d/2-v,visible:h&&f.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:a/2,y:-this.rotateAnchorOffset()*ee._sign(l)-v,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:a,height:l,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0}),(e=this.getLayer())===null||e===void 0||e.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();var e=this.findOne("."+this._movingAnchorName);e&&e.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),ss.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return we.prototype.toObject.call(this)}}function dF(r){return r instanceof Array||ee.warn("enabledAnchors value should be an array"),r instanceof Array&&r.forEach(function(e){gh.indexOf(e)===-1&&ee.warn("Unknown anchor name: "+e+". Available names are: "+gh.join(", "))}),r||[]}St.prototype.className="Transformer";Yt(St);F.addGetterSetter(St,"enabledAnchors",gh,dF);F.addGetterSetter(St,"flipEnabled",!0,Gn());F.addGetterSetter(St,"resizeEnabled",!0);F.addGetterSetter(St,"anchorSize",10,Ae());F.addGetterSetter(St,"rotateEnabled",!0);F.addGetterSetter(St,"rotationSnaps",[]);F.addGetterSetter(St,"rotateAnchorOffset",50,Ae());F.addGetterSetter(St,"rotationSnapTolerance",5,Ae());F.addGetterSetter(St,"borderEnabled",!0);F.addGetterSetter(St,"anchorStroke","rgb(0, 161, 255)");F.addGetterSetter(St,"anchorStrokeWidth",1,Ae());F.addGetterSetter(St,"anchorFill","white");F.addGetterSetter(St,"anchorCornerRadius",0,Ae());F.addGetterSetter(St,"borderStroke","rgb(0, 161, 255)");F.addGetterSetter(St,"borderStrokeWidth",1,Ae());F.addGetterSetter(St,"borderDash");F.addGetterSetter(St,"keepRatio",!0);F.addGetterSetter(St,"centeredScaling",!1);F.addGetterSetter(St,"ignoreStroke",!1);F.addGetterSetter(St,"padding",0,Ae());F.addGetterSetter(St,"node");F.addGetterSetter(St,"nodes");F.addGetterSetter(St,"boundBoxFunc");F.addGetterSetter(St,"anchorDragBoundFunc");F.addGetterSetter(St,"shouldOverdrawWholeArea",!1);F.addGetterSetter(St,"useSingleNodeRotation",!0);F.backCompat(St,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});class Gi extends me{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.radius(),0,De.getAngle(this.angle()),this.clockwise()),e.lineTo(0,0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}}Gi.prototype.className="Wedge";Gi.prototype._centroid=!0;Gi.prototype._attrsAffectingSize=["radius"];Yt(Gi);F.addGetterSetter(Gi,"radius",0,Ae());F.addGetterSetter(Gi,"angle",0,Ae());F.addGetterSetter(Gi,"clockwise",!1);F.backCompat(Gi,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});function jg(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}var vF=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],pF=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function gF(r,e){var n=r.data,a=r.width,l=r.height,f,h,v,d,p,S,E,A,O,k,T,x,G,j,B,U,J,P,I,D,R,Y,re,se,Q=e+e+1,q=a-1,Ce=l-1,K=e+1,ne=K*(K+1)/2,te=new jg,pe=null,le=te,Ee=null,Be=null,Ke=vF[e],Ne=pF[e];for(v=1;v<Q;v++)le=le.next=new jg,v===K&&(pe=le);for(le.next=te,E=S=0,h=0;h<l;h++){for(U=J=P=I=A=O=k=T=0,x=K*(D=n[S]),G=K*(R=n[S+1]),j=K*(Y=n[S+2]),B=K*(re=n[S+3]),A+=ne*D,O+=ne*R,k+=ne*Y,T+=ne*re,le=te,v=0;v<K;v++)le.r=D,le.g=R,le.b=Y,le.a=re,le=le.next;for(v=1;v<K;v++)d=S+((q<v?q:v)<<2),A+=(le.r=D=n[d])*(se=K-v),O+=(le.g=R=n[d+1])*se,k+=(le.b=Y=n[d+2])*se,T+=(le.a=re=n[d+3])*se,U+=D,J+=R,P+=Y,I+=re,le=le.next;for(Ee=te,Be=pe,f=0;f<a;f++)n[S+3]=re=T*Ke>>Ne,re!==0?(re=255/re,n[S]=(A*Ke>>Ne)*re,n[S+1]=(O*Ke>>Ne)*re,n[S+2]=(k*Ke>>Ne)*re):n[S]=n[S+1]=n[S+2]=0,A-=x,O-=G,k-=j,T-=B,x-=Ee.r,G-=Ee.g,j-=Ee.b,B-=Ee.a,d=E+((d=f+e+1)<q?d:q)<<2,U+=Ee.r=n[d],J+=Ee.g=n[d+1],P+=Ee.b=n[d+2],I+=Ee.a=n[d+3],A+=U,O+=J,k+=P,T+=I,Ee=Ee.next,x+=D=Be.r,G+=R=Be.g,j+=Y=Be.b,B+=re=Be.a,U-=D,J-=R,P-=Y,I-=re,Be=Be.next,S+=4;E+=a}for(f=0;f<a;f++){for(J=P=I=U=O=k=T=A=0,S=f<<2,x=K*(D=n[S]),G=K*(R=n[S+1]),j=K*(Y=n[S+2]),B=K*(re=n[S+3]),A+=ne*D,O+=ne*R,k+=ne*Y,T+=ne*re,le=te,v=0;v<K;v++)le.r=D,le.g=R,le.b=Y,le.a=re,le=le.next;for(p=a,v=1;v<=e;v++)S=p+f<<2,A+=(le.r=D=n[S])*(se=K-v),O+=(le.g=R=n[S+1])*se,k+=(le.b=Y=n[S+2])*se,T+=(le.a=re=n[S+3])*se,U+=D,J+=R,P+=Y,I+=re,le=le.next,v<Ce&&(p+=a);for(S=f,Ee=te,Be=pe,h=0;h<l;h++)d=S<<2,n[d+3]=re=T*Ke>>Ne,re>0?(re=255/re,n[d]=(A*Ke>>Ne)*re,n[d+1]=(O*Ke>>Ne)*re,n[d+2]=(k*Ke>>Ne)*re):n[d]=n[d+1]=n[d+2]=0,A-=x,O-=G,k-=j,T-=B,x-=Ee.r,G-=Ee.g,j-=Ee.b,B-=Ee.a,d=f+((d=h+K)<Ce?d:Ce)*a<<2,A+=U+=Ee.r=n[d],O+=J+=Ee.g=n[d+1],k+=P+=Ee.b=n[d+2],T+=I+=Ee.a=n[d+3],Ee=Ee.next,x+=D=Be.r,G+=R=Be.g,j+=Y=Be.b,B+=re=Be.a,U-=D,J-=R,P-=Y,I-=re,Be=Be.next,S+=a}}const yF=function(e){var n=Math.round(this.blurRadius());n>0&&gF(e,n)};F.addGetterSetter(we,"blurRadius",0,Ae(),F.afterSetFilter);const mF=function(r){var e=this.brightness()*255,n=r.data,a=n.length,l;for(l=0;l<a;l+=4)n[l]+=e,n[l+1]+=e,n[l+2]+=e};F.addGetterSetter(we,"brightness",0,Ae(),F.afterSetFilter);const _F=function(r){var e=Math.pow((this.contrast()+100)/100,2),n=r.data,a=n.length,l=150,f=150,h=150,v;for(v=0;v<a;v+=4)l=n[v],f=n[v+1],h=n[v+2],l/=255,l-=.5,l*=e,l+=.5,l*=255,f/=255,f-=.5,f*=e,f+=.5,f*=255,h/=255,h-=.5,h*=e,h+=.5,h*=255,l=l<0?0:l>255?255:l,f=f<0?0:f>255?255:f,h=h<0?0:h>255?255:h,n[v]=l,n[v+1]=f,n[v+2]=h};F.addGetterSetter(we,"contrast",0,Ae(),F.afterSetFilter);const bF=function(r){var e=this.embossStrength()*10,n=this.embossWhiteLevel()*255,a=this.embossDirection(),l=this.embossBlend(),f=0,h=0,v=r.data,d=r.width,p=r.height,S=d*4,E=p;switch(a){case"top-left":f=-1,h=-1;break;case"top":f=-1,h=0;break;case"top-right":f=-1,h=1;break;case"right":f=0,h=1;break;case"bottom-right":f=1,h=1;break;case"bottom":f=1,h=0;break;case"bottom-left":f=1,h=-1;break;case"left":f=0,h=-1;break;default:ee.error("Unknown emboss direction: "+a)}do{var A=(E-1)*S,O=f;E+O<1&&(O=0),E+O>p&&(O=0);var k=(E-1+O)*d*4,T=d;do{var x=A+(T-1)*4,G=h;T+G<1&&(G=0),T+G>d&&(G=0);var j=k+(T-1+G)*4,B=v[x]-v[j],U=v[x+1]-v[j+1],J=v[x+2]-v[j+2],P=B,I=P>0?P:-P,D=U>0?U:-U,R=J>0?J:-J;if(D>I&&(P=U),R>I&&(P=J),P*=e,l){var Y=v[x]+P,re=v[x+1]+P,se=v[x+2]+P;v[x]=Y>255?255:Y<0?0:Y,v[x+1]=re>255?255:re<0?0:re,v[x+2]=se>255?255:se<0?0:se}else{var Q=n-P;Q<0?Q=0:Q>255&&(Q=255),v[x]=v[x+1]=v[x+2]=Q}}while(--T)}while(--E)};F.addGetterSetter(we,"embossStrength",.5,Ae(),F.afterSetFilter);F.addGetterSetter(we,"embossWhiteLevel",.5,Ae(),F.afterSetFilter);F.addGetterSetter(we,"embossDirection","top-left",null,F.afterSetFilter);F.addGetterSetter(we,"embossBlend",!1,null,F.afterSetFilter);function Ad(r,e,n,a,l){var f=n-e,h=l-a,v;return f===0?a+h/2:h===0?a:(v=(r-e)/f,v=h*v+a,v)}const SF=function(r){var e=r.data,n=e.length,a=e[0],l=a,f,h=e[1],v=h,d,p=e[2],S=p,E,A,O=this.enhance();if(O!==0){for(A=0;A<n;A+=4)f=e[A+0],f<a?a=f:f>l&&(l=f),d=e[A+1],d<h?h=d:d>v&&(v=d),E=e[A+2],E<p?p=E:E>S&&(S=E);l===a&&(l=255,a=0),v===h&&(v=255,h=0),S===p&&(S=255,p=0);var k,T,x,G,j,B,U,J,P;for(O>0?(T=l+O*(255-l),x=a-O*(a-0),j=v+O*(255-v),B=h-O*(h-0),J=S+O*(255-S),P=p-O*(p-0)):(k=(l+a)*.5,T=l+O*(l-k),x=a+O*(a-k),G=(v+h)*.5,j=v+O*(v-G),B=h+O*(h-G),U=(S+p)*.5,J=S+O*(S-U),P=p+O*(p-U)),A=0;A<n;A+=4)e[A+0]=Ad(e[A+0],a,l,x,T),e[A+1]=Ad(e[A+1],h,v,B,j),e[A+2]=Ad(e[A+2],p,S,P,J)}};F.addGetterSetter(we,"enhance",0,Ae(),F.afterSetFilter);const TF=function(r){var e=r.data,n=e.length,a,l;for(a=0;a<n;a+=4)l=.34*e[a]+.5*e[a+1]+.16*e[a+2],e[a]=l,e[a+1]=l,e[a+2]=l};F.addGetterSetter(we,"hue",0,Ae(),F.afterSetFilter);F.addGetterSetter(we,"saturation",0,Ae(),F.afterSetFilter);F.addGetterSetter(we,"luminance",0,Ae(),F.afterSetFilter);const CF=function(r){var e=r.data,n=e.length,a=1,l=Math.pow(2,this.saturation()),f=Math.abs(this.hue()+360)%360,h=this.luminance()*127,v,d=a*l*Math.cos(f*Math.PI/180),p=a*l*Math.sin(f*Math.PI/180),S=.299*a+.701*d+.167*p,E=.587*a-.587*d+.33*p,A=.114*a-.114*d-.497*p,O=.299*a-.299*d-.328*p,k=.587*a+.413*d+.035*p,T=.114*a-.114*d+.293*p,x=.299*a-.3*d+1.25*p,G=.587*a-.586*d-1.05*p,j=.114*a+.886*d-.2*p,B,U,J,P;for(v=0;v<n;v+=4)B=e[v+0],U=e[v+1],J=e[v+2],P=e[v+3],e[v+0]=S*B+E*U+A*J+h,e[v+1]=O*B+k*U+T*J+h,e[v+2]=x*B+G*U+j*J+h,e[v+3]=P},EF=function(r){var e=r.data,n=e.length,a=Math.pow(2,this.value()),l=Math.pow(2,this.saturation()),f=Math.abs(this.hue()+360)%360,h,v=a*l*Math.cos(f*Math.PI/180),d=a*l*Math.sin(f*Math.PI/180),p=.299*a+.701*v+.167*d,S=.587*a-.587*v+.33*d,E=.114*a-.114*v-.497*d,A=.299*a-.299*v-.328*d,O=.587*a+.413*v+.035*d,k=.114*a-.114*v+.293*d,T=.299*a-.3*v+1.25*d,x=.587*a-.586*v-1.05*d,G=.114*a+.886*v-.2*d,j,B,U,J;for(h=0;h<n;h+=4)j=e[h+0],B=e[h+1],U=e[h+2],J=e[h+3],e[h+0]=p*j+S*B+E*U,e[h+1]=A*j+O*B+k*U,e[h+2]=T*j+x*B+G*U,e[h+3]=J};F.addGetterSetter(we,"hue",0,Ae(),F.afterSetFilter);F.addGetterSetter(we,"saturation",0,Ae(),F.afterSetFilter);F.addGetterSetter(we,"value",0,Ae(),F.afterSetFilter);const AF=function(r){var e=r.data,n=e.length,a;for(a=0;a<n;a+=4)e[a]=255-e[a],e[a+1]=255-e[a+1],e[a+2]=255-e[a+2]};var wF=function(r,e,n){var a=r.data,l=e.data,f=r.width,h=r.height,v=n.polarCenterX||f/2,d=n.polarCenterY||h/2,p,S,E,A=0,O=0,k=0,T=0,x,G=Math.sqrt(v*v+d*d);S=f-v,E=h-d,x=Math.sqrt(S*S+E*E),G=x>G?x:G;var j=h,B=f,U,J,P=360/B*Math.PI/180,I,D;for(J=0;J<B;J+=1)for(I=Math.sin(J*P),D=Math.cos(J*P),U=0;U<j;U+=1)S=Math.floor(v+G*U/j*D),E=Math.floor(d+G*U/j*I),p=(E*f+S)*4,A=a[p+0],O=a[p+1],k=a[p+2],T=a[p+3],p=(J+U*f)*4,l[p+0]=A,l[p+1]=O,l[p+2]=k,l[p+3]=T},kF=function(r,e,n){var a=r.data,l=e.data,f=r.width,h=r.height,v=n.polarCenterX||f/2,d=n.polarCenterY||h/2,p,S,E,A,O,k=0,T=0,x=0,G=0,j,B=Math.sqrt(v*v+d*d);S=f-v,E=h-d,j=Math.sqrt(S*S+E*E),B=j>B?j:B;var U=h,J=f,P,I,D=n.polarRotation||0,R,Y;for(S=0;S<f;S+=1)for(E=0;E<h;E+=1)A=S-v,O=E-d,P=Math.sqrt(A*A+O*O)*U/B,I=(Math.atan2(O,A)*180/Math.PI+360+D)%360,I=I*J/360,R=Math.floor(I),Y=Math.floor(P),p=(Y*f+R)*4,k=a[p+0],T=a[p+1],x=a[p+2],G=a[p+3],p=(E*f+S)*4,l[p+0]=k,l[p+1]=T,l[p+2]=x,l[p+3]=G};const OF=function(r){var e=r.width,n=r.height,a,l,f,h,v,d,p,S,E,A,O=Math.round(this.kaleidoscopePower()),k=Math.round(this.kaleidoscopeAngle()),T=Math.floor(e*(k%360)/360);if(!(O<1)){var x=ee.createCanvasElement();x.width=e,x.height=n;var G=x.getContext("2d").getImageData(0,0,e,n);wF(r,G,{polarCenterX:e/2,polarCenterY:n/2});for(var j=e/Math.pow(2,O);j<=8;)j=j*2,O-=1;j=Math.ceil(j);var B=j,U=0,J=B,P=1;for(T+j>e&&(U=B,J=0,P=-1),l=0;l<n;l+=1)for(a=U;a!==J;a+=P)f=Math.round(a+T)%e,E=(e*l+f)*4,v=G.data[E+0],d=G.data[E+1],p=G.data[E+2],S=G.data[E+3],A=(e*l+a)*4,G.data[A+0]=v,G.data[A+1]=d,G.data[A+2]=p,G.data[A+3]=S;for(l=0;l<n;l+=1)for(B=Math.floor(j),h=0;h<O;h+=1){for(a=0;a<B+1;a+=1)E=(e*l+a)*4,v=G.data[E+0],d=G.data[E+1],p=G.data[E+2],S=G.data[E+3],A=(e*l+B*2-a-1)*4,G.data[A+0]=v,G.data[A+1]=d,G.data[A+2]=p,G.data[A+3]=S;B*=2}kF(G,r,{polarRotation:0})}};F.addGetterSetter(we,"kaleidoscopePower",2,Ae(),F.afterSetFilter);F.addGetterSetter(we,"kaleidoscopeAngle",0,Ae(),F.afterSetFilter);function rh(r,e,n){var a=(n*r.width+e)*4,l=[];return l.push(r.data[a++],r.data[a++],r.data[a++],r.data[a++]),l}function Ol(r,e){return Math.sqrt(Math.pow(r[0]-e[0],2)+Math.pow(r[1]-e[1],2)+Math.pow(r[2]-e[2],2))}function xF(r){for(var e=[0,0,0],n=0;n<r.length;n++)e[0]+=r[n][0],e[1]+=r[n][1],e[2]+=r[n][2];return e[0]/=r.length,e[1]/=r.length,e[2]/=r.length,e}function RF(r,e){var n=rh(r,0,0),a=rh(r,r.width-1,0),l=rh(r,0,r.height-1),f=rh(r,r.width-1,r.height-1),h=e||10;if(Ol(n,a)<h&&Ol(a,f)<h&&Ol(f,l)<h&&Ol(l,n)<h){for(var v=xF([a,n,f,l]),d=[],p=0;p<r.width*r.height;p++){var S=Ol(v,[r.data[p*4],r.data[p*4+1],r.data[p*4+2]]);d[p]=S<h?0:255}return d}}function PF(r,e){for(var n=0;n<r.width*r.height;n++)r.data[4*n+3]=e[n]}function LF(r,e,n){for(var a=[1,1,1,1,0,1,1,1,1],l=Math.round(Math.sqrt(a.length)),f=Math.floor(l/2),h=[],v=0;v<n;v++)for(var d=0;d<e;d++){for(var p=v*e+d,S=0,E=0;E<l;E++)for(var A=0;A<l;A++){var O=v+E-f,k=d+A-f;if(O>=0&&O<n&&k>=0&&k<e){var T=O*e+k,x=a[E*l+A];S+=r[T]*x}}h[p]=S===255*8?255:0}return h}function IF(r,e,n){for(var a=[1,1,1,1,1,1,1,1,1],l=Math.round(Math.sqrt(a.length)),f=Math.floor(l/2),h=[],v=0;v<n;v++)for(var d=0;d<e;d++){for(var p=v*e+d,S=0,E=0;E<l;E++)for(var A=0;A<l;A++){var O=v+E-f,k=d+A-f;if(O>=0&&O<n&&k>=0&&k<e){var T=O*e+k,x=a[E*l+A];S+=r[T]*x}}h[p]=S>=255*4?255:0}return h}function NF(r,e,n){for(var a=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],l=Math.round(Math.sqrt(a.length)),f=Math.floor(l/2),h=[],v=0;v<n;v++)for(var d=0;d<e;d++){for(var p=v*e+d,S=0,E=0;E<l;E++)for(var A=0;A<l;A++){var O=v+E-f,k=d+A-f;if(O>=0&&O<n&&k>=0&&k<e){var T=O*e+k,x=a[E*l+A];S+=r[T]*x}}h[p]=S}return h}const MF=function(r){var e=this.threshold(),n=RF(r,e);return n&&(n=LF(n,r.width,r.height),n=IF(n,r.width,r.height),n=NF(n,r.width,r.height),PF(r,n)),r};F.addGetterSetter(we,"threshold",0,Ae(),F.afterSetFilter);const DF=function(r){var e=this.noise()*255,n=r.data,a=n.length,l=e/2,f;for(f=0;f<a;f+=4)n[f+0]+=l-2*l*Math.random(),n[f+1]+=l-2*l*Math.random(),n[f+2]+=l-2*l*Math.random()};F.addGetterSetter(we,"noise",.2,Ae(),F.afterSetFilter);const FF=function(r){var e=Math.ceil(this.pixelSize()),n=r.width,a=r.height,l,f,h,v,d,p,S,E=Math.ceil(n/e),A=Math.ceil(a/e),O,k,T,x,G,j,B,U=r.data;if(e<=0){ee.error("pixelSize value can not be <= 0");return}for(G=0;G<E;G+=1)for(j=0;j<A;j+=1){for(v=0,d=0,p=0,S=0,O=G*e,k=O+e,T=j*e,x=T+e,B=0,l=O;l<k;l+=1)if(!(l>=n))for(f=T;f<x;f+=1)f>=a||(h=(n*f+l)*4,v+=U[h+0],d+=U[h+1],p+=U[h+2],S+=U[h+3],B+=1);for(v=v/B,d=d/B,p=p/B,S=S/B,l=O;l<k;l+=1)if(!(l>=n))for(f=T;f<x;f+=1)f>=a||(h=(n*f+l)*4,U[h+0]=v,U[h+1]=d,U[h+2]=p,U[h+3]=S)}};F.addGetterSetter(we,"pixelSize",8,Ae(),F.afterSetFilter);const $F=function(r){var e=Math.round(this.levels()*254)+1,n=r.data,a=n.length,l=255/e,f;for(f=0;f<a;f+=1)n[f]=Math.floor(n[f]/l)*l};F.addGetterSetter(we,"levels",.5,Ae(),F.afterSetFilter);const GF=function(r){var e=r.data,n=e.length,a=this.red(),l=this.green(),f=this.blue(),h,v;for(h=0;h<n;h+=4)v=(.34*e[h]+.5*e[h+1]+.16*e[h+2])/255,e[h]=v*a,e[h+1]=v*l,e[h+2]=v*f,e[h+3]=e[h+3]};F.addGetterSetter(we,"red",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)});F.addGetterSetter(we,"green",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)});F.addGetterSetter(we,"blue",0,Jy,F.afterSetFilter);const WF=function(r){var e=r.data,n=e.length,a=this.red(),l=this.green(),f=this.blue(),h=this.alpha(),v,d;for(v=0;v<n;v+=4)d=1-h,e[v]=a*h+e[v]*d,e[v+1]=l*h+e[v+1]*d,e[v+2]=f*h+e[v+2]*d};F.addGetterSetter(we,"red",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)});F.addGetterSetter(we,"green",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)});F.addGetterSetter(we,"blue",0,Jy,F.afterSetFilter);F.addGetterSetter(we,"alpha",1,function(r){return this._filterUpToDate=!1,r>1?1:r<0?0:r});const BF=function(r){var e=r.data,n=e.length,a,l,f,h;for(a=0;a<n;a+=4)l=e[a+0],f=e[a+1],h=e[a+2],e[a+0]=Math.min(255,l*.393+f*.769+h*.189),e[a+1]=Math.min(255,l*.349+f*.686+h*.168),e[a+2]=Math.min(255,l*.272+f*.534+h*.131)},UF=function(r){var e=r.data,n=r.width,a=r.height,l=n*4,f=a;do{var h=(f-1)*l,v=n;do{var d=h+(v-1)*4,p=e[d],S=e[d+1],E=e[d+2];p>127&&(p=255-p),S>127&&(S=255-S),E>127&&(E=255-E),e[d]=p,e[d+1]=S,e[d+2]=E}while(--v)}while(--f)},HF=function(r){var e=this.threshold()*255,n=r.data,a=n.length,l;for(l=0;l<a;l+=1)n[l]=n[l]<e?0:255};F.addGetterSetter(we,"threshold",.5,Ae(),F.afterSetFilter);const C$=$g.Util._assign($g,{Arc:Fi,Arrow:no,Circle:Ts,Ellipse:ca,Image:Wn,Label:Uv,Tag:io,Line:$i,Path:wt,Rect:cu,RegularPolygon:ao,Ring:oo,Sprite:vi,Star:da,Text:jt,TextPath:dr,Transformer:St,Wedge:Gi,Filters:{Blur:yF,Brighten:mF,Contrast:_F,Emboss:bF,Enhance:SF,Grayscale:TF,HSL:CF,HSV:EF,Invert:AF,Kaleidoscope:OF,Mask:MF,Noise:DF,Pixelate:FF,Posterize:$F,RGB:GF,RGBA:WF,Sepia:BF,Solarize:UF,Threshold:HF}});export{l$ as A,rp as B,b$ as C,l_ as D,_e as E,_$ as F,u$ as G,jF as H,XF as I,KF as J,C$ as K,YF as L,ZF as M,jl as N,n$ as O,h$ as P,v$ as Q,c$ as R,m$ as S,d$ as T,t$ as U,p$ as V,f$ as W,a$ as a,JF as b,QF as c,o$ as d,e$ as e,Jm as f,qm as g,qF as h,y$ as i,Xg as j,r$ as k,i$ as l,Qm as m,ja as n,VF as o,S$ as p,g$ as q,a_ as r,Vm as s,qg as t,Zg as u,i_ as v,T$ as w,o_ as x,zF as y,s$ as z};
